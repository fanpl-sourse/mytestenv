webpackJsonpSm_name_([8],{1937:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"PLUGIN_NAME",function(){return un});var r=e(133),i=(e.n(r),e(2565),e(1)),o=e.n(i),a=e(6),c=e.n(a),u=e(90),l=e.n(u),s=e(481),f=e.n(s),v=e(345),d=e.n(v),p=e(112),g=e.n(p),b=e(3),h=e(0),I=e.n(h),m=e(2568),w=e(2578),C=e(2579),x=e(2127),A=e(2135),j=e(2115),M=e(2580),y=e(2252),O=e(17);e.n(O);e.d(t,"PivotTableEvents",function(){return A.b});var N,k=this&&this.__extends||(N=function(n,t){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}N(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),T=this&&this.__awaiter||function(n,t,e,r){return new(e||(e=Promise))(function(i,o){function a(n){try{u(r.next(n))}catch(n){o(n)}}function c(n){try{u(r.throw(n))}catch(n){o(n)}}function u(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e(function(n){n(t)})).then(a,c)}u((r=r.apply(n,t||[])).next())})},S=this&&this.__generator||function(n,t){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(n,a)}catch(n){o=[6,n],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},D=b.sheets.Core.Spread.Sheets.Events,Z=D.EditEnd,B=D.ActiveCellChanged,P=(b.Editor,b.sheets),z=P.Events,R=(P.root,P.path),G=P.changeset,E=P.Hooks,L=P.position,W=P.sheet,F=P.range,H=P.formula,V=P.track,J=P.Plugin,Q=P.filter,U=(R.setByPath,G.findSheetMetaByIterator),Y=G.YE,X=L.stringifyPosition,_=L.parsePosition,K=W.getActiveCell,q=F.isSameRange,$=F.getActualCellRange,nn=F.isCellInRange,tn=b.sheets.utils.showAlert,en=H.formulaToExpression,rn=H.updateExpressionOnModifyRowOrCols,on=H.updateExpressionOnMoveRowOrCols,an=Q.getFilterOutRowsInRange,cn=Object(O.isMobile)(),un="PivotTable",ln=function(n){function t(e){var r=n.call(this,{name:un,Constructor:t,config:e})||this;r.PivotTableEvents=A.b,r.getMenuConfig=function(){return Object(m.a)({showPivotCreateDialog:r._showPivotCreateDialog.bind(r),A:r.A})},r.destroy=function(){var n=r.A;n.off(z.AfterChangeApplied,r.YF),n.off(z.AfterSheetRendered,r.YF),n.off(z.AfterSheetQuickApply,r.YF),n.off(z.IV,r._onSheetSwitched),n.off(z.AfterSheetRendered,r._afterSheetRendered),n.off(z.CopiedSheet,r._onSheetCopied),n.off(z.PermissionChanged,r._onPermissionChanged),r._unbindGcEvents(),A.e.off(A.b.PivotTableRendered,r._onPivotTableRenderedOrDeleted),A.e.off(A.b.PivotTableDeleted,r._onPivotTableRenderedOrDeleted)},r.showSidebar=function(n){V(2,"9009"),r.emit(A.b.ShowPivotTableSideBar),r.sidebar.current.show(n)},r.RS=function(n){var t=(void 0===n?{}:n).silent;r.sidebar&&r.sidebar.current&&r.sidebar.current.close(!1),!0!==t&&r.emit(A.b.HidePivotTableSideBar)},r.render=function(){r.options.disableEvents||Object(C.a)(r.A),r._renderPivotComponents(r.pluginContainer),r._renderPivotTable()},r._bindEditorEvents=function(){var n=r.A;if(n.on(z.AfterSheetQuickApply,r.YF),n.on(z.AfterSheetFullApply,r.YF),n.on(z.AfterSheetQuickRendered,r.YF),n.on(z.AfterSheetFullRendered,r.YF),n.on(z.IV,r._onSheetSwitched),n.on(z.AfterSheetRendered,r._afterSheetRendered),n.on(z.CopiedSheet,r._onSheetCopied),n.on(z.PermissionChanged,r._onPermissionChanged),!n.spreadOptions.isHistoryPreview){var t=n.F.get("HistoryPreview");t&&t.instance?r._bindHistoryEvents(t.instance.A):n.on(z.PluginInstalled,function(n){var t=n.name,e=n.instance;"HistoryPreview"===t&&e&&r._bindHistoryEvents(e.A)})}},r._bindHistoryEvents=function(n){n.on(z.JD,function(){Object(w.a)(n,!0)}),n.on(z.JE,function(){var t=r.A.F.get("HistoryPreview"),e=r.A.F.get("VersionPreview"),i=t&&t.instance.isShown()||e&&e.instance.isShown();Object(w.a)(i?n:r.A,i)})},r._bindGcEvents=function(){var n=r.A.spread.gcSpread;n.bind(Z,r._onEditCell),n.bind(B,r._onActiveCellChanged)},r._unbindGcEvents=function(){var n=r.A.spread.gcSpread;n.unbind(Z,r._onEditCell),n.unbind(B,r._onActiveCellChanged)},r._registerEditorHooks=function(){var n=r.A.R.RR;n(E.CollectFormulaOperatorAfterSheetRenamed,r._collectFormulaOperatorAfterSheetRenamed),n(E.CollectOperatorAfterDragDropped,r._updatePivotTableAfterDragDropped),n(E.CollectOperatorAfterRowOrColChanged,r._updatePivotTableAfterRowOrColChanged),n(E.CollectOperatorAfterPasted,r._updatePivotTableAfterPasted),n(E.CollectOperatorAfterDragFillBlockCompleted,r._updatePivotTableAfterFill),n(E.CollectOperatorAfterDeleteSelectionsOrReplace,r._updatePivotTableAfterDeleteOrReplace),n(E.CollectOperatorAfterCellEditEnded,r._updatePivotTableAfterAddArrayFormula),n(E.CollectOperatorAfterAddOrDeleteCells,r._updatePivotTableAfterModifyCells)},r._showPivotCreateDialog=function(){var n=r.A.spread.B().E,t=Object(x.f)(n);r.createDialog.show(t),V(2,"9001")},r._renderPivotComponents=function(n){var t=[o.a.createElement(M.a,{key:"pivotTable",ref:function(n){return r.createDialog=n},A:r.A}),o.a.createElement(M.b,{key:"pivotFilter",ref:function(n){return r.filterDialog=n},A:r.A}),o.a.createElement(M.c,{key:"pivotSidebar",ref:r.sidebar,A:r.A})];c.a.render(t,n.appendChild(document.createElement("div")))},r._init=function(){r._bindEditorEvents(),r._registerEditorHooks(),r.A.editable&&r._bindGcEvents(),Object(w.a)(r.A,Boolean(r.options.disableEvents)),Object(A.d)(r.A),r.options.disableEvents||(A.e.on(A.b.PivotTableRendered,r._onPivotTableRenderedOrDeleted),A.e.on(A.b.PivotTableDeleted,r._onPivotTableRenderedOrDeleted))},r._renderPivotTable=function(){return T(r,void 0,Promise,function(){var n,t,e=this;return S(this,function(r){switch(r.label){case 0:return[4,(n=this.A).getSheetsMetaIterator()];case 1:return t=r.sent(),n.spread.sheets.forEach(function(n){var r=U(t,n.id).getAttributes();e.YF({sheet:n,tableActions:r})}),[2]}})})},r.YF=function(n){if(n){var t=n.sheet,e=n.tableActions,i=n.rows,o=n.cols,a=n.cellsData,c=t.E;Object(A.c)(c,e);var u=[];a&&Y(a,function(n){u.push({row:n[0],col:n[1]})}),r._checkPivotTableAfterApplyRowCols(c,e,i||[],o||[],u)}},r._onActiveCellChanged=function(n,t){var e=r.A.spread.gcSpread.B();if(Object(x.n)(r.A)&&e.isEditable()){var i=t.row,o=t.col;r._checkActiveCell(e,i,o)}},r._onPermissionChanged=function(n){n&&n.hasOwnProperty("editable")&&(n.editable?r._bindGcEvents():r._unbindGcEvents()),r.A.isRendered&&r._checkLock()},r._checkLock=function(){var n=r.A.spread.gcSpread.B(),t=K(n),e=t.row,i=t.col;if(n.isRangeEditable({row:e,col:i,rowCount:1,colCount:1})||r.RS(),r.filterDialog){var o=r.filterDialog,a=o.state,c=o.options;if(a.show&&c&&c.cell)!n.isRangeEditable({row:c.cell.row,col:c.cell.col,rowCount:1,colCount:1})&&r.filterDialog.hideDialog()}},r._onSheetSwitched=function(n){return T(r,void 0,Promise,function(){var t,e,r,i;return S(this,function(o){return t=n.newSheet.E,Object(x.n)(this.A)&&t.isEditable()&&(e=K(t),r=e.row,i=e.col,this._checkActiveCell(t,r,i)),this._checkPivotTables(t),[2]})})},r._afterSheetRendered=function(n){return T(r,void 0,Promise,function(){var t;return S(this,function(e){return(t=n.sheet.E).guid()===this.A.spread.B().id&&this._checkPivotTables(t),[2]})})},r._checkPivotTables=function(n){var t=Object.values(n.attrs.pivotTables||{}).filter(function(n){return n.isNeedRecalc()}).map(function(n){return n.getTableId()});t.length&&A.e.recalcPivotTables(n,t)},r._onSheetCopied=function(n){if(n){var t=n.newSheet,e=n.tableAttrs,r=t.E;r.attrs.pivotTables&&delete r.attrs.pivotTables,Object(A.c)(r,e)}},r._onPivotTableRenderedOrDeleted=function(n){if(!(r.sidebar&&r.sidebar.current&&r.sidebar.current.manualClosed)){var t=n.sheet,e=n.renderRange,i=n.oldRenderRange,o=n.pivotTableId,a=r.A.spread.gcSpread.B();if(t.guid()===a.guid()&&Object(x.n)(r.A)&&a.isEditable()){var c=K(a),u=c.row,l=c.col;if(e&&i&&o&&nn(u,l,i)&&!nn(u,l,e)){var s=A.e.getPivotTable(a,o),f=_(s.getDefinition().location),v=f.row,d=f.col;return a.TG(v,d,1,1)}r._checkActiveCell(a,u,l)}}},r._onEditCell=function(n,t){var e=t.sheet,r=t.row,i=t.col,o=t.editingText;if(o!==t.oldValue){var a=y.getCellRelatedPivotTable(e,r,i);if(a){var c=a.getEditableCells()[r+"-"+i],u=a.getTableId(),l=a.getDefinition(),s=a.getPageFieldRange(),f=a.getRowColFieldRange();if(c){var v=null==o?"":o;if(v.startsWith("="))tn({title:I()("数据透视表区域不能输入公式"),type:"error"});else{switch(c.type){case"row":l.rowFields[c.fieldIndex].name=v;break;case"col":l.colFields[c.fieldIndex].name=v;break;case"data":l.dataFields[c.fieldIndex].name=v;break;case"page":l.pageFields[c.fieldIndex].name=v}A.e.updatePivotTable(e,u,l,j.d.renderConfigChange)}t.cancel=!0,t.resetEditorStatus=!0}else l.location===X(r,i)?(tn({title:I()("数据透视表的根节点单元格不能输入内容"),type:"error"}),t.cancel=!0,t.resetEditorStatus=!0):(s&&nn(r,i,s)||f&&nn(r,i,f))&&(t.cancel=!0,t.resetEditorStatus=!0)}}},r._collectFormulaOperatorAfterSheetRenamed=function(n,t){var e=r.A,i={};return n.adjustFormulaCells.forEach(function(n){var t=n.targetSheet,e=n.formula;if(d()(e,"PIVOTTABLE")){var r=t.guid();if(i[r]||(i[r]={}),e){var o=Object(x.r)(e),a=o.id,c=o.sheetSource;i[r][a]={id:a,sheetSource:c,targetSheet:t}}}}),g()(i,function(n,r){var i,o;g()(n,function(n){var t=n.sheetSource,e=n.targetSheet,r=n.id;i||(o=e,i=Object(x.e)(e)),i[r]&&(i[r].source.sheetSource=t,A.e.updatePivotTable(o,r,i[r],j.d.sourceChange,!1))});var a={fnName:"tableAttrs2Cs",params:e.opProcessor([{sheetId:r,sheetIndex:e.spread.getCsIndexBySheetId(r)},Object(x.b)(o,i)])};t.push(a)}),t},r._updatePivotTableAfterAddArrayFormula=function(n,t){var e=n.args,r=e.row,i=e.col,o=e.sheet,a=o.getFormulaInformation(r,i);if(a&&a.isArrayFormula){var c=a.baseRange;Object.values(o.attrs.pivotTables||{}).forEach(function(n){var e=n.getTableId(),r=n.getDefinition(),i=_(r.location);nn(i.row,i.col,c)&&t.push(A.e.deletePivotTable(o,e,!1))})}return t},r._updatePivotTableAfterModifyCells=function(n,t){var e=n.sheet,i=n.range,o=n.movedRange,a=n.dir,c=n.isAdd,u=e.E,s="up"===a||"down"===a?"row":"col",f="row"===s?i.row:i.col,v="row"===s?i.rowCount:i.colCount;return r.A.spread.gcSpread.sheets.forEach(function(n){var e=n.guid()===u.guid();Object.values(n.attrs.pivotTables||{}).forEach(function(r){var a,d=r.getDefinition(!1),p=_(d.location),g=d.source.sheetSource,b=Object(x.s)(n,g)||{},h=b.E,I=void 0===h?null:h,m=b.range,w=void 0===m?null:m,C=!1,j=nn(p.row,p.col,i),M=nn(p.row,p.col,o);if(e&&(j||M)&&(a=l()(d),c?(p[s]+=v,a.location=X(p.row,p.col)):j?(t.push(A.e.deletePivotTable(n,r.getTableId(),!1)),C=!0):(p[s]-=v,a.location=X(p.row,p.col))),w&&I&&I.guid()===u.guid()&&!C&&function(n,t,e){return"row"===n?t.col<=e.col&&t.col+t.colCount>=e.col+e.colCount:t.row<=e.row&&t.row+t.rowCount>=e.row+e.rowCount}(s,i,w)){a||(a=l()(d));var y=en(n,Object(x.c)(r.getTableId(),g),p.row,p.col),O=rn(y,n,p.row,p.col,u,f,v,c,"row"===s).arguments[0],N="object"==typeof O.value&&O.value._error?O.value._error:Object(x.g)(O);N&&N!==g&&(a.source={type:d.source.type,sheetSource:N}),"col"===s&&(c&&f>w.col&&f<w.col+w.colCount||!c&&f+v>w.col)&&(a=Object(x.x)(f,v,c,a||d,w,{}))}if(a&&!C){var k=A.e.updatePivotTable(n,r.getTableId(),a,void 0,!1);t.push(k)}})}),t},r._updatePivotTableAfterDragDropped=function(n,t){var e=n.args,i=e.fromRow,o=e.fromCol,a=e.toRow,c=e.toCol,u=e.rowCount,l=e.colCount,s=e.sheet,f=e.insert,v=-1!==i&&-1===o,d=-1!==i&&-1!==o,p=d?{row:i,col:o,rowCount:u,colCount:l}:v?{row:i,col:0,rowCount:u,colCount:s.H()}:{row:0,col:o,rowCount:s.G(),colCount:l},g=d?{row:a,col:c,rowCount:u,colCount:l}:v?{row:a,col:0,rowCount:u,colCount:s.H()}:{row:0,col:c,rowCount:s.G(),colCount:l},b={},h=[],I=y.getLocationInRangePivotTables(s,p),m=I.map(function(n){return n.getTableId()});f?Object.values(s.attrs.pivotTables||{}).forEach(function(n){var t,e=n.getTableId(),r=n.getDefinition(),f=_(r.location),v=f.row,d=f.col,p=i+u-1<v&&a>v||i>v&&a<=v;if(-1===i&&(o+l-1<d&&c>d||o>d&&c<=d)){var g=o>d?d+l:d-l;t=Object.assign(r,{location:X(v,g)})}else if(-1===o&&p){var h=i>v?v+u:v-u;t=Object.assign(r,{location:X(h,d)})}t&&(b[e]={definition:t,E:s})}):y.getLocationInRangePivotTables(s,g).forEach(function(n){var e=n.getTableId();-1===m.indexOf(e)&&(t.push(A.e.deletePivotTable(s,e,!1)),h.push(e))});return I.forEach(function(n){var t,e,r=n.getDefinition(),d=_(r.location),p=d.row,g=d.col;f?(t=v?a>i?a+p-i-u:a+p-i:p,e=v?g:c>o?c+g-o-l:c+g-o):(t=-1===i?p:a+p-i,e=-1===o?g:c+g-o);var h=Object.assign(r,{location:X(t,e)});b[n.getTableId()]={E:s,definition:h}}),r.A.spread.gcSpread.sheets.forEach(function(n){Object.values(n.attrs.pivotTables||{}).forEach(function(t){var e=t.getDefinition(),r=t.getTableId(),g=e.source.sheetSource,I=Object(x.s)(n,g)||{},m=I.E,w=void 0===m?null:m,C=I.range,A=void 0===C?null:C;if(A&&w&&w.guid()===s.guid()&&-1===h.indexOf(r)){var M=A.row+A.rowCount-1,y=A.col+A.colCount-1,O=void 0;b[r]&&(O=b[r].definition);var N=_((O||e).location),k=v?i:o,T=v?a:c,S=v?u:l,D=d?{row:i,col:o,rowCount:u,colCount:l}:{row:-1===i?0:i,col:-1===o?0:o,rowCount:-1===i?s.G():u,colCount:-1===o?s.H():l};if(D.row<=A.row&&D.col<=A.col&&D.row+D.rowCount>=A.row+A.rowCount&&D.col+D.colCount>=A.col+A.colCount){var Z=!d&&(v?a>i:c>o),B={row:-1===i?A.row:A.row+a-i-(f&&Z?u:0),col:-1===o?A.col:A.col+c-o-(f&&Z?l:0),rowCount:A.rowCount,colCount:A.colCount},P=Object(x.w)(w,B);O=Object.assign(O||e,{source:{type:e.source.type,sheetSource:P}})}else if(f){var z=en(n,Object(x.c)(t.getTableId(),g),N.row,N.col),R=on(z,n,N.row,N.col,s,v?i:o,v?a:c,v?u:l,v).arguments[0];if((P="object"==typeof R.value&&R.value._error?R.value._error:Object(x.g)(R))&&(P!==g||v&&i>=A.row&&i<=M&&a>=A.row&&a<=M)&&(O=Object.assign(O||e,{source:{type:e.source.type,sheetSource:P}})),!v){var G={};if(!(p.col+S-1<A.col||y<p.col)&&c>A.col&&c<=y)for(var E=Math.max(o,A.col),L=Math.min(y,o+S-1);E<=L;E++){var W=c>o?c-o-S+E:c-o+E;G[E]=W,G[W]=E}var F=T<=(v?M:y)&&T>A.col&&T<A.col+A.colCount;k<=(v?M:y)&&k+S>A.col&&(O=Object(x.x)(k,S,!1,O||e,A,G,!F)),F&&(O=Object(x.x)(T,S,!0,O||e,A,G))}}O?b[r]={E:n,definition:O}:n.guid()===s.guid()&&k<(v?A.row:A.col)&&k<(v?N.row:N.col)&&(b[r]={E:n,definition:e,changeType:j.d.renderConfigChange})}})}),Object.keys(b).forEach(function(n){var e=b[n],r=e.definition,i=e.E,o=e.changeType;t.push(A.e.updatePivotTable(i,n,r,o,!1))}),t},r._updatePivotTableAfterRowOrColChanged=function(n,t){var e=n.count,i=n.index,o=n.isAdd,a=n.type,c=n.sheet;return r.A.spread.gcSpread.sheets.forEach(function(n){var r=n.guid()===c.guid();Object.values(n.attrs.pivotTables||{}).forEach(function(u){var s,f=u.getDefinition(!1),v=_(f.location),d=f.source.sheetSource,p=Object(x.s)(n,d)||{},g=p.E,b=void 0===g?null:g,h=p.range,I=void 0===h?null:h,m=!1;if(r&&i<=v[a]&&(s=l()(f),o?(v[a]+=e,s.location=X(v.row,v.col)):i+e>v[a]?(t.push(A.e.deletePivotTable(n,u.getTableId(),!1)),m=!0):(v[a]-=e,s.location=X(v.row,v.col))),I&&b&&b.guid()===c.guid()&&!m){s||(s=l()(f));var w=en(n,Object(x.c)(u.getTableId(),d),v.row,v.col),C=rn(w,n,v.row,v.col,c,i,e,o,"row"===a).arguments[0],j="object"==typeof C.value&&C.value._error?C.value._error:Object(x.g)(C);j&&j!==d&&(s.source={type:f.source.type,sheetSource:j}),"col"===a&&(o&&i>I.col&&i<I.col+I.colCount||!o&&i+e>I.col)&&(s=Object(x.x)(i,e,o,s||f,I,{}))}if(s&&!m){var M=A.e.updatePivotTable(n,u.getTableId(),s,void 0,!1);t.push(M)}})}),t},r._updatePivotTableAfterPasted=function(n,t){var e=n.fromSheet,r=n.sheet,i=n.fromRange,o=n.pasteOption,a=n.isCutting,c=n.actualCellRange,u=n.isFromSameSheet,l=r._clipboardHelper._getPasteOptionsConfig(),s=l.all,f=l.formula,v=l.value,d=r._clipboardHelper._getCustomPasteOptionsConfig(),p=d.exceptBorder,g=d.matchTargetFormat,b=u&&q($(e,i),c),h=o===s||o===f||o===p,I=h||o===v||o===g,m=e&&i?y.getLocationInRangePivotTables(e,i):[],w=y.getLocationInRangePivotTables(r,c);if(I&&w.forEach(function(n){!b&&t.push(A.e.deletePivotTable(r,n.getTableId(),!1))}),e&&i&&m.length)if(a)m.forEach(function(n){u?t.push(A.e.copyOrMovePivotTable({pivotTable:n,toSheet:r,fromRange:i,toRange:c,isMove:!0})):(t.push(A.e.deletePivotTable(e,n.getTableId(),!1)),t.push(A.e.copyOrMovePivotTable({pivotTable:n,toSheet:r,fromRange:i,toRange:c,isMove:!1})))});else if(h){var C=e._isSingleCellToSpanCell(i,c),x=an(e,i).length,j=an(r,c).length,M=!x&&!j&&!C;m.forEach(function(n){for(var o=M?c.rowCount/i.rowCount:1,a=M?c.colCount/i.colCount:1,u=0;u<o;u++)for(var l=0;l<a;l++){var s={row:u*i.rowCount+c.row,col:l*i.colCount+c.col,rowCount:i.rowCount,colCount:i.colCount};t.push(A.e.copyOrMovePivotTable({pivotTable:n,toSheet:r,fromRange:i,toRange:s,isMove:!1,fromSheet:e,calcFilteredRows:!0}))}})}return t},r._updatePivotTableAfterDeleteOrReplace=function(n,t){var e=r.A.spread.B().E;return n.reduce(function(n,t){var r=y.getLocationInRangePivotTables(e,t);return n.concat(r)},[]).forEach(function(n){t.push(A.e.deletePivotTable(e,n.getTableId(),!1))}),t},r._updatePivotTableAfterFill=function(n,t){var e=n.args,r=e.fillRange,i=e.sheet;return y.getLocationInRangePivotTables(i,r).forEach(function(n){t.push(A.e.deletePivotTable(i,n.getTableId()))}),t};var i=e.A;return r.A=i,r.options=e,r.pivotRangeHelpers=y,r._init(),r.sidebar=o.a.createRef(),r.A.isRendered&&r.render(),r.install(),r}return k(t,n),t.prototype.setLocale=function(n){I.a.setLocaleSync(n)},t.prototype._checkPivotTableAfterApplyRowCols=function(n,t,e,r,i){var o=n.attrs.pivotTables||{},a=Object.keys(o),c=Object.keys(t).filter(function(n){return n.match(/pivot-table-/)}).map(function(n){return n.replace("pivot-table-","")}),u=f()(a,c);if(u.length)for(var l=0;l<u.length;l++){var s=u[l],v=o[s],d=v.getDefinition(!1),p=v.getRenderRange(),g=_(d.location),b=g.row,h=g.col;if(e&&e.length){var I=e[0];if("remove"===I.type&&I.index+I.amount-1<b||"insert"===I.type&&I.index<=b){n.setFormula(b,h,Object(x.c)(s,d.source.sheetSource));continue}}if(r&&r.length){var m=r[0];if("remove"===m.type&&m.index+m.amount-1<h||"insert"===m.type&&m.index<=h){n.setFormula(b,h,Object(x.c)(s,d.source.sheetSource));continue}}for(var w=0;w<i.length;w++){var C=i[w];if(p&&nn(C.row,C.col,p)){n.setFormula(b,h,Object(x.c)(s,d.source.sheetSource));break}}}},t.prototype._checkActiveCell=function(n,t,e){if(!cn&&!this.options.disableSidebar){if(n.getFormulaInformation(t,e).isArrayFormula)return this.RS();var r=y.getCellRelatedPivotTable(n,t,e,{ignoreCalcErrorRenderRange:!0});r&&n.isRangeEditable({row:t,col:e,rowCount:1,colCount:1})?this.showSidebar({sheet:n,pivotTableId:r.getTableId()}):this.RS()}},t}(J);t.default=ln},2115:function(n,t,e){"use strict";e.d(t,"a",function(){return l}),e.d(t,"b",function(){return i}),e.d(t,"f",function(){return o}),e.d(t,"e",function(){return a}),e.d(t,"d",function(){return c}),e.d(t,"c",function(){return u});var r,i,o,a,c,u,l=e(3).sheets.Core.Spread.CalcEngine.CalcError;!function(n){n[n.worksheet=0]="worksheet",n[n.external=1]="external"}(r||(r={})),function(n){n[n.ascending=1]="ascending",n[n.descending=2]="descending"}(i||(i={})),function(n){n.SUM="sum",n.COUNTA="counta",n.AVERAGE="average",n.MAX="max",n.MIN="min",n.PRODUCT="product",n.COUNT="count",n.STDEV="stdev",n.STDEVP="stdevp",n.VAR="var",n.VARP="varp"}(o||(o={})),function(n){n[n.default=0]="default",n[n.rowPercent=1]="rowPercent",n[n.colPercent=2]="colPercent",n[n.totalPercent=3]="totalPercent"}(a||(a={})),function(n){n[n.noChange=0]="noChange",n[n.sourceChange=1]="sourceChange",n[n.sourceAndLocationChange=2]="sourceAndLocationChange",n[n.locationChange=3]="locationChange",n[n.rowColDataFieldChange=4]="rowColDataFieldChange",n[n.rowColFilterChange=5]="rowColFilterChange",n[n.pageFieldChange=6]="pageFieldChange",n[n.sortChange=7]="sortChange",n[n.renderConfigChange=8]="renderConfigChange"}(c||(c={})),function(n){n.RowField="rowFields",n.ColField="colFields",n.PageField="pageFields"}(u||(u={}))},2127:function(n,t,e){"use strict";t.k=function(n){var t=n.permissions.query.shimo.getUserPermission();return!t||t.id<0},t.n=function(n){0;var t=n.permissions.query.shimo.getUserPermission(),e=t&&t.accountType;if(!e)return!1;return e.includes("enterprise")&&!e.includes("expired")||"personal_premium"===e},t.i=function(n,t){var e=t.row,r=t.col,o=Math.min(e+f.b,n.G()),a=Math.min(r+f.a,n.H()),c={row:e,col:r,rowCount:o-e,colCount:a-r};if(!n.isRangeEditable(c)||V(n,c))return{hasContent:!0,error:i()("目标区域不能有锁定或筛选")};for(var u=e;u<o;u++)for(var l=r;l<a;l++){if(H(n,u,l)||n.getFormula(u,l)||n._getStyleProperty(u,l,"backgroundImage"))return{hasContent:!0,error:i()("目标区域不能有其他数据单元格")};if(n.getSpan(u,l))return{hasContent:!0,error:i()("目标区域不能有合并单元格")}}return{hasContent:!1,error:""}},t.j=function(n,t){if(!n.isRangeEditable(t)||V(n,t))return!0;for(var e=t.row,r=t.col,i=t.rowCount,o=t.colCount,a=e;a<i;a++)for(var c=r;c<o;c++)if(H(n,a,c)||n.getFormula(a,c)||n.getSpan(a,c)||n._getStyleProperty(a,c,"backgroundImage"))return!0;return!1},t.f=function(n){var t,e=n.getSelections()[0];if(!e)return null;var r=O(n,Object.assign({},e)),i=r.row,o=r.col,a=r.rowCount,c=r.colCount;if(1===a&&1===c){if((t=y(n,r,function(n,t){return H(n,t.row,t.column)})).row===i&&t.rowCount>1){for(var u=!1,l=o;l<o+t.colCount;l++)if(H(n,i,l)){u=!0;break}u||(t.row+=1,t.rowCount-=1)}if(t.col===o&&t.colCount>1){for(var s=!1,f=i;f<i+t.rowCount;f++)if(H(n,f,o)){s=!0;break}s||(t.col+=1,t.colCount-=1)}if(t.col+t.colCount-1===o&&t.colCount>1){for(var s=!1,f=i;f<i+t.rowCount;f++)if(H(n,f,o)){s=!0;break}s||(t.colCount-=1)}}else{t={row:i,col:o,rowCount:a,colCount:c};var v=i,d=o,p=o+c-1;n:for(;v<i+a-1;v++)for(var l=o;l<o+c;l++)if(H(n,v,l))break n;n:for(;d<o+c-1;d++)for(var f=v;f<i+a;f++)if(H(n,f,d))break n;n:for(;p>d;p--)for(var f=v;f<i+a;f++)if(H(n,f,p))break n;v=Math.min(i+a-1,v),d=Math.min(o+c-1,d),t={row:v,col:d,rowCount:i+a-v,colCount:p-d+1}}return n.TG(t.row,t.col,t.rowCount,t.colCount),t},t.t=function(n,t,e,r){if(!n)return{error:i()("数据源无效")};var o=J(t,n,e,r);if(!o)return{error:i()("请输入一个有效范围")};var a=o,c=a.E,u=a.range;if(u.colCount<1||u.rowCount<1)return{error:i()("数据源不能超出当前表格范围")};if(Object(h.hasPivotTableInRange)(c,u))return{error:i()("数据透视表区域不能作为数据源")};if(!c.isRangeReadable(u))return{error:i()("不能引用锁定禁止查看的单元格")};if(!function(n,t){var e=O(n,t),r=e.row,i=e.col,o=e.rowCount,a=e.colCount;if(o<2)return!1;for(var c=i;c<i+a;c++){var u=n.getText(r,c);if(!u)return!1}return!0}(c,u))return{error:i()("数据源应至少有两行数据，且首行无空单元格")};return{rangeString:Q(c,u),sourceGcSheet:c}},t.s=J,t.w=Q,t.q=function(n){for(var t=0;t<n.length;++t)for(var e=0;e<n[t].length;++e)n[t][e]=U(n[t][e]);return n},t.c=function(n,t){return v.a+"("+t+', "'+n+'")'},t.o=function(n){return!(!n||(""+n.functionName).toLocaleUpperCase()!==v.a)},t.g=function(n){if(!n||1!==n.type||!n.source||!n.source.PM)return"";var t=n.getRange(0,0);return Q(n.source.PM,t)},t.h=function(n,t){if(t){var e=new B(t);return e.format(n,{})}if("boolean"==typeof n||n instanceof Boolean)return n.toString().toUpperCase();if(n instanceof Date){var r=Z.YB(Z.culture()).DateTimeFormat;return D._toOADate(n)<1?D._localeFormat(n,"HH:mm:ss"):0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()?D._localeFormat(n,r.shortDatePattern):D._localeFormat(n,r.shortDatePattern+" HH:mm:ss")}return n.toString()},t.l=Y,t.d=function(n,t,e){if(t<0)return"";var r=(P(n,t)||"").replace((n+1).toString(),"");return e===W.defaultLocale?r+i()("列"):"Column "+r},t.e=function(n){var t=n.attrs.pivotTables,e={};return c()(t,function(n,t){var r=n.getDefinition(!0);e[t]=r}),e},t.r=function(n){if(!l()(n,"PIVOTTABLE"))throw Error("Formula is not PivotTable type!");var t=n.split(",");return{id:t[1].slice(1,t[1].length-2),sheetSource:t[0].slice(11)}},t.b=function(n,t){var e={},r=n.attrs.pivotTables;return c()(t,function(n,t){r[t].setDefinition(n),delete n.pivotFields,e["pivot-table-"+t]=JSON.stringify(n)}),e},t.x=function(n,t,e,r,i,o,a){void 0===a&&(a=!0);for(var c=i.col,u=i.col+i.colCount-1,l=n;l<n+t;l++)l>=c&&l<=u&&(r.pageFields=s(r.pageFields,l),r.rowFields=s(r.rowFields,l),r.colFields=s(r.colFields,l),r.dataFields=s(r.dataFields,l));a&&(r.pageFields.map(function(n){return f(n)}),r.rowFields.map(function(n){return f(n)}),r.colFields.map(function(n){return f(n)}),r.dataFields.map(function(n){return f(n)}));function s(n,t){return n.filter(function(n){var r=n.index!==t-c||null!=o[c+n.index];return function(n,t,e){void 0===n.newIndex&&(n.newIndex=n.index);!t&&n.index+c>=e&&(n.newIndex-=1);t&&(null!=o[n.index]?n.newIndex=o[n.index]:n.index+c>=e&&(n.newIndex+=1))}(n,e,t),e||r})}function f(n){return void 0!==n.newIndex&&(n.index=n.newIndex,delete n.newIndex),n}return r},t.y=function(n,t,e){var r=t.source.sheetSource,i=J(n,r),o=Object.assign({},t);if(o.source.sheetSource=e,!i)return o.pageFields=[],o.rowFields=[],o.colFields=[],o.dataFields=[],o;var a=i.E,c=i.range,u=J(n,e),l=u.E,s=u.range;if(a.guid()!==l.guid())o.pageFields=[],o.rowFields=[],o.colFields=[],o.dataFields=[];else{for(var f=[],v=c.col;v<c.col+c.colCount;v++)(v<s.col||v>s.col+s.colCount-1)&&f.push(v);o.pageFields=d(o.pageFields,f),o.rowFields=d(o.rowFields,f),o.colFields=d(o.colFields,f),o.dataFields=d(o.dataFields,f)}function d(n,t){return n.filter(function(n){var e=-1===t.indexOf(c.col+n.index);return n.index-=t.filter(function(t){return t<c.col+n.index}).length,e})}return o},t.a=function(n){var t,e,r,i=n.ctx,o=n.sheet,a=n.row,c=n.col,u=n.x,l=n.y,s=n.width,f=n.height,v=n.sheetArea,d=n.style,b=n.pivotStyle,h=n.type,I=n.collapseInfo;if("filter"===h){var m=o.getActualStyle(a,c),C=new w.Rect(u,l,s,f);r=X(o,C,v,"right");var x=!0,A=_(o,a,c);m&&m.backColor&&(e=F._fromString(m.backColor),x=.299*e.r+.587*e.g+.114*e.b>=192);var j=!1;if(A){var M=A.pivotTableKey;j=Object(g.e)(o,M,A.index,A.excludeValues)}t=Object(p.a)(j,x)}else{e=d&&d.backColor?d.backColor:b&&b.backColor?b.backColor:"#ffffff",t=Object(p.b)(I.isCollapsed);var C=new w.Rect(u,l,s,f);r=X(o,C,3,"left")}var y=r.width,O=r.height,N=r.x,k=r.y;i.save(),i.rect(u,l,s,f),i.clip(),i.beginPath();try{var T=o._getImageLoader();if(T._getState(t)){var S=e?"rgb("+e.r+","+e.g+","+e.b+")":"#ffffff";i.fillStyle="filter"===h?S:e,function(n,t,e,r,i,o){n.beginPath(),n.moveTo(t+o,e),n.lineTo(t+r-o,e),n.quadraticCurveTo(t+r,e,t+r,e+o),n.lineTo(t+r,e+i-o),n.quadraticCurveTo(t+r,e+i,t+r-o,e+i),n.lineTo(t+o,e+i),n.quadraticCurveTo(t,e+i,t,e+i-o),n.lineTo(t,e+o),n.quadraticCurveTo(t,e,t+o,e),n.closePath(),n.fill()}(i,N-1,k,y-3,O-3,2),i.drawImage(T._getImage(t),N-1,k,y-3,O-3)}else T._addImage(t)}catch(n){}i.beginPath(),i.restore()},t.m=function(n,t,e){var r=K(n,t,e);if(r){var i=r.pivotTableKey,o=v.e.getPivotTable(n,i);return!Y(n,o)}return!1},t.v=function(n,t,e){var r=this.attrs.pivotTables;if(r&&Object.keys(r).length)for(var i in r){var o=r[i],a=o.getRenderRange(),c=o.getDefinition().location,u=z(c),l=u.row,s=u.col,f=!!e||n+t<=l;if(a&&n<l&&f){var d=l+(e?t:-t),p=this.getFormula(d,s);p&&p.startsWith(v.a)&&this.setFormula(d,s,null)}}},t.p=function(n,t){var e=q.call(this,n,t);if(!e)return!1;var r=e.foldBtnHitResult,i=e.filterBtnHitResult;if(r){var o=r.pivotTableId,a=r.definition,c=r.collapseInfo,u=c.isCollapsed,l=c.value,f=c.type,d=c.fieldIndex;"row"===f?u?delete a.rowFields[d].foldValues[l]:a.rowFields[d].foldValues[l]=!0:u?delete a.colFields[d].foldValues[l]:a.colFields[d].foldValues[l]=!0,v.e.updatePivotTable(this,o,a,s.d.renderConfigChange,!0)}else i&&v.e.emit(b.a.OpenPivotFilterDialog,i);return!0},t.u=q;var r=e(0),i=e.n(r),o=e(3),a=e(112),c=e.n(a),u=e(345),l=e.n(u),s=e(2115),f=e(2174),v=e(2135),d=e(2204),p=e(2577),g=e(2251),b=e(2177),h=e(2252),I=this&&this.__assign||function(){return(I=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},m=o.sheets.Core,w=m.Spread.Sheets,C=o.sheets,x=C.range,A=C.sheet,j=C.position,M=C.formula,y=x.searchSelectionRange,O=x.getActualCellRange,N=x.toRangeStr,k=x.fromGcRange,T=A.getSheetAttrs,S=m.Spread.Common,D=S._DateTimeHelper,Z=S.CultureManager,B=m.Spread.Formatter.GeneralFormatter,P=j.stringifyPosition,z=j.parsePosition,R=M.parseFormulaToRanges,G=M.fixSheetNameForFormula,E=M.formulaToExpression,L=M.updateFormulaByNewBase,W=o.Editor,F=m.Spread.Common._ColorHelper;function H(n,t,e){var r=n.getValue(t,e);return!!r||0===r}function V(n,t){var e=n.rowFilter();if(!e||!e.range)return!1;var r=e.range,i=Math.max(r.row-1,0),o=t.row,a=t.col,c=o+t.rowCount-1,u=a+t.colCount-1,l=r.col,s=i+r.rowCount-1,f=l+r.colCount-1;return!(o>s||i>c||a>f||l>u)}function J(n,t,e,r){void 0===e&&(e=0),void 0===r&&(r=0);var i=n.parent.getCustomNameFormula(t.toLocaleUpperCase());i&&(i=L(n,i,0,0,e,r));var o=i||t,a=E(n,o);if(!a||1!==a.type||a.endSource)return null;var c=R(n,o);if(1!==c.length)return null;var u=c[0],l=u.sheetName,s=u.range,f=n.parent.getSheetFromName(l);return s.rowCount=Math.min(s.rowCount,f.G()-s.row),s.colCount=Math.min(s.colCount,f.H()-s.col),{E:f,range:s}}function Q(n,t){return G(n.name())+"!"+N(n,k(t),!0)}function U(n){if(n&&"string"==typeof n._calcError){var t=s.a.parse(n._calcError);return t||n}return n}function Y(n,t){var e=t.getDefinition(!1).location,r=z(e),i=r.row,o=r.col;return n.getValue(i,o)instanceof s.a}function X(n,t,e,r){e=e||3;var i=n.zoom(),o=n.parent,a=i>1?1:i,c=3===e?n.defaults.rowHeight:n.defaults.colHeaderRowHeight,u=parseInt((Math.min(20,c)*a).toString());return o&&o.options.useTouchLayout&&(u=parseInt((c*i).toString())),{x:"left"===r?t.x+4:t.x+t.width-u,y:t.y+t.height-u,width:u,height:u}}function _(n,t,e){var r=K(n,t,e);if(r){var i=r.field,o=r.pivotTableKey,a=r.fieldKey,c=Object.assign({index:i.index,sort:i.sort},i.filter);return Object.assign(c,{pivotTableKey:o,fieldKey:a})}}function K(n,t,e){for(var r=T(n,d.b)||{},i=Object.keys(r),o=0;o<i.length;o++){var a=i[o],c=r[a],u=c.getDefinition(!1);if(!Y(n,c)){var l=c.getFilterCells();if(l&&l[t+"-"+e]){var f=l[t+"-"+e],v=f.fieldIndex,p=f.type,g="row"===p?s.c.RowField:"col"===p?s.c.ColField:s.c.PageField,b=u[g][v];if(b)return{field:b,pivotTableKey:a,fieldKey:g}}}}}function q(n,t){var e,r,i=this.NK(),o=this._getRowViewportIndexFromY(t),a=this._getColumnViewportIndexFromX(n),c=this._getViewportColumnLayout(a).findX(n);if(o>=0&&o<=2&&a>=0?(r=3,e=this._getViewportRowLayout(o).findY(t)):o<0&&a>=0&&(r=1,e=this._getColumnHeaderRowLayout().findY(t)),!e||!c)return null;var u=e.row,l=c.col,s=Object(h.getCellRelatedPivotTable)(this,u,l,{ignoreCalcErrorPivot:!0});e=this._getRowLayout(o,r).findRow(u);var f={x:(c=this.NE(a,r).findCol(l)).x,width:c.width,y:e.y,height:e.height};if(!this.isRangeEditable({row:u,col:l,rowCount:1,colCount:1}))return null;if(s){var v=s.getCollapseCells()[u+"-"+l],d=_(this,u,l);if(v||d){var p=X(this,f,r,v?"left":"right");return p.x<=n&&n<=p.x+p.width&&p.y<=t&&t<=p.y+p.height?d?{filterBtnHitResult:I(I({},d),{left:f.x+f.width,top:i.top+f.y,row:u,col:l})}:{foldBtnHitResult:{pivotTableId:s.getTableId(),definition:s.getDefinition(),collapseInfo:v}}:null}}return null}},2135:function(n,t,e){"use strict";e.d(t,"a",function(){return f}),e.d(t,"e",function(){return l}),t.d=function(n){!l&&(l=new c.a(n))},t.c=function(n,t){if(i()(t))return;var e=s(n,a.b)||{};Object.keys(t).filter(function(n){return n.match(/pivot-table-/)}).sort(function(n,r){return null===t[n]?-1:null===t[r]?1:e[n.substring(v.length)]?-1:e[r.substring(v.length)]?1:0}).forEach(function(r){var i=r.substring(v.length);if(i){var o=t[r],a=e[i];if(o){var c=JSON.parse(o);a?l.updatePivotTable(n,i,c,void 0,!1):l.addPivotTable(n,i,c)}else a&&l.deletePivotTable(n,i,!1)}})};var r=e(129),i=e.n(r),o=e(3),a=e(2204),c=e(2575),u=e(2177);e.d(t,"b",function(){return u.a});var l,s=o.sheets.sheet.getSheetAttrs,f="PIVOTTABLE",v="pivot-table-"},2174:function(n,t,e){"use strict";e.d(t,"b",function(){return a}),e.d(t,"a",function(){return c}),e.d(t,"e",function(){return u}),e.d(t,"d",function(){return l}),e.d(t,"c",function(){return s});var r=e(0),i=e.n(r),o=e(2115),a=10,c=5,u=function(){var n;return(n={})[o.f.SUM]=i()("求和"),n[o.f.COUNTA]=i()("计数"),n[o.f.AVERAGE]=i()("平均值"),n[o.f.MAX]=i()("最大值"),n[o.f.MIN]=i()("最小值"),n[o.f.PRODUCT]=i()("求积"),n[o.f.COUNT]=i()("数值计数"),n[o.f.STDEV]=i()("标准偏差"),n[o.f.STDEVP]=i()("总体标准偏差"),n[o.f.VAR]=i()("方差"),n[o.f.VARP]=i()("总体方差"),n},l=function(){var n;return(n={})[o.e.default]=i()("默认"),n[o.e.rowPercent]=i()("占行总和的百分比"),n[o.e.colPercent]=i()("占列总和的百分比"),n[o.e.totalPercent]=i()("占总和的百分比"),n},s={BG_LEFT_TOP_CORNER:"#F3F3F4",BG_FIELD_NAME:"#F3F3F4",BG_ROW_FIELD:"#F3F3F4",BG_COL_FIELD:"#7B7F83",BG_PAGE_FIELD:"#F3F3F4",BG_DATA_REGION:"#FFFFFF",BG_TOTAL_ROW:"#D7D8D9",FORE_COL_FIELD:"#FFFFFF",BORDER_TRANSPARENT:"transparent",BORDER_DARK_GRAY:"#7B7F83",BORDER_LIGHT_GRAY:"#D7D8D9"}},2175:function(n,t,e){"use strict";t.a=function(n,t){var e=n.rowFields,r=n.colFields,o=n.pageFields;return l(e,r,o).reduce(function(n,t){var e=t.filter;return n.filter(function(n){if(!n[t.index])return!0;var r=n[t.index],o=r.value,a=r.formatter;return!e.excludeValues.includes(Object(i.h)(o,a))})},t.filter(function(n){return n.some(function(n){var t=n.value;return""!==t&&!u()(t)})}))},t.b=v,t.c=function(n,t,e){var o=[];if(s(n,t).reduce(function(n,t){var e=Object(i.h)(t.value,t.formatter),r=n.findIndex(function(n){return n.value===e});return r<0?n.push({value:e,count:1,origValue:t.value}):n[r].count++,n},o),e){var c=e===r.b.ascending?a.b:a.c;o.sort(function(n,t){return c(n.origValue,t.origValue)})}return o},t.d=function(n,t,e,r){var i=o.e.getPivotTable(n,t);if(!i)return!1;var a=v(i.getSourceData(),e);return a.filter(function(n){return!r.includes(n)}).length<a.length};var r=e(2115),i=e(2127),o=e(2135),a=e(2176),c=e(19),u=e.n(c),l=this&&this.__spreadArrays||function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),i=0;for(t=0;t<e;t++)for(var o=arguments[t],a=0,c=o.length;a<c;a++,i++)r[i]=o[a];return r};function s(n,t){return n.filter(function(n){return n.some(function(n){var t=n.value;return""!==t&&!u()(t)})}).map(function(n){return n[t]})}var f=new Map;function v(n,t){var e=f.get(n),r=e?e.get(t):void 0;if(r)return r.slice();var o=s(n,t).reduce(function(n,t){if(t){var e=Object(i.h)(t.value,t.formatter);n.some(function(n){return n===e})||n.push(e)}return n},[]),a=e||new Map;return f.set(n,a.set(t,o)),o}},2176:function(n,t,e){"use strict";t.b=s,t.c=function(n,t){return-s(n,t)},t.h=function(n,t,e){void 0===e&&(e=-1/0);return n&&n.summary&&n.summary[t]?n.summary[t].value:e},t.a=function(n,t){return t.reduce(function(n,t){return n.groups[t]?n.groups[t]:n},n)},t.d=function(n,t,e){var r=n[t.index]?Object(i.e)()[t.subtotal]+":"+n[t.index].name:"";return e?r+(t.name?" ("+t.name+")":""):t.name||r},t.f=function(n,t,e){var r=n[t.index]?n[t.index].name:"";return e?r+(t.name?" ("+t.name+")":""):t.name||r},t.g=function(n,t){return t.name||(n[t.index]?n[t.index].name:"")},t.e=function(n,t,e){var r=n[t.index]?n[t.index].name:"";return e?r+(t.name?" ("+t.name+")":""):t.name||r};var r=e(2115),i=e(2174),o="date",a="string",c="calc_error",u={number_date:-1,number_string:-1,number_boolean:-1,number_calc_error:-1,date_number:1,date_string:-1,date_boolean:-1,date_calc_error:-1,string_number:1,string_date:1,string_boolean:-1,string_calc_error:-1,boolean_number:1,boolean_date:1,boolean_string:1,boolean_calc_error:-1,calc_error_number:1,calc_error_date:1,calc_error_string:1,calc_error_boolean:1};function l(n){return n instanceof Date?o:n instanceof r.a?c:typeof n}function s(n,t){if(""===n)return 1;if(""===t)return-1;var e=l(n),r=l(t);if(e===r)return e===c&&(n=n.toString(),t=t.toString()),e===a||e===c?function(n,t){return n.localeCompare(t)}(n,t):function(n,t){return n>t?1:n<t?-1:0}(n,t);var i=e.toString()+"_"+r.toString();return u[i]}},2177:function(n,t,e){"use strict";var r;e.d(t,"a",function(){return r}),function(n){n.OpenPivotFilterDialog="OpenPivotFilterDialog",n.ShowPivotTableSideBar="ShowPivotTableSideBar",n.HidePivotTableSideBar="HidePivotTableSideBar",n.PivotDefinitionChanged="PivotDefinitionChanged",n.PivotTableRendered="PivotTableRendered",n.PivotTableDeleted="PivotTableDeleted"}(r||(r={}))},2204:function(n,t,e){"use strict";e.d(t,"b",function(){return I}),e.d(t,"a",function(){return w});var r=e(3),i=e(90),o=e.n(i),a=e(2174),c=e(2115),u=e(2251),l=e(2175),s=r.sheets.Core,f=s.Spread.Sheets.Style,v=r.sheets,d=v.position,p=v.range,g=d.parsePosition,b=p.isSameRange,h=p.isCellInRange,I="pivotTables",m="ExcludedPivotCell",w=function(){return function(n,t){var e=this;this.getTableId=function(){return e.pivotTableId},this.setDefinition=function(n){e.definition=n},this.getDefinition=function(n){return void 0===n&&(n=!0),n?o()(e.definition):e.definition},this.isNormalCell=function(n,t,e){var r=Boolean(n.OC(t,e,m,void 0,!0));return r&&n.C_removeValueForKey(t,e,m,void 0,!0),r},this.updateNormalCells=function(n){var t=e.definition.pageFields.length;if(e.renderRange&&t)for(var r=e.renderRange,i=r.row,o=r.col,a=r.rowCount,c=r.colCount,u=i;u<i+a;u++)for(var l=o;l<c+o;l++)e.pageFieldRange&&h(u,l,e.pageFieldRange)||e.rowColFieldRange&&h(u,l,e.rowColFieldRange)||n.C_setValueForKey(u,l,m,n._id+"@"+u+"@"+l,void 0,!0)},this.getSourceData=function(){return e.sourceData},this.applyRenderStyles=function(n,t,r){var i=t+"-"+r,o=e.renderStyles[i];o&&n.C_setValueForKey(t,r,"pivotTableStyle",o,void 0,!0)},this.clearRenderStyle=function(n,t,e){n.OC(t,e,"pivotTableStyle",void 0,!0)&&n.C_setValueForKey(t,e,"pivotTableStyle",null,void 0,!0)},this.getRenderStyle=function(n,t){return e.renderStyles[n+"-"+t]},this.clearModelData=function(n,t){void 0===t&&(t=!0),t&&Object.keys(e.renderStyles).forEach(function(t){var e=t.split("-").map(function(n){return parseInt(n)}),r=e[0],i=e[1];n.C_setValueForKey(r,i,"pivotTableStyle",null,void 0,!0)}),e.sourceData=[],e.filteredData=[],e.renderStyles={},e.renderRange=void 0,e.pageFieldRange=void 0,e.rowColFieldRange=void 0,e.editableCells={},e.collapseCells={},e.filterCells={}},this.getRenderRange=function(){return e.renderRange},this.getPageFieldRange=function(){return e.pageFieldRange},this.getRowColFieldRange=function(){return e.rowColFieldRange},this.getEditableCells=function(){return e.editableCells},this.getCollapseCells=function(){return e.collapseCells},this.getFilterCells=function(){return e.filterCells},this.getChangeType=function(){return e.sourceData.length?e.changeType:c.d.noChange},this.setChangeType=function(n){e.changeType=n},this.isNeedRecalc=function(){return e.needRecalc},this.markNeedRecalc=function(){e.needRecalc=!0},this.render=function(n){var t;switch(n.length&&!e.sourceData.length&&(e.sourceData=n,e.filteredData=Object(l.a)(e.definition,e.sourceData)),e.changeType){case c.d.noChange:case c.d.sourceChange:default:t=e._fullRender(n);break;case c.d.rowColFilterChange:case c.d.pageFieldChange:t=e._renderAfterFilterChanged();break;case c.d.rowColDataFieldChange:t=e._renderAfterFieldConfigChanged(e.filteredData);break;case c.d.sortChange:t=e.pivotDataContext?e._renderAfterSortChanged():e._renderAfterFieldConfigChanged(e.filteredData);break;case c.d.locationChange:case c.d.renderConfigChange:t=e.pivotDataContext?e._renderAfterRenderConfigChanged():e._renderAfterFieldConfigChanged(e.filteredData)}return e.changeType=c.d.noChange,e.needRecalc=!1,t},this._fullRender=function(n){return e.sourceData=n,e._renderAfterFilterChanged()},this._renderAfterFilterChanged=function(){var n=Object(l.a)(e.definition,e.sourceData);return e.filteredData=n,e._renderAfterFieldConfigChanged(n)},this._renderAfterFieldConfigChanged=function(n){var t=Object(u.a)(e.definition,n);return e.pivotDataContext=t,e._renderAfterSortChanged()},this._renderAfterSortChanged=function(){return Object(u.b)(e.definition,e.sourceData),Object(u.h)(e.definition,e.pivotDataContext),e._renderAfterRenderConfigChanged()},this._renderAfterRenderConfigChanged=function(){var n=Object(u.f)(e.definition,e.pivotDataContext),t=n.cells,r=n.styles,i=t.length?t[0].length:a.a,o=Object(u.g)(e.definition,e.sourceData,i),c=o.cells,l=o.styles,v=c.concat(t),d=l.concat(r),p=g(e.definition.location),h=p.row,I=p.col,m={},w=[],C={},x={},A={},j=e.definition.pageFields.length?e.definition.pageFields.length+1:0;d.forEach(function(n){for(var t=n.row,e=n.rowCount,r=n.col,i=n.colCount,o=n.isPageFieldCell,a=n.style,c=0;c<e;c++)for(var u=0;u<i;u++){var l=(o?h+t+c-j:h+t+c)+"-"+(I+r+u);for(var s in m[l]||(m[l]=new f),a)m[l][s]=a[s]}}),v.forEach(function(n,t){var e=[];n.forEach(function(n,r){var i=n.value,o=n.formatter,a=n.editInfo,c=n.collapseInfo,u=n.filterInfo,l=h+t-j+"-"+(I+r);a&&(C[l]=a),c&&(x[l]=c),u&&(A[l]=u),e.push(i),o&&(m[l]||(m[l]=new s.Spread.Sheets.Style),m[l].formatter=o)}),w.push(e)}),e.renderStyles=m,e.editableCells=C,e.collapseCells=x,e.filterCells=A;var M={row:c.length?h-c.length:h,col:I,rowCount:Math.max(w.length,1),colCount:w.length?w[0].length:1},y=!e.renderRange||!b(M,e.renderRange);return e.renderRange=M,e.pageFieldRange=c.length?{row:h-c.length,col:I,rowCount:c.length-1,colCount:2}:void 0,e.rowColFieldRange=t.length?{row:h,col:I,rowCount:t.length,colCount:i}:void 0,{calcValues:w,renderRange:M,rangeChanged:y}},this.pivotTableId=n,this.definition=t,this.sourceData=[],this.filteredData=[],this.renderStyles={},this.editableCells={},this.collapseCells={},this.filterCells={},this.changeType=c.d.noChange,this.needRecalc=!1}}()},2251:function(n,t,e){"use strict";var r=e(2175);e.d(t,"c",function(){return r.b}),e.d(t,"d",function(){return r.c}),e.d(t,"e",function(){return r.d});var i=e(2569);e.d(t,"a",function(){return i.a});var o=e(2571);e.d(t,"h",function(){return o.b}),e.d(t,"b",function(){return o.a});var a=e(2573);e.d(t,"f",function(){return a.a}),e.d(t,"g",function(){return a.b})},2252:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLocationInRangePivotTables=function(n,t){var e=[];return Object.values(n.attrs.pivotTables||{}).forEach(function(n){var r=n.getDefinition(!1),i=v(r.location),o=i.row,a=i.col;g(o,a,t)&&e.push(n)}),e},t.getPivotTableActualRenderRanges=function(n,t){var e=[];return Object.values(n.attrs.pivotTables||{}).forEach(function(r){var o=r.getDefinition(!1),a=v(o.location),c=a.row,u=a.col,l=n.getValue(c,u)instanceof i.a?{row:c,col:u,rowCount:1,colCount:1}:r.getRenderRange(),s=o.pageFields;if(g(c,u,t)&&l)if(s.length){var f=[r.getPageFieldRange(),r.getRowColFieldRange()];e=e.concat(f)}else e.push(l)}),e},t.getAllPivotTableRenderRanges=function(n){return Object.values(n.attrs.pivotTables||{}).reduce(function(t,e){var r=e.getDefinition(!1),o=v(r.location),a=o.row,c=o.col,u=r.pageFields,l=n.getValue(a,c),s=e.getRenderRange(),f=s.row,p=s.col,g=s.rowCount,b=s.colCount;if(l instanceof i.a)t.push(new d.Range(a,c,1,1));else if(u.length){var h=new d.Range(f,p,u.length,2),I=new d.Range(a,c,g-u.length-1,b);t.push(h,I)}else t.push(new d.Range(f,p,g,b));return t},[])},t.isPivotTableExcludedCell=function(n,t,e){return Boolean(n.OC(t,e,"ExcludedPivotCell",void 0,!0))},t.hasPivotTableInRange=function(n,t){var e=p(n,t),r=[];Object.values(n.attrs.pivotTables||{}).forEach(function(n){var t=n.getPageFieldRange(),e=n.getRowColFieldRange();t&&r.push(t),e&&r.push(e)});for(var i=0;i<r.length;i++)if(b(r[i],e))return!0;return!1},t.getCellRelatedPivotTable=function(n,t,e,r){var i=(r=r||{}).ignoreCalcErrorPivot,c=r.ignoreCalcErrorRenderRange,u=h(n,a.b)||{};for(var l in u){var s=u[l],f=Object(o.l)(n,s);if(!i||!f)if(c&&f){var d=v(s.getDefinition().location);if(d.row===t&&d.col===e)return s}else{var p=s.getPageFieldRange(),b=s.getRowColFieldRange();if(p&&g(t,e,p)||b&&g(t,e,b))return s}}return null};var r=e(3),i=e(2115),o=e(2127),a=e(2204),c=r.sheets.Core,u=r.sheets,l=u.position,s=u.range,f=u.sheet,v=l.parsePosition,d=c.Spread.Sheets,p=s.getActualCellRange,g=s.isCellInRange,b=s.isRangeIntersect,h=f.getSheetAttrs},2565:function(n,t,e){"use strict";var r=e(0),i=e.n(r),o=e(2566),a=e.n(o),c=e(2567),u=e.n(c);i.a.addLocaleResource("en-US",a.a),i.a.addLocaleResource("ja-JP",u.a),i.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2566:function(n,t){n.exports={"求和":"Sum","计数":"Count","平均值":"Average","最大值":"Max","最小值":"Min","求积":"Product","数值计数":"Count numbers","标准偏差":"Standard deviation","总体标准偏差":"Population standard deviation ","方差":"Variance","总体方差":"Population variance","默认":"Default","占行总和的百分比":"Percentage of total row","占列总和的百分比":"Percentage of total column","占总和的百分比":"Percentage of total","数据透视表生成的列超过限制，请调整列字段以减少列数。":"The columns generated by pivot table exceed limit. Please adjust the column fields to reduce number of columns.","目标区域不能有锁定或筛选":"No lock or filter is allowed in target area","目标区域不能有其他数据单元格":"No other data cells are allowed in target area","目标区域不能有合并单元格":"No merged cells are allowed in target area","数据源无效":"Invalid data source","请输入一个有效范围":"Please enter a valid range","数据源不能超出当前表格范围":"Data source cannot be out of current table range","数据透视表区域不能作为数据源":"Pivot table area cannot be data source","不能引用锁定禁止查看的单元格":"Cannot refer to a cell that is locked from viewing","数据源应至少有两行数据，且首行无空单元格":"Data source should have at least two rows of data, and the top row should be free of empty cells","列":"Column","请登录后使用":"Please use it after sign-in","升级高级版享用此功能":"Upgrade to Premium Edition to use this feature","数据透视表":"Pivot table","创建数据透视表":"Create pivot table","请选择要分析的数据":"Please select data to be analyzed","选择一个表或区域":"Select a table or area","请选择要放置数据透视表的位置":"Please select the position where pivot table is to be placed","新工作表":"New sheet","现有工作表":"Current sheet","确定":"OK","目标区域无效":"Invalid target area","目标区域不能超出当前表格范围":"Target area cannot be out of current table range","搜索":"Search","全选":"Select all","（空白）":"(Empty)","清除筛选":"Clear filter","未找到数据源":"Data source not found","行":"Row","值":"Value","筛选器":"Filter","数据透视表编辑器":"Pivot table editor","使用推荐的透视表":"Use recommended pivot table","显示总计":"Show grand total","汇总方式":"Summarize by","显示方式":"Display by","添加":"Add","没有可添加的字段":"No field to add","升序":"Ascending","降序":"Descending","排序依据":"Sort by","总计":"Total","（全部）":"(All)","（多项）":"(Multiple items)","只读模式下不可使用":"Not available in read-only mode"}},2567:function(n,t){n.exports={"求和":"合計","计数":"個数","平均值":"平均値","最大值":"最大値","最小值":"最小値","求积":"求積","数值计数":"数値の個数","标准偏差":"標準偏差","总体标准偏差":"母標準偏差","方差":"分散","总体方差":"母分散","默认":"デフォルト","占行总和的百分比":"行の合計に占める百分率","占列总和的百分比":"列の合計に占める百分率","占总和的百分比":"合計に占める百分率","数据透视表生成的列超过限制，请调整列字段以减少列数。":"ピボットテーブルの列が上限を超えています、列のフィールドを調整して列数を減らしてください。","目标区域不能有锁定或筛选":"対象範囲にロックまたはフィルタがあってはなりません","目标区域不能有其他数据单元格":"対象範囲にその他のデータセルがあってはなりません","目标区域不能有合并单元格":"対象範囲に結合セルがあってはなりません","数据源无效":"データソースが無効です","请输入一个有效范围":"有効な範囲を入力してください","数据源不能超出当前表格范围":"データソースは現在のスプレッドシートの範囲を超えてはなりません","数据透视表区域不能作为数据源":"ピボットテーブルの範囲をデータソースとすることはできません","不能引用锁定禁止查看的单元格":"閲覧禁止のロックセルは参照できません","数据源应至少有两行数据，且首行无空单元格":"データソースは少なくとも2行あり、かつ1行目に空白のセルがない必要があります","列":"列","请登录后使用":"ログインしてからご使用ください","升级高级版享用此功能":"アドバンスドエディションにグレードアップすると、この機能をご使用いただけます","数据透视表":"ピボットテーブル","创建数据透视表":"ピボットテーブルを作成","请选择要分析的数据":"分析するデータを選択してください","选择一个表或区域":"表または範囲を選択","请选择要放置数据透视表的位置":"ピボットテーブルを配置する位置を選択してください","新工作表":"新しいシート","现有工作表":"既存のシート","确定":"確認","目标区域无效":"対象範囲は無効です","目标区域不能超出当前表格范围":"対象範囲は現在のスプレッドシートの範囲を超えてはなりません","搜索":"検索","全选":"すべて選択","（空白）":"（空白）","清除筛选":"フィルタをクリア","未找到数据源":"データソースが見つかりません","行":"行","值":"値","筛选器":"フィルタ","数据透视表编辑器":"ピボットテーブルエディタ","使用推荐的透视表":"おすすめのピボットテーブルを使用","显示总计":"合計を表示","汇总方式":"合計方法","显示方式":"表示方法","添加":"追加","没有可添加的字段":"追加できるフィールドはありません","升序":"昇順","降序":"降順","排序依据":"並べ替え基準","总计":"合計","（全部）":"（すべて）","（多项）":"（複数項目）","只读模式下不可使用":"読み取り専用モードでは使用できません"}},2568:function(n,t,e){"use strict";var r,i=e(0),o=e.n(i),a=e(1),c=e.n(a),u=e(3),l=e(79),s=e(21),f=e(2127),v=e(42),d=u.sheets.utils.Features,p=function(n){return n.selection.hasPivotTableInRange||!n.permission.U||!n.permission.canReadRange||!Object(f.n)(n.A)&&!g(n)},g=function(n){return n.A.features.includes(d.POVIT_TABLE)};function b(n){var t=p(n),e=n.A.permissions.query.shimo.getFilePermission(),r=e&&e.permissions.editable,i=Object(f.k)(n.A)?o()("请登录后使用"):Object(f.n)(n.A)||g(n)||!r?null:o()("升级高级版享用此功能");return c.a.createElement("div",{style:{position:"relative"}},c.a.createElement(s.e,{icon:"pivot_table",A:n.A,text:o()("数据透视表"),disabled:t,onTap:h,tip:i},v.M.visible&&Object(f.n)(n.A)&&c.a.createElement("span",{className:"badge"})))}function h(){r.showPivotCreateDialog(),v.M.markAsOld()}t.a=function(n){var t;return r=n,{tabList:(t={},t[l.b.data]=b,t)}}},2569:function(n,t,e){"use strict";t.a=function(n,t){var e=n.rowFields,r=n.colFields,u=n.dataFields,l=function n(t,e,r,i,c,u){var l;u||(l=r.map(function(n){var t=n.subtotal,e=a.a[t],r="",c=i.map(function(t){var e=t[n.index],i=e.value,o=e.formatter;return o&&(r=o),i}).filter(function(n){return""!==n});return{value:c.length?e(c):0,formatter:t===o.f.COUNT||t===o.f.COUNTA?"":r}}));if(c===t.length+e.length)return{summary:l};var s;s=c<t.length?t[c]:e[c-t.length];var f={};var v={};i.forEach(function(n){if(n[s.index]){var t=n[s.index],e=t.value,r=t.formatter,i=String(e);f[i]||(f[i]=[],v[i]={value:e,formatter:r}),f[i].push(n),r&&(v[i].formatter=r)}});var d={};Object.keys(f).forEach(function(i){d[i]=n(t,e,r,f[i],c+1,!1)});var p;!u&&c<t.length&&(p=n(t,e,r,i,t.length,!0));return{summary:l,groups:d,groupsRaw:v,colSummary:p}}(e,r,u,t,0,!1),s=function(n,t){var e=n.rowFields;if(!n.colFields.length)return[];var r={};return function n(t,r){if(r===e.length)return[t];return i()(Object.keys(t.groups).map(function(e){return n(t.groups[e],r+1)}))}(t,0).forEach(function(n){return function n(t,e){t.groups&&Object.keys(t.groups).forEach(function(r){e.groups||(e.groups={},e.groupsRaw={}),e.groups[r]||(e.groups[r]={},e.groupsRaw[r]=t.groupsRaw[r]),n(t.groups[r],e.groups[r])})}(n,r)}),function n(t){return t.groups?Object.keys(t.groups).map(function(e){return c(c({},t.groupsRaw[e]),{valueStr:e,children:n(t.groups[e])})}):[]}(r)}(n,l);return{data:l,colHeaders:s}};var r=e(480),i=e.n(r),o=e(2115),a=e(2570),c=this&&this.__assign||function(){return(c=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)}},2570:function(n,t,e){"use strict";var r=e(3).sheets.Core,i=r.Spread.CalcEngine,o=r.Spread.Common,a=o._NumberHelper,c=o._DateTimeHelper;function u(n){return"number"==typeof n?n:n instanceof Date?c._toOADate(n):0}var l=function(n){return a._toPrecisionFloor(n.reduce(function(n,t){return n+u(t)},0),15)},s=function(n){return a._toPrecisionFloor(l(n)/n.length,15)},f={sum:l,counta:function(n){return n.reduce(function(n,t){return n+(""===t?0:1)},0)},average:s,max:function(n){return n.reduce(function(n,t){return Math.max(n,u(t))},-1/0)},min:function(n){return n.reduce(function(n,t){return Math.min(n,u(t))},1/0)},product:function(n){return a._toPrecisionFloor(n.reduce(function(n,t){return n*u(t)},1),15)},count:function(n){return n.reduce(function(n,t){return n+("number"==typeof t?1:0)},0)},stdev:function(n){var t=s(n),e=n.reduce(function(n,e){return n+Math.pow(u(e)-t,2)},0);return n.length<2?i.CalcErrorsDivideByZero:a._toPrecisionFloor(Math.sqrt(e/(n.length-1)),15)},stdevp:function(n){var t=s(n),e=n.reduce(function(n,e){return n+Math.pow(u(e)-t,2)},0);return a._toPrecisionFloor(Math.sqrt(e/n.length),15)},var:function(n){var t=s(n),e=n.reduce(function(n,e){return n+Math.pow(u(e)-t,2)},0);return n.length<2?i.CalcErrorsDivideByZero:a._toPrecisionFloor(e/(n.length-1),15)},varp:function(n){var t=s(n),e=n.reduce(function(n,e){return n+Math.pow(u(e)-t,2)},0);return a._toPrecisionFloor(e/n.length,15)}};t.a=f},2571:function(n,t,e){"use strict";t.a=function(n,t){var e=n.rowFields,r=n.colFields,i=n.dataFields;e.concat(r).forEach(function(n){if(n.sortBy&&!n.ineffectiveSort){var e=n.sortBy,r=e[0],o=e.slice(1);!o.some(function(n){var e=n.index,r=n.valueStr;return!Object(c.b)(t,e).includes(r)})&&i[r]||(n.ineffectiveSort=!0)}})},t.b=function(n,t){var e=t.data,r=t.colHeaders;(function n(t,e,r){var c=t.rowFields,u=t.colFields;var l=c[r];if(!l)return;var s=l.sort,f=l.sortBy;var v=s===o.b.ascending?a.b:a.c;if(f){for(var d=f[0],p=f.slice(1),g=0;g<p.length;g++)if(!u[g]||p[g].index!==u[g].index)return l.ineffectiveSort=!0,void(e.groupsOrder=i()(e.groupsRaw).sort(function(n,t){var e=n[1].value,r=t[1].value;return v(e,r)}).map(function(n){var t=n[0];return t}));if(p.length){var b=Object.keys(e.groups),h=b.reduce(function(n,t){var r=Object(a.a)(e.groups[t].colSummary||e.groups[t],p.map(function(n){return n.valueStr}));return n[t]=Object(a.h)(r,d),n},{});e.groupsOrder=b.sort(function(n,t){return v(h[n],h[t])})}else e.groupsOrder=i()(e.groups).sort(function(n,t){var e=n[1],r=t[1],i=Object(a.h)(e,d),o=Object(a.h)(r,d);return v(i,o)}).map(function(n){var t=n[0];return t})}else e.groupsOrder=i()(e.groupsRaw).sort(function(n,t){var e=n[1].value,r=t[1].value;return v(e,r)}).map(function(n){var t=n[0];return t});Object.keys(e.groups).forEach(function(i){n(t,e.groups[i],r+1)})})(n,e,0),function n(t,e,r,i,c){var l=t.colFields;var s=l[i];if(!s)return;var f=s.sort,v=s.sortBy,d=s.ineffectiveSort;var p=f===o.b.ascending?a.b:a.c;if(!v||d){if(r.sort(function(n,t){return p(n.value,t.value)}),d)return}else{var g=v[0],b=e[i],h=r.reduce(function(n,t){var e=t.valueStr,r=Object(a.a)(b,u(c,[e]));return n[e]=Object(a.h)(r,g),n},{});r.sort(function(n,t){return p(h[n.valueStr],h[t.valueStr])})}r.forEach(function(r){return n(t,e,r.children,i+1,u(c,[r.valueStr]))})}(n,function(n,t){var e=n.rowFields;return n.colFields.map(function(n){var r=n.sortBy;if(r){for(var i=r.slice(1),o=0;o<i.length;o++)if(!e[o]||i[o].index!==e[o].index){n.ineffectiveSort=!0;break}if(!n.ineffectiveSort){var c=Object(a.a)(t,i.map(function(n){return n.valueStr}));return c.colSummary||c}}})}(n,e),r,0,[])};var r=e(2572),i=e.n(r),o=e(2115),a=e(2176),c=e(2175),u=this&&this.__spreadArrays||function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),i=0;for(t=0;t<e;t++)for(var o=arguments[t],a=0,c=o.length;a<c;a++,i++)r[i]=o[a];return r}},2572:function(n,t,e){n.exports=e(802)},2573:function(n,t,e){"use strict";t.a=function(n,t){var e=t.data,r=t.colHeaders,o=[],a=[],c=function(n,t,e,r,o){var a=e.dataFields,c=e.rowFields,s=e.colFields,f=e.pivotFields;if(!(c.length||s.length||a.length))return x(n,1,0,{value:i()("行"),formatter:""}),x(n,0,1,{value:i()("列"),formatter:""}),x(n,1,1,{value:i()("值"),formatter:""}),{rowStart:1,colStart:1,rowCount:u.b-1,colCount:u.a-1};if(!c.length&&!s.length)return a.forEach(function(t,e){x(n,0,e,{value:Object(l.d)(f,t),formatter:"",editInfo:{type:"data",fieldIndex:e}})}),{rowStart:1,colStart:0,rowCount:1,colCount:a.length};if(!c.length&&!a.length)return v({colStart:0,rowCount:0},j(n,e,o,0));if(!s.length&&!a.length)return v({rowStart:1,colCount:0},A(n,t,e,r,1));if(!c.length){if(1===a.length){var d=j(n,e,o,1),p=d.rowStart,g=d.colCount;return x(n,p,0,{value:Object(l.d)(f,a[0]),formatter:""}),{colStart:1,rowStart:p,rowCount:1,colCount:g}}return v({colStart:0,rowCount:1},j(n,e,o,0))}if(!s.length){var b=A(n,t,e,r,1),h=b.colStart,I=b.rowCount;return a.forEach(function(t,e){x(n,0,h+e,{value:Object(l.d)(f,t),formatter:"",editInfo:{type:"data",fieldIndex:e}})}),{colStart:h,rowStart:1,rowCount:I,colCount:w(a)}}var m=c.length;1===a.length&&x(n,0,0,{value:Object(l.d)(f,a[0]),formatter:"",editInfo:{type:"data",fieldIndex:0}});var C=j(n,e,o,m),M=C.rowStart,y=C.colCount,O=A(n,t,e,r,M).rowCount;return{rowStart:M,colStart:m,rowCount:O,colCount:y}}(o,a,n,e,r),s=c.rowStart,f=c.rowCount,p=c.colStart,g=c.colCount,M=function(n,t){var e=n.rowStart,r=n.colStart,i=n.rowCount,o=n.colCount,a=[];if(o&&e>1){var c={row:0,col:r,rowCount:1,colCount:o};a.push(v(v({},c),{style:{backColor:u.c.BG_FIELD_NAME,bold:!0}}))}if(r){var c={row:e-1,col:0,rowCount:1,colCount:r};a.push(v(v({},c),{style:v({backColor:u.c.BG_FIELD_NAME,bold:!0},I)}))}e&&r&&a.push({row:0,col:0,rowCount:e-1,colCount:r,style:{backColor:u.c.BG_LEFT_TOP_CORNER,bold:!0}});if(o&&e){var l=0,s=e;e>1&&(l=1,s=e-1),a.push({row:l,col:r,rowCount:s,colCount:o,style:v({backColor:u.c.BG_COL_FIELD,foreColor:u.c.FORE_COL_FIELD,bold:!0},m)})}i&&r+o&&a.push({row:e,col:0,rowCount:i,colCount:r+o,style:v({backColor:u.c.BG_DATA_REGION},b)});i&&r&&a.push({row:e,col:0,rowCount:i,colCount:r,style:{backColor:u.c.BG_ROW_FIELD}});var f=r+o;return t.forEach(function(n){var t=n.row,e=n.col,r=n.isBottomRow,i={row:t,col:e,rowCount:1,colCount:f-e,style:v({backColor:u.c.BG_TOTAL_ROW},h)};r&&(i.style.bold=!0),a.push(i)}),a}(c,a);return function n(t,e,r,i,o,a,c,u,l,s,f){var v=e.rowFields,p=e.colFields,g=e.dataFields;if(u===v.length+p.length)return i.summary?(i.summary.forEach(function(n,e){var i=C(g,e,n,r,s,f);x(t,a,c+e,i)}),[1,w(g)]):[1,0];if(u>=v.length){var b=p[u-v.length],h=0;return l&&u!==v.length||(h=o.reduce(function(o,l){var v=String(l.value);return o+n(t,e,r,i.groups[v]||{summary:[],groups:{}},l.children,a,c+o,u+1,b.foldValues[v],s,d(f,[v]))[1]},0)),(b.showTotal||l)&&i.summary&&(i.summary.forEach(function(n,e){var i=C(g,e,n,r,s,f);x(t,a,c+h+e,i)}),h+=w(g)),[1,h]}var I=v[u],m=0;if(u>0&&(I.showTotal||l)){var A=n(t,e,r,i.colSummary,o,a+m,c,v.length,!1,s,f),j=A[0],M=A[1];(p.length&&p[0].showTotal||!p.length)&&i.summary.forEach(function(n,e){var i=C(g,e,n,r,s,f);x(t,a+m,c+M+e,i)}),m+=j}if(l||(m=(i.groupsOrder||Object.keys(i.groups)).reduce(function(l,v){return l+n(t,e,r,i.groups[v],o,a+l,c,u+1,I.foldValues[v],d(s,[v]),f)[0]},m)),0===u&&I.showTotal){var y=n(t,e,r,i.colSummary,o,a+m,c,v.length,!1,s,f),j=y[0],O=y[1];(p.length&&p[0].showTotal||!p.length)&&i.summary.forEach(function(n,e){var i=C(g,e,n,r,s,f);x(t,a+m,c+O+e,i)}),m+=j}return[m,1]}(o,n,e,e,r,s,p,0,!1,[],[]),function(n,t,e){for(var r=0;r<t;r++){for(var o=n[r]||[],a=0;a<e;a++){var c=o[a];c?""===c.value&&(c.value=i()("（空白）")):o[a]={value:"",formatter:""}}n[r]=o}}(o,s+f,p+g),{cells:o,styles:M}},t.b=function(n,t,e){var r=[],o=[],a=n.pageFields,c=n.pivotFields,s=Math.max(e,2);if(a.length)for(var v=0;v<=a.length;v++){r.push([]);for(var d=function(n){var e=void 0;if(v===a.length||n>1)r[v].push({value:"",formatter:"",isPageFieldCell:!0});else{var s=a[v],d=s.filter,p=void 0,g=Object(l.e)(c,s),b=Object(f.b)(t,s.index),h=b.filter(function(n){return!d.excludeValues.includes(n)});if(0===n)p=g;else if(b.length===h.length){var I=""===b[0]?i()("（空白）"):b[0];p=1===b.length?I:i()("（全部）")}else p=1===h.length?h[0]:i()("（多项）");var m={value:p,formatter:"",isPageFieldCell:!0};0===n&&Object.assign(m,{editInfo:{type:"page",fieldIndex:v}}),1===n&&Object.assign(m,{filterInfo:{type:"page",fieldIndex:v}}),r[v].push(m),e={bold:!0,backColor:u.c.BG_PAGE_FIELD}}e&&o.push({row:v,col:n,rowCount:1,colCount:1,style:e,isPageFieldCell:!0})},p=0;p<s;p++)d(p)}return{cells:r,styles:o}};var r=e(0),i=e.n(r),o=e(3),a=e(2115),c=e(2574),u=e(2174),l=e(2176),s=e(2127),f=e(2175),v=this&&this.__assign||function(){return(v=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},d=this&&this.__spreadArrays||function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),i=0;for(t=0;t<e;t++)for(var o=arguments[t],a=0,c=o.length;a<c;a++,i++)r[i]=o[a];return r},p=o.sheets.Core.Spread.CalcEngine,g="0.00%",b={borderLeft:new c.a(u.c.BORDER_TRANSPARENT,c.b.dashed),borderTop:new c.a(u.c.BORDER_TRANSPARENT,c.b.dashed),borderRight:new c.a(u.c.BORDER_TRANSPARENT,c.b.dashed),borderBottom:new c.a(u.c.BORDER_TRANSPARENT,c.b.dashed)},h={borderTop:new c.a(u.c.BORDER_DARK_GRAY,c.b.thin),borderBottom:new c.a(u.c.BORDER_LIGHT_GRAY,c.b.thin)},I={borderBottom:new c.a(u.c.BORDER_DARK_GRAY,c.b.medium)},m={borderLeft:new c.a(u.c.BORDER_DARK_GRAY,c.b.thin),borderTop:new c.a(u.c.BORDER_DARK_GRAY,c.b.thin),borderRight:new c.a(u.c.BORDER_DARK_GRAY,c.b.thin),borderBottom:new c.a(u.c.BORDER_DARK_GRAY,c.b.thin)};function w(n){return Math.max(n.length,1)}function C(n,t,e,r,i,o){if("number"!=typeof e.value)return e;var c=n[t].showDataAs;if(c===a.e.default)return e;var u=(e=v({},e)).value;if(c===a.e.rowPercent){var s=Object(l.a)(r,i);u=Object(l.h)(s,t,u)}else if(c===a.e.colPercent){if(r.colSummary)if(o.length){s=Object(l.a)(r.colSummary,o);u=Object(l.h)(s,t,u)}else{s=Object(l.a)(r,[]);u=Object(l.h)(s,t,u)}}else c===a.e.totalPercent&&(u=Object(l.h)(r,t,u));return"number"!=typeof u?(e.value=u,e):u?(e.value=e.value/u,e.formatter=g,e):(e.value=p.CalcErrorsDivideByZero,e)}function x(n,t,e,r){n[t]||(n[t]=[]),n[t][e]=r}function A(n,t,e,r,o){var a=e.rowFields,c=e.pivotFields;return a.forEach(function(t,e){x(n,o-1,e,{value:Object(l.g)(c,t),formatter:"",editInfo:{type:"row",fieldIndex:e},filterInfo:{type:"row",fieldIndex:e}})}),{rowCount:function n(t,e,r,o,a,c,u,l){var s=r[u];if(!s)return 1;var f=0;return u>0&&(s.showTotal||l)&&(x(t,a,c,{value:i()("总计"),formatter:""}),e.push({row:a,col:c-1}),f++),l||(f=(o.groupsOrder||Object.keys(o.groups)).reduce(function(i,f){l=s.foldValues[f];var d=v({},o.groupsRaw[f]);return u<r.length-1&&(d.collapseInfo={type:"row",fieldIndex:u,value:f,isCollapsed:l}),x(t,a+i,c,d),i+n(t,e,r,o.groups[f],a+i,c+1,u+1,l)},f)),0===u&&s.showTotal&&(x(t,a+f,c,{value:i()("总计"),formatter:""}),e.push({row:a+f,col:c,isBottomRow:!0}),f++),f}(n,t,a,r,o,0,0,!1),colStart:a.length}}function j(n,t,e,r){var o=t.colFields,a=t.dataFields,c=t.pivotFields;return o.forEach(function(t,e){x(n,0,r+e,{value:Object(l.g)(c,t),formatter:"",editInfo:{type:"col",fieldIndex:e},filterInfo:{type:"col",fieldIndex:e}})}),a.length>1&&x(n,0,r+o.length,{value:i()("值"),formatter:""}),{rowStart:a.length>1?o.length+2:o.length+1,colCount:function n(t,e,r,o,a,c,u,f,v,d,p){var g=e[f];if(!g)return r.length>1&&r.forEach(function(n,e){x(t,c,u+e,{value:Object(l.d)(o,n),formatter:"",editInfo:{type:"data",fieldIndex:e}})}),w(r);var b=0;if(p||(b=a.reduce(function(i,a){var l=a.value,s=a.formatter,v=a.children,d=String(l),p=g.foldValues[d];if(!p||f===e.length-1){var b={value:l,formatter:s};f<e.length-1&&(b.collapseInfo={type:"col",fieldIndex:f,value:d,isCollapsed:!1}),x(t,c,u+i,b)}return i+n(t,e,r,o,v,c+1,u+i,f+1,l,s,p)},0)),g.showTotal||p){var h={value:(""!==v?Object(s.h)(v,d)+" ":0!==f?i()("（空白）")+" ":"")+i()("总计"),formatter:""};p&&(h.collapseInfo={type:"col",fieldIndex:f-1,value:String(v),isCollapsed:!0}),x(t,f>0?c-1:c,u+b,h),b+=n(t,e,r,o,[],c+e.length-f,u+b,e.length,"",d,!1)}return b}(n,o,a,c,e,1,r,0,"","",!1)}}},2574:function(n,t,e){"use strict";e.d(t,"a",function(){return i}),e.d(t,"b",function(){return o});var r=e(3).sheets.Core,i=r.Spread.Sheets.LineBorder,o=r.Spread.Sheets.LineStyle},2575:function(n,t,e){"use strict";var r,i=e(0),o=e.n(i),a=e(3),c=e(70),u=e.n(c),l=e(19),s=e.n(l),f=e(318),v=e.n(f),d=e(90),p=e.n(d),g=e(2576),b=e.n(g),h=e(64),I=e.n(h),m=e(55),w=(e.n(m),e(2204)),C=e(2177),x=e(2115),A=e(2127),j=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),M=a.sheets,y=M.sheet,O=M.position,N=M.filter,k=y.getSheetAttrs,T=y.setSheetAttrs,S=O.stringifyPosition,D=O.parsePosition,Z=N.getFilterOutRowsInRange;function B(n,t,e){var r=k(n,w.b)||{};r[t]=e,T(n,w.b,r)}var P=function(n){function t(e){var r=n.call(this)||this;return r.createPivotTable=function(n,t,e,i,o){var a=Object(m.genGuid)(),c=o||{row:0,col:0},u=c.row,l=c.col,s={source:{type:"worksheet",sheetSource:t},location:S(u,l),pivotFields:[],rowFields:[],colFields:[],pageFields:[],dataFields:[]},f=n.parent,d=r._genPivotTableAttr(a,s),p=new w.a(a,s);if(e){var g=r._genNewPivotTableSheetName(i),b=r._genSheetIndexAndOrder(n),h=b.order,I=b.index;d=Object.assign(d,{newSheetOrder:h,newSheetIndex:I}),r.A.spread.actions.insertSheet({name:g,newSheetIndex:I,newSheetOrder:h,sheetAttrs:d,sheetInsertedCallback:function(){B(i=f.getSheetFromName(g),a,p),i.setFormula(u,l,Object(A.c)(a,t))}})}else{i.setFormula(u,l,Object(A.c)(a,t));var C={fnName:"tableAttrs2Cs",params:[i.guid(),d]};r.A.actions.calcOperator({operator:[C],label:"createPivotTable"}),B(i,a,p);var x=v()(f.sheets,function(n){return n.guid()===i.guid()});f.getActiveSheetIndex()!==x&&f.TJ(x)}return p},r.addPivotTable=function(n,t,e){void 0===e.pivotFields&&(e.pivotFields=[]);var r=new w.a(t,e);B(n,t,r);var i=D(e.location),o=i.row,a=i.col;return n.setFormula(o,a,Object(A.c)(t,e.source.sheetSource)),r},r.recalcPivotTables=function(n,t){var e=k(n,w.b)||{};t.forEach(function(t){var r=e[t],i=D(r.getDefinition(!1).location),o=i.row,a=i.col;n.NY(null,o,a)})},r.updatePivotTable=function(n,t,e,i,o){void 0===o&&(o=!0);var a=(k(n,w.b)||{})[t],c=a.getDefinition(!1);(s()(i)||i===x.d.pageFieldChange)&&(i=r._comparePivotTableDefinition(c,e)),e.pivotFields&&i!==x.d.sourceChange||(e.pivotFields=p()(c.pivotFields));var u=!1,l=D(c.location),f=l.row,v=l.col,d=c.pageFields.length;if(d<e.pageFields.length){var g=a.getRenderRange(),b=!1;if(g&&(0===d&&g.row>1||d>0&&g.row>0)){var h=0===d?g.row-2:g.row-1;Object(A.j)(n,{row:h,col:v,rowCount:1,colCount:2})||(b=!0)}else g||(b=!0);if(!b){u=!0;var I=e.pageFields.length+1;e.location=S(I,v),a.setDefinition(e),a.setChangeType(x.d.noChange),n.setFormula(f,v,null),n.setFormula(I,v,Object(A.c)(t,e.source.sheetSource))}}if(!u)if(a.setDefinition(e),a.setChangeType(i),i===x.d.sourceChange)a.clearModelData(n,!0),n.setFormula(f,v,Object(A.c)(t,e.source.sheetSource));else if(i===x.d.locationChange||i===x.d.sourceAndLocationChange){n.setFormula(f,v,null);var m=e.pageFields.length,C=D(e.location),j=(I=C.row,C.col);m&&m+1>I&&(n.setFormula(I,j,null),e.location=S(m+1,j),I=m+1),i===x.d.sourceAndLocationChange&&a.clearModelData(n,!0),n.setFormula(I,j,Object(A.c)(t,e.source.sheetSource))}else n.getFormula(f,v)?n.NY(null,f,v):n.setFormula(f,v,Object(A.c)(t,e.source.sheetSource));B(n,t,a);var M={fnName:"tableAttrs2Cs",params:[n.guid(),r._genPivotTableAttr(t,e)]};return o&&r.A.actions.calcOperator({operator:[M],label:"updatePivotTable"}),M},r.deletePivotTable=function(n,t,e){void 0===e&&(e=!0);var i=k(n,w.b)||{},o=i[t],a=o.getDefinition(!1).location;delete i[t],T(n,w.b,i);var c=D(a),u=c.row,l=c.col,s=!Object(A.l)(n,o);o.clearModelData(n,s);var f=n.getFormula(u,l);f&&f.startsWith("PIVOTTABLE(")&&n.setFormula(u,l,null);var v={fnName:"tableAttrs2Cs",params:[n.guid(),r._genPivotTableAttr(t,null)]};return e&&r.A.actions.calcOperator({operator:[v],label:"deletePivotTable"}),r.emit(C.a.PivotTableDeleted,{sheet:n,pivotTableId:t}),v},r.getPivotTable=function(n,t){return(k(n,w.b)||{})[t]},r._genSheetIndexAndOrder=function(n){var t=n.parent,e=v()(t.sheets,function(t){return t.guid()===n.guid()}),i=0!==e?t.sheets[e-1]:null,o=r.A.spread.sheets.find(function(t){return t.id===n.guid()}).order,a=i?r.A.spread.sheets.find(function(n){return n.id===i.guid()}).order:o<0?o-1:-1;return{order:parseFloat(((a+o)/2).toFixed(8)),index:e}},r._genNewPivotTableSheetName=function(n){var t=n.parent.sheets.map(function(n){return n.name().trim()}).filter(function(n){return new RegExp("^"+o()("数据透视表")+"(\\s+)?\\d+$").test(n)}).map(function(n){return parseInt(n.replace(o()("数据透视表"),"").trim())});return o()("数据透视表")+(t.length?Math.max.apply(Math,t)+1:1)},r._genPivotTableAttr=function(n,t){var e,r,i="pivot-table-"+n;return null==t?((e={})[i]=null,e):((r={})[i]=JSON.stringify(u()(t,["source","location","rowFields","colFields","pageFields","dataFields"])),r)},r._comparePivotTableDefinition=function(n,t){if((n=p()(n)).pivotFields=[],(t=p()(t)).pivotFields=[],JSON.stringify(n)===JSON.stringify(t))return x.d.noChange;var e=n.source.sheetSource!==t.source.sheetSource,r=n.location!==t.location;if(e&&r)return x.d.sourceAndLocationChange;if(e)return x.d.sourceChange;if(r)return x.d.locationChange;var i=n.pageFields,o=t.pageFields;if(JSON.stringify(i)!==JSON.stringify(o))if(i.length>o.length){if(b()(i,o,I)[0].filter.excludeValues.length)return x.d.pageFieldChange}else if(i.length<o.length){if(b()(o,i,I)[0].filter.excludeValues.length)return x.d.pageFieldChange}else for(var a=0,c=o.length;a<c;a++)if(i[a].index!==o[a].index||JSON.stringify(i[a].filter.excludeValues)!==JSON.stringify(o[a].filter.excludeValues))return x.d.pageFieldChange;var u=!1,l=!1,s=n.rowFields,f=t.rowFields;if(JSON.stringify(s)!==JSON.stringify(f))if(s.length>f.length){if(l=!0,b()(s,f,I)[0].filter.excludeValues.length)return x.d.rowColFilterChange}else if(s.length<f.length){if(l=!0,b()(f,s,I)[0].filter.excludeValues.length)return x.d.rowColFilterChange}else for(a=0,c=f.length;a<c;a++){if(s[a].index!==f[a].index)return x.d.pageFieldChange;if(JSON.stringify(s[a].filter.excludeValues)!==JSON.stringify(f[a].filter.excludeValues))return x.d.pageFieldChange;s[a].sort===f[a].sort&&s[a].sortBy===f[a].sortBy&&s[a].ineffectiveSort===f[a].ineffectiveSort||(u=!0)}var v=n.colFields,d=t.colFields;if(JSON.stringify(v)!==JSON.stringify(d))if(v.length>d.length){if(l=!0,b()(v,d,I)[0].filter.excludeValues.length)return x.d.rowColFilterChange}else if(v.length<d.length){if(l=!0,b()(d,v,I)[0].filter.excludeValues.length)return x.d.rowColFilterChange}else for(a=0,c=d.length;a<c;a++){if(v[a].index!==d[a].index)return x.d.pageFieldChange;if(JSON.stringify(v[a].filter.excludeValues)!==JSON.stringify(d[a].filter.excludeValues))return x.d.pageFieldChange;v[a].sort===d[a].sort&&v[a].sortBy===d[a].sortBy&&v[a].ineffectiveSort===d[a].ineffectiveSort||(u=!0)}if(l)return x.d.rowColDataFieldChange;var g=n.dataFields,h=t.dataFields;if(JSON.stringify(g)!==JSON.stringify(h)){if(g.length!==h.length)return x.d.rowColDataFieldChange;for(a=0,c=h.length;a<c;a++)if(g[a].subtotal!==h[a].subtotal||g[a].showDataAs!==h[a].showDataAs)return x.d.rowColDataFieldChange}return n.location!==t.location?x.d.locationChange:u?x.d.sortChange:x.d.renderConfigChange;function I(n,t){return n.index===t.index}},"object"==typeof t.instance?(t.instance.A=e,t.instance):(r.A=e,t.instance=r,r)}return j(t,n),t.prototype.copyOrMovePivotTable=function(n){var t=n.pivotTable,e=n.toSheet,r=n.fromRange,i=n.toRange,o=n.isMove,a=n.fromSheet,c=n.calcFilteredRows,u=t.getDefinition(!1),l=D(u.location),s=l.row,f=l.col,v=r.row,d=r.col,g=i.row,b=i.col,h=g+s-Math.max(v,0),I=0;a&&c&&(I-=Z(a,{row:v,rowCount:s-v,col:0,colCount:1}).length,I+=Z(e,{row:g,rowCount:h-g,col:0,colCount:1}).length);var C,j={row:h+I,col:b+f-Math.max(d,0)},M=Object.assign(p()(u),{location:S(j.row,j.col)});if(o)C=this.updatePivotTable(e,t.getTableId(),M,x.d.locationChange,!1);else{var y=Object(m.genGuid)();B(e,y,new w.a(y,M)),e.setFormula(j.row,j.col,Object(A.c)(y,M.source.sheetSource)),C={fnName:"tableAttrs2Cs",params:[e.guid(),this._genPivotTableAttr(y,M)]}}return C},t}(I.a);t.a=P},2576:function(n,t,e){var r=e(805),i=e(164),o=e(248),a=e(486),c=e(157)(function(n,t){var e=a(t);return o(e)&&(e=void 0),o(n)?r(n,i(t,1,o,!0),void 0,e):[]});n.exports=c},2577:function(n,t,e){"use strict";t.b=function(n){return n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTlweCIgaGVpZ2h0PSIxOXB4IiB2aWV3Qm94PSIwIDAgMTkgMTkiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjIgKDcyNjQzKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5vcGVuPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+CiAgICAgICAgPGxpbmVhckdyYWRpZW50IHgxPSI1MCUiIHkxPSIwJSIgeDI9IjUwJSIgeTI9IjEwMCUiIGlkPSJsaW5lYXJHcmFkaWVudC0xIj4KICAgICAgICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iI0ZDRkNGQyIgb2Zmc2V0PSIwJSI+PC9zdG9wPgogICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjRjdGN0Y3IiBvZmZzZXQ9IjEwMCUiPjwvc3RvcD4KICAgICAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IuaVsOaNrumAj+inhuihqCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE3MjcuMDAwMDAwLCAtNDAuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJvcGVuIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzI3LjAwMDAwMCwgNDAuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlLUNvcHktOCIgc3Ryb2tlLW9wYWNpdHk9IjAuMyIgc3Ryb2tlPSIjMzMzMzMzIiBmaWxsPSJ1cmwoI2xpbmVhckdyYWRpZW50LTEpIiB4PSIyLjUiIHk9IjIuNSIgd2lkdGg9IjE0IiBoZWlnaHQ9IjE0IiByeD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS1Db3B5LTE3IiBmaWxsPSIjNjY2NjY2IiB4PSI2IiB5PSI5IiB3aWR0aD0iNyIgaGVpZ2h0PSIxIiByeD0iMC41Ij48L3JlY3Q+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlLUNvcHktMTgiIGZpbGw9IiM2NjY2NjYiIHg9IjkiIHk9IjYiIHdpZHRoPSIxIiBoZWlnaHQ9IjciIHJ4PSIwLjUiPjwvcmVjdD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTlweCIgaGVpZ2h0PSIxOXB4IiB2aWV3Qm94PSIwIDAgMTkgMTkiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjIgKDcyNjQzKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5mb2xkPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+CiAgICAgICAgPGxpbmVhckdyYWRpZW50IHgxPSI1MCUiIHkxPSIwJSIgeDI9IjUwJSIgeTI9IjEwMCUiIGlkPSJsaW5lYXJHcmFkaWVudC0xIj4KICAgICAgICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iI0ZDRkNGQyIgb2Zmc2V0PSIwJSI+PC9zdG9wPgogICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjRjdGN0Y3IiBvZmZzZXQ9IjEwMCUiPjwvc3RvcD4KICAgICAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IuaVsOaNrumAj+inhuihqCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE2ODYuMDAwMDAwLCAtNDAuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJmb2xkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjg2LjAwMDAwMCwgNDAuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlLUNvcHktNyIgc3Ryb2tlLW9wYWNpdHk9IjAuMyIgc3Ryb2tlPSIjMzMzMzMzIiBmaWxsPSJ1cmwoI2xpbmVhckdyYWRpZW50LTEpIiB4PSIyLjUiIHk9IjIuNSIgd2lkdGg9IjE0IiBoZWlnaHQ9IjE0IiByeD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS1Db3B5LTEyIiBmaWxsPSIjNjY2NjY2IiB4PSI2IiB5PSI5IiB3aWR0aD0iNyIgaGVpZ2h0PSIxIiByeD0iMC41Ij48L3JlY3Q+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="},t.a=function(n,t){if(n){var e="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIzMHB4IiBoZWlnaHQ9IjMwcHgiIHZpZXdCb3g9IjAgMCAzMCAzMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT5ibHVlX2ZpbHRlcmVkQDJ4PC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxkZWZzPjwvZGVmcz4gICAgPGcgaWQ9IlBhZ2UtMiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+ICAgICAgICA8ZyBpZD0iR3JvdXAtNS1Db3B5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0LjAwMDAwMCwgNi4wMDAwMDApIiBmaWxsPSIjNjI5MENDIj4gICAgICAgICAgICA8cGF0aCBkPSJNMTMsOS44MTgxODE4MiBMMTMsMjAgTDksMjAgTDksOS44MTgxODE4MiBMMCwwIEwyMiwwIEwxMyw5LjgxODE4MTgyIFoiIGlkPSJDb21iaW5lZC1TaGFwZS1Db3B5LTYiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTogbXVsdGlwbHk7Ij48L3BhdGg+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=",r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIzMHB4IiBoZWlnaHQ9IjMwcHgiIHZpZXdCb3g9IjAgMCAzMCAzMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT53aGl0ZV9maWx0ZXJlZEAyeDwvdGl0bGU+ICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPiAgICA8ZGVmcz48L2RlZnM+ICAgIDxnIGlkPSJQYWdlLTIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtb3BhY2l0eT0iMC43NSI+ICAgICAgICA8ZyBpZD0iR3JvdXAtNy1Db3B5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0LjAwMDAwMCwgNi4wMDAwMDApIiBmaWxsPSIjRkZGRkZGIj4gICAgICAgICAgICA8cGF0aCBkPSJNMTMsOS44MTgxODE4MiBMMTMsMjAgTDksMjAgTDksOS44MTgxODE4MiBMMCwwIEwyMiwwIEwxMyw5LjgxODE4MTgyIFoiIGlkPSJDb21iaW5lZC1TaGFwZS1Db3B5LTc3Ij48L3BhdGg+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=";return t?e:r}var e="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIzMHB4IiBoZWlnaHQ9IjMwcHgiIHZpZXdCb3g9IjAgMCAzMCAzMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT5ibHVlQDJ4PC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxkZWZzPjwvZGVmcz4gICAgPGcgaWQ9IlBhZ2UtMiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+ICAgICAgICA8ZyBpZD0iR3JvdXAtNC1Db3B5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0LjAwMDAwMCwgNi4wMDAwMDApIiBmaWxsPSIjNjI5MENDIj4gICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwyMiwwIEwyMiwyIEwwLDIgTDAsMCBaIE00LDQgTDE4LDQgTDE4LDYgTDQsNiBMNCw0IFogTTgsOCBMMTQsOCBMMTQsMTAgTDgsMTAgTDgsOCBaIE0xMCwxMiBMMTIsMTIgTDEyLDE4IEwxMCwxOCBMMTAsMTIgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlLUNvcHktMTAiPjwvcGF0aD4gICAgICAgIDwvZz4gICAgPC9nPjwvc3ZnPg==",r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIzMHB4IiBoZWlnaHQ9IjMwcHgiIHZpZXdCb3g9IjAgMCAzMCAzMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT53aGl0ZUAyeDwvdGl0bGU+ICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPiAgICA8ZGVmcz48L2RlZnM+ICAgIDxnIGlkPSJQYWdlLTIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtb3BhY2l0eT0iMC43NSI+ICAgICAgICA8ZyBpZD0iR3JvdXAtNi1Db3B5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0LjAwMDAwMCwgNi4wMDAwMDApIiBmaWxsPSIjRkZGRkZGIj4gICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwyMiwwIEwyMiwyIEwwLDIgTDAsMCBaIE00LDQgTDE4LDQgTDE4LDYgTDQsNiBMNCw0IFogTTgsOCBMMTQsOCBMMTQsMTAgTDgsMTAgTDgsOCBaIE0xMCwxMiBMMTIsMTIgTDEyLDE4IEwxMCwxOCBMMTAsMTIgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlLUNvcHktMTAiPjwvcGF0aD4gICAgICAgIDwvZz4gICAgPC9nPjwvc3ZnPg==";return t?e:r}},2578:function(n,t,e){"use strict";t.a=function(n,t){var e=f(c.a,function(e,r,o){var s=e.source.PM,f=s,v=s.parent.isPrinting,b=n.spread.getSheet(f.guid()),h=f.attrs||{};!Object.keys(h).length&&b&&(h=b.E.attrs||{},f=b.E);var I=h.pivotTables&&h.pivotTables[o];if(!I)return l.CalcErrorsValue;var m=r.getRow(),w=r.getColumn(),C=r.G(),x=r.H(),A=r.getSource().PM,j=[];if(!A)return I.clearModelData(f,!1),l.CalcErrorsReference;var M=n.sheetStates,y=f.guid(),O=n.spread.B();if(!n.csrManager.getAllBackRefSheets(y).some(function(n){return!!M.getState(n)[0]})&&y!==O.id&&!v)return I.markNeedRecalc(),"";var N=I.getChangeType(),k=I.getDefinition(!1);if(N===a.d.noChange||N===a.d.sourceChange||N===a.d.sourceAndLocationChange||!k.pivotFields){for(var T=[],S={},D=m;D<m+C;D++){for(var Z=[],B=w;B<w+x;B++){var P=A.getValue(D,B);if(P=null==P?"":P,D===m)T.push({name:A.getText(D,B)||Object(u.d)(D,B,n.getLocale()),isNumberField:!0});else{var z=A.K(D,B),R=z&&(z.formatter||z._autoFormatter)||"";R||!A.getFormula(D,B)&&!A.isArrayComputedCell(D,B)||(R=A.SG(D,B)),Z.push({value:P,formatter:R}),!1!==S[B-w]&&(S[B-w]=!isNaN(Number(P)))}}D!==m&&j.push(Z)}T.forEach(function(n,t){void 0!==S[t]&&(n.isNumberField=S[t])}),k.pivotFields=T,I.setDefinition(k)}if(k.colFields.length){var G=k.colFields.map(function(n){return n.index}),E=new Set;if(j.forEach(function(n){var t=n.filter(function(n,t){return-1!==G.indexOf(t)}).map(function(n){return n.value.toString()}).join("-");E.add(t)}),E.size>g)return new p("#ERROR!","",i()("数据透视表生成的列超过限制，请调整列字段以减少列数。"))}c.e.emit(c.b.PivotDefinitionChanged,{sheet:f,pivotTableId:o});var L,W=I.getRenderRange();try{var F=I.render(j),H=F.calcValues,V=F.renderRange,J=F.rangeChanged;L=H,Array.isArray(H)&&(H.length&&H[0].length>g?L=new p("#ERROR!","",i()("数据透视表生成的列超过限制，请调整列字段以减少列数。")):(L=new d(Object(u.q)(H),e)).pivotTableRange=V),!t&&J&&c.e.emit(c.b.PivotTableRendered,{sheet:f,pivotTableId:o,renderRange:V,oldRenderRange:W})}catch(n){return l.CalcErrorsValue}return L},void 0,{minArgs:2,maxArgs:2,acceptsReference:!0,isContextSensitive:!0,returnReference:!0,returnArray:!0});v(c.a,e)};var r=e(0),i=e.n(r),o=e(3),a=e(2115),c=e(2135),u=e(2127),l=o.sheets.Core.Spread.CalcEngine,s=l.Functions,f=s.createFunction,v=s.defineGlobalCustomFunction,d=l.CalcArray,p=l.CalcError,g=300},2579:function(n,t,e){"use strict";t.a=function(n){(function(n){var t,e,r,c,u=((t={})[f.Worksheet.getArrayFormulaRange]=function(n){Object(i.o)(n.expr)&&n.arrValue.pivotTableRange&&(n.returnRange=n.arrValue.pivotTableRange)},t[f.Worksheet.isCellEmpty]=function(t){var e=t.row,r=t.col,i=t.isEmpty;if(!i){var o=n.spread.getSheet(this.guid()),c=o&&o.E?o.E:this,u=Object(a.isPivotTableExcludedCell)(c,e,r),l=""===t.v&&null===c.getValue(e,r);(u||l)&&(t.isEmpty=!0)}},t[f.Worksheet.clearArrayValueCell]=function(t){if(Object(i.o)(t.expr)){var e=this.attrs;if(!Object.keys(this.attrs).length){var r=n.spread.getSheet(this.guid());r&&(e=r.E.attrs)}var o=t.row,a=t.col,c=t.expr.arguments[1].value,u=e.pivotTables[c];u&&u.isNormalCell(this,o,a)?t.ignore=!0:u&&u.clearRenderStyle(this,o,a)}},t[f.Worksheet.beforeSetValuesForArrayExpression]=function(t){if(Object(i.o)(t.expr)){var e=this.attrs;if(!Object.keys(this.attrs).length){var r=n.spread.getSheet(this.guid());r&&(e=r.E.attrs)}var o=t.expr.arguments[1].value,a=e.pivotTables[o];a&&a.updateNormalCells(this)}},t[f.Worksheet.setArrayValueCell]=function(t){if(Object(i.o)(t.expr)){var e=this.attrs;if(!Object.keys(this.attrs).length){var r=n.spread.getSheet(this.guid());r&&(e=r.E.attrs)}var o=t.row,a=t.col,c=t.expr.arguments[1].value,u=e.pivotTables[c];if(u){var l=u.getDefinition(!1).pageFields.length;if(l){var s=u.getPageFieldRange(),f=u.getRowColFieldRange();s&&v(o,a,s)||f&&v(o,a,f)||(t.ignore=!0)}t.ignore||(t.ignore=!0,this.updateCalcResult(t.row,t.col,t.value),u.applyRenderStyles(this,o,a))}}},t[f.Worksheet.toJson]=function(n,t){t&&t.includePivotTableStyle&&(n._guid=this.guid())},t[f.Worksheet.beforeGetIsArrayComputedCell]=function(n){var t=n.cell,e=t.row,r=t.col;Object(a.isPivotTableExcludedCell)(this,e,r)&&(n.isCellExcludedInArrayFormula=!0)},t[f.Worksheet.onLayoutChanged]=function(n){var t=n.changeType,e=n.row,r=n.rowCount;"addRows"!==t&&"deleteRows"!==t||i.v.call(this,e,r,"addRows"===t)},t[f.Worksheet.setHost]=function(n){var t=this;n&&s(n).bind("mousedown",function(n){if(t.isEditable()){var e=t.NK();i.p.call(t,n.pageX-e.left,n.pageY-e.top)}})},t[f.Worksheet.dispose]=function(){s(this._getCanvas()).unbind("mousedown")},t[f.Worksheet.paintCell]=function(n){var t=n.ctx,e=n.cell,r=n.sheetArea;if(null==r||3===r){null==r&&(r=3);var o=e.width,c=e.height,u=e.row,l=e.col,s=e.x,f=e.y,v=e.style,d=Object(a.getCellRelatedPivotTable)(this,u,l,{ignoreCalcErrorPivot:!0});if(d){var p=d.getCollapseCells()[u+"-"+l];if(p){var g=d.getRenderStyle(u,l);Object(i.a)({ctx:t,sheet:this,row:u,col:l,x:s,y:f,width:o,height:c,sheetArea:r,style:v,pivotStyle:g,type:"fold",collapseInfo:p})}else o>0&&c>0&&Object(i.m)(this,u,l)&&Object(i.a)({ctx:t,sheet:this,row:u,col:l,x:s,y:f,width:o,height:c,sheetArea:r,style:v,type:"filter"})}}},t[f.Worksheet.processMouseDown]=function(n){var t=n.e,e=this.NK();i.u.call(this,t.pageX-e.left,t.pageY-e.top)&&(n.r=!0)},t[f.Worksheet.beforeTouchHitTest]=function(n){var t=n.position,e=t.X,r=t.Y;i.p.call(this,e,r)&&(n.cancel=!0)},t[f.Worksheet.afterSetValuesForArrayExpression]=function(t){var e=t.sheet,r=t.range,i=[];if(r){for(var o=r.row;o<r.row+r.rowCount;o++)i.push(o);e.guid()===n.spread.B().E.guid()&&e.autoFitRow(i)}},t),l=((e={priority:4e3})[f.Worksheet.getCellStyle]=p,e[f.Worksheet.getActualStyle]=p,e[f.Worksheet.getCompositeStyle]=p,e),g=((r={})[f.BaseCellType.adjustCellXPosition]=function(n,t){var e=n.sheet,r=n.row,o=n.col,c=n.hAlign,u=Object(a.getCellRelatedPivotTable)(e,r,o,{ignoreCalcErrorPivot:!0});if(u){var l=u.getCollapseCells()[r+"-"+o];if(l&&!c)return n.adjX+=16,t()}else if(Object(i.m)(e,r,o)&&2===c)return n.adjX-=16,t()},r),b=((c={priority:100})[f.Workbook.beforeSetCopyMoveValue]=function(n){var t=n.srcSheet,e=n.srcCell;n.cancelSetValue&&Object(a.isPivotTableExcludedCell)(t,e.row,e.col)&&(n.cancelSetValue=!1)},c[f.Workbook.collectCopyMoveValueCell]=function(n){var t=n.sheet,e=n.row,r=n.col;if(n.ignoreCollect)Object(a.isPivotTableExcludedCell)(t,e,r)&&(n.ignoreCollect=!1);else if(!n.ignoreCollect&&t.attrs&&t.attrs.pivotTables&&Object.keys(t.attrs.pivotTables).length){var i=t.getFormula(e,r);i&&i.startsWith(o.a)&&(n.ignoreCollect=!0)}},c[f.Workbook.beforeCopyMoveFormula]=function(n){var t=n.src,e=n.row,r=n.col;if(t.attrs&&t.attrs.pivotTables&&Object.keys(t.attrs.pivotTables).length){var i=t.getFormula(e,r);i&&i.startsWith(o.a)&&(n.cancelCopyFormula=!0)}},c);d("Worksheet").register("pivotTable",u),d("Worksheet").register("pivotTable",l),d("BaseCellType").register("pivotTable",g),d("Workbook").register("pivotTable",b)})(n),function(n){var t=l._getFeatureManager("Worksheet")._features.filter(function(n){return"pivotTable"===n.name});if(!t.length)return;var e=t[0],r=n.spread.B().E;e.setHost.call(r,r._canvas)}(n)};var r=e(3),i=e(2127),o=e(2135),a=e(2252),c=r.sheets.Core,u=c.Spread.Sheets.Style,l=c.Spread.Sheets,s=l.GC$,f=l.HookNames,v=r.sheets.range.isCellInRange,d=l._getFeatureManager;var p=function(n){var t=n.sheet,e=n.row,r=n.column,i=t.OC(e,r,"pivotTableStyle",void 0,!0);if(i){var o=n.sheet,a=n.info,c=n.currentStyle;n.changed=!0;var l=new u;for(var s in a&&l._compose(a,!1,1),c&&l._compose(c,!1,1),i){var f=i[s];switch(s){case"bold":var v=l.font;if(v&&-1===v.indexOf("bold "))l.font="bold "+v;else if(!v){var d=o.TC(3).font;l.font="bold "+d}break;case"formatter":!l.formatter&&!l._autoFormatter&&(l[s]=f);break;case"foreColor":case"backColor":case"borderTop":case"borderRight":case"borderBottom":case"borderLeft":!l[s]&&(l[s]=f)}}n.info=l}}},2580:function(n,t,e){"use strict";var r=e(2581),i=e(2584),o=e(2588);e.d(t,"a",function(){return r.a}),e.d(t,"b",function(){return i.a}),e.d(t,"c",function(){return o.a})},2581:function(n,t,e){"use strict";var r,i=e(0),o=e.n(i),a=e(3),c=e(1),u=e.n(c),l=e(31),s=e.n(l),f=e(2582),v=(e.n(f),e(195)),d=e.n(v),p=e(2135),g=e(2127),b=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),h=a.sheets,I=h.track,m=h.range,w=h.spread,C=m.RangeInput,x=w.setSpreadFocus,A=function(n){function t(t){var e=n.call(this,t)||this;return e.show=function(n){var t=e.props.A,r=n?Object(g.w)(t.spread.gcSpread.B(),n):"";e.setState({open:!0,sourceRangeStr:r}),e._setSpreadFocus(!1)},e.headTpl=function(){return u.a.createElement("div",null,o()("创建数据透视表"),u.a.createElement("span",{className:"hicon icon-close  sm-icon-shortcut-close pcd-close",onClick:e._onClose}))},e.bodyTpl=function(){var n=e.state,t=n.sourceRangeStr,r=n.newLocationSheet,i=n.sourceError,a=n.locationError,c=n.locationRangeStr,l=e.props.A;return u.a.createElement("div",{className:"pcd-body"},u.a.createElement("div",{className:"source-range-selector"},u.a.createElement("div",{className:"range-selector-title"},o()("请选择要分析的数据")),u.a.createElement("div",{className:"range-selector-content"},u.a.createElement("div",{className:"choice-tip"},u.a.createElement("input",{type:"radio",id:"source-range-radio",defaultChecked:!0}),u.a.createElement("label",{htmlFor:"source-range-radio"},o()("选择一个表或区域"))),u.a.createElement(C,{key:"source-range-input",A:l,textValue:t,className:"source-range-input",invalid:!!i,acceptCell:!1,use$A$1:!0,singleRange:!0,disabled:!1,resetRangeOnQuitSelect:!1,onStartSelect:e._onStartSelectRange,onQuitSelect:e._onQuitSelectRange,onChange:e._onSourceRangeChange}))),u.a.createElement("div",{className:"separate-line"}),u.a.createElement("div",{className:"location-range-selector"},u.a.createElement("div",{className:"range-selector-title"},o()("请选择要放置数据透视表的位置")),u.a.createElement("div",{className:"range-selector-content"},u.a.createElement("div",{className:"choice-tip",key:"choice-new-sheet"},u.a.createElement("input",{type:"radio",id:"location-new-sheet",checked:e.state.newLocationSheet,onChange:e._onChangeLocationType.bind(e,!0)}),u.a.createElement("label",{htmlFor:"location-new-sheet"},o()("新工作表"))),u.a.createElement("div",{className:"choice-tip",key:"choice-existed-sheet"},u.a.createElement("input",{type:"radio",id:"location-existed-sheet",checked:!e.state.newLocationSheet,onChange:e._onChangeLocationType.bind(e,!1)}),u.a.createElement("label",{htmlFor:"location-existed-sheet"},o()("现有工作表"))),u.a.createElement(C,{key:"location-range-input",A:l,textValue:c,className:"location-range-input",invalid:!!a,acceptCell:!1,use$A$1:!0,singleRange:!0,disabled:r,resetRangeOnQuitSelect:!1,onStartSelect:e._onStartSelectRange,onQuitSelect:e._onQuitSelectRange,onChange:e._onLocationRangeChange}))))},e.footTpl=function(){var n=e.state,t=n.sourceError,r=n.locationError,i=t||r;return u.a.createElement("div",{className:"pcd-confirm-btn-wrapper"},u.a.createElement("div",{className:"f-1"},i?u.a.createElement("strong",null,i):null),u.a.createElement("button",{className:"sm-button sm-button-ok sm-btn-shortcut-confirm",onClick:e._onConfirm},o()("确定")))},e.close=function(){e._onClose()},e._setSpreadFocus=function(n){var t=e.props.A.spread.gcSpread,r=t.B();x(t,r,n)},e._onStartSelectRange=function(){e.setState({selectingRange:!0})},e._onQuitSelectRange=function(){e.setState({selectingRange:!1})},e._onSourceRangeChange=function(n){var t=n.textValue;e.setState({sourceRangeStr:t,sourceError:""})},e._onLocationRangeChange=function(n){var t=n.textValue;e.setState({locationRangeStr:t,locationError:""})},e._onChangeLocationType=function(n){e.setState({newLocationSheet:n,locationError:""})},e._onClose=function(){e.setState({open:!1,sourceError:"",locationError:"",newLocationSheet:!0,locationRangeStr:""}),e._setSpreadFocus(!0)},e._onConfirm=function(){var n,t=e.state,r=t.locationRangeStr,i=t.newLocationSheet,a=e.state.sourceRangeStr,c=e.props.A.spread.gcSpread.B(),u=null;if(i)n=c;else{if(!r)return e.setState({locationError:o()("目标区域无效")});var l=Object(g.s)(c,r);if(!l)return e.setState({locationError:o()("请输入一个有效范围")});n=l.E;var s=l.range;if(s.row>=n.G()||s.col>=n.H())return e.setState({locationError:o()("目标区域不能超出当前表格范围")});u={row:s.row,col:s.col};var f=Object(g.i)(n,u),v=f.hasContent,d=f.error;if(v)return e.setState({locationError:d})}var b=u||{row:0,col:0},h=b.row,m=b.col,w=Object(g.t)(a,c,h,m),C=w.error,x=w.rangeString,A=w.sourceGcSheet;if(C)return e.setState({sourceError:C});a=x,p.e.createPivotTable(A,a,i,n,u),e.close(),I(2,i?"9002":"9003")},e.state={open:!1,selectingRange:!1,sourceRangeStr:"",sourceError:"",newLocationSheet:!0,locationRangeStr:"",locationError:""},e}return b(t,n),t.prototype.render=function(){var n=this.state,t=n.open,e=n.selectingRange,r=s()("pivot-create-dialog",{hidden:e});return u.a.createElement(d.a,{customClass:r,hasActions:!1,keepCenter:!0,enableCloseClickMask:!1,open:t,onClose:this._onClose,headTpl:this.headTpl,bodyTpl:this.bodyTpl,footTpl:this.footTpl,A:this.props.A})},t}(u.a.Component);t.a=A},2582:function(n,t,e){var r=e(2583);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1854)(r,i);r.locals&&(n.exports=r.locals)},2583:function(n,t,e){var r=e(1857);(n.exports=e(1853)(!1)).push([n.i,".sm-sheet-plugin-container .pivot-create-dialog {\n  width: 420px; }\n  .sm-sheet-plugin-container .pivot-create-dialog.hidden {\n    display: none; }\n  .sm-sheet-plugin-container .pivot-create-dialog .sm-dialog {\n    width: 420px; }\n  .sm-sheet-plugin-container .pivot-create-dialog .sm-dialog-head {\n    font-size: 16px;\n    color: #333;\n    padding-bottom: 22px; }\n  .sm-sheet-plugin-container .pivot-create-dialog .pcd-close {\n    position: absolute;\n    right: 35px;\n    padding: 5px;\n    font-size: 12px;\n    top: 25px;\n    cursor: pointer; }\n  .sm-sheet-plugin-container .pivot-create-dialog .pcd-body {\n    width: 360px;\n    font-size: 12px;\n    color: #333;\n    margin-left: 40px; }\n    .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .range-selector-title {\n      display: inline-block;\n      line-height: 20px;\n      font-size: 12px;\n      font-weight: 500; }\n    .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .range-selector-content {\n      margin-left: 20px; }\n      .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .range-selector-content .sm-range-input_disabled input {\n        background-color: #f5f5f5;\n        cursor: not-allowed; }\n    .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .separate-line {\n      height: 1px;\n      width: 320px;\n      background: #e5e5e5;\n      margin-top: 20px;\n      margin-bottom: 16px; }\n    .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .choice-tip {\n      height: 14px;\n      line-height: 14px;\n      margin-top: 12px; }\n      .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .choice-tip input[type='radio'] {\n        display: none; }\n      .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .choice-tip input[type='radio'] + label:before {\n        display: inline-block;\n        content: '';\n        background-image: url("+r(e(1862))+");\n        background-size: 100%;\n        margin: -4px 8px 0 0;\n        width: 14px;\n        height: 14px;\n        vertical-align: middle; }\n      .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .choice-tip input[type='radio']:checked + label:before {\n        background-image: url("+r(e(1863))+"); }\n    .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .sm-range-input {\n      width: 300px;\n      margin-top: 8px;\n      margin-left: 20px; }\n      .sm-sheet-plugin-container .pivot-create-dialog .pcd-body .sm-range-input input.sm-range-input-main {\n        height: 34px; }\n  .sm-sheet-plugin-container .pivot-create-dialog .sm-dialog-foot {\n    padding-top: 30px;\n    height: auto; }\n  .sm-sheet-plugin-container .pivot-create-dialog .pcd-confirm-btn-wrapper {\n    display: flex;\n    align-items: center; }\n    .sm-sheet-plugin-container .pivot-create-dialog .pcd-confirm-btn-wrapper strong {\n      font-size: 12px;\n      font-weight: normal;\n      color: #cd4747; }\n    .sm-sheet-plugin-container .pivot-create-dialog .pcd-confirm-btn-wrapper .f-1 {\n      flex: 1;\n      margin-right: 5px; }\n",""])},2584:function(n,t,e){"use strict";var r,i,o=e(0),a=e.n(o),c=e(1),u=e.n(c),l=e(62),s=e.n(l),f=e(3),v=e(2135),d=e(2177),p=e(2251),g=e(2115),b=e(2585),h=e(2586),I=(e.n(h),this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)})),m=f.sheets.track;!function(n){n.all="all",n.none="none",n.part="part"}(i||(i={}));var w=function(n){function t(t){var e=n.call(this,t)||this;return e.updateAfterPivotTableChanged=function(n){if(e.state.show&&n){var t=e.A.spread.gcSpread.B(),r=v.e.getPivotTable(t,n.pivotTableId).getDefinition(),i=r[e.options.fieldKey];i&&i.find(function(n){return n.index===e.options.fieldIndex})?(e.options.definition=r,e.forceUpdate()):e.hideDialog()}},e.resetSortInfo=function(n){var t=n.sort,r=n.sortBy,i=n.ineffectiveSort;e.updatePivotTable({sort:t,sortBy:r,ineffectiveSort:i})},e.A=t.A,e.debounceSearch=s()(e.search,300),e.state={show:!1,fieldData:[],checkType:i.all,excludeValues:[],searchVal:"",pos:{left:0,top:0}},e.options={definition:{pageFields:[]},fieldData:[],pivotTableKey:"",cell:null},e}return I(t,n),t.prototype.componentDidMount=function(){v.e.on(d.a.OpenPivotFilterDialog,this.showDialog.bind(this)),v.e.on(d.a.PivotDefinitionChanged,this.updateAfterPivotTableChanged.bind(this))},t.prototype.componentWillUnmount=function(){v.e.off(d.a.OpenPivotFilterDialog,this.showDialog.bind(this)),v.e.off(d.a.PivotDefinitionChanged,this.updateAfterPivotTableChanged.bind(this))},t.prototype.render=function(){var n=this,t=this.state,e=t.show,r=t.fieldData,i=t.checkType,o=t.pos,c=t.excludeValues,l=t.searchVal,s=this.options,f=s.definition,v=s.fieldIndex,d=s.pivotTableKey,g=s.fieldKey,h=!!f.pageFields.find(function(n){return n.index===v}),I=this.A.spread.B().E;return u.a.createElement("div",{className:"pivot-filter-dialog-wrapper"},e?u.a.createElement("div",{className:"pivot-filter-overlay",onClick:function(){return n.hideDialog()}}):null,u.a.createElement("div",{ref:"pivotFilterDialog",className:"pivot-filter-dialog"+(e?"":" hide"),style:o},!h&&e&&u.a.createElement(b.a,{pivotTableKey:d,fieldIndex:v,definition:f,resetSortInfo:this.resetSortInfo,A:this.A,fieldKey:g,resetDialogPosition:this.resetDialogPosition.bind(this),pos:o}),u.a.createElement("div",{className:"pivot-filter-wrapper"},u.a.createElement("div",{className:"pivot-filter-search"+(h?" no-sort":"")},u.a.createElement("input",{className:"search",type:"text",placeholder:a()("搜索"),value:l,onKeyUp:function(){return n.debounceSearch()},onChange:function(t){return n.setState({searchVal:t.target.value})}})),u.a.createElement("div",{className:"pivot-filter-selectAll"},u.a.createElement("a",{className:"pivot-filter-check-wrapper",onClick:function(){return n.toggleAllCheck()}},u.a.createElement("span",{className:"pivot-filter-check "+i}),u.a.createElement("span",{className:"pivot-filter-check-text"},a()("全选"))))),u.a.createElement("div",{className:"pivot-filter-wrapper pivot-filter-items"},u.a.createElement("div",{className:"pivot-filter-item-container"},r.map(function(t,e){var r=!c.includes(t.value);return u.a.createElement("label",{key:e,className:"pivot-filter-item"},u.a.createElement("span",{className:"pivot-filter-item-count"},t.count),u.a.createElement("input",{type:"checkbox",value:e,className:"pivot-filter-item-input",checked:r,onChange:function(t){return n.onItemsCheckChange(t)}}),u.a.createElement("span",{className:"pivot-filter-item-text"},""===t.value?a()("（空白）"):t.value))}))),u.a.createElement("div",{className:"pivot-filter-wrapper pivot-filter-confirm"},u.a.createElement("a",{className:"filter-btn-clear"+(Object(p.e)(I,d,v,c)?"":" disabled"),onClick:function(){return n.clearFilters()}},a()("清除筛选")),u.a.createElement("button",{className:"filter-btn-confirm",onClick:function(){return n.resetFilters()}},a()("确定")))))},t.prototype.hideDialog=function(){this.setState({show:!1})},t.prototype.resetDialogPosition=function(){var n=this.state.pos,t=n.left,e=n.top,r=window.innerWidth,i=window.innerHeight,o=this.refs.pivotFilterDialog,a=o.offsetWidth,c=o.offsetHeight;if(t+a>r||e+c>i){var u={left:Math.min(t,r-a),top:Math.min(e,i-c)};this.setState({pos:u})}},t.prototype.toggleAllCheck=function(){var n=this.state.checkType===i.none?i.all:i.none,t=this.A.spread.gcSpread.B(),e=v.e.getPivotTable(t,this.options.pivotTableKey).getSourceData();this.setState({checkType:n,excludeValues:n===i.all?[]:Object(p.c)(e,this.options.fieldIndex)})},t.prototype.onItemsCheckChange=function(n){var t=this.state,e=t.fieldData,r=t.excludeValues,i=e[n.target.value],o=r.findIndex(function(n){return n===i.value});o>-1?r.splice(o,1):r.push(i.value),this.setState({excludeValues:r,checkType:this.getCheckType(this.options.fieldData,r)})},t.prototype.showDialog=function(n){var t=this,e=n.left,r=n.top,i=n.index,o=n.sort,a=n.excludeValues,c=n.pivotTableKey,u=n.fieldKey,l=n.row,s=n.col,f=this.A.spread.gcSpread.B();if(f){var d=v.e.getPivotTable(f,c),g=d.getSourceData(),b=d.getDefinition(),h=Object(p.d)(g,i,o);this.options={definition:b,pivotTableKey:c,fieldIndex:i,fieldData:h,fieldKey:u,cell:{row:l,col:s}},this.setState({show:!0,searchVal:"",fieldData:h,excludeValues:a.slice(),pos:{left:e,top:r},checkType:this.getCheckType(h,a)},function(){t.resetDialogPosition()}),m(2,"pageFields"===u?"9008":"9005")}},t.prototype.getCheckType=function(n,t){return n.every(function(n){return t.includes(n.value)})?i.none:n.every(function(n){return!t.includes(n.value)})?i.all:i.part},t.prototype.search=function(){var n=this,t=this.state.searchVal?this.options.fieldData.filter(function(t){return t.value.indexOf(n.state.searchVal)>-1}):this.options.fieldData;this.setState({fieldData:t})},t.prototype.clearFilters=function(){var n=this;this.state.excludeValues.length&&this.setState({excludeValues:[],checkType:i.all},function(){n.updatePivotTable()})},t.prototype.resetFilters=function(){this.updatePivotTable()},t.prototype.updatePivotTable=function(n){var t,e=this.options,r=e.pivotTableKey,i=e.definition,o=e.fieldKey,a=e.fieldIndex,c=i[o].find(function(n){return n.index===a});if(c){n?(Object.assign(c,n),null===c.sortBy&&delete c.sortBy,t=g.d.sortChange):(c.filter.excludeValues=this.state.excludeValues,t=o===g.c.PageField?g.d.pageFieldChange:g.d.rowColFilterChange);var u=this.A.spread.gcSpread.B();v.e.updatePivotTable(u,r,i,t,!0),this.hideDialog(),this.A.spread.gcSpread.focus(!0)}},t}(u.a.Component);t.a=w},2585:function(n,t,e){"use strict";var r,i=e(0),o=e.n(i),a=e(1),c=e.n(a),u=e(6),l=e.n(u),s=e(483),f=(e.n(s),e(484)),v=e.n(f),d=e(90),p=e.n(d),g=e(43),b=e.n(g),h=e(3),I=e(2135),m=e(2175),w=e(2115),C=e(2127),x=e(2176),A=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),j=this&&this.__assign||function(){return(j=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},M=h.sheets.track,y=function(n){function t(t){var e=n.call(this,t)||this;return e.isSortInfoAllSelected=!1,e.updateSortBy=function(n){var t=e.state.field.sortBy;if(!n||b()(n.pos,e.props.pos)){var r=(n||e.props).definition[e.state.oppositeFieldKey];if(t&&r.length!==t.length-1&&t[t.length-1].valueStr!==o()("总计")){var i={index:r[t.length-1].index,valueStr:o()("总计")};t.push(i),e.isSortInfoAllSelected=!0,e.setState({field:Object.assign(e.state.field,{sortBy:t})})}}},e.renderSortDataFields=function(n){var t=e.state.field,r=e.props.definition,i=r.dataFields,o=r.pivotFields,a=t.ineffectiveSort?null:t.sortBy,u=i.map(function(n){return{value:Object(x.d)(o,n)}});u.unshift({value:n});var l=a&&a[0];return c.a.createElement(v.a,{style:{maxHeight:Math.min(window.innerHeight,305)+"px"}},u.map(function(n,t){return c.a.createElement(v.a.Item,{onClick:function(){return e.changeSortDataField(t)},key:t},c.a.createElement("span",null,n.value),(!a&&0===t||l===t-1)&&c.a.createElement("span",{className:"sort-field-selected"}))}))},e.changeSortDataField=function(n){var t=e.state.field.sortBy;if(!t||n-1!==t[0]){var r,i=e.props.definition[e.state.oppositeFieldKey][0];if(0===n)r=null;else if(i){var o=O(e.props.definition,i.index).fieldName,a=i.name||o;r=[n-1,{index:i.index,valueStr:a}]}else r=[n-1];e.isSortInfoAllSelected=!(n>0&&Boolean(i)),e.isSortInfoAllSelected&&(e.sortBy=p()(r)),e.setState({field:Object.assign(e.state.field,{sortBy:r,ineffectiveSort:!1})},function(){if(r&&r.length>1){var n=l.a.findDOMNode(e.refs.sortBy_0);n&&n.click(),e.props.resetDialogPosition()}})}},e.renderSortRowOrColFields=function(n){var t=e.A.spread.gcSpread.B(),r=I.e.getPivotTable(t,e.props.pivotTableKey).getSourceData(),i=e.state.field.sortBy,a=e.props.definition[e.state.oppositeFieldKey],u=i.filter(function(n,t){return t>0}).slice(0,n),l=r.filter(function(n){return!u.length||u.some(function(t){var e=t.valueStr,r=t.index;return e===Object(C.h)(n[r].value,n[r].formatter)})}),s=Object(m.b)(l,a[n].index),f=O(e.props.definition,a[n].index),d=f.name,p=f.fieldName,g=[d||p,o()("总计")];s.length&&s.unshift.apply(s,g);var b=i[n+1];return c.a.createElement(v.a,{style:{maxHeight:Math.min(window.innerHeight,305)+"px"}},s.map(function(t,r){return c.a.createElement(v.a.Item,{className:0===r?"pivot-sort-dropdown-disabled":"",disabled:0===r,onClick:function(){return e.changeSortRowOrColFieldItems(n,t,r)},key:r},c.a.createElement("span",null,""===t?o()("（空白）"):t),r>0&&b.valueStr===t&&c.a.createElement("span",{className:"sort-field-selected"}))}))},e.changeSortRowOrColFieldItems=function(n,t,r){var i=e.state.field.sortBy;if(t!==i[n+1].valueStr){var a=e.props.definition.pivotFields,c=e.props.definition[e.state.oppositeFieldKey],u=i.slice(0,n+1);e.sortBy=p()(u);var s={index:c[n].index,valueStr:t};u.push(s);var f=c[n+1],v=1===r&&t===o()("总计");if(!v&&e.sortBy.push(s),f&&!v){var d=f.name||a[f.index].name,g={index:f.index,valueStr:d};u.push(g),e.sortBy.push(g)}e.isSortInfoAllSelected=!Boolean(f)||v,e.setState({field:Object.assign(e.state.field,{sortBy:u})},function(){if(f&&!v){var t=l.a.findDOMNode(e.refs["sortBy_"+(n+1)]);t&&t.click(),e.props.resetDialogPosition()}})}},e.sort=function(n){var t={sort:n,ineffectiveSort:!1};e.isSortInfoAllSelected&&Object.assign(t,{sortBy:e.sortBy}),e.props.resetSortInfo(t),M(2,n===w.b.ascending?"9006":"9007")},e.A=t.A,e.state={field:O(t.definition,t.fieldIndex),oppositeFieldKey:t.fieldKey===w.c.RowField?w.c.ColField:w.c.RowField},e.sortBy=p()(e.state.field.sortBy),e}return A(t,n),t.prototype.componentWillReceiveProps=function(n){var t=this.state,e=t.oppositeFieldKey,r=t.field.sortBy,i=this.props.definition[e].map(function(n){return n.index}),o=n.definition[e].map(function(n){return n.index}),a=!1;if(JSON.stringify(i)!==JSON.stringify(o)&&(a=!0),r){var c=this.props.definition.dataFields[r[0]],u=n.definition.dataFields[r[0]];u&&u.index===c.index||(a=!0)}a&&(this.setState({field:O(n.definition,n.fieldIndex)}),this.sortBy=p()(this.state.field.sortBy)),!a&&this.updateSortBy(n)},t.prototype.componentDidMount=function(){this.updateSortBy()},t.prototype.render=function(){var n=this,t=this.state.field,e=this.props.definition,r=e.pivotFields,i=e.dataFields,a=t.fieldName,u=t.sortBy,l=t.ineffectiveSort,f=t.name||a,v=u&&u.filter(function(n,t){return t>0});return c.a.createElement("div",null,c.a.createElement("div",{className:"pivot-filter-wrapper pivot-filter-sort"},c.a.createElement("a",{className:"pivot-filter-sort-asc",onClick:function(){return n.sort(w.b.ascending)}},c.a.createElement("span",{className:"pivot-filter-sort-icon"}),c.a.createElement("span",{className:"pivot-filter-sort-label"},o()("升序"))),c.a.createElement("a",{className:"pivot-filter-sort-desc",onClick:function(){return n.sort(w.b.descending)}},c.a.createElement("span",{className:"pivot-filter-sort-icon"}),c.a.createElement("span",{className:"pivot-filter-sort-label"},o()("降序")))),c.a.createElement("div",{className:"pivot-filter-wrapper pivot-filter-sort-gist"},c.a.createElement("span",null,o()("排序依据")),c.a.createElement(s.Button,{mask:!0,getPopupContainer:function(){return document.body},overlay:this.renderSortDataFields(f),className:"sort-type-selector"},c.a.createElement("span",null,u&&!l?Object(x.d)(r,i[u[0]]):f))),v&&!l&&v.map(function(t,e){return c.a.createElement("div",{key:e+"_pivot-filter-wrapper",className:"pivot-filter-wrapper pivot-filter-sort-list"},c.a.createElement(s.Button,{ref:"sortBy_"+e,mask:!0,getPopupContainer:function(){return document.body},overlay:n.renderSortRowOrColFields(e),className:"sort-type-selector sort-child-list"},c.a.createElement("span",null,""===t.valueStr?o()("（空白）"):t.valueStr)))}))},t}(c.a.Component);function O(n,t){var e=n.rowFields,r=n.colFields,i=n.pivotFields,o=e.find(function(n){return t===n.index});o||(o=r.find(function(n){return t===n.index}));var a=i[t].name;return o&&o.ineffectiveSort&&delete o.sortBy,j(j({},o),{fieldName:a})}t.a=y},2586:function(n,t,e){var r=e(2587);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1854)(r,i);r.locals&&(n.exports=r.locals)},2587:function(n,t,e){var r=e(1857);(n.exports=e(1853)(!1)).push([n.i,".pivot-filter-dialog {\n  font-size: 12px;\n  border: 1px solid #eee;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.1);\n  border-radius: 1px;\n  background: #fafafa;\n  position: fixed;\n  padding: 20px 0;\n  margin: 0px;\n  width: 250px;\n  height: auto;\n  z-index: 11;\n  outline: none;\n  display: block; }\n  .pivot-filter-dialog.hide {\n    display: none; }\n  .pivot-filter-dialog .pivot-filter-search {\n    padding: 5px 0 0; }\n    .pivot-filter-dialog .pivot-filter-search.no-sort {\n      padding: 0; }\n    .pivot-filter-dialog .pivot-filter-search .search {\n      display: block;\n      width: 100%;\n      height: 28px;\n      padding: 6px 12px;\n      font-size: 12px;\n      color: #333;\n      border-radius: 2px;\n      box-sizing: border-box;\n      background-color: #ffffff;\n      background-image: none;\n      border: 1px solid #e5e5e5;\n      box-shadow: 0px 1px 3px 0px #efefef inset;\n      margin: 0 0 8px 0;\n      -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\n      transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; }\n      .pivot-filter-dialog .pivot-filter-search .search:focus {\n        outline: 0;\n        border-color: #a6a6a6 !important;\n        color: #333; }\n      .pivot-filter-dialog .pivot-filter-search .search:hover {\n        border-color: #ccc; }\n\n.pivot-filter-overlay {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  margin: 0px;\n  padding: 0px;\n  top: 0px;\n  left: 0px;\n  border: none;\n  background-color: rgba(0, 0, 0, 0); }\n\n.filter-btn-clear {\n  color: #6290cc;\n  font-size: 12px;\n  cursor: pointer; }\n  .filter-btn-clear.disabled {\n    color: #aaa;\n    cursor: default; }\n\n.filter-btn-confirm {\n  background: #41464b;\n  color: #fff;\n  float: right;\n  cursor: pointer;\n  box-shadow: none;\n  box-sizing: content-box;\n  outline: none;\n  width: 78px;\n  height: 26px;\n  line-height: 26px;\n  text-align: center;\n  border-radius: 2px;\n  border: 1px solid #2c3033; }\n  .filter-btn-confirm:hover {\n    background-color: #313438;\n    border-color: #313438;\n    border-radius: 2px; }\n\n.pivot-filter-wrapper {\n  min-height: 28px;\n  line-height: 28px;\n  padding: 0 20px;\n  margin-bottom: 8px;\n  outline: none; }\n  .pivot-filter-wrapper.pivot-filter-confirm {\n    margin-bottom: 0; }\n  .pivot-filter-wrapper.pivot-filter-items {\n    margin-bottom: 16px; }\n  .pivot-filter-wrapper .sort-type-selector {\n    font-size: 12px;\n    color: #333333;\n    width: 150px;\n    height: 28px;\n    border-radius: 2px;\n    border: solid 1px #e5e5e5;\n    background-color: #ffffff;\n    float: right;\n    text-align: left;\n    user-select: none;\n    cursor: pointer; }\n    .pivot-filter-wrapper .sort-type-selector.sort-child-list {\n      margin-bottom: 8px; }\n    .pivot-filter-wrapper .sort-type-selector span {\n      width: 100px;\n      height: 30px;\n      line-height: 30px;\n      display: inline-block;\n      margin-left: 10px;\n      text-overflow: ellipsis;\n      overflow: hidden; }\n    .pivot-filter-wrapper .sort-type-selector:after {\n      content: ' ';\n      vertical-align: middle;\n      width: 8px;\n      right: 11px;\n      float: right;\n      top: 11px;\n      position: relative;\n      height: 5px;\n      background: url("+r(e(1932))+") no-repeat;\n      background-size: 8px 5px; }\n  .pivot-filter-wrapper.pivot-filter-sort-gist {\n    margin-top: 13px;\n    display: flex;\n    justify-content: space-between; }\n    .pivot-filter-wrapper.pivot-filter-sort-gist > span {\n      white-space: nowrap; }\n  .pivot-filter-wrapper.pivot-filter-sort-list, .pivot-filter-wrapper.pivot-filter-sort-gist {\n    height: 30px;\n    line-height: 30px; }\n\n.pivot-filter-item-container {\n  border: 1px solid #e5e5e5;\n  background: #fff;\n  border-radius: 1px;\n  margin: 0 0px 8px 0;\n  overflow-x: hidden;\n  overflow-y: auto;\n  height: 180px;\n  box-sizing: border-box;\n  padding: 5px 0; }\n  .pivot-filter-item-container .pivot-filter-item:hover {\n    background: #f5f5f5; }\n\n.pivot-filter-item-container .pivot-filter-item {\n  position: relative;\n  cursor: default;\n  font-weight: normal;\n  border-style: solid;\n  border-color: transparent;\n  display: block;\n  padding: 0 8px;\n  border: 0;\n  overflow: hidden;\n  margin-bottom: 0;\n  height: 24px;\n  line-height: 24px;\n  user-select: none; }\n  .pivot-filter-item-container .pivot-filter-item .pivot-filter-item-count {\n    float: right;\n    color: #999; }\n  .pivot-filter-item-container .pivot-filter-item input {\n    margin-right: 5px;\n    margin-top: 5px;\n    display: none;\n    color: #333;\n    float: left;\n    box-sizing: border-box;\n    padding: 0;\n    clear: left;\n    border-radius: 1px;\n    box-shadow: inset 0 1px 3px 0 #e5e5e5;\n    border: solid 1px #e5e5e5;\n    background-color: #ffffff; }\n  .pivot-filter-item-container .pivot-filter-item .pivot-filter-item-text {\n    font-family: Lucida Grande, Lucida Sans, Arial, sans-serif;\n    font-size: 12px;\n    white-space: nowrap;\n    word-wrap: normal;\n    float: left;\n    max-width: 80%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    margin: 0; }\n  .pivot-filter-item-container .pivot-filter-item input[type='checkbox'] + span::before {\n    display: inline-block;\n    content: '';\n    background-image: url("+r(e(1859))+");\n    background-size: 100%;\n    margin: -3px 8px 0 0;\n    width: 14px;\n    height: 14px;\n    vertical-align: middle; }\n  .pivot-filter-item-container .pivot-filter-item input[type='checkbox']:checked + span::before {\n    background-image: url("+r(e(1860))+'); }\n\n.pivot-filter-selectAll {\n  user-select: none;\n  margin-bottom: -2px; }\n  .pivot-filter-selectAll .pivot-filter-check-wrapper {\n    cursor: pointer; }\n    .pivot-filter-selectAll .pivot-filter-check-wrapper .pivot-filter-check {\n      display: inline-block;\n      margin: -3px 5px 0 0;\n      background-repeat: no-repeat;\n      background-size: 12px 13px;\n      width: 16px;\n      height: 16px;\n      position: relative;\n      top: 5px; }\n      .pivot-filter-selectAll .pivot-filter-check-wrapper .pivot-filter-check.all {\n        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAaCAYAAACtv5zzAAAENElEQVRIS5VW32ubVRh+zvk2oTNCF9v8km03Mlb8Aza9G13TZmlXeyHo0qZ1iheCsIEgiMxaZG1N6oaKoEzB/0FRxGvZ/H2ztibtLhw2abrVlM0lLck58r7nOydf0nixD8KX8+V8z/O8z3l/RNRqNQ3/+uvOHdy7t22Xj3zXGujrC+PokSPuXUEEP964ietffIVqtfrIoN1e6O3txauvTOO5Uychfv7lVz07dwVKKUjpwfOEece/dWUkqR2XfaSU9rEkZi+/DXHpzbf06moBhw714PFQCEIIgy32M+gO4LY1/SYE6Nm/Dx7g4cMaBgZOQEy8cF7XazX0R/o4AsJlig6CIFjreyASrUEr4tFaYatyFz09PRCp0QneFY1FIRldmCgCAVjA4H1/NNZZDaWBymbFOG0J4vEYhJQ+sCGhqw3cqlQKpJcd862ZGB/DjZs/oUzAWqFc7iRIxCElgdoIjJ+ORJMyAlXQdJD+d/o9mzmPM4OnUd3ZwWLuQ5TKmyiXy2y1GEk/zyiJpxK+NS31neCUaVopzhJFRFpjejKD5NAgC6nX61i69jGKa+v7CeKJeBsBWRSMgEHp02w6AgIfTp5x4PmrHzE4vesiGE6PcwTxuCEwNrUKgUjIFgJvNlsE09kMRpJDDjy3dA1r67ddkrQTKI1YIs6biYDSVammn3ItAkUEqomZ7FSb8sX8VRTX1uB5njvDFkHqHOdGNBZjgmPHjuLiG6/j8+tfYmX1T7bJeG/uM6R8OOmUL+SWUCyuQ3oSnvRcBKVSyRxykgi0QjQaxeFwL67MzSIUCmF3dxcU9q2VFSYhgpenJ9vA5z/IMzgpl1IyiV+mKJXKxuihkTEmiEQjDDKVeQmpEaOQSOYX87i1vIwLM9Puea1ex8JiHgWyhfuXxzXkScnVTFdpo9QioJSLRPrZAtoxlXkR6bMpR/Lb73/g2VMnee3Ai8ZztsY74BLEtArdhaDfEFA0lC0z2UmMpg2JvQx4DgVriw9O9pguI41IABt/b5i0txb1+xGQTc0mZRCRTGFs9KxTPr+Q4zwPKmfv/Q5AG01aByKwhxyJRAIREIHZSCSDg6edcmMJ+X7AHKykype8lxQHI+BDHk6d09RXqJtai7gdGDNZfSwaQ+XuFh+o9TwIbi0MVj5ZZAjS45psicWjfs4bYNtruPiEhOACJMV+SvrKGSTQ223kjiB74TW9ubmJJ8NhHHzsoBsYlE1mhJjZQDZYO+y9E9yewd7eHrYqW+yK+OTTz/TX33zLoYeeCJlqDMwBG74ZQq1PEDw4OxrNBu7v3OdEoQQR1WpVX37vfRQKa75igEZS51jnFug3Qn9qG4+7zG56fvz405h79x3w35ZGo4Hvvv8Byyur2N7+x41LmxnBWggCdoJTToTDh/HMwAmeEVzh9o9X96HeVmdO7f+pbt9tVv8Bbua0eaIHvIAAAAAASUVORK5CYII="); }\n      .pivot-filter-selectAll .pivot-filter-check-wrapper .pivot-filter-check.part {\n        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAaCAYAAACtv5zzAAACc0lEQVRIS7WWz08TQRTHv1O7oYc2bVNr1EBbbwqCR9Nw0gMHPXnw4kUjKv6o4kFPRhMSb1xIkAQNGP1jCMaTAW242V2IGhfTNpa0ZOuOeTM7y7K0lKXlJXvY7e738+a975spq9frHEcYjAC/TRPvFj+gWFxDtVrtChePxzE4eBb3xm/hRDoNphsGfzz5DLWtra6E/R9Ho1HMzkyDvXg1xZc/fUZfpA/JZAJaOAyAgQXEyTpzWM0myuUKthvbyOcvgl27foNTWU6dPgntWBhgDIyuQwA45wDnsP418fPHL1C52OWxqwKeyQxIYecKqC/z59y9DGNdPHMB2WxGiIdClHvQ/FU6HLYtIbpu7AUocQJ5w3/vylFJPCFKBAlxAZfGroi3zuRyPS3R91JJrqAVQCXlzVxmtxPtflN9aAkQROUgt0yOAX3zvlNFp5zUYKfRpNMWEGIMhYcTuDAyHMhIK6tfMTs3D9tZ6R5ALpsV3mGhEBbm3wQSVy/fuV8At22xkpKu7+4BAVSJFt/OHQowPvFIWJRiX8Bk4QFGhs8HgnxZWRUlOhBA+Vnampq3u9GqwWJDEZMv1i4MciAAiVIIaQci72W4Y+iIuztXJ4Bqsut5x3oC1dKmjrSzJLGCdk2mSaYgm3q1/APmb4x34CjBtjZVgCMdNP9W3ZOtgg6cSrWCgf5+aJrWk/PAsiysb2wgEU+AvZx6zZeWlhGJRJBOpxAOS0i7jc373N8fum82LZjmHzQaDYyO5uWh/+Tpc/yt1QINVqeXY7GYPPTpb4u5uYmF9x/xrbiGcrnc6dt9f08mkxgaOoe7t2/ieColAV0pdvj4Px6VagUKeShVAAAAAElFTkSuQmCC"); }\n      .pivot-filter-selectAll .pivot-filter-check-wrapper .pivot-filter-check.none {\n        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAaCAYAAACtv5zzAAABdUlEQVRIS+2WTW+CQBCGZ/musYlYq5Ub//+3GLgYj96gWuuS1Mi328w0a6B+FAtNL24yByDMw/vOMrMsjmMBf7gYApIkgSAIIMsyOBwOrXCKooBhGOA4DliWBYxzLpbLJQjRrRDGGLiuC2w+n5MCJFvWA6iqCvgQ45aFH4hRliUkSUxOkALP8wRe9PuPlBxBbQCYCyG73cdXrtlsRt4MBjbdkPEbBZhcRhRxMuAIGA6fSEEXFqGC7fa9DhiNnkHTtLMWXVJT3RiyBqigKArYbN7qgPF4cqyBrMOtRZb2oIL1elUHTCYvNQD513AnSSVVwGr1eh3QNLlUiZBGgK6KfFHBHYA7CONu0ck/WO2m/2tRF930qgIJ6KxV+L4vkIjdVNf1TuZBnufUTemnXSwWYr/fU3LbtkHT9JOJdku7LoocOOeAkF6vByyKIhr6bU8T37cVWk1DH48teFwJwxDSNKVh0Wbh0DJNE6bTKR1fCNAm4U/vfgLdEL2Shj9ItQAAAABJRU5ErkJggg=="); }\n\n.pivot-filter-sort {\n  margin-bottom: 8px; }\n  .pivot-filter-sort .pivot-filter-sort-asc, .pivot-filter-sort .pivot-filter-sort-desc {\n    display: inline-block;\n    width: 98px;\n    height: 28px;\n    text-align: center;\n    line-height: 28px;\n    border: 1px solid #ccc;\n    border-radius: 2px;\n    white-space: nowrap;\n    cursor: pointer; }\n    .pivot-filter-sort .pivot-filter-sort-asc .pivot-filter-sort-icon, .pivot-filter-sort .pivot-filter-sort-desc .pivot-filter-sort-icon {\n      display: inline-block;\n      width: 30px;\n      height: 26px;\n      margin-top: -1px;\n      background-position: center;\n      background-repeat: no-repeat;\n      background-size: 100%;\n      vertical-align: middle; }\n  .pivot-filter-sort .pivot-filter-sort-asc {\n    margin-right: 10px; }\n    .pivot-filter-sort .pivot-filter-sort-asc .pivot-filter-sort-icon {\n      background-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIzMHB4IiBoZWlnaHQ9IjI2cHgiIHZpZXdCb3g9IjAgMCAzMCAyNiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT7ljYfluo88L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGRlZnM+PC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4gICAgICAgIDxnIGlkPSLljYfluo8iPiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xOCwxMCBMMTUuNDkyNjQwNywxMCBMMTguNDkyNjQwNyw3IEwyMS40OTI2NDA3LDEwIEwxOSwxMCBMMTksMjAgTDE4LDIwIEwxOCwxMCBaIiBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGw9IiM2REEwRTMiPjwvcGF0aD4gICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aCIgZmlsbD0iIzU1NTU1NSIgcG9pbnRzPSIxMCAxOS4zMzc1OTg4IDEwIDE5Ljg0OTU5ODggMTQgMTkuODQ5NTk4OCAxNCAxOS4zMzc1OTg4IDEwLjc5NTc3NDYgMTkuMzM3NTk4OCAxNCAxNS43OTE5OTg4IDE0IDE1LjI3OTk5ODggMTAgMTUuMjc5OTk4OCAxMCAxNS43OTE5OTg4IDEzLjEyNjc2MDYgMTUuNzkxOTk4OCI+PC9wb2x5Z29uPiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMS41MTk2Mzc1LDcgTDEyLjQ3MTI5OTEsNyBMMTUsMTMuODU0NCBMMTQuMDQ4MzM4NCwxMy44NTQ0IEwxMy4zNDEzODk3LDExLjc5MDQgTDEwLjYwNDIyOTYsMTEuNzkwNCBMOS44NzkxNTQwOCwxMy44NTQ0IEw5LDEzLjg1NDQgTDExLjUxOTYzNzUsNyBaIE0xMC44NzYxMzI5LDExLjAyMjQgTDEzLjA2OTQ4NjQsMTEuMDIyNCBMMTEuOTkwOTM2Niw3LjgyNTYgTDExLjk3MjgwOTcsNy44MjU2IEwxMC44NzYxMzI5LDExLjAyMjQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBzdHJva2U9IiM2REEwRTMiIHN0cm9rZS13aWR0aD0iMC4yIiBmaWxsPSIjNkRBMEUzIj48L3BhdGg+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4="); }\n  .pivot-filter-sort .pivot-filter-sort-desc .pivot-filter-sort-icon {\n    background-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIzMHB4IiBoZWlnaHQ9IjI2cHgiIHZpZXdCb3g9IjAgMCAzMCAyNiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT7pmY3luo88L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGRlZnM+PC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4gICAgICAgIDxnIGlkPSLpmY3luo8iPiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xOCwxNyBMMTgsNyBMMTksNyBMMTksMTcgTDIxLjk3NzY0MDMsMTcgTDE4LjQ5MjQ5OTgsMjAuNDg1MTQwNSBMMTUuMDA3MzU5MywxNyBMMTgsMTcgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNkRBMEUzIj48L3BhdGg+ICAgICAgICAgICAgPHBhdGggZD0iTTExLjA5OTY5NzksMTUgTDExLjg5Mjc0OTIsMTUgTDE0LDIwLjcxMiBMMTMuMjA2OTQ4NiwyMC43MTIgTDEyLjYxNzgyNDgsMTguOTkyIEwxMC4zMzY4NTgsMTguOTkyIEw5LjczMjYyODQsMjAuNzEyIEw5LDIwLjcxMiBMMTEuMDk5Njk3OSwxNSBaIE0xMC41NjM0NDQxLDE4LjM1MiBMMTIuMzkxMjM4NywxOC4zNTIgTDExLjQ5MjQ0NzEsMTUuNjg4IEwxMS40NzczNDE0LDE1LjY4OCBMMTAuNTYzNDQ0MSwxOC4zNTIgWiIgaWQ9IlBhdGgiIGZpbGw9IiM1NTU1NTUiPjwvcGF0aD4gICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aCIgc3Ryb2tlPSIjNkRBMEUzIiBzdHJva2Utd2lkdGg9IjAuMyIgZmlsbD0iIzZEQTBFMyIgcG9pbnRzPSI5IDEyLjM1MTk5ODggOSAxMi45OTE5OTg4IDE0IDEyLjk5MTk5ODggMTQgMTIuMzUxOTk4OCA5Ljk5NDcxODMxIDEyLjM1MTk5ODggMTQgNy45MTk5OTg3OCAxNCA3LjI3OTk5ODc4IDkgNy4yNzk5OTg3OCA5IDcuOTE5OTk4NzggMTIuOTA4NDUwNyA3LjkxOTk5ODc4Ij48L3BvbHlnb24+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4="); }\n\n.sort-type-selector .pivot-sort-dropdown-disabled {\n  opacity: 0.3;\n  cursor: default !important; }\n  .sort-type-selector .pivot-sort-dropdown-disabled:hover {\n    background: transparent; }\n\n.sort-type-selector .sort-field-selected {\n  background: url('+r(e(1933))+") no-repeat;\n  background-size: 10px 10px;\n  width: 10px;\n  height: 10px;\n  margin-top: 2px; }\n\n.sort-type-selector .sm-sheet-dropdown-menu .sm-sheet-dropdown-menu-item {\n  padding-right: 30px; }\n\n.sort-type-selector ul {\n  overflow-y: auto; }\n\n.sort-type-selector li {\n  height: 35px;\n  display: flex !important;\n  flex-direction: row;\n  justify-content: space-between; }\n",""])},2588:function(n,t,e){"use strict";var r,i=e(0),o=e.n(i),a=e(3),c=e(2589),u=(e.n(c),e(1)),l=e.n(u),s=e(481),f=e.n(s),v=e(162),d=e.n(v),p=e(156),g=e.n(p),b=e(19),h=e.n(b),I=e(2135),m=e(2177),w=e(2115),C=e(2174),x=e(2176),A=e(2127),j=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),M=this&&this.__assign||function(){return(M=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},y=this&&this.__rest||function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e},O=a.sheets,N=O.range,k=O.track,T=O.spread,S=O.position,D=N.RangeInput,Z=S.parsePosition,B=T.setSpreadFocus;function P(n,t,e){return{index:t,subtotal:void 0===e?n.pivotFields[t].isNumberField?w.f.SUM:w.f.COUNTA:e,showDataAs:w.e.default}}function z(n,t){return{index:t,sort:w.b.ascending,showTotal:!0,foldValues:{},filter:{excludeValues:[]}}}function R(n){for(var t=[],e=0;e<n.length;e++){var r=n[e];if(t[r])return!1;t[r]=!0}return!0}var G=function(n){function t(t){var e=n.call(this,t)||this;return e.fieldPosArr=[],e.dragY=0,e.show=function(n){var t=n.sheet,r=n.pivotTableId,i=I.e.getPivotTable(t,r),a=i.getDefinition(),c="";Object(A.l)(t,i)&&!Object(A.s)(t,a.source.sheetSource)&&(c=o()("未找到数据源")),e.setState({open:!0,sheet:t,pivotTableId:r,pivotTable:a,sheetSource:a.source.sheetSource,sourceError:c}),e.manualClosed=!1},e.close=function(n){void 0===n&&(n=!0),e.manualClosed=n,e.state.open&&(e.setState({open:!1,sourceError:""}),e._setSpreadFocus(!0))},e.manualClose=function(){e.close()},e._setSpreadFocus=function(n){var t=e.props.A.spread.gcSpread,r=t.B();B(t,r,n)},e.makePanel=function(n,t){var r=e.state.pivotTable.pivotFields,i=n.fieldGroup,o=n.iconClass,a=n.title,c=i.map(e.makePanelItem.bind(null,n));return l.a.createElement("div",{className:"panel",key:t},l.a.createElement("div",{className:"panel--hd",ref:function(n){return e.saveFieldPositionInfo(n,i)}},l.a.createElement("div",null,l.a.createElement("span",{className:"panel--icon "+o}),l.a.createElement("span",{className:"panel--title"},a)),e.makeAddBtnDropDown(i,r)),0!==i.length&&l.a.createElement("div",{className:"panel--bd"},c))},e.makePanelItem=function(n,t,r){var i=n.fieldGroup,o=n.getFieldName,a=n.makePanelItemBody,c=e.state,u=c.pivotTable.pivotFields,s=c.dragField,f=s?i.findIndex(function(n){return n===s}):null;return l.a.createElement("div",{key:r,ref:function(n){return e.saveFieldPositionInfo(n,i,t)},className:"panel--item "+(t===e.state.dragField?"panel--item__hidden":""),style:{borderTop:h()(f)||f+1!==r?"":"1px solid #e5e5e5"},onMouseDown:function(n){return e.onMouseDown(n,i,t,r)}},l.a.createElement("div",{className:"item--hd"},l.a.createElement("div",{className:"item--fieldName"},o(u,t,!0)),l.a.createElement("div",{className:"item--closeBtn",onMouseDown:function(n){return n.stopPropagation()},onClick:function(){return e.onDeleteField(i,r)}})),s!==t&&a(t))},e.makeCheckerItem=function(n){return l.a.createElement("div",{className:"item--bd"},l.a.createElement("div",{className:"item--checker"},l.a.createElement("label",{className:"checker--label",onMouseDown:function(n){return n.stopPropagation()}},l.a.createElement("input",{type:"checkbox",checked:n.showTotal,onChange:function(t){return e.onChangeShowTotal(t,n)}}),l.a.createElement("span",null,o()("显示总计")))))},e.makeDroperItem=function(n){var t=Object(C.e)(),r=Object(C.d)();return l.a.createElement("div",{className:"item--bd"},l.a.createElement("div",{className:"item--droper"},l.a.createElement("div",{className:"droper--label"},o()("汇总方式")),l.a.createElement("div",{onMouseDown:function(n){return n.stopPropagation()}},l.a.createElement(g.a,{className:"droper--dp",menuItems:Object.keys(t),selectedTpl:function(){return l.a.createElement("div",{className:"droper--select"},t[n.subtotal])},itemTpl:function(n,e){return l.a.createElement("div",{className:"droper--item droper--item__align",title:t[e]},t[e])},onMenuChange:e.onChangeSubTotal.bind(null,n),forceTap:!0}))),l.a.createElement("div",{className:"item--droper"},l.a.createElement("div",{className:"droper--label"},o()("显示方式")),l.a.createElement("div",{onMouseDown:function(n){return n.stopPropagation()}},l.a.createElement(g.a,{className:"droper--dp",menuItems:Object.keys(r).map(Number),selectedTpl:function(){return l.a.createElement("div",{className:"droper--select"},r[n.showDataAs])},itemTpl:function(n,t){return l.a.createElement("div",{className:"droper--item droper--item__align",title:r[t]},r[t])},onMenuChange:e.onChangeShowDataAs.bind(null,n),forceTap:!0}))))},e.makeAddBtnDropDown=function(n,t){return l.a.createElement(g.a,{className:"droper--dp",menuItems:e.makeAddBtnDropDownItems(n),selectedTpl:function(){return l.a.createElement("div",{className:"panel--addBtn"},o()("添加"))},itemTpl:function(n,e){return l.a.createElement("div",{className:"droper--item"+(-1===e?" disable--dropper--item":"")},-1===e?o()("没有可添加的字段"):t[e].name)},onMenuChange:e.onAddField.bind(null,n),forceTap:!0})},e.makeAddBtnDropDownItems=function(n){var t=e.state.pivotTable,r=t.rowFields,i=t.colFields,o=t.dataFields,a=t.pivotFields,c=t.pageFields,u=a.map(function(n,t){return t}),l=n===o?u:f()(u,r.concat(i).concat(c).map(function(n){return n.index}));return!l.length&&l.push(-1),l},e.saveFieldPositionInfo=function(n,t,r){n&&e.fieldPosArr.push({top:n.offsetTop,bottom:n.offsetTop+n.offsetHeight,group:t,field:r})},e.onMouseDown=function(n,t,r,i){n.stopPropagation();var o=e.state.pivotTable,a=o.colFields,c=o.rowFields,u=o.dataFields,l=o.pageFields,s=y(o,["colFields","rowFields","dataFields","pageFields"]);e.backUpPivotTable=M({colFields:a.slice(),rowFields:c.slice(),dataFields:u.slice(),pageFields:l.slice()},s),e.fieldOriginPos=[t,i],e.fieldDistPos=void 0;var f=n.currentTarget.getBoundingClientRect().top;e.dragY=-1e3;var v=e.rootDom.scrollTop;e.setState({dragField:r},function(){e.rootDom.scrollTop=v;var n=e.containerDom.getBoundingClientRect().top;e.dragY=f-n,e.forceUpdate()})},e.onMouseMove=function(n){e.state.dragField&&(e.dragY+=n,e.dragDom.style.top=e.dragY+"px",e.findAndMoveField(n))},e.onMouseUp=function(){var n=e.state.dragField;if(n)if(e.setState({dragField:null}),e.checkFieldsDuplicate())e.moveFromDataField(n);else{var t=e.transformField();t&&e.applyPivotDefinitionChange(t)}},e.moveFromDataField=function(n){var t=e.state.pivotTable,r=t.rowFields,i=t.colFields,o=t.pageFields,a=[r,i,o],c=a.every(function(n){return R(n.map(function(n){return n.index}))});if(null!=n.showDataAs&&e.fieldOriginPos&&e.fieldDistPos&&c){var u=e.backUpPivotTable.dataFields,l=e.fieldDistPos,s=l[0],f=l[1];a.forEach(function(t){if(t!==s){var e=t.findIndex(function(t){return t.index===n.index});e>-1&&t.splice(e,1)}});var v=e.makeField(s,e.state.dragField.index)[0];s[f]=v,e.setState({pivotTable:Object.assign(e.state.pivotTable,{dataFields:u})});var d=s===o?w.d.pageFieldChange:w.d.rowColDataFieldChange;e.applyPivotDefinitionChange(d)}else e.setState({pivotTable:e.backUpPivotTable})},e.findAndMoveField=d()(function(n){if(e.dragDom){if(n>0)for(var t=e.dragDom.offsetTop+e.dragDom.offsetHeight,r=e.fieldPosArr.length-1;r>=0;r--){var i=e.fieldPosArr[r],o=i.bottom,a=i.group,c=i.field;if(t>o-20){e.moveToField(a,c);break}}else if(n<0){var u=e.dragDom.offsetTop;for(r=0;r<e.fieldPosArr.length;r++){var l=e.fieldPosArr[r],s=l.top;a=l.group;if(c=l.field){if(u<s+20){e.moveToField(a,c);break}}else if(u<s){if(e.fieldPosArr[r-1]){e.moveToField(e.fieldPosArr[r-1].group,e.fieldPosArr[r-1].field);break}e.moveToField(a,c);break}}}}},60),e.moveToField=function(n,t){var r=e.state.dragField;if(r&&t!==r){var i,o=e.fieldDistPos||e.fieldOriginPos,a=o[0],c=o[1];if(a===n){if(c===(i=t?n.findIndex(function(n){return n===t}):0))return;!function(n,t,e){if(t<e){for(var r=n[t],i=t;i<e;i++)n[i]=n[i+1];n[e]=r}else if(t>e){var o=n[t];for(i=t;i>e;i--)n[i]=n[i-1];n[e]=o}}(n,c,i)}else i=t?n.findIndex(function(n){return n===t})+1:0,a.splice(c,1),n.splice(i,0,r);e.fieldDistPos=[n,i],e.setState({pivotTable:e.state.pivotTable})}},e.checkFieldsDuplicate=function(){var n=e.state.pivotTable,t=n.rowFields,r=n.colFields,i=n.pageFields;return!R(t.concat(r).concat(i).map(function(n){return n.index}))},e.transformField=function(){if(!e.fieldOriginPos||!e.fieldDistPos)return!1;var n=e.fieldOriginPos,t=n[0],r=n[1],i=e.fieldDistPos,o=i[0],a=i[1];if(t===o&&r===a)return!1;var c=e.state.pivotTable,u=c.rowFields,l=c.colFields,s=c.pageFields;if((t!==u&&t!==l||o!==u&&o!==l)&&t!==o){var f=e.makeField(o,e.state.dragField.index)[0];o[a]=f}return t===s||o===s?w.d.pageFieldChange:w.d.rowColDataFieldChange},e.makeField=function(n,t){var r=e.state.pivotTable,i=r.dataFields,o=r.colFields,a=r.rowFields;return n===i?[P(r,t),w.d.rowColDataFieldChange]:n===a||n===o?[z(0,t),w.d.rowColDataFieldChange]:[function(n,t){return{index:t,filter:{excludeValues:[]}}}(0,t),w.d.pageFieldChange]},e.onAddField=function(n,t,r,i){if(!(i<0)){var o=e.makeField(n,i),a=o[0],c=o[1];n.push(a),e.applyPivotDefinitionChange(c)}},e.onChangeShowTotal=function(n,t){t.showTotal=n.target.checked,e.applyPivotDefinitionChange(w.d.renderConfigChange)},e.onChangeShowDataAs=function(n,t,r,i){n.showDataAs!==i&&(n.showDataAs=i,e.applyPivotDefinitionChange(w.d.renderConfigChange))},e.onChangeSubTotal=function(n,t,r,i){n.subtotal!==i&&(n.subtotal=i,e.applyPivotDefinitionChange(w.d.rowColDataFieldChange))},e.onRecommendClick=function(){e.applyRecommendPivotDefinition(),k(2,"9004")},e.onStartSelectRange=function(){e.setState({open:!1})},e.onQuitSelectRange=function(){e.setState({open:!0})},e.onSourceRangeChange=function(n){var t=n.textValue,r=n.isChangeFromSelect,i=e.state.pivotTable;if(!r)return e.setState({sheetSource:t,sourceError:""});t!==i.source.sheetSource&&e.checkSourceRangeChange(t)},e.onSourceInputEnter=function(n){var t=n.textValue;t!==e.state.pivotTable.source.sheetSource&&e.checkSourceRangeChange(t)},e.onPivotDefinitionChanged=function(n){var t=n.sheet,r=n.pivotTableId;e.state.sheet&&e.state.pivotTableId&&(e.state.sheet.guid()!==t.guid()||e.state.pivotTableId!==r)||e.setState({sheet:t,pivotTableId:r,pivotTable:I.e.getPivotTable(t,r).getDefinition()})},e.checkSourceRangeChange=function(n){var t=e.props.A.spread.gcSpread.B(),r=Z(e.state.pivotTable.location),i=r.row,o=r.col,a=Object(A.t)(n,t,i,o),c=a.error,u=a.rangeString;if(c)return e.setState({sourceError:c});n=u;var l=Object(A.y)(t,e.state.pivotTable,n);e.setState({sourceError:"",sheetSource:l.source.sheetSource,pivotTable:l}),e.applyPivotDefinitionChange(w.d.sourceChange)},e.applyPivotDefinitionChange=function(n){var t=e.state.pivotTable.source;e.state.sourceError&&e.setState({sourceError:"",sheetSource:t.sheetSource}),e.forceUpdate(),e.forceUpdate(function(){return I.e.updatePivotTable(e.state.sheet,e.state.pivotTableId,e.state.pivotTable,n)})},e.applyRecommendPivotDefinition=function(){var n=e.state.pivotTable,t=n.pivotFields,r=y(n,["pivotFields"]),i=[],o=[],a=[],c=t.length;if(c){if(i.push(z(0,0)),c>=3){o.push(z(0,1));var u=c-1;a.push(P(n,u,w.f.SUM))}else a.push(P(n,1===c?0:1,1===c?w.f.COUNTA:w.f.SUM));var l=M(M({pivotFields:t},r),{rowFields:i,colFields:o,dataFields:a,pageFields:[]});e.setState({pivotTable:l}),e.applyPivotDefinitionChange(w.d.pageFieldChange)}},e.state={},e.manualClosed=!1,e}return j(t,n),t.prototype.componentDidMount=function(){I.e.on(m.a.PivotDefinitionChanged,this.onPivotDefinitionChanged)},t.prototype.componentWillUnmount=function(){I.e.off(m.a.PivotDefinitionChanged,this.onPivotDefinitionChanged)},t.prototype.render=function(){var n=this;if(!this.state.open)return null;this.fieldPosArr=[];var t=this.props.A,e=this.state,r=e.pivotTable,i=r.rowFields,a=r.colFields,c=r.dataFields,u=r.pageFields,s=r.pivotFields,f=e.dragField,v=e.sourceError,d=[{iconClass:"icon--row",title:o()("行"),getFieldName:x.f,makePanelItemBody:this.makeCheckerItem,fieldGroup:i},{iconClass:"icon--column",title:o()("列"),getFieldName:x.f,makePanelItemBody:this.makeCheckerItem,fieldGroup:a},{iconClass:"icon--value",title:o()("值"),getFieldName:x.d,makePanelItemBody:this.makeDroperItem,fieldGroup:c},{iconClass:"icon--filter",title:o()("筛选器"),getFieldName:x.e,makePanelItemBody:function(){return null},fieldGroup:u}];return l.a.createElement("div",{ref:function(t){return n.rootDom=t},className:"pivot-sidebar"},l.a.createElement("div",{className:"f-row f-m-between pivot-sidebar-title"},l.a.createElement("span",{className:"bold"},o()("数据透视表编辑器")),l.a.createElement("span",{className:"icon-close hicon",onClick:this.manualClose})),l.a.createElement("div",{className:"pivot-sidebar-content"},l.a.createElement(D,{key:"source-range-input",A:t,textValue:this.state.sheetSource,className:"rangeInput",acceptCell:!1,use$A$1:!0,singleRange:!0,disabled:!1,resetRangeOnQuitSelect:!0,onStartSelect:this.onStartSelectRange,onQuitSelect:this.onQuitSelectRange,onChange:this.onSourceRangeChange,onEnter:this.onSourceInputEnter,onBlur:this.onSourceInputEnter,onFocus:function(){n._setSpreadFocus(!1),n.state.sourceError&&n.setState({sourceError:""})}}),v?l.a.createElement("div",{className:"rangeInputError"},v):null,l.a.createElement("div",{className:"recommend",onClick:this.onRecommendClick},l.a.createElement("span",{className:"recommend--icon icon--recommend"}),l.a.createElement("span",null,o()("使用推荐的透视表"))),l.a.createElement("div",{className:"panel-container",ref:function(t){return n.containerDom=t},onMouseMove:function(t){t.stopPropagation(),n.onMouseMove(t.movementY)},onMouseUp:this.onMouseUp,onMouseLeave:this.onMouseUp},d.map(this.makePanel),f&&l.a.createElement("div",{ref:function(t){return n.dragDom=t},className:"panel--item panel--item__float",style:{top:this.dragY+"px"}},l.a.createElement("div",{className:"item--hd"},l.a.createElement("div",{className:"item--fieldName"},s[f.index].name),l.a.createElement("div",{className:"item--closeBtn"}))))))},t.prototype.onDeleteField=function(n,t){var e=this.state.pivotTable.pageFields;n.splice(t,1),this.applyPivotDefinitionChange(n===e?w.d.pageFieldChange:w.d.rowColDataFieldChange)},t}(l.a.Component);t.a=G},2589:function(n,t,e){var r=e(2590);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1854)(r,i);r.locals&&(n.exports=r.locals)},2590:function(n,t,e){var r=e(1857);(n.exports=e(1853)(!1)).push([n.i,".pivot-sidebar {\n  user-select: none;\n  box-sizing: border-box;\n  position: fixed;\n  width: 350px;\n  height: calc(100% - 55px);\n  top: 55px;\n  right: 0;\n  padding-top: 20px;\n  z-index: 10;\n  color: #333333;\n  background-color: #ffffff;\n  box-shadow: 0 1px 6px #cccccc;\n  -webkit-font-smoothing: antialiased;\n  font-size: 12px; }\n  .pivot-sidebar .pivot-sidebar-title {\n    font-size: 16px;\n    padding-bottom: 13px;\n    margin: 0 30px;\n    border-bottom: 1px solid #e5e5e5; }\n    .pivot-sidebar .pivot-sidebar-title .icon-close {\n      cursor: pointer; }\n  .pivot-sidebar .pivot-sidebar-content {\n    height: calc(100vh - 108px);\n    position: fixed;\n    box-sizing: border-box;\n    width: 350px;\n    padding: 0 30px;\n    overflow-y: auto;\n    overflow-x: hidden; }\n    .pivot-sidebar .pivot-sidebar-content::-webkit-scrollbar {\n      width: 6px;\n      background-color: transparent;\n      margin-left: -6px; }\n    .pivot-sidebar .pivot-sidebar-content::-webkit-scrollbar-thumb {\n      border-radius: 3px;\n      background-color: #d8d8d8; }\n  .pivot-sidebar .bold, .pivot-sidebar .panel--title, .pivot-sidebar .item--fieldName {\n    font-family: PingFangSC-Medium, sans-serif; }\n  .pivot-sidebar input[type='checkbox'] {\n    display: none; }\n  .pivot-sidebar input[type='checkbox'] + span::before {\n    display: inline-block;\n    content: '';\n    background-image: url("+r(e(1859))+");\n    background-size: 100%;\n    width: 14px;\n    height: 14px;\n    margin-top: -2px;\n    margin-right: 8px;\n    vertical-align: middle; }\n  .pivot-sidebar input[type='checkbox']:checked + span::before {\n    background-image: url("+r(e(1860))+"); }\n  .pivot-sidebar .icon--recommend {\n    background: url("+r(e(2591))+");\n    background-position: center; }\n  .pivot-sidebar .icon--row {\n    background: url("+r(e(2592))+");\n    background-position: center; }\n  .pivot-sidebar .icon--column {\n    background: url("+r(e(2593))+");\n    background-position: center; }\n  .pivot-sidebar .icon--value {\n    background: url("+r(e(2594))+");\n    background-position: center; }\n  .pivot-sidebar .icon--filter {\n    background: url("+r(e(2595))+");\n    background-position: center; }\n  .pivot-sidebar .rangeInput {\n    margin-top: 13px;\n    display: block; }\n    .pivot-sidebar .rangeInput input.sm-range-input-main {\n      height: 34px; }\n  .pivot-sidebar .rangeInputError {\n    color: #cd4747;\n    padding-top: 10px; }\n  .pivot-sidebar .recommend {\n    margin: 12px 0 16px;\n    font-size: 12px;\n    line-height: 24px;\n    color: #333333; }\n    .pivot-sidebar .recommend:hover {\n      border-radius: 1px;\n      background-color: #f7f7f7;\n      cursor: pointer; }\n    .pivot-sidebar .recommend > * {\n      vertical-align: middle; }\n  .pivot-sidebar .recommend--icon {\n    display: inline-block;\n    width: 14px;\n    height: 12px;\n    margin-right: 8px; }\n  .pivot-sidebar .panel-container {\n    position: relative;\n    padding-bottom: 30px;\n    user-select: none;\n    -moz-user-select: none; }\n  .pivot-sidebar .panel--hd {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    height: 40px; }\n  .pivot-sidebar .panel--icon {\n    display: inline-block;\n    width: 16px;\n    height: 16px;\n    margin-right: 8px;\n    vertical-align: middle; }\n  .pivot-sidebar .panel--title {\n    font-size: 14px;\n    line-height: 16px;\n    color: #333333;\n    vertical-align: middle; }\n  .pivot-sidebar .panel--addBtn {\n    font-size: 12px;\n    line-height: 22px;\n    padding: 0 8px;\n    color: #666666;\n    background-image: linear-gradient(-180deg, #ffffff 0%, #fafafa 100%);\n    border: 1px solid #e5e5e5;\n    border-radius: 2px;\n    cursor: pointer; }\n    .pivot-sidebar .panel--addBtn:hover {\n      border: 1px solid #cccccc; }\n  .pivot-sidebar .panel--bd {\n    padding: 4px 0 12px; }\n  .pivot-sidebar .panel--item {\n    width: 288px;\n    font-size: 12px;\n    line-height: 16px;\n    border: 1px solid #e5e5e5;\n    border-radius: 2px;\n    cursor: move; }\n    .pivot-sidebar .panel--item:not(:first-child) {\n      border-top: none; }\n    .pivot-sidebar .panel--item:hover {\n      border: 1px solid #cccccc; }\n  .pivot-sidebar .panel--item__hidden {\n    visibility: hidden; }\n  .pivot-sidebar .panel--item__float {\n    position: absolute;\n    left: 0;\n    right: 0;\n    background: white;\n    box-shadow: #333333 0 1;\n    border-top: 1px solid #e5e5e5; }\n  .pivot-sidebar .item--hd {\n    position: relative;\n    display: flex;\n    justify-content: space-between;\n    padding: 12px 15px; }\n  .pivot-sidebar .item--fieldName {\n    color: #333333;\n    text-overflow: ellipsis;\n    width: 227px;\n    white-space: nowrap;\n    overflow: hidden; }\n  .pivot-sidebar .item--closeBtn {\n    right: 15px;\n    width: 16px;\n    height: 16px;\n    cursor: pointer;\n    position: absolute; }\n    .pivot-sidebar .item--closeBtn:before, .pivot-sidebar .item--closeBtn:after {\n      content: '';\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      width: 13px;\n      height: 1px;\n      background: #cccccc; }\n    .pivot-sidebar .item--closeBtn:before {\n      transform: translateX(-50%) translateY(-50%) rotateZ(45deg); }\n    .pivot-sidebar .item--closeBtn:after {\n      transform: translateX(-50%) translateY(-50%) rotateZ(-45deg); }\n    .pivot-sidebar .item--closeBtn:hover:before, .pivot-sidebar .item--closeBtn:hover::after {\n      background: #666666; }\n  .pivot-sidebar .item--checker {\n    margin-left: 10px; }\n  .pivot-sidebar .item--bd {\n    display: flex;\n    padding: 0 15px 16px; }\n  .pivot-sidebar .item--droper {\n    flex: 1 0; }\n    .pivot-sidebar .item--droper:first-child {\n      margin-right: 10px; }\n  .pivot-sidebar .checker--label {\n    font-size: 12px;\n    color: #333333;\n    line-height: 16px;\n    cursor: pointer; }\n  .pivot-sidebar .droper--label {\n    line-height: 1;\n    color: #a5a5a5;\n    margin-bottom: 6px; }\n  .pivot-sidebar .droper--select {\n    position: relative;\n    padding: 4px 20px 4px 12px;\n    line-height: 18px;\n    border: 1px solid #e5e5e5;\n    border-radius: 2px;\n    color: #333333;\n    cursor: pointer;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    width: 90px;\n    overflow: hidden; }\n    .pivot-sidebar .droper--select:hover {\n      border: 1px solid #cccccc; }\n    .pivot-sidebar .droper--select:after {\n      position: absolute;\n      top: 11px;\n      right: 10px;\n      content: '';\n      border-left: 4px solid transparent;\n      border-right: 4px solid transparent;\n      border-top: 5px solid #a5a5a5; }\n  .pivot-sidebar .droper--item {\n    line-height: 30px;\n    padding: 0 20px;\n    cursor: pointer;\n    text-align: left;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden; }\n    .pivot-sidebar .droper--item__align {\n      padding: 0 0 0 13px; }\n    .pivot-sidebar .droper--item:hover {\n      background: #f7f7f7; }\n    .pivot-sidebar .droper--item.disable--dropper--item {\n      cursor: default;\n      opacity: 0.5; }\n      .pivot-sidebar .droper--item.disable--dropper--item:hover {\n        background: #fff; }\n  .pivot-sidebar .droper--dp {\n    position: relative; }\n  .pivot-sidebar .droper--dp:not(.unactive) .droper--select {\n    border: 1px solid #cccccc; }\n  .pivot-sidebar .droper--dp:not(.unactive) .menu-wrap {\n    position: absolute;\n    z-index: 1;\n    padding: 5px 0;\n    max-width: 180px;\n    margin-top: 2px;\n    background: white;\n    border-radius: 1px;\n    box-shadow: 0 1px 4px 0 rgba(0, 0, 0, 0.1); }\n  .pivot-sidebar .panel--hd .menu-wrap {\n    right: 0;\n    text-align: right;\n    white-space: nowrap; }\n  .pivot-sidebar .panel--bd .menu-wrap {\n    width: 100%; }\n",""])},2591:function(n,t,e){n.exports=e.p+"images/recommend.2178ee3cad.svg"},2592:function(n,t,e){n.exports=e.p+"images/row.9026de11dd.svg"},2593:function(n,t,e){n.exports=e.p+"images/column.271c803b03.svg"},2594:function(n,t,e){n.exports=e.p+"images/value.23903f6eb4.svg"},2595:function(n,t,e){n.exports=e.p+"images/filter.19a3a93e19.svg"}});