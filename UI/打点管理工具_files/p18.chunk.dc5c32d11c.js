webpackJsonpSm_name_([16],{1944:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PLUGIN_NAME",function(){return b});var r,i=n(0),o=n.n(i),s=(n(2942),n(3)),c=n(1),a=n.n(c),l=n(6),u=n.n(l),h=n(2945),f=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function c(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,c)}a((r=r.apply(t,e||[])).next())})},m=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},v=s.sheets,p=v.Events,y=v.path,b=(v.root,y.setByPath,s.Editor,"CellHistory"),x=function(t){function e(n){var r=t.call(this,{name:b,Constructor:e,config:n})||this;return r.options=n,r.render(),r.install(),r}return f(e,t),e.prototype.setLocale=function(t){o.a.setLocaleSync(t)},e.prototype.show=function(t){return d(this,void 0,Promise,function(){var e;return m(this,function(n){switch(n.label){case 0:return[4,this.options.getRev()];case 1:return e=n.sent(),this.dialog&&this.dialog.show(t,e),s.sheets.track(2,"13000"),[2]}})})},e.prototype.render=function(){var t=this;this.options.A.isRendered?this.renderContainer():this.options.A.on(p.Rendered,function(){t.renderContainer()})},e.prototype.renderContainer=function(){var t=this,e=this.options,n=e.A,r=e.fetchHistoryApi;u.a.render(a.a.createElement(h.a,{ref:function(e){return t.dialog=e},A:n,fetchHistoryApi:r}),this.pluginContainer)},e}(s.sheets.Plugin);e.default=x},2942:function(t,e,n){"use strict";var r=n(0),i=n.n(r),o=n(2943),s=n.n(o),c=n(2944),a=n.n(c);i.a.addLocaleResource("en-US",s.a),i.a.addLocaleResource("ja-JP",a.a),i.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2943:function(t,e){t.exports={"改动来源于数据透视表":"Change is from pivot table","改动来源于数组公式":"Change is from array formula","改动来源于 %s 单元格公式":"Change is from %s cell formula","编辑历史":"Edit history","无更多修改历史":"No more modification history","无修改历史":"No modification history","已查询到%s，暂未找到编辑记录":"% s has been found through query. No editing record has been found","继续查询":"Continue to query","请求失败":"Request failed","修改为":"Modified to","用":"Use","替换了":"Replaced","删除了":"Deleted","增加了":"Added"}},2944:function(t,e){t.exports={"改动来源于数据透视表":"変更はピボットテーブルによるものです","改动来源于数组公式":"変更は配列数式によるものです","改动来源于 %s 单元格公式":"変更は%sセル数式によるものです","编辑历史":"編集履歴","无更多修改历史":"その他の変更履歴はありません","无修改历史":"変更履歴はありません","已查询到%s，暂未找到编辑记录":"%s検索しました、変更履歴が見つかりません","继续查询":"検索を続行","请求失败":"リクエストエラー","修改为":"に変更","用":"用","替换了":"を置換しました","删除了":"を削除しました","增加了":"を追加しました"}},2945:function(t,e,n){"use strict";var r,i,o,s=n(0),c=n.n(s),a=n(1),l=n.n(a),u=n(3),h=n(2946),f=n(2947),d=n(2948),m=(n.n(d),n(2950)),v=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},b=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function c(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,c)}a((r=r.apply(t,e||[])).next())})},x=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},g=u.sheets,w=g.utils,k=g.constants,N=g.changeset,C=g.Events,I=g.track,j=w.dateTime,O=N.stringifyPosition,_=function(t){function e(e){var n=t.call(this,e)||this;return n.show=function(t,e){var r=t.row,i=t.col,o=t.sheetId;n.setState({open:!0,cell:{row:r,col:i}}),n.requestHistory({cell:{row:r,col:i,sheetId:o,sheetIndex:n.props.A.spread.sheets.findIndex(function(t){return t.id===o})},from:e})},n.onDialogClosed=function(){n.setState({open:!1,historyItems:[],lastItem:"loading",firstItem:null,activeIndex:0}),n.reset()},n.continueFetch=function(){n.fetchResult.isFetchExceed=!1,n.requestHistory(),I(2,"13002")},n.prev=function(){var t=n.state,e=t.activeIndex,r=t.historyItems,i=t.lastItem,o=t.firstItem,s=r.length+(o?1:0);if(e<s){var c=e+1;n.setState({activeIndex:c}),c===s&&"loading"===i&&n.requestHistory(),I(2,"13001")}},n.next=function(){var t=n.state.activeIndex;0!==t&&n.setState({activeIndex:t-1})},n.state={open:!1,historyItems:[],firstItem:null,lastItem:"loading",activeIndex:0,cell:{row:0,col:0}},n.isFetching=!1,n}return v(e,t),e.prototype.render=function(){return this.state.open?l.a.createElement(h.a,{A:this.props.A,relativeCell:this.state.cell,inner:this.inner(),zIndex:10,onDialogClosed:this.onDialogClosed}):null},e.prototype.reset=function(){this.isFetching=!1},e.prototype.requestHistory=function(t){return b(this,void 0,Promise,function(){var e,n,r,i,o,s;return x(this,function(c){switch(c.label){case 0:if(e=this.genFetchParams(t),this.isFetching||!e)return[2];c.label=1;case 1:return c.trys.push([1,3,,4]),t&&(n=t.cell,r=t.from,i=function(t,e){try{var n=t.row,r=t.col,i=t.sheetId,o=e.spread.getSheet(i);if(!o)return;var s=o.E,c=function(t,e,n){return t._getArrayFormulaInfo(e,n)||function(t,e,n){var r=t.getArrayValueMark(e,n);if("string"==typeof r){var i=r.split("@");return{row:+i[1],col:+i[2]}}}(t,e,n)}(s,n,r);if(c){var a=function(t,e,n){if(t.getFormula(e,n).indexOf("PIVOTTABLE")>-1)return"pivottable";if(t._getArrayFormulaInfo(e,n))return"range";return"other"}(s,c.row,c.col);if("pivottable"===a||"range"===a||!function(t,e){return t.row===e.row&&t.col===e.col}(c,t))return{type:"formula",data:{type:a,cell:O(c.row,c.col)}}}}catch(t){e.emit(C.Track,k.ERR_CODE.WT,{stack:t&&t.stack,type:"get array formula error"})}}(n,this.props.A))?(this.setState({firstItem:i}),this.fetchResult={cell:n,rev:r,cellChanges:[],lastHistory:void 0,isFetchExceed:!1},[2]):(this.isFetching=!0,this.setState({lastItem:"loading"}),o=this,[4,Object(m.a)(e)]);case 2:return o.fetchResult=c.sent(),this.setState({lastItem:function(t){var e=t.rev,n=t.cell,r=t.isFetchExceed;if(Object(m.b)(e,n))return"end";if(r)return"max";return"loading"}(this.fetchResult),historyItems:function(t){for(var e=t.cellChanges,n=t.cell,r=t.rev,i=[],o=Object(m.b)(r,n),s=0,c=e.length;s<c;s++){var a=e[s],l=P(a);if(1===c&&l)break;if(1!==c&&s===c-1&&(l||!o))break;i.push({user:a.user,prev:e[s+1]&&e[s+1].data||o&&{text:""},cur:a.data})}return i}(this.fetchResult)}),[3,4];case 3:return s=c.sent(),this.props.A.emit(C.Track,k.ERR_CODE.WT,{stack:s&&s.stack}),this.setState({lastItem:"error"}),[3,4];case 4:return this.isFetching=!1,[2]}})})},e.prototype.genFetchParams=function(t){return t||this.fetchResult?y({fetchUrl:this.props.fetchHistoryApi,prevCellChanges:[]},t||{cell:this.fetchResult.cell,from:this.fetchResult.rev,prevCellChanges:this.fetchResult.cellChanges}):null},e.prototype.activeItem=function(){var t=this.state,e=t.activeIndex,n=t.historyItems,r=t.firstItem,o=r?1:0;if(0===e&&r){var s=r.data,a=s.cell,u=s.type,h="pivottable"===u?c()("改动来源于数据透视表"):"range"===u?c()("改动来源于数组公式"):c()(i||(i=p(["改动来源于 "," 单元格公式"],["改动来源于 "," 单元格公式"])),a);return l.a.createElement("span",{className:"sm-sheet-cell-history-first"},h)}return n[e-o]?l.a.createElement(f.a,{data:n[e-o]}):l.a.createElement("span",{className:"sm-sheet-cell-history-last"},this.getLastItemEle())},e.prototype.inner=function(){var t=this.state,e=t.activeIndex,n=t.historyItems,r=t.firstItem?1:0,i=e>=n.length+r,o=0===e;return l.a.createElement("div",{className:"sm-sheet-cell-history-container"},l.a.createElement("div",{className:"sm-sheet-cell-history-header"},l.a.createElement("span",{className:"sm-sheet-cell-history-header-label"},c()("编辑历史")),l.a.createElement("span",{className:"sm-sheet-cell-history-header-prev "+(i?"disabled":""),onClick:this.prev}),l.a.createElement("span",{className:"sm-sheet-cell-history-header-next "+(o?"disabled":""),onClick:this.next})),l.a.createElement("div",{className:"sm-sheet-cell-history-body"},this.activeItem()))},e.prototype.getLastItemEle=function(){var t=this.state.lastItem,e=this.state.historyItems.length>0;if("end"===t)return l.a.createElement("span",{className:"sm-sheet-cell-history-body-text"},e?c()("无更多修改历史"):c()("无修改历史"));if("max"===t){var n=this.fetchResult&&this.fetchResult.lastHistory,r=n?j.format(n.updatedAt):"";return l.a.createElement("span",{className:"sm-sheet-cell-history-body-text"},c()(o||(o=p(["已查询到","，暂未找到编辑记录"],["已查询到","，暂未找到编辑记录"])),r)," ",l.a.createElement("span",{className:"sm-sheet-cell-history-continue-request",onClick:this.continueFetch},c()("继续查询")))}return"error"===t?l.a.createElement("span",{className:"sm-sheet-cell-history-body-text"},c()("请求失败")):l.a.createElement("span",{className:"sm-sheet-loading-rotate"})},e}(l.a.Component);function P(t){var e=t.data,n=e.text,r=e.url;return!(n||r)}e.a=_},2946:function(t,e,n){"use strict";(function(t){var r,i=n(1),o=n.n(i),s=n(3),c=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=s.sheets.Core.Spread.Sheets.Events,l=a.TopRowChanged,u=a.LeftColumnChanged,h=a.LayoutChanged,f=a.SelectionChanged,d=a.ActiveSheetChanged,m=function(e){function n(t){var n=e.call(this,t)||this;return n.onLayoutChanged=function(){n.recalcPos=!0,n.forceUpdate()},n.onSelectionChanged=function(){n.A.csApplier.isApplingChange||n.close()},n.onActiveSheetChanged=function(){n.close()},n.onSheetFullApply=function(t){var e=t.rows,r=t.cols,i=n.state.relativeCell,o=i.row,s=i.col;o=v(e,o),s=v(r,s),-1===o||-1===s?n.close():(n.recalcPos=!0,n.setState({relativeCell:{row:o,col:s}}))},n.bindEvents(),n.A=t.A,n.state={relativeCell:n.props.relativeCell,visibility:"hidden",pos:{left:0,top:0}},n.recalcPos=!0,n}return c(n,e),n.prototype.render=function(){var t=this.state,e=t.pos,n=t.visibility,r=e.left,i=e.top;return o.a.createElement("div",{className:"sm-sheet-floating-dialog",style:{zIndex:this.props.zIndex||1,left:r,top:i,visibility:n}},this.props.inner)},n.prototype.componentWillReceiveProps=function(t){this.props.inner!==t.inner&&(this.recalcPos=!0)},n.prototype.componentDidMount=function(){this.rePosition()},n.prototype.componentDidUpdate=function(){this.rePosition()},n.prototype.componentWillUnmount=function(){var t=this;setTimeout(function(){t.destroy()})},n.prototype.bindEvents=function(){this.props.A.spread.gcSpread.bind(l,this.onLayoutChanged),this.props.A.spread.gcSpread.bind(u,this.onLayoutChanged),this.props.A.spread.gcSpread.bind(h,this.onLayoutChanged),this.props.A.spread.gcSpread.bind(f,this.onSelectionChanged),this.props.A.spread.gcSpread.bind(d,this.onActiveSheetChanged),this.props.A.on(s.sheets.Events.AfterSheetFullApply,this.onSheetFullApply)},n.prototype.destroy=function(){this.props.A.spread.gcSpread.unbind(l,this.onLayoutChanged),this.props.A.spread.gcSpread.unbind(u,this.onLayoutChanged),this.props.A.spread.gcSpread.unbind(h,this.onLayoutChanged),this.props.A.spread.gcSpread.unbind(f,this.onSelectionChanged),this.props.A.spread.gcSpread.unbind(d,this.onActiveSheetChanged),this.props.A.off(s.sheets.Events.AfterSheetFullApply,this.onSheetFullApply)},n.prototype.rePosition=function(){this.recalcPos&&(this.recalcPos=!1,this.setState(this.getContainerPosition()))},n.prototype.close=function(){this.props.onDialogClosed()},n.prototype.getContainerPosition=function(){var e=this.state.relativeCell,n=e.row,r=e.col,i=this.A.spread.gcSpread.B(),o=i.getCellRect(n,r),s=o.x,c=o.y,a=o.width,l=o.height,u=t("#sm-canvas-container-viewport").offset(),h=t(".sm-sheet-floating-dialog").offset();return{pos:{left:function(t,e,n,r){return t+e+n>r?r-n:t+e}(s,a,h.width,u.width),top:function(e,n,r,i){var o=(a=t("#sm-canvas-container-viewport").offset(),l=t(".sm-sheet-view-container").offset(),a.top-l.top),s=i+22,c=Math.max(e,s);var a,l;return(c+n>r?r-n:c)+o}(c,h.height,u.height,function(t,e){var n=t.frozenRowCount(),r=0;if(n<=e)for(var i=0;i<n;i++)r+=t.getRowHeight(i);return r}(i,n))},visibility:s+a<=0||c+l<=0?"hidden":"visible"}},n}(o.a.Component);function v(t,e){if(!t)return e;for(var n=e,r=0;r<t.length;r++){var i=t[r],o=i.type,s=i.index,c=i.amount;if("insert"===o&&s<=e)n+=c;else if("remove"===o)if(s+c-1<n)n-=c;else if(s+c-1>=n&&s<=n)return-1}return n}e.a=m}).call(e,n(25))},2947:function(t,e,n){"use strict";e.a=function(t){var e=t.data,n=e.user,r=e.prev,o=e.cur;return s.a.createElement("div",{className:"sm-sheet-cell-hisotry-item"},s.a.createElement("div",{className:"cell-hisotry-item-user"},s.a.createElement("img",{src:n.avatar,className:"cell-hisotry-item-user-img"}),s.a.createElement("span",{className:"cell-hisotry-item-user-name"},n.name),s.a.createElement("span",{className:"cell-hisotry-item-user-time"},c.format(n.updatedAt))),s.a.createElement("div",{className:"cell-hisotry-item-content"},function(t,e){var n=a(t),r=a(e);if(!t)return[{des:i()("修改为"),data:e}];if(n&&r)return[{des:i()("用"),data:e},{des:i()("替换了"),data:t}];if(n)return[{des:i()("删除了"),data:t}];if(r)return[{des:i()("增加了"),data:e}];return[]}(r,o).map(function(t,e){var n=t.des,r=t.data;return s.a.createElement("div",{className:"cell-hisotry-item-content-action",key:e},s.a.createElement("span",{className:"cell-hisotry-item-content-action-label"},n+":"),s.a.createElement("span",{className:"cell-hisotry-item-content-action-content"},r.url?s.a.createElement("a",{href:r.url,target:"_blank"},r.text||r.url):r.text))})))};var r=n(0),i=n.n(r),o=n(1),s=n.n(o),c=n(3).sheets.utils.dateTime;function a(t){return!(!t||!t.text&&!t.url)}},2948:function(t,e,n){var r=n(2949);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(1854)(r,i);r.locals&&(t.exports=r.locals)},2949:function(t,e,n){(t.exports=n(1853)(!1)).push([t.i,".sm-sheet-floating-dialog {\n  position: absolute;\n  background: white;\n  box-shadow: 0 0 20px #c8c8c8;\n  left: 400px;\n  top: 200px;\n  border-radius: 2px; }\n\n.sm-sheet-cell-history-container {\n  width: 240px;\n  box-sizing: border-box;\n  font-size: 12px; }\n\n.sm-sheet-cell-history-loading {\n  width: 20px;\n  height: 20px;\n  margin: 0 110px; }\n\n.sm-sheet-cell-history-body-text {\n  padding: 0 15px;\n  display: inline-block; }\n\n.sm-sheet-cell-history-body {\n  font-size: 0px; }\n  .sm-sheet-cell-history-body .sm-sheet-loading-rotate {\n    width: 20px;\n    height: 20px;\n    margin: 0 110px;\n    box-sizing: border-box; }\n\n.sm-sheet-cell-history-continue-request {\n  color: #6da0e3;\n  cursor: pointer; }\n  .sm-sheet-cell-history-continue-request:hover {\n    color: #6290cc; }\n\n.sm-sheet-cell-history-first,\n.sm-sheet-cell-history-last {\n  display: inline-block;\n  line-height: 20px;\n  margin: 12px 0;\n  font-size: 12px;\n  color: #a5a5a5; }\n\n.sm-sheet-cell-history-first {\n  margin-left: 15px; }\n\n.sm-sheet-cell-history-header {\n  height: 36px;\n  line-height: 36px;\n  background: #f7f7f7;\n  padding: 0 15px;\n  color: #333;\n  position: relative; }\n\n.sm-sheet-cell-history-header-prev,\n.sm-sheet-cell-history-header-next {\n  display: inline-block;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  line-height: 20px;\n  vertical-align: -5px;\n  position: absolute;\n  top: 7px;\n  cursor: pointer;\n  opacity: 0.6; }\n  .sm-sheet-cell-history-header-prev::before,\n  .sm-sheet-cell-history-header-next::before {\n    content: '';\n    border-style: solid;\n    border-color: #494949;\n    border-width: 0 0 2px 2px;\n    width: 5px;\n    height: 5px;\n    display: block;\n    position: absolute;\n    top: 7px; }\n  .sm-sheet-cell-history-header-prev:hover,\n  .sm-sheet-cell-history-header-next:hover {\n    opacity: 1; }\n  .sm-sheet-cell-history-header-prev.disabled,\n  .sm-sheet-cell-history-header-next.disabled {\n    opacity: 0.3; }\n    .sm-sheet-cell-history-header-prev.disabled:hover,\n    .sm-sheet-cell-history-header-next.disabled:hover {\n      opacity: 0.3; }\n\n.sm-sheet-cell-history-header-prev {\n  right: 51px; }\n  .sm-sheet-cell-history-header-prev::before {\n    transform: rotate(45deg);\n    left: 8px; }\n\n.sm-sheet-cell-history-header-next {\n  right: 15px; }\n  .sm-sheet-cell-history-header-next::before {\n    transform: rotate(-135deg);\n    left: 6px; }\n\n.sm-sheet-cell-hisotry-item {\n  font-size: 12px; }\n\n.cell-hisotry-item-user {\n  background: #f7f7f7;\n  height: 32px;\n  padding: 4px 15px 12px; }\n\n.cell-hisotry-item-user-img {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  float: left; }\n\n.cell-hisotry-item-user-time {\n  margin-top: 8px;\n  color: #a5a5a5; }\n\n.cell-hisotry-item-user-name {\n  color: #333; }\n\n.cell-hisotry-item-user-name,\n.cell-hisotry-item-user-time {\n  display: block;\n  margin-left: 44px; }\n\n.cell-hisotry-item-content {\n  padding: 12px 15px;\n  line-height: 20px; }\n\n.cell-hisotry-item-content-action {\n  overflow-x: hidden;\n  overflow-y: auto;\n  overflow-wrap: break-word;\n  word-wrap: break-word; }\n\n.cell-hisotry-item-content-action-label {\n  color: #a5a5a5;\n  white-space: nowrap; }\n\n.cell-hisotry-item-content-action-content {\n  margin-left: 8px;\n  color: #333; }\n  .cell-hisotry-item-content-action-content a {\n    color: #6da0e3;\n    text-decoration: none; }\n",""])},2950:function(t,e,n){"use strict";e.a=function t(e,n){var r=e.fetchUrl,h=e.from,f=e.cell,d=e.prevCellChanges;void 0===n&&(n=0);return o(this,void 0,Promise,function(){var e,m,v,p,y,b,x;return s(this,function(g){switch(g.label){case 0:return[4,function(t,e,n){return o(this,void 0,Promise,function(){return s(this,function(r){switch(r.label){case 0:return[4,c(null,{url:t,params:{from:n,to:e}})];case 1:return[2,r.sent()]}})})}(r,h,Math.max(h-l,1))];case 1:return e=g.sent(),m=Object(i.a)(e.reverse(),f,d),v=m.cellChanges,p=m.cell,y=m.rev,b=d.length>0&&v.length>0||v.length>1,x=function(t){return t>=a}(n),n+=e.length,v.unshift.apply(v,d),b||u(y,p)||x?[2,{cellChanges:v,cell:p,rev:y,lastHistory:e[e.length-1],isFetchExceed:x}]:[2,t({fetchUrl:r,from:y,cell:p,prevCellChanges:v},n)]}})})},e.b=u;var r=n(3),i=n(2951),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function c(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,c)}a((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},c=r.sheets.ajax.ajax,a=3e3,l=300;function u(t,e){return t<1||Object(i.b)(e)}},2951:function(t,e,n){"use strict";e.a=function(t,e,n){for(var r=Object.assign({},e),i=[],o=t[t.length-1].rev,s=0;s<t.length;s++){var c=t[s],a=f(c,r);if(r=a.cell,a.cellChange&&(i.push(a.cellChange),i=b(n,i)),p(r)||y(n,i)){o=c.rev;break}}return{cellChanges:i,cell:r,rev:o-1}},e.b=p;var r=n(3).sheets,i=r.utils,o=r.changeset,s=r.formatter,c=i.modoc,a=i.decodeFormula,l=s.GeneralFormatter,u=s.composeFormatterAndPrecision,h=o.findCellOpInColDelta;function f(t,e){for(var n=null,r=null,i=e.sheetIndex,o=-1,s=new c.Delta(t.delta).getIter();s.hasNext();){var a=s.next(),l=a.action,u=a.data,h="number"==typeof u?u:1,f=o+h,m=o<i,v=f>=i;if("retain"===l&&v){n=(p=d(a,e)).cell,r=p.cellChangeData;break}if("remove"===l&&m)i+=h;else if("insert"===l&&m){if(v){var p;i=-1,n=(p=d(a,e)).cell,r=p.cellChangeData;break}i-=h}"insert"!==l&&(o=f)}return{cell:Object.assign(e,{sheetIndex:i},n),cellChange:r&&function(t,e){return{data:e,user:{name:t.user.name,avatar:t.user.avatar,updatedAt:t.updatedAt}}}(t,r)}}function d(t,e){var n=t.getAttributes();if(n&&n.id&&n.id!==e.sheetId)return{cell:{row:-1,col:-1},cellChangeData:null};var r=t.data,i=e.row,o=e.col;if("number"==typeof r)return{cell:{row:i,col:o},cellChangeData:null};var s=t.getParsedData(),c=s[0],f=s[1],d=h(f,i,o);return{cell:{row:m(c,i),col:m(f,o)},cellChangeData:function(t){if(!t)return null;var e=t.getAttributes(),n=e.formula,r=e.link,i=e.backgroundImage,o=function(t){if(t){var e=a(t),n=!(!e||!e.a),r="="+(e?e.f:t);return n?"{"+r+"}":r}return""}(n)||function(t){var e=t.cellValue,n=t.format,r=t.autoFormatter,i=t.precision;if(null!=e&&(n||r)){var o=n||r;return n&&"number"==typeof i&&(o=u(n,i)),new l(o).format(e,{})}if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();return""}(e);if(r)return{text:o,url:r};if(i)return{text:"图片",url:i};if(e.hasOwnProperty("cellValue")||e.hasOwnProperty("formula"))return{text:o};return null}(d)}}function m(t,e){if(!t)return e;for(var n=-1,r=e,i=t.getIter();i.hasNext();){var o=i.next(),s=o.action,c="number"==typeof o.data?o.data:1,a=n+c,l=n<r,u=a>=r;if("retain"===s&&u)break;if("remove"===s&&l)r+=c;else if("insert"===s&&l){if(u){r=-1;break}r-=c}"insert"!==s&&(n=a)}return r}function v(t){var e=t.text,n=t.url;return!(!e&&!n)}function p(t){var e=t.sheetIndex,n=t.row,r=t.col;return-1===e||-1===n||-1===r}function y(t,e){return t.length&&e.length>0||e.length>1}function b(t,e){var n=t[t.length-1];return e.filter(function(t,r){var i=0===r?n:e[r-1];return v(t.data)||!i||i&&v(i.data)})}}});