webpackJsonpSm_name_([17],{1864:function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),n.d(i,"PLUGIN_NAME",function(){return x}),i.getCachedOriginFillParams=function(){return k},i.getCopyFillCells=function(){return E},i.getCachedOriginAttributes=function(){return B},i.getCachedFillOps=function(){return I},i.deleteCachedFillInfo=V;var r,e=n(133),u=(n.n(e),n(17)),o=(n.n(u),n(3)),s=n(2562),a=n.n(s),l=n(2368),c=n(0),h=n.n(c),f=n(2563),v=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)},g=o.sheets.CellAppendant,A=g.HorizontalAlign,p=g.VerticalAlign,m=o.sheets.Core,w=o.sheets.cell.getCellAttrs,b=(o.Editor,o.sheets),C=b.range,O=b.perf,y=(b.root,b.path),R=b.fill,F=b.Plugin,j=b.formula,D=(y.setByPath,o.sheets.Hooks),T=m.Spread.Sheets,S=o.sheets.Events,M=R.fillZhSR,_=j.encodeFormula,N=u.isMac(),x="Fill",k=null,E=null,B=null,I=null;function V(){E=null,I=null,k=null,B=null}var U=function(t){function i(n){var r=t.call(this,{name:x,Constructor:i,config:n})||this;r.getCellAppendant=function(){return{priority:1001,component:f.a,align:[A.right,p.bottom],disableRender:!1}},r.render=function(){var t=r.A;r.init(),m.Spread.Sheets.Fill.initSpread(t.spread.gcSpread),r.registerFillShortcut()},r.registerFillShortcut=function(){var t=r.A,i=t.spread.gcSpread.commandManager();i.register("custom-fillBottom",function(){if(!t.permissions.query.U())return!0;var i=T.Fill,n=i.AutoFillType,e=i.FillDirection,u=r.A.spread.B();if(!u.E.isEditing()){var o=u.getCurSelection(),s=u.E,a=s._commandManager(),l=s.name(),c=void 0,h=void 0;if(1===o.rowCount){var f=o.row-1;if(-1===f)return!0;c=d(d({},o),{row:f}),h=d(d({},o),{row:o.row,rowCount:o.rowCount})}else c=d(d({},o),{row:o.row,rowCount:1}),h=d(d({},o),{row:o.row+1,rowCount:o.rowCount-1});return c=C.createRange(c.row,c.col,c.rowCount,c.colCount),h=C.createRange(h.row,h.col,h.rowCount,h.colCount),a.execute({cmd:"fill",sheetName:l,startRange:c,fillRange:h,realFillRange:h,autoFillType:n.copyCells,fillDirection:e.down,srcRange:c}),!0}});i.RX("custom-fillBottom",68,!N,!1,!1,N)},r.collectPreviousAttributes=function(t){var i=t.realFillRange,n=t.sheet,e=[],u=r.getConditionalFormatPlugin();u&&(e=u.getRulesByRanges(n,[i],!0));var o=[],s=r.getDataValidationPlugin();s&&(o=s.getRulesByRange(n,i)),B={conditionFormatRules:e,validationRules:o,realFillRange:i,dateMention:d({},n.dateMentions._dateMentions)}},r.beforeDragFillCompleted=function(t,i){var n=t.args,e=n.startRange,u=n.realFillRange;if(!(k&&C.isSameRange(e,k.srcRange)&&C.isSameRange(u,k.realFillRange))){V(),r.collectPreviousAttributes(n);for(var o=n.sheet,s=n.fillDirection,a=C.fixRange(o,n.startRange),l=u.row,c=u.col,h=l+u.rowCount-1,f=c+u.colCount-1,v=l;v<=h;v++)for(var d=c;d<=f;d++)!k&&(k={originCells:{}}),k.originCells[v+"-"+d]=[v,d,o.getValue(v,d),w(o,v,d)];k.srcRange=a,k.fillDirection=s,k.fillRange=n.fillRange,k.realFillRange=n.realFillRange,k.autoFillType=n.autoFillType}},r.onCollectOperatorAfterDragFillBlockCompleted=function(t,i){var n=t.args,e=T.Fill.AutoFillType,u=n.sheet,o=n.autoFillType,s=n.fillDirection,a=n.collectedCells;if(!Object.keys(a).length)return i;var c=C.fixRange(u,n.fillRange),h=C.fixRange(u,n.srcRange);O.paintWrap({obj:u,func:l.a,suspendCalcService:!0})(u,s,h,c,a);for(var f=h.row,v=h.col,g=h.rowCount,A=h.colCount,p=f;p<f+g;p++)for(var m=v;m<v+A;m++){a[R=p+"-"+m]&&(delete a[R].returnStyle,delete a[R].returnVal)}var b=r.A,y=u._rowFilter?u._rowFilter._getFilterArgs().filteredOutRows:[];for(var R in a)if(a[R].formula){var F=R.split("-").map(Number),j=F[0],D=F[1],M=u.getFormulaInformation(j,D);M.isArrayFormula&&(a[R].formula=_(u,j,D,M))}var N={fillRange:c,autoFillType:o,fillDirection:s,srcRange:h,filteredRows:y,collectedCells:a};!k||o!==e.fillFormattingOnly&&o!==e.fillWithoutFormatting||(N.resetBaseCells=E,N.originCells=k.originCells);var x={fnName:"dragFill2Cs",params:b.opProcessor([u.guid(),N])};if(i.push(x),!E&&(I=i,b.emit(S.AfterFill,d({},n))),!E)for(var B in a){var V=B.split("-"),U=+V[0],L=+V[1],P=+U-h.row,Q=+L-h.col;P>=0&&P<h.rowCount&&Q>=0&&Q<h.colCount||(!E&&(E={}),E[B]=[U,L,u.getValue(U,L),w(u,U,L)])}return i};var e=n.A;return r.A=e,r.bindEditorEvents(),r.registerHooks(),r.A.isRendered&&r.render(),r.install(),r}return v(i,t),i.prototype.setLocale=function(t){h.a.setLocaleSync(t)},i.prototype.init=function(){m.Spread.Sheets.Fill||(a()(m),m.Spread.Sheets.Fill.install(m.Spread.Sheets),m.Spread.Sheets.Fill.SR.zh=function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);return t}(m.Spread.Common.SR.zh,M))},i.prototype.bindEditorEvents=function(){this.A.on(S.Rendered,this.render)},i.prototype.registerHooks=function(){var t=this.A.R.RR;t(D.CollectOperatorAfterDragFillBlockCompleted,this.onCollectOperatorAfterDragFillBlockCompleted),t(D.BeforeDragFillCompleted,this.beforeDragFillCompleted)},i.prototype.getConditionalFormatPlugin=function(){var t=this.A.F.get("ConditionalFormat");return t&&t.instance?t.instance:null},i.prototype.getDataValidationPlugin=function(){var t=this.A.F.get("DataValidation");return t&&t.instance?t.instance:null},i}(F);i.default=U},2203:function(t,i,n){"use strict";i.c=function(t){return t.spread.B().E.isEditing()},i.b=function(t,i,n){var r=m(i),e=r.row,o=r.col,s=O(n,e,o);if(!t.permissions.query.canEditSheet({sheetId:i.guid()}))return;if(!i.isRangeEditable(s))return g({title:u()("编辑的单元格已被锁定"),type:"error"});if(n.some(function(t){return i._hasPartArrayFormulas(t.row,t.col,t.rowCount,t.colCount)}))return g({title:u()("您选择的范围里包含部分数组公式，无法填充"),type:"error"});var a=t.F.get("PivotTable"),l=a?a.instance.pivotRangeHelpers.hasPivotTableInRange:null;if(l&&n.some(function(t){return l(i,t)}))return g({title:u()("您选择的范围里包含数据透视表，无法填充"),type:"error"});var c=i.isEditing(),h=w(i,e,o);if(c)try{var A=i.endEdit(!1,!1,!1);if(!A)return}catch(t){}var y=function(t,i,n,r,e){var u=n.fromRow,o=n.fromCol,s=[],a=[],l=w(t,u,o);return i.forEach(function(i){for(var n=p(t,i),c=n.row,h=n.col,f=n.rowCount,v=n.colCount,g=c;g<c+f;g++)if(!t._isRowFilterOut||!t._isRowFilterOut(g))for(var A=function(i){if(g!==u||i!==o||e){var n=w(t,g,i),c=t.getSpan(g,i);if(e){var h={formula:l.attrs.formula||null};["link","linkToolTip","backgroundImage","backgroundImageLayout","backgroundImageSize","mentionGuid","checkbox"].forEach(function(t){var i;return n.attrs.hasOwnProperty(t)&&Object.assign(h,((i={})[t]=null,i))}),l.attrs.richText?["bold","italic","underline","strike","color","font-size","font-family","richText","format"].forEach(function(t){var i;return Object.assign(h,((i={})[t]=l.attrs[t]||null,i))}):Object.assign(h,{richText:null});var f=l.attrs.autoFormatter;if(f){var v=n.attrs.format;v&&!d({formatter:v},{autoFormatter:f})||Object.assign(h,{format:f})}var A=Object.assign({},n.attrs,h),p=g===u&&i===o?r:n,m=!c||c.row===g&&c.col===i?l.value:p.value;s.push([g,i,p,{value:m,attrs:A}]),a.push([g,i,m,A])}else{var b=l.attrs;for(var C in b)C.indexOf("comment")>-1&&delete b[C];var O=n.attrs,y=Object.keys(O).reduce(function(t,i){return t[i]=i.indexOf("comment")>-1?O[i]:null,t},{});A=Object.assign(y,b,{rowspan:O.rowspan,colspan:O.colspan}),m=!c||c.row===g&&c.col===i?l.value:n.value,s.push([g,i,n,{value:m,attrs:A}]),a.push([g,i,m,A])}}},m=h;m<h+v;m++)A(m)}),{newCells:a,collectedCells:s}}(i,n,{fromRow:e,fromCol:o},h,c),R=y.newCells,F=y.collectedCells,j=[{fnName:"editCell2Changeset",params:t.opProcessor([i.guid(),F,{skipParseFormat:!0}])}];if(!c){var D={row:e,col:o,rowCount:1,colCount:1},T={sheet:i,fillRanges:s,selectedRanges:n,srcRange:D};t.R.triggerHook(f.CollectOperatorAfterFillAreaByShortcut,T,j)}C({obj:i,func:b,suspendCalcService:!0})(i,R),t.emit(v.AfterCellsChanged,{sheet:i,cellsData:R}),t.actions.calcOperator({operator:j,isCalcInWorker:R.length>1e3,label:"fillAreaShortCut"})},i.a=O;var r=n(3),e=n(0),u=n.n(e),o=r.sheets.range,s=r.sheets,a=s.alert,l=s.sheet,c=s.cellCommand,h=s.perf,f=s.Hooks,v=s.Events,d=s.formatter.isSatisfiedResetRule,g=a.showAlert,A=o.isCellInRange,p=o.fixRange,m=l.getActiveCell,w=l.getCell,b=c.setBulkCells,C=h.paintWrap;function O(t,i,n){return t.reduce(function(t,r){if(A(i,n,r)){var e=r.row,u=r.col,o=r.rowCount,s=r.colCount;o>1&&t.push({row:Math.max(0,i>e?e:e+1),col:Math.max(0,u),rowCount:o-1,colCount:s}),s>1&&t.push({row:Math.max(0,i>e?e+o-1:e),col:Math.max(0,n>u?u:u+1),rowCount:1,colCount:s-1})}else t.push(r);return t},[])}},2249:function(t,i,n){"use strict";i.a=function(t,i,n){var r=A(i),o=r.row,l=r.col,c=Object(u.a)(n,o,l);if(!t.permissions.query.canEditSheet({sheetId:i.guid()}))return!1;if(!i.isRangeEditable(c))return m({title:s()("编辑的单元格已被锁定"),type:"error"}),!1;if(n.some(function(t){return i._hasPartArrayFormulas(t.row,t.col,t.rowCount,t.colCount)}))return m({title:s()("您选择的范围里包含部分数组公式，无法填充"),type:"error"}),!1;var h=t.F.get("PivotTable"),f=h?h.instance.pivotRangeHelpers.hasPivotTableInRange:null;if(f&&n.some(function(t){return f(i,t)}))return m({title:s()("您选择的范围里包含数据透视表，无法填充"),type:"error"}),!1;var v=function(t,i,n){var r,u=t.getText(i,n);if(!(u=u&&u.trim()))return;if(n>0){var o=t.isRangeReadableByLock(i,n-1,1,1),s=t.getText(i,n-1);o&&s&&s.length&&(r=O(u,s))}if(r)return a(a({},r),{direction:e.a.Forward});n>0&&(r=y(t,u,i,n,e.a.Forward));if(r)return r;if(n<t.H()-1){var o=t.isRangeReadableByLock(i,n+1,1,1),l=t.getText(i,n+1);o&&l&&l.length&&(r=O(u,l))}if(r)return a(a({},r),{direction:e.a.Backward});n<t.H()-1&&(r=y(t,u,i,n,e.a.Backward));if(r)return r}(i,o,l);if(!v)return m({title:s()("填充失败，请尝试输入一些参考数据，再执行智能填充。"),type:"error"}),!1;var d=function(t,i,n){var r=[],e=[];return i.forEach(function(i){for(var u=C(t,i),o=u.row,s=u.col,a=u.rowCount,l=(u.colCount,o+1);l<o+a;l++)if(!t._isRowFilterOut||!t._isRowFilterOut(l)){var c=t.getSpan(l,s),h=p(t,l,s),f=p(t,l,s).attrs,v=void 0;if(c&&c.row!==l)v=t.getValue(l,s);else{var d=t.getValue(l,s);v=(v=R(n,t,l,s))&&v.length?isNaN(+v)?v:+v:d}r.push([l,s,h,{value:v,attrs:f}]),e.push([l,s,v,f])}}),{newCells:e,collectedCells:r}}(i,n,v),F=d.newCells,j=d.collectedCells,D=[{fnName:"editCell2Changeset",params:t.opProcessor([i.guid(),j,{skipParseFormat:!0}])}];return w({obj:i,func:b,suspendCalcService:!0})(i,F),t.emit(g.AfterCellsChanged,{sheet:i,cellsData:F}),t.actions.calcOperator({operator:D,isCalcInWorker:F.length>1e3,label:"intelligentFillAreaShortCut"}),!0};var r=n(3),e=n(2250),u=n(2203),o=n(0),s=n.n(o),a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)},l=r.sheets.range,c=r.sheets,h=c.sheet,f=c.alert,v=c.perf,d=c.cellCommand,g=c.Events,A=h.getActiveCell,p=h.getCell,m=f.showAlert,w=v.paintWrap,b=d.setBulkCells,C=l.fixRange;function O(t,i){if((i=i&&i.trim())===t)return{name:e.b.CutOff,isEqual:!0};var n=i.indexOf(t),r=i[n-1],u=i[n+t.length],o=r?i.slice(0,n-1).split(r).length:0,s=u?i.slice(0,n+t.length).split(u).length:0;return n>-1?{name:e.b.CutOff,cutHeadChar:i[n-1],cutTailChar:i[n+t.length],headCharCount:o,tailCharCount:s}:void 0}function y(t,i,n,r,u){var o,s=!1,a="";if(u===e.a.Forward)for(var l=r-1;l>-1;){var c=t.isRangeReadableByLock(n,l,1,1);if((v=t.getText(n,l))&&v.trim().length&&c){var h=v+a;if(i.indexOf(h)>-1&&(s=!0,a=h,h&&(o=l),l--),-1===i.indexOf(h))break}else l--}if(u===e.a.Backward)for(var f=r+1;f<t.H();){var v;c=t.isRangeReadableByLock(n,f,1,1);if((v=t.getText(n,f))&&v.trim().length&&c){h=a+v;if(i.indexOf(h)>-1&&(s=!0,a=h,h&&(o=f),f++),-1===i.indexOf(h))break}else f++}if(s){var d=i.indexOf(a),g=i.slice(0,d),A=i.slice(a.length+d);return{name:e.b.Join,direction:u,toCol:o,paddingHeadChar:g,paddingTailChar:A}}}function R(t,i,n,r){switch(t.name){case e.b.CutOff:var u="",o=t.cutHeadChar,s=t.cutTailChar,a=t.isEqual,l=t.headCharCount,c=t.tailCharCount;if(t.direction===e.a.Forward?i.isRangeReadableByLock(n,r-1,1,1)&&(u=i.getText(n,r-1)):i.isRangeReadableByLock(n,r+1,1,1)&&(u=i.getText(n,r+1)),u&&u.length)return function(t,i,n,r,e,u){if(r)return n;var o,s,a;if(t){var l="",c=n.split(t);l=c.filter(function(t,i){return i<e}).join(t),o=l.length,a=o>-1}if(i){var l=void 0,c=n.split(i);l=c.filter(function(t,i){return i<u}).join(i),s=l.length,a=s>-1}if(!a)return;return o=o?o+1:0,s=s||n.length,n.slice(o,s)}(o,s,u,!!a,l,c);break;case e.b.Join:var h=t.toCol;return function(t,i,n,r,u,o,s){var a,l="";if(r===e.a.Forward)for(a=s-1;a>u-1;)if(t.isRangeReadableByLock(o,a,1,1)){var c=t.getText(o,a);l=c+l,a--}else a--;else for(a=s+1;a<u+1;)if(t.isRangeReadableByLock(o,a,1,1)){var c=t.getText(o,a);l+=c,a++}else a++;return""+i+l+n}(i,t.paddingHeadChar,t.paddingTailChar,t.direction,h,n,r)}}},2250:function(t,i,n){"use strict";var r,e;n.d(i,"b",function(){return r}),n.d(i,"a",function(){return e}),function(t){t[t.CutOff=0]="CutOff",t[t.Join=1]="Join"}(r||(r={})),function(t){t[t.Forward=0]="Forward",t[t.Backward=1]="Backward"}(e||(e={}))},2368:function(t,i,n){"use strict";i.a=function(t,i,n,r,o){!function(t,i,n,r,e,o){for(var s=[],a={},l=n.row,c=n.col,h=n.rowCount,f=n.colCount,v=r.row,d=r.col,g=r.rowCount,A=r.colCount,p=v;p<v+g;p++)for(var m=d;m<d+A;m++){var w=e[p+"-"+m];if(w){var b=C(p,m);if(o(p,w,b)){a[v]=!0,s.push(p);break}}}function C(t,n){var r=0===i||1===i,u=r?t:(t-l)%h+l,o=r?(n-c)%f+c:n;return e[u+"-"+o]}u.sheets.cellCommand.autofitRows(t,s)}(t,i,n,r,o,function(i,n,r){var u=r.style||{},o=n.hasOwnProperty("value")?n.value:r.value,s=n.hasOwnProperty("formula")?n.formula:r.formula,a=n.style||{};if(!(u.backgroundImageSize===a.backgroundImageSize||e()(u.backgroundImageSize)&&e()(a.backgroundImageSize)))return!0;if(!e()(o)||s){var l=u.wordWrap,c=a.wordWrap;if(t._getActualRowHeight(i)<C)return!0;if((l&&"text-no-wrap"!==l||c&&"text-no-wrap"!==c)&&(l!==c||["text-wrap","text-linebreak-overflow"].includes(l)))return!0;var h=v(a),f=v(u),d=m(f["font-size"],u.richText),g=m(h["font-size"],a.richText);if(d&&9!==d||g&&9!==g)return!0;if(f["font-family"]!==h["font-family"]&&(b(f["font-family"])||b(h["font-family"])))return!0}else{if(t._getActualAutoFitRowHeight(i)>t._getActualRowHeight(i))return!0;if(u&&u.cellType&&"8"===u.cellType.typeName){var d=m(w(u),u.richText),g=m(w(a),a.richText);return d!==g&&!!(d&&9!==d||g&&9!==g)}}return!1})},i.b=function(t){var i,n=t.type,r=t.A,e=t.E,u=t.cachedAttributes,o=t.cachedOps,c=[],v={type:n,A:r,sheet:e,cachedAttribute:u},p=o.filter(function(t){return"conditionalFormats2Cs"===t.fnName})[0];if(p){var m=Object.assign(v,{operator:p});i=function(t){var i=l.Fill.AutoFillType,n=t.type,r=t.cachedAttribute,e=t.A,u=t.operator,o=t.sheet,a=[],c=r.conditionFormatRules,h=r.realFillRange,f=function(t){var i=t.F.get("ConditionalFormat");if(i&&i.instance)return i.instance;return null}(e);if(!f)return[];var v="conditionalFormats2Cs",d=s()(u.params[1]);a.push({fnName:v,params:[o.guid(),f.removeRulesByRanges(o,[h],!1)]});var g={};if(n===i.fillWithoutFormatting)g=c;else for(var A in d)d[A]&&(g[A]=d[A]);Object.keys(g).length&&a.push({fnName:v,params:[o.guid(),g]});return f.applyChanges(o,g,!1),f.refreshSheetRules(o),a}(m)}i instanceof Array?c.push.apply(c,i):c.push(i);var w,b=o.filter(function(t){return"validation2Cs"===t.fnName})[0];if(b){var C=Object.assign(v,{operator:b});w=function(t){var i=l.Fill.AutoFillType,n=function(t){var i=t.F.get("DataValidation");if(i&&i.instance)return i.instance;return null}(t.A);if(n){var r=t.sheet,e=t.type,u=t.operator;if(e===i.fillWithoutFormatting&&u){var o=u.params[1],s=[];for(var a in o){var c=o[a],h=a.substring(17),f=A(h),v=n.findRuleByRange(r,f);c?v&&s.push([f,v]):n.applyRule(r,f,null,!1)}return s.forEach(function(t){n.applyRule(r,t[0],t[1],!1)}),[u]}if(e===i.fillFormattingOnly){var d=t.cachedAttribute,g=d.validationRules,p=d.realFillRange,m=n.resetRules(r,p,g);return m}}return[]}(C)}w instanceof Array?c.push.apply(c,w):c.push(w);var O=function(t){var i,n,r,e=t.sheet,u=t.type,o=l.Fill.AutoFillType,s=t.cachedAttribute,a=s.dateMention,c=s.realFillRange;if(u===o.fillFormattingOnly){var h={};for(var f in a)if(!(null===(i=e.dateMentions)||void 0===i?void 0:i._dateMentions[f])){null===(n=e.dateMentions)||void 0===n||n.set(f,a[f],e),h["date-mention-"+f]=JSON.stringify(a[f].rule);var v=a[f],d=v.row,g=v.col;e.addCellExtendTag(d,g,"dateMention",f)}return[{fnName:"tableAttrs2Cs",params:[e.guid(),h]}]}for(var f in a){var A=a[f],d=A.row,g=A.col,p=c.row,m=c.col,w=c.colCount,b=c.rowCount;d>=p&&g>=m&&d<d+b&&g<g+w&&(null===(r=e.dateMentions)||void 0===r||r.remove(f))}return[]}(v);O instanceof Array?c.push.apply(c,O):c.push(O);var y=function(t){var i=t.A,n=t.E,r=t.type,e=t.originCells,u=t.copyFillCells,o=(t.cachedAttributes,[]),s=[],c=l.Fill.AutoFillType,v=function(t,i){for(var n in t)i[n]||(i[n]=null);return i};for(var A in u){var p=u[A],m=p[0],w=p[1],b=p[2],C=p[3],O=e[A],y=O[2],R=O[3],F=r===c.fillWithoutFormatting?{value:null,attrs:a({},C)}:{value:null,attrs:{}},j=r===c.fillWithoutFormatting?{value:b,attrs:v(a({},C),a({},R))}:{value:y,attrs:a({},C)},D=R.formula,T=void 0===D?null:D,S=R.remarks,M=void 0===S?null:S,_=R.link,N=void 0===_?null:_,x=R.backgroundImage,k=void 0===x?null:x,E=R.backgroundImageLayout,B=void 0===E?null:E,I=R.backgroundImageSize,V=void 0===I?null:I,U=R.autoFormatter,L=void 0===U?null:U,P=R.richText,Q=void 0===P?null:P,Y=R.dateMention,H=void 0===Y?null:Y,G=R.checkbox,W=void 0===G?null:G,X=C.backgroundImage,K=void 0===X?null:X,Z=C.backgroundImageLayout,q=void 0===Z?null:Z,J=C.backgroundImageSize,z=void 0===J?null:J,$=C.autoFormatter,tt=void 0===$?null:$,it=C.richText,nt=void 0===it?null:it,rt=C.dateMention,et=void 0===rt?null:rt,ut=C.checkbox,ot=void 0===ut?null:ut,st=C.link,at=void 0===st?null:st;j.attrs.formula=r===c.fillWithoutFormatting?C.formula:T,j.attrs.backgroundImage=r===c.fillWithoutFormatting?K:k,j.attrs.backgroundImageLayout=r===c.fillWithoutFormatting?q:B,j.attrs.backgroundImageSize=r===c.fillWithoutFormatting?z:V,j.attrs.autoFormatter=r===c.fillWithoutFormatting?L:tt,j.attrs.richText=r===c.fillWithoutFormatting?nt:Q,j.attrs.dateMention=r===c.fillWithoutFormatting?et:H,j.attrs.checkbox=r===c.fillWithoutFormatting?ot:W,j.attrs.link=r===c.fillWithoutFormatting?at:N,j.value instanceof Date&&(j.value=g(j.value)),j.attrs.remarks=M,h(n,m,w,M),o.push([m,w,F,j]),s.push([m,w,j.value,j.attrs])}return f({obj:n,func:d,suspendCalcService:!0})(n,s),[{fnName:"editCell2Changeset",params:i.opProcessor([n.guid(),o,{skipParseFormat:!0}])}]}(t);return y instanceof Array?c.push.apply(c,y):c.push(y),c};var r=n(19),e=n.n(r),u=n(3),o=n(90),s=n.n(o),a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)},l=u.sheets.Core.Spread.Sheets,c=u.sheets,h=c.remarks.resetRemarks,f=c.perf.paintWrap,v=c.cell.collectFontAttrs,d=c.cellCommand.setBulkCells,g=c.utils.toOADate,A=c.range.strToRange,p=u.sheets.cell,m=p.getCellMaxFontSize,w=p.getFontSizeFromStyle,b=p.isSupportedFont;var C=22},2562:function(t,i){t.exports=function(i){i.Spread.Sheets.Fill=t.exports=function(t){var i={};function n(r){if(i[r])return i[r].exports;var e=i[r]={i:r,l:!1,exports:{}};return t[r].call(e.exports,e,e.exports,n),e.l=!0,e.exports}return n.m=t,n.c=i,n.d=function(t,i,r){n.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},n.p="",n(n.s=14)}([function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),n.d(i,"ROW_COUNT",function(){return l}),n.d(i,"COLUMN_COUNT",function(){return c}),n.d(i,"NUMBER_STRING",function(){return h}),n.d(i,"SER_NUMBER_STRING",function(){return f}),n.d(i,"SER_STRING",function(){return v}),n.d(i,"MONTH_STRING",function(){return d}),n.d(i,"DAY_STRING",function(){return g}),n.d(i,"WEEK_STRING",function(){return A}),n.d(i,"DATE_STRING",function(){return p}),i.getValType=function(t){switch(!0){case t instanceof Date:return p;case m(t):return h;case C(t):return g;case b(t):return A;case O(t):return d;case w(t):return f+t.toString().split(".").length;case y(t):return v;default:return null}},i.toArray=function(t){var i=[t];return i.rowCount=1,i.colCount=t.length,i},i.isNumber=m,i.isSerialNum=w,i.isWeek=b,i.isDay=C,i.isMonth=O,i.isAllSame=function(t){return!t.length||!t.some(function(i){return i!==t[0]})},i.isSameStep=function(t){if(t.length<=2)return!0;var i=t[1]-t[0];return!t.some(function(n,r){return 0!==r&&i!==n-t[r-1]})},i.isSerialString=y,i._hasOwnProperty=R,i._CopyProperty=function(t,i){for(var n in i)R(i,n)&&(t[n]=i[n])},i.printException=F,i.isValidRange=function(t,i,n,r,e,u){if(-1<=t&&t<e&&-1<=i&&i<u){if(-1===t&&-1===i)return!0;if(-1===t){if(0!==r&&i+r<=u)return!0}else if(-1===i){if(0!==n&&t+n<=e)return!0}else if(0!==r&&i+r<=u&&0!==n&&t+n<=e)return!0}return!1},i.cellRangeInflate=function t(i,n){var r=i.length;for(var e=0;e<r;e++){var u=i[e];if(n.intersect(u.row,u.col,u.rowCount,u.colCount))return i.splice(e--,1),t(i,n.union(u))}return n},i.isDefined=function(t){return void 0!==t},i.createElement=function(t){return document.createElement(t)},i.documentInsertBefore=function(t){document.body&&document.body.insertBefore(t,null)},i.cancelDefault=function(t){t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1);return!1},i._getPreferredZIndex=function(t){var i=document.body,n=t;for(;n&&n.parentElement&&n.parentElement!==i;)n=n.parentElement;var r,e=1e3;n&&n.parentElement===i&&(r=parseInt(s(n).css("z-index")),isNaN(r)||(e+=r));return e},i.device=function(){var t,i,n,r,e=navigator.userAgent,u=e.match(/iPad/i);u&&(t=u[0])&&(i="ipad"===t.toLowerCase());(u=e.match(/iPhone/i))&&(t=u[0])&&(n="iphone"===t.toLowerCase());(u=e.match(/android/i))&&(t=u[0])&&(r="android"===t.toLowerCase());return{ipad:!!i,iphone:!!n,android:!!r}},n.d(i,"browser",function(){return j}),i._createRange=function(t,i,n,r){return new o.a.Range(t,i,n,r)},i._fixRange=function(t,i){var n=i.row,r=i.col,e=i.rowCount,u=i.colCount,o=t.G(),s=t.H();return e=-1===n||-1===e?o:e,u=-1===r||-1===u?s:u,n=-1===n?0:n,r=-1===r?0:r,e=Math.min(o-n,e),u=Math.min(s-r,u),{row:n,col:r,rowCount:e,colCount:u}},i.spanContainsFilteredRow=function(t,i){if(t._isRowFilterOut)for(var n=i.row;n<i.row+i.rowCount;n++)if(t._isRowFilterOut(n))return!0;return!1},i._getColor=function(t,i){if(t&&i){var n=t._currentTheme;if(n)return n.getColor(i)}return i};var r=n(3),e=n.n(r),u=n(1),o=n.n(u),s=o.a.GC$,a=e.a._isNumber,l="rowCount",c="colCount",h="number",f="serialNumber",v="serialString",d="monthString",g="day",A="week",p="date";function m(t){return"string"!=typeof t&&a(t)}function w(t){if(!t)return!1;return t="string"!=typeof t?t.toString():t,/^\d+\.(\d+\.)+\d+$/.test(t)}function b(t){return/^周[一,二,三,四,五,六,天,日]$/.test(t)}function C(t){return/^星期[一,二,三,四,五,六,天,日]$/.test(t)}function O(t){return-1!==["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"].indexOf(t)||-1!==["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"].indexOf(t)}function y(t){return/.*\d$/.test(t)}function R(t,i){return Object.prototype.hasOwnProperty.call(t,i)}function F(t){}var j=function(){var t=navigator.userAgent,i=function(t){t=t.toLowerCase();var i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:i[1]||"",version:i[2]||"0"}}(t),n={};i.browser&&(n[i.browser]=!0,n.version=i.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),t.indexOf("PhantomJS")>=0&&(n.safari=!1,n.chrome=!0);var r=t.toLowerCase();r.indexOf("compatible")<0&&null!==/(trident)(?:.*? rv ([\w.]+)|)/.exec(r)&&(n.mozilla=void 0,n.msie=!0);var e=/Edge\/\d+/.exec(t);return null!==e&&e.length>0&&(n.webkit=void 0,n.chrome=void 0,n.msie=!0,n.edge=!0,n.version=e[0].substr(e[0].indexOf("/")+1)),n.msie&&function(){var t=null,i=!1;try{new ActiveXObject("htmlfile")}catch(i){t=i.name}try{i=!!new ActiveXObject("htmlfile")}catch(t){i=!1}return!(i="ReferenceError"===t||!1!==i)}()&&(n.metroMode=!0),t.indexOf("QQBrowser")>-1&&(n.QQBrowser=!0),n}()},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.Sheets},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.Common},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.Common._Types},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),n.d(i,"SR",function(){return s}),n.d(i,"sR",function(){return a});var r=n(2),e=n.n(r),u=n(15),o=n.n(u),s={};function a(){return e.a._getResource(s)()}s.en=o.a,i.default={SR:s}},function(t,i,n){"use strict";var r=n(0),e=n(3),u=n.n(e),o=n(2),s=n.n(o),a=s.a._growth,l=s.a._leastSquare,c=u.a._isNullOrUndefined,h=function(){function t(t){this._startIndex=t}return t.prototype.add=function(t,i){c(this._type)&&(this._type=Object(r.getValType)(i)),this._indexes.push(t),this._innerValues.push(i)},t.prototype._dataCount=function(){return this._innerValues&&this._innerValues.length},t.prototype._values=function(){return this._innerValues},t.prototype._insert=function(t,i,n){c(this._type)&&(this._type=Object(r.getValType)(n)),this._indexes.splice(t,0,i),this._innerValues.splice(t,0,n)},t.prototype._indexes2=function(){var t=this._indexes,i=t?t.length:0;if(i>0){var n=this._startIndex,r=[],e=void 0;for(-1===n&&(n=t[0]),e=0;e<i;e++)r[e]=t[e]-n+1;return r}return null},t.prototype.valueConverter=function(){var t=this._innerValues;return t&&t.length?t:null},t.prototype._toActualValue=function(t){return t},t.prototype.getTrendOrGrowthValue=function(t,i,n,e,u){u=u||this.valueConverter(),e=e||this._indexes2();var o,s=Object(r.toArray)(u),l=Object(r.toArray)(e),c=Object(r.toArray)([n]),h=(o=t?this.trend(s,l,c,!0,function(t){return t},null,null,null,i):a(s,l,c,!0,null,null,null))&&o[0][0];return typeof h===r.NUMBER_STRING&&h.toString().length>15?+h.toPrecision(16):h},t.prototype._getInnerIncrease=function(t,i,n,e){var u=Object(r.getValType)(t);if(!u)return null;var o=null;if(i===u){if(this.patternMatch&&!this.patternMatch(t))return null;o=n?e?n.colCount:n.rowCount:1}return o},t.prototype.patternMatch=function(t){return!0},t.prototype.trend=function(t,i,n,e,u,o,s,a,c){var h,f,v,d=[],g=this.resultConverter&&this.resultConverter.bind(this),A=i[r.ROW_COUNT],p=i[r.COLUMN_COUNT],m=t[r.ROW_COUNT],w=t[r.COLUMN_COUNT],b=n[r.ROW_COUNT],C=n[r.COLUMN_COUNT];if(m!==A||w!==p)return null;var O=l(i,t,A,p),y=O.mm,R=O.d;for(h=0;h<b;h++)for(d[h]=[],f=0;f<C;f++)v=y*n[h][f]+R,this._type!==r.WEEK_STRING&&this._type!==r.DAY_STRING&&this._type!==r.MONTH_STRING||v%1==0||(v=t[0][c%p]),d[h][f]=(g?g(v):v)||"";return d},t.prototype.resultConverter=function(t){return t},t}();i.a=h},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.CalcEngine},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(4),e=n(0),u=n(16),o=c(n(1)),s=c(n(6)),a=c(n(2)),l=c(n(8));function c(t){return t&&t.__esModule?t:{default:t}}var h=e._createRange,f=o.default._supportsCalc,v=a.default._Types,d=Math.floor,g=v._isNullOrUndefined,A=a.default._ArrayHelper._getLength,p=a.default._DateTimeHelper,m=p._toOADate,w=p._fromOADate;function b(t,i){this.PM=t,this.collectedCells=i}function C(t,i){switch(!0){case(0,e.isDay)(t):case(0,e.isWeek)(t):return new u.DaySource;case(0,e.isMonth)(t):return new u.MonthSource;case t instanceof Date&&l.default.isDateFormatter(i):return new u.DateSource;case(0,e.isNumber)(t):case(0,e.isSerialNum)(t):return new u.NumberSource;case(0,e.isSerialString)(t):return new u.SerialStringSource}}function O(t){return h(t.row,t.col,t.rowCount,t.colCount)}b.prototype={_fillLinearOrGrowth:function(t,i,n,r,e){var u=t?1:2;g(r)&&g(e)?this._seriesFillRange(i,n,u):this._seriesFillRange(i,n,u,r,e,null)},_seriesFillRange:function(t,i,n,e,u,o){var s=this.PM,a=s._getActualRange(t),l=a.row,c=a.col,h=a.rowCount,f=a.colCount;if(s._getSpanModel().hasSpans(l,c,h,f))throw new Error((0,r.sR)().Exp_RangeContainsMergedCell);var v,d,g,p,m,w=arguments.length>3,b=0,C=1===i,O=C?f:h,y=C?l:c,R=C?l+h:c+f,F=w?1:O,j=this.PM.OK._fillStartRange,D=j.row===l&&j.rowCount===h&&j.col>c||j.col===c&&j.colCount===f&&j.row>l;for(v=y;v<R;v++){var T=D&&w?c+f-1:c,S=D&&w?l+h-1:l,M=C?this._getSeriesSource(v,T,1,F,i):this._getSeriesSource(S,v,F,1,i);if(M&&M._dataCount())for(p=M._indexes[0],w?(m=D?M._innerValues[A(M._innerValues)-1]:M._innerValues[0],d=this._calcSeriesData(D,m,O,n,e,u,o),D&&(b=O-A(d),p=M._indexes[A(M._indexes)-1])):d=this._calcSeriesTrendData(M,O,n),g=0;g<A(d);g++){var _=M._toActualValue(d[g]);C?this._copyCell(s,v,p,v,c+b+g,_,n,!1,void 0,void 0,!0):this._copyCell(s,p,v,l+b+g,v,_,n,!1,void 0,void 0,!0)}}},_getSeriesSource:function(t,i,n,r,o){for(var s,a=null,l=this.PM,c=1===o,h=c?i+r-1:t+n-1,f=c?i:t;h>=f;)s=c?l.getValue(t,h):l.getValue(h,i),(0,e.isNumber)(s)&&(a||(a=new u.NumberSource(f)),a._insert(0,h,s)),h--;return a},_calcSeriesData:function(t,i,n,r,e,u,o){var s,a=[],l=i,c=e>=0,h=g(u);for(s=0;s<n;s++){var f=l>=u,v=l<=u;t&&(h||c&&f||!c&&v)?(a.unshift(l),1===r?l-=e:2===r?l/=e:3!==r||g(o)||(l=this._getNextDateValue(!0,o,i,l,e,s+1))):!t&&(h||c&&v||!c&&f)&&(a.push(l),1===r?l+=e:2===r?l*=e:3!==r||g(o)||(l=this._getNextDateValue(!1,o,i,l,e,s+1)))}return a},_calcSeriesTrendData:function(t,i,n){var r,e=[],u=1===n;if(u||2===n){for(1===t._dataCount()&&t.add(t._indexes[0]+1,u?t._toActualValue(t._innerValues[0]+1):t._values()[0]),r=0;r<i;r++)e.push(t.getTrendOrGrowthValue(u,r,r+1));return e}return null},_fillAuto:function(t,i,n,e){var u=this.PM,o=u._getSpanModel(),s=u._getActualRange(t),a=s.row,l=s.col,c=s.rowCount,h=s.colCount,f=u._getActualRange(u.OK._fillStartRange),v=f.row,d=f.col;if(o.hasPartSpans(v,d,f.rowCount,f.colCount)||o.hasPartSpans(a,l,c,h))throw new Error((0,r.sR)().Exp_ChangeMergedCell);for(var g=c,A=a;A<a+c;A++)u._isRowFilterOut&&u._isRowFilterOut(A)&&g--;return this._autoFillRange(f,g,h,i,n,!(a<v||l<d),e)},_autoFillRange:function(t,i,n,e,u,o,s){var a,l,c,f,v=this.PM,g=o?1:-1,A=t.row,p=t.col,m=t.rowCount,w=t.colCount;if(!u){var b=function(){switch(!0){case 1===e&&o:return{row:t.row,col:t.col+t.colCount,rowCount:t.rowCount,colCount:n-t.colCount};case 1===e&&!o:return{row:t.row,col:t.col+t.colCount-n,rowCount:t.rowCount,colCount:n-t.colCount};case 1!==e&&o:return{row:t.row+t.rowCount,col:t.col,rowCount:i-t.rowCount,colCount:n};default:return{row:t.row+t.rowCount-i,col:t.col,rowCount:i-t.rowCount,colCount:n}}}(),C=v&&v._getCalcModel();if(C&&C._intersectWithArrayFormula(b.row,b.col,b.rowCount,b.colCount))return v&&v._raiseInvalidOperation(4,(0,r.sR)().Exp_ArrayFromulaPart,{message:(0,r.sR)().Exp_ArrayFromulaPart}),null}if(1===e){if(a=d(n/w),l=n%w,!u)for(f=1;f<a;f++)c=h(A,p+f*g*w,m,w),this._copyRange(t,c,e,4,u,void 0,void 0,void 0,void 0,s,[]);if(u&&a>1&&0===l&&(a-=1,l=w),a>0&&l>0)return c=h(A,o?p+a*w:p-a*w+w-l,m,l),this._copyRange(t,c,e,4,u,o,null,o?0:w-l,void 0,s,[])}else{for(var O=[],y=A;y<A+m;y++)this.PM._isRowFilterOut&&this.PM._isRowFilterOut(y)&&O.push(y);var R=m-O.length;a=d(i/R),l=i%R;var F=0;if(!u){var j=0,D=0,T=0;for(f=1;f<a;f++){var S=R;if(o){for(T=A+f*g*R+(o?O.length:0),T=Math.max(j,T);this.PM._isRowFilterOut&&this.PM._isRowFilterOut(T);)T++,F++;for(var M=T;M<T+S;M++)this.PM._isRowFilterOut&&this.PM._isRowFilterOut(M)&&(S++,F++);j=T+S*g}else{var _=A-1;for(1===f&&(D=A),_=Math.min(D-1,_);this.PM._isRowFilterOut&&this.PM._isRowFilterOut(_);)_--,F++;var N=0;for(T=_;N<R;)this.PM._isRowFilterOut&&!this.PM._isRowFilterOut(T)?N++:F++,N<R&&T--;S=_-T+1,D=T}c=h(T,p,S,w),this._copyRange(t,c,e,4,u,o,null,null,!0,s,O)}}if(u&&a>1&&0===l&&(a-=1,l=m),a>0&&l>0){for(var x=i%R,k=o?A+a*R+O.length+F:A-a*R+x-F;this.PM._isRowFilterOut&&this.PM._isRowFilterOut(k);)o?k++:k--;return c=h(k,p,l,w),this._copyRange(t,c,e,4,u,o,o?0:R-l,null,!0,s,O)}}},_copyRange:function(t,i,n,r,u,o,s,a,l,c,h){h||(h=[]);var f,v,d,g,A,p=this.PM,m=null,w=1===n,b=w?t.row:t.col,O=w?t.col:t.row,y=w?i.row:i.col,R=w?i.col:i.row,F=w?t.rowCount-h.length:t.colCount,j=w?t.colCount:t.rowCount-h.length,D=w?i.colCount:i.rowCount,T=p.getArrayExpressionCellsInRange(t);for(g=0;g<F;g++){for(var S=null,M=null,_=0,N=b+g,x=y+g,k=N,E=x,B=(w?a:s)||0,I=w?0:B,V=w?null:l;_<j;){var U=O+_,L=R+_-B,P=null,Q=U,Y=L;if(!w){N=[U,U=k][0];for(var H=h.filter(function(t){return t<N});h.includes(N);)N++;for(N+=H.length,x=[L,L=E][0];p._isRowFilterOut&&p._isRowFilterOut(x);)x++}d=p._getSpanModel().find(N,U),f=p.getFormula&&p.getFormula(N,U);var G=p.getArrayValueMark(N,U);f&&""!==f||G&&T[G]||(P=p.getValue(N,U));var W=P,X=p.getCellType&&p.getCellType(N,U);if(X&&"8"==X.typeName&&(W=""),4===r){var K=p.getFormatter(N,U)||p.getAutoFormatter(N,U);if(S=S||C(W,K),v=(0,e.getValType)(W),M||(M=v),S&&(m=S._getInnerIncrease(W,M,d,w))){S.add(Q,W),_+=m;continue}}if(W&&S&&S._dataCount()){if(A=this._autoFillTrendValues(w,t,i,k,E,S,u,o,I,V,c,h),u&&(A||0===A))return A;S=null,M=null}else{if(!d||d&&(w?d.row:d.col)===k){for(var Z=Y===R+D-1;!w&&p._isRowFilterOut&&p._isRowFilterOut(Y);)Y++;if(u){if(d&&Z||!d&&(Z&&o||!o&&Y===R))return P}else Y<R+D&&Y>=R&&(w||!w&&!(l&&p._isRowFilterOut&&p._isRowFilterOut(Y)))&&this._copyCell(p,N,U,x,L,P,r,c,t,i,!1)}d?_+=w?d.colCount:d.rowCount:_++}}if(S&&S._dataCount()&&(A=this._autoFillTrendValues(w,t,i,k,E,S,u,o,I,V,c,h),u&&(A||0===A)))return A}return null},_copyCell:function(t,i,n,r,u,o,a,l,c,h,v){if(i!==r||!t._isRowFilterOut||!t._isRowFilterOut(i)){var d,g,A=t._getSpanModel(),p=this.collectedCells,m=r+"-"+u;p[m]?p[m].value=o:p[m]={value:o};var w=t.XT(i,n);if(f&&(w||t.XT(r,u))){var b=t.getFormulaInformation(r,u),C=b&&b.isArrayFormula;if(b&&b.XT&&!w&&(p[m].formula=null),C){var y=b.baseRange;r===y.row&&u===y.col&&t.setArrayFormula(y.row,y.col,y.rowCount,y.colCount,null)}else t.setFormula(r,u,null);if(0===a||4===a){d=t._getCalcModel();var R=t.getFormulaInformation(i,n);if(R.XT)if(R&&R.isArrayFormula){var F=R.baseRange;if(c){var j=function(t,i,n,r,e,u){switch(function(t,i,n,r){if(i>t)return"Down";if(i<t)return"Up";if(r>n)return"Right";if(r<n)return"Left"}(n,r,e,u)){case"Down":return{row:t.row,col:t.col,rowCount:i.rowCount,colCount:t.colCount};case"Up":return{row:t.row+(t.rowCount-i.rowCount),col:t.col,rowCount:i.rowCount,colCount:t.colCount};case"Right":return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:i.colCount};case"Left":return{row:t.row,col:t.col+(t.colCount-i.colCount),rowCount:t.rowCount,colCount:i.colCount}}return t}(c,h,i,r,n,u),D=O(F).getIntersect(O(j));D.row===i&&D.col===n&&s.default.CalcOperatorAdjustor.copyFormula(d,i,n,d,r,u,D.rowCount,D.colCount,void 0,void 0,Y)}else s.default.CalcOperatorAdjustor.copyFormula(d,i,n,d,r,u,1,1,void 0,void 0,Y)}else s.default.CalcOperatorAdjustor.copyFormula(d,i,n,d,r,u,1,1,void 0,void 0,Y)}}t.setValue(r,u,o);var T=16380;if(l&&(T|=128),t._copyToCore(i,n,r,u,1,1,T,void 0,void 0,p,{ignoreNumberText:!1,clearRichText:v,fromAutoFill:!0}),!A.isEmpty()&&(t.removeSpan(r,u,3),(g=A.find(i,n))&&!(0,e.spanContainsFilteredRow)(t,g)&&i===g.row&&n===g.col)){t._addSpanImp(r,u,g.rowCount,g.colCount,3),p[i+"-"+n].mergeInfo=g;for(var S=c.row,M=c.col,_=c.rowCount,N=c.colCount,x=h.row,k=h.col,E=h.rowCount,B=h.colCount,I=r;I<r+g.rowCount;I++)for(var V=u;V<u+g.colCount;V++)if(I!==r||V!==u){if(t.setValue(I,V,null),t.getFormula(I,V)&&t.setFormula(I,V,null),p){var U=t._getStyleObject(I,V);U&&U.cellType&&"8"===U.cellType.typeName&&(U=Object.assign({},U,{cellType:U.cellType.toJSON()})),p[I+"-"+V]={style:U}}if(I>x+E-1||V>k+B-1){i=(I-S)%_+S;var L=(V-M)%N+M,P=t._getStyleObject(i,L);if(P&&P.clone&&(P=P.clone()),P&&delete P.ignoreNumberTextPrompt,t._setStyleObject(I,V,P),p){var Q=i+"-"+L;P&&P.cellType&&"8"===P.cellType.typeName&&(P=Object.assign({},P,{cellType:P.cellType.toJSON()})),p[Q]?p[Q].style=P:p[Q]={style:P}}}}}}function Y(t){var i=t.formula,n=t.toRow+"-"+t.toColumn;p[n]?p[n].formula=i:p[n]={formula:i}}},_autoFillTrendValues:function(t,i,n,r,e,u,o,s,a,c,h,f){var v,d,g,A,p=this.PM,m=t?n.col:n.row,w=t?i.col:i.row,b=t?n.colCount:n.rowCount,C=t?i.colCount:i.rowCount-f.length,O=s?1:-1;a=a||0,s&&!t&&(a+=f.length);var y=0;if(!t)for(var R=s?i.row+i.rowCount:n.row,F=s?n.row:i.row,j=R;j<F;j++)p._isRowFilterOut&&p._isRowFilterOut(j)&&y++;s&&!t?a+=y:a-=y;var D=u._dataCount(),T=(m-w-a)/C,S=this._isArithmeticProgression(u._indexes,u.valueConverter());if(S){for(g=[],d=0;d<D;d++)g[d]=d+1;v=D}else{if(A=u._indexes[0],v=u._indexes[D-1]-A+1,1===D){var M=p.getFormatter(i.row,i.col)||p.getAutoFormatter(i.row,i.col),_=1;l.default.isTimeFormatter(M)&&(_=1/24),u.add(u._indexes[0]+1,u._toActualValue(u.increase(u._innerValues[0],_)))}g=u._indexes2()}for(d=0;d<v;d++){var N=u.getTrendOrGrowthValue(!0,d,v*T+d+1,g),x=m+b-1,k=S?u._indexes[d]:A+d,E=k+T*C;if(!t){for(E+=y*O,s&&(E+=f.length);p._isRowFilterOut&&p._isRowFilterOut(E);)E++;for(var B=f.filter(function(t){return t<k});f.includes(k);)k++;k+=B.length}if(o){if(S&&(s&&E===x||!s&&E===m)||!S&&E+a===x)return u._toActualValue(N)}else E<m+b&&E>=m&&(t?this._copyCell(p,r,k,e,E,u._toActualValue(N),4,h,i,n,!0):c&&p._isRowFilterOut&&p._isRowFilterOut(E)||this._copyCell(p,k,r,E,e,u._toActualValue(N),4,h,i,n,!0))}return null},_isArithmeticProgression:function(t,i){var n=A(i);if(n<=1||A(t)!==n)return!1;var r,e=t[1]-t[0],u=i[1]-i[0];for(r=2;r<n;r++)if(t[r]-t[r-1]!==e||i[r]-i[r-1]!==u)return!1;return!0},_fillAutoByDirection:function(t,i){var n,r=this.PM,u=r.getSpans(),o=r._getActualRange(t),s=o.row,a=o.col,l=o.rowCount,c=o.colCount;n=0===i?h(s,a+c-1,l,1):1===i?h(s,a,l,1):h(2===i?s+l-1:s,a,1,c),(n=(0,e.cellRangeInflate)(u,n))&&this._directionFillRange(n,s,a,l,c,i)},_directionFillRange:function(t,i,n,e,u,o){var s,a,l,c,f,v,g,A,p=t.row,m=t.col,w=t.rowCount,b=t.colCount,C=this.PM._getSpanModel();if(0===o?(A=C.hasSpans(i,n,e,u-b),v=0,g=-1*b,l=u,c=b,f=1):1===o?(A=C.hasSpans(i,n+b,e,u-b),v=0,g=b,l=u,c=b,f=1):2===o?(A=C.hasSpans(i,n,e-w,u),v=-1*w,g=0,l=e,c=w,f=0):(A=C.hasSpans(i+w,n,e-w,u),v=w,g=0,l=e,c=w,f=0),A)throw new Error((0,r.sR)().Exp_TargetContainsMergedCells);if(l%c!=0)throw new Error((0,r.sR)().Exp_MergedCellsIdentical);for(s=d(l/c),a=1;a<s;a++)this._copyRange(t,h(p+a*v,m+a*g,w,b),f,0)},_getNextDateValue:function(t,i,n,r,e,u){var o=t?-1:1,s=d(u*e),a=Math.abs(e),l=w(i>1?n:r);if(0===i)l.setDate(l.getDate()+o*e);else if(1===i)for(;a>0;)l.setDate(l.getDate()+o*(e>0?1:-1)),6!==l.getDay()&&0!==l.getDay()&&a--;else 2===i?l.setMonth(l.getMonth()+o*s):l.setFullYear(l.getFullYear()+o*s);return m(l)}},i.default=b},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.Formatter},function(t,i,n){"use strict";var r;Object.defineProperty(i,"__esModule",{value:!0}),i.sheetEx=i.regiterCmds=i.FILL_FEATURE_NAME=void 0;var e=n(4),u=n(0),o=l(n(1)),s=l(n(2)),a=l(n(7));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,i,n){return i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t}var h=o.default.Events,f=o.default.Exception,v=o.default.Commands,d=o.default._SheetModel,g=o.default._supportsCalc,A=o.default.GC$,p=f.triggerError,m=v._prepareCommands,w=s.default._Types._isNullOrUndefined,b=Math.max,C=Math.floor,O=v.ActionBase,y=v._ChangedCells,R=v._CopyMoveHelper,F=R._saveViewportInfo,j=R._raiseRangeDataChanged,D=v._CopyMoveCellsInfo,T="startRange",S="fillRange",M="realFillRange",_="autoFillType",N="fillDirection",x="srcRange",k=v._performUndo,E=v._saveColumnHeaderInfo,B=v._saveViewportInfoForDragDrop,I=v._saveTableInfo,V=v._saveRowHeaderInfo,U=i.FILL_FEATURE_NAME="fill";i.regiterCmds=m((c(r={},U,{canUndo:!0,execute:function(t,i,n){return v._executeCommand(t,G,i,n)}}),c(r,"dragDrop",{canUndo:!0,execute:function(t,i,n){return v._executeCommand(t,X,i,n)}}),r));function L(t){return t.rowCount}function P(t){return t.colCount}function Q(t,i){return t.G(i)}function Y(t,i){return t.H(i)}var H=function(t){function i(i,n){var r=n[N],e=0===r,o=e||1===r,s=n[S],a=(n[M],n[T]),l=a.row,c=a.col,h=L(a),f=P(a);t.call(this),this.PM=i,this._autoFillExtent=n,4===n[_]?this._clearValueUndoAction=new v._ClearValueUndoAction(i,[n[S]]):this._wholeFillRange=o?(0,u._createRange)(l,e?s.col:c,h,f+P(s)):(0,u._createRange)(2===r?s.row:l,c,h+L(s),f),this._fillSeries=o?1:0}A.inherit(i,t);var n={canExecute:function(){var t=this.PM,i=this._autoFillExtent,n=i[T],r=i[S];return!!t._canChange(r.row,r.col,L(r),P(r))&&(4===i[_]||!r.intersect(n.row,n.col,L(n),P(n)))},execute:function(){if(this.canExecute()){var t=this._autoFillExtent,i=t[S],n=this.PM;this._beforeAction(n);try{g&&n.suspendCalcService(),4===t[_]?this._executeDragFillClear(n):this._executeAutoFill(n)}catch(t){(0,u.printException)(t),p(t)}finally{this._afterAction(n),g&&n.resumeCalcService(!1),n._updateTableSlicer&&n._updateTableSlicer(i.row,i.col,L(i),P(i))}}},_executeDragFillClear:function(t){this._clearValueUndoAction.execute(t);var i,n=this._autoFillExtent,r=n[T],e=n[S],o=0===this._fillSeries,s=L(r),a=P(r),l=o?b(1,s-L(e)):s,c=o?a:b(1,a-P(e));r.equals(e)||(i=(0,u._createRange)(r.row,r.col,l,c),t._setActiveCellImp(b(t._getFirstVisualRow(),i.row),b(t._getFirstVisualColumn(),i.col),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.TH(i.row,i.col,L(i),P(i)))},_executeAutoFill:function(t){var i,n,r=this.PM,e=this._autoFillExtent[T],u=this._autoFillExtent[S],o=this._autoFillExtent[_],s=this._wholeFillRange,a={fillType:4,series:this._fillSeries,withTag:!0,collectedCells:this._autoFillExtent.collectedCells},l={fromAutoFill:!0};if(1===o){if(r.fillAuto(e,s,a),r._getSpanModel().hasSpans(e.row,e.col,e.rowCount,e.colCount))for(i=0;i<u.rowCount;i++)if(!r._isRowFilterOut||!r._isRowFilterOut(u.row+i))for(n=0;n<u.colCount;n++){var c=e.row+C(i%e.rowCount),h=e.col+C(n%e.colCount),f=r._getStyleObject(c,h);if(f&&f.clone&&(f=f.clone()),f&&delete f.ignoreNumberTextPrompt,r._setStyleObject(u.row+i,u.col+n,f),a.collectedCells){var v=c+"-"+h;f&&f.cellType&&"8"===f.cellType.typeName&&(f=Object.assign({},f,{cellType:f.cellType.toJSON()})),a.collectedCells[v]?a.collectedCells[v].style=f:a.collectedCells[v]={style:f}}}}else if(0===o)this._copyCells(e,u,15867,l);else if(6===o)this._copyCells(e,u,15867,l);else if(2===o)this._copyCells(e,u,192,l);else if(3===o){if(!(1!==L(e)||1!==P(e)||-1===e.row&&-1!==e.col||-1===e.col&&-1!==e.row)){this._copyCells(e,u,187,l)}else{var g=r._getActualRange(s),A=g.row,p=g.col,m=L(g),w=P(g),O=new d(L(g),P(g),null);for(i=0;i<m;i++)for(n=0;n<w;n++)O.setStyle(i,n,r._getStyleObject(A+i,p+n));for(r.fillAuto(e,s,a),i=0;i<m;i++)for(n=0;n<w;n++)r._setStyleObject(A+i,p+n,O.K(i,n))}}r._setActiveCellImp(b(t._getFirstVisualRow(),s.row),b(t._getFirstVisualColumn(),s.col),t._activeRowViewportIndex,t._activeColViewportIndex),t._selectionModel&&t._clearSelectionImp(),r.TH(s.row,s.col,L(s),P(s))},_copyCells:function(t,i,n,r){var e,u,o,s,a,l=this.PM,c=l._getActualRange(t),h=l._getActualRange(i),f=c.row,v=c.col,d=L(c),g=P(c),A=h.row,p=h.col,m=L(h),w=P(h),b=this._autoFillExtent[N],O=3===b,y=1===b,R=C(m/d),F=m%d,j=C(w/g),D=w%g,T=l.XT(f,v)?n:2^n;if(0===this._fillSeries){for(e=0;e<R;e++)s=O?A+e*d:A+m-(e+1)*d,l._isRowFilterOut&&l._isRowFilterOut(s)||l._copyToCore(f,v,s,p,d,g,T,!0,void 0,this._autoFillExtent.collectedCells,r);0!==F&&(u=O?f:f+(R+1)*d-m,s=O?A+d*R:A+m-R*d-F,l._isRowFilterOut&&l._isRowFilterOut(s)||(T=l.XT(u,v)?n:2^n,l._copyToCore(u,v,s,p,F,g,T,!0,void 0,this._autoFillExtent.collectedCells,r)))}else{for(e=0;e<j;e++)a=y?p+e*g:p+w-(e+1)*g,l._copyToCore(f,v,A,a,d,g,T,!0,void 0,this._autoFillExtent.collectedCells,r);0!==D&&(o=y?v:v+(j+1)*g-w,a=y?p+g*j:p+w-j*g-D,T=l.XT(f,o)?n:2^n,l._copyToCore(f,o,A,a,d,D,T,!0,void 0,this._autoFillExtent.collectedCells,r))}},saveState:function(){var t=this._autoFillExtent;4===t[_]?this._clearValueUndoAction.saveState():this._savedStartViewportCells=this._saveRangeStates(t[T]),this.PM.isDirtySuspended()||(this._savedBeforeFillChangedCells=new y(this.PM,t[S],16383)),this._savedFilledViewportCells=this._saveRangeStates(t[S])},_saveRangeStates:function(t){var i=this.PM,n=i._getActualRange(t),r=new D(L(n),P(n));return F(i,r,n.row,n.col,16383),r},undo:function(){var t=this.PM,i=!1;if(this.canUndo()){this._beforeAction(t,!0);try{g&&t.suspendCalcService();var n=t.getSelections(),r=this._autoFillExtent,e=t._fillDialog,o=r[S];i=4===r[_]?this._undoDragClear(t):this._undoDragFill(t),!t._skipCloseDragFillSmartTag&&e&&e.close(),j(t,o.row,o.col,L(o),P(o),this._savedAfterFilledChangedCells?this._savedAfterFilledChangedCells._getChangedCells():[],1),t._raiseSelectionChanging(n,t.getSelections())&&t.ME(n)}catch(t){(0,u.printException)(t),p(t)}finally{this._afterAction(t,!0),g&&t.resumeCalcService(!1)}}return i},_undoDragClear:function(t){var i=this._autoFillExtent[T],n=i.row,r=i.col,e=this._clearValueUndoAction.undo(t);return t._setActiveCellImp(b(t._getFirstVisualRow(),n),b(t._getFirstVisualColumn(),r),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.TH(n,r,L(i),P(i)),e},_undoDragFill:function(t){var i=this._autoFillExtent,n=i[T],r=n.row,e=n.col;g&&t.suspendCalcService();try{this._undoRangeStates(this._savedFilledViewportCells,i[S]),this._undoRangeStates(this._savedStartViewportCells,n),t._setActiveCellImp(b(t._getFirstVisualRow(),r),b(t._getFirstVisualColumn(),e),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.TH(r,e,L(n),P(n))}catch(t){(0,u.printException)(t),p(t)}finally{g&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},_undoRangeStates:function(t,i){var n=this.PM,r=n._getActualRange(i);R.AR(n,t,r.row,r.col,3)}};return A.extend(i.prototype,n),i}(O),G=function(t){function i(i,n){t.call(this),this.PM=i,this._fillExtent=n,this._startRange=n[T],this._fillRange=n[S],this._realFillRange=n[M],this._autoFillType=n[_],this._fillDirection=n[N],this._srcRange=n[x]}A.inherit(i,t);var n={execute:function(){var t=!1;if(this.canExecute()){var i=this.PM,n=this._fillRange;this._beforeAction(i,!0);try{var r=i.OK,e={sheet:i,sheetName:i._name,cancel:!1};e[S]=n,e[M]=this._realFillRange,e[_]=this._autoFillType,e[N]=this._fillDirection,this._srcRange&&(e[x]=this._srcRange),e[T]=this._startRange,i.NC(h.DragFillBlock,e),e.cancel||(r._currentAutoFillType=e[_],r._isCancelFill=e.cancel,e.collectedCells={},this._executeFillAction(e),delete e.cancel,i.NC(h.DragFillBlockCompleted,e),t=!0)}catch(t){(0,u.printException)(t),p(t)}finally{this._afterAction(i,!0)}}return t},_executeFillAction:function(t){var i=this.PM,n=i.OK,r=this._fillRange,e=this._autoFillType;if(n._currentAutoFillType=e,!n._isCancelFill){var u={};u[T]=this._startRange,u[S]=r,u[M]=t[M],u[_]=5===t[_]?e:t[_],u[N]=this._fillDirection,u.collectedCells=t.collectedCells;var o=new H(i,u);i.suspendEvent("executeFillAction");try{o.execute()}catch(t){throw t}finally{i.resumeEvent("executeFillAction")}this._fillExtent._fillUndoActionImp=o}},saveState:function(){this.PM.isDirtySuspended()||(this._savedBeforeFillChangedCells=new y(this.PM,this._fillRange,16383))},undo:function(){var t=!1;if(this.canUndo()){var i=this.PM,n=this._fillRange;this.saveState(),this._beforeAction(i);try{t=this._fillExtent._fillUndoActionImp.undo()}catch(t){(0,u.printException)(t),p(t)}finally{this._applyDataChanged(!1,i,n)}}return t},_applyDataChanged:function(t,i,n){this._afterAction(i,t);var r=[];i.isDirtySuspended()||(this._savedAfterFilledChangedCells=new y(i,n,16383),this._savedAfterFilledChangedCells._mergeCellsHasDiffData(this._savedBeforeFillChangedCells._getCellsData()),r=this._savedAfterFilledChangedCells._getChangedCells()),j(i,n.row,n.col,L(n),P(n),r,1)}};return A.extend(i.prototype,n),i}(O);function W(t,i,n,r,e){t._clearSelectionImp(),t.TH(i,n,r,e);var u=i>0?i:t._getFirstVisualRow(),o=n>0?n:t._getFirstVisualColumn();t._setActiveCellImp(u,o,t._activeRowViewportIndex,t._activeColViewportIndex)}function X(t,i){O.call(this),this.PM=t,this._command=i}A.inherit(X,O),A.extend(X.prototype,{canExecute:function(){var t=this.PM,i=this._command,n=i.fromRow,r=i.fromColumn,e=L(i),o=i.columnCount,s=i.toRow,a=i.toColumn;return!!(0,u.isValidRange)(n,r,e,o,Q(t),Y(t))&&(!(!i.insert&&!(0,u.isValidRange)(s,a,e,o,Q(t),Y(t)))&&(t._canChange(s,a,e,o,!!i.insert)&&t._canChange(n,r,e,o)))},execute:function(){var t=!1;if(this.canExecute()){var i,n,r,e=this.PM,o=this._command,s=o.fromRow,a=o.fromColumn,l=o.toRow,c=o.toColumn,h=o.rowCount,f=o.columnCount,v=o.option,d=o.collectedCells;this._beforeAction(e,!0);try{if(o.insert){if(a>=0&&s<0){i=a,n=c,r=f;var g=c,A=e._beforeUpdateArrayExprCellsByAddCols&&e._beforeUpdateArrayExprCellsByAddCols(n,r);e.L(n,r,!0),o.copy?(e.copyTo(-1,n<=i?i+r:i,-1,n,-1,r,v),e._updateArrayExprCellsByRowColOps&&A&&e._updateArrayExprCellsByRowColOps(A)):(e.moveTo(-1,n<=i?i+r:i,-1,n,-1,r,v,void 0,d),e._updateArrayExprCellsByRowColOps&&A&&e._updateArrayExprCellsByRowColOps(A),e.M(n<=i?i+r:i,r,!0),i<n&&(g=n-r)),W(e,-1,g,Q(e),r)}else if(s>=0&&a<0){i=s,n=l,r=h;var p=l;A=e._beforeUpdateArrayExprCellsByAddRows&&e._beforeUpdateArrayExprCellsByAddRows(n,r);e.addRows(n,r,!0),o.copy?(e.copyTo(n<=i?i+r:i,-1,n,-1,r,-1,v),e._updateArrayExprCellsByRowColOps&&A&&e._updateArrayExprCellsByRowColOps(A)):(e.moveTo(n<=i?i+r:i,-1,n,-1,r,-1,v,void 0,d),e._updateArrayExprCellsByRowColOps&&A&&e._updateArrayExprCellsByRowColOps(A),e.deleteRows(n<=i?i+r:i,r,!0),i<n&&(p=n-r)),W(e,p,-1,r,Y(e))}}else o.copy?e.copyTo(s,a,l,c,h,f,v):e.moveTo(s,a,l,c,h,f,v,{row:l,col:c,rowCount:h,colCount:f},d),e&&W(e,l,c,h,f);t=!0}catch(t){(0,u.printException)(t),W(e,s,a,h,f),e._raiseInvalidOperation(0,"string"==typeof t?t:t.message)}finally{e.OK._dragRect={},this._afterAction(e,!0)}}return t},_mergeCellsData:function(t,i,n,r,e,o,s){if(i&&i._isValueOrFormulaSaved()){var a=new y(t,(0,u._createRange)(r,e,o,s),this._command.option);return a._mergeCellsHasDiffData(n._getCellsData()),R._raiseRangeDataChanged(t,r,e,o,s,a._getChangedCells(),0),a}},saveState:function(){var t,i=this.PM,n=this._command,r=n._state={},e=n.fromRow,o=n.fromColumn,s=n.toRow,a=n.toColumn,l=n.option,c=e<0?0:e,h=o<0?0:o,f=s<0?0:s,v=a<0?0:a,d=e<0?Q(i):L(n),g=o<0?Y(i):n.columnCount;if(n.insert){if(o<0&&e>=0){var A=i.tables;!n.copy&&A&&A._has(f,-1,1,-1)&&(t=V(i,c,d,l),r._savedFromRowHeaderCells=t.headerCells,r._savedFromRows=t.rows,r._savedFromViewportCells=B(i,c,h,d,g,l))}}else e<0&&(t=E(i,v,g,l),r._savedToColumnHeaderCells=t.headerCells,r._savedToColumns=t.columns,n.copy||(t=E(i,h,g,l),r._savedFromColumnHeaderCells=t.headerCells,r._savedFromColumns=t.columns)),o<0&&(t=V(i,f,d,l),r._savedToRowHeaderCells=t.headerCells,r._savedToRows=t.rows,n.copy||(t=V(i,c,d,l),r._savedFromRowHeaderCells=t.headerCells,r._savedFromRows=t.rows)),r._savedToTables=I(i,f,v,d,g),r._savedToViewportCells=B(i,f,v,d,g,l),n.copy||(r._savedFromTables=I(i,c,h,d,g),r._savedFromViewportCells=B(i,c,h,d,g,l),i.isDirtySuspended()||(r._savedFromBeforePastedChangedCells=new y(i,(0,u._createRange)(c,h,d,g),l))),i.isDirtySuspended()||(r._savedToBeforePastedChangedCells=new y(i,(0,u._createRange)(f,v,d,g),l));r._savedAcitveRowViewportIndex=i._activeRowViewportIndex,r._savedAcitveColumnViewportIndex=i._activeColViewportIndex,r._savedActiveRow=i._activeRowIndex,r._savedActiveColumn=i._activeColIndex},undo:function(){var t=0;if(this.canUndo()){var n,r,e,o=this.PM,s=this._command,a=s.fromRow,l=s.fromColumn,c=s.toRow,h=s.toColumn,f=L(s),v=s.columnCount;if(!(0,u.isValidRange)(a,l,f,v,Q(o),Y(o)))return!1;if(!s.insert&&!(0,u.isValidRange)(c,h,f,v,Q(o),Y(o)))return!1;var d=s._state;this._beforeAction(o,!0);try{if(s.insert){if(!(l>=0&&a>=0))if(l>=0){var g=l;n=v,s.copy?o.M(h,n):(r=h,e=l,l<h?r=h-n:e=l+n,o.L(e,n),o.copyTo(-1,e<=r?r+n:r,-1,e,-1,n,s.option),o.M(e<=r?r+n:r,n),r<e&&(g=e-n)),o&&W(o,-1,g,Q(o),n),t++}else if(a>=0){n=f;var A=a;s.copy?o.deleteRows(c,n):(r=c,e=a,a<c?r=c-n:e=a+n,o.addRows(e,n),t+=k(this,d._savedFromViewportCells),t+=k(this,d._savedFromRowHeaderCells),(t+=k(this,d._savedFromRows))||o.copyTo(e<=r?r+n:r,-1,e,-1,n,-1,s.option),o.deleteRows(e<=r?r+n:r,n),r<e&&(A=e-n)),o&&W(o,A,-1,n,Y(o)),t++}}else{var m=a<0?0:a,w=l<0?0:l,b=c<0?0:c,C=h<0?0:h,O=a<0?Q(o):f,y=l<0?Y(o):v;i._supportsCalc&&R._clearFormula(o,b,C,O,y);var F=null,j=null,D=d._savedFromViewportCells;!s.copy&&D&&D.data&&D.data._isValueOrFormulaSaved()&&(j=R._getValues(o,m,w,O,y));var T=d._savedToViewportCells;T&&T.data&&T.data._isValueOrFormulaSaved()&&(F=R._getValues(o,b,C,O,y)),t+=k(this,d._savedToTables),t+=k(this,d._savedToColumnHeaderCells),t+=k(this,d._savedToColumns),t+=k(this,T),t+=k(this,d._savedToRowHeaderCells),t+=k(this,d._savedToRows),t+=k(this,d._savedFromTables),t+=k(this,d._savedFromColumnHeaderCells),t+=k(this,d._savedFromColumns),t+=k(this,D),t+=k(this,d._savedFromRowHeaderCells),(t+=k(this,d._savedFromRows))&&o&&(W(o,a,l,f,v),F&&R._raiseRangeDataChanged(o,b,C,O,y,d._savedToAfterPastedChangedCells?d._savedToAfterPastedChangedCells._getChangedCells():[],0),j&&R._raiseRangeDataChanged(o,m,w,O,y,d._savedFromAfterPastedChangedCells?d._savedFromAfterPastedChangedCells._getChangedCells():[],0))}if(t&&o){if(-1!==d._savedActiveRow&&-1!==d._savedActiveColumn){var S=o.getSelections()[0];S.contains(d._savedActiveRow,d._savedActiveColumn)?o.MJ(d._savedActiveRow,d._savedActiveColumn):o.MJ(S.row,S.col)}-2!==d._savedAcitveRowViewportIndex&&-2!==d._savedAcitveColumnViewportIndex&&-1!==d._savedActiveRow&&-1!==d._savedActiveColumn&&o.showCell(d._savedActiveRow,d._savedActiveColumn,3,3)}}catch(t){(0,u.printException)(t),p(t)}finally{this._afterAction(o,!0)}}return t>0}});i.sheetEx={fillAuto:function(t,i,n){if(!i)throw new Error((0,e.sR)().Exp_RangeIsNull);var r=n.fillType,u=n.series,o=n.direction,l=n.step,c=n.stop,h=n.collectedCells,f=new a.default(this,h);(function(t,i,n,r){return!!(t&&i&&i.containsRange(t))&&(!w(n)&&(1===n&&t.row===i.row&&L(t)===L(i)||0===n&&t.col===i.col&&P(t)===P(i))||!(w(r)||(2!==r&&3!==r||t.col!==i.col||P(t)!==P(i))&&(0!==r&&1!==r||t.row!==i.row||L(t)!==L(i))))})(t,i,o?null:u,o)&&(t&&(this.OK._fillStartRange=t),4===r?f._fillAuto(i,u,!1,n.withTag):0===r?f._fillAutoByDirection(i,o):1===r||2===r?f._fillLinearOrGrowth(1===r,i,u,l,c):3===r&&f._seriesFillRange(i,u,3,l,w(c)?null:s.default._DateTimeHelper._toOADate(c),n.unit),this.NR())}}},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,e=n(4),u=n(1),o=n.n(u),s=n(0),a=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),l=o.a.GC$,c=o.a._BaseDialog,h=s._getPreferredZIndex,f=s.device,v=l(document),d=" btn btn-default",g="sm-sheet-fill-type-item",A="sm-sheet-fill-menu-container",p="ui-icon ui-icon-check sm-sheet-check-image",m="sm-sheet-menu-item-input",w="ui-state-active sm-sheet-smart-tag-active",b="sm-sheet-tag-container",C="float",O="left",y="display",R="width",F="height",j="margin";function D(t,i,n,r,e,u){var o=t._isTouchMode,a=o?"160px":"150px",c=o?"25px":"20px",h=l(Object(s.createElement)("div")).css([y,R,F,"padding",j],["block",a,c,0,0]).addClass("sm-sheet-smartMenu-item-default "+n+" ui-state-default"+d),f=l(Object(s.createElement)("div")).addClass(m).appendTo(h),v=l(Object(s.createElement)("div")).addClass("sm-sheet-menu-item-text").appendTo(h),g=l(Object(s.createElement)("input")).attr({id:i,value:e,type:"radio",name:"fill-group",style:"display:none"}).appendTo(f);return l(Object(s.createElement)("span")).text(r).appendTo(v),u?(f.addClass(p),g.prop("checked","checked")):g.prop("checked",""),h}var T=function(t){function i(i,n){var r=t.call(this,i,h(n.parent._host))||this;r.PM=n,r._smartTagContainer=l("."+b);var u=r._menuContainer=r._getContainer();return u.addClass(A),D(n,"smartMenuCopyCells",g,Object(e.sR)().CopyCells,"0",!0).appendTo(u),D(n,"smartMenuFillSeries",g,Object(e.sR)().FillSeries,"1").appendTo(u),D(n,"smartMenuFillFormattingOnly",g,Object(e.sR)().FillFormattingOnly,"2").appendTo(u),D(n,"smartMenuFillWithoutFormatting",g,Object(e.sR)().FillWithoutFormatting,"3").appendTo(u),r}return a(i,t),i.prototype._attachEvent=function(){var t=this;l("."+g).bind("mouseover",function(t){l(t.elementItem).addClass("ui-state-hover sm-sheet-smartMenu-item-hover")}).bind("mouseout",function(t){l(t.elementItem).removeClass("ui-state-hover sm-sheet-smartMenu-item-hover")}).bind("click",function(i){var n=l(i.elementItem),r=t._smartTagContainer,e=n.find("input[type=radio]"),u=e[0];u.checked=!0,e.trigger("change"),r.trigger("click"),r.trigger("mouseout"),n.removeClass("ui-state-hover sm-sheet-smartMenu-item-hover");var o=parseInt(l(u).attr("value"));t._changeFill(o)}),this._menuContainer.find("input[type=radio]").bind("change",function(t){l("."+m).removeClass(p),l(t.elementItem).parent().addClass(p)})},i.prototype._dettachEvent=function(){l("."+g).unbind("mouseover").unbind("mouseout").unbind("click"),this._menuContainer.find("input[type=radio]").unbind("change")},i.prototype._changeFill=function(t){var i=this.PM,n=i.OK;this._fillType!==t&&(this._fillType=t,i._skipCloseDragFillSmartTag=!0,i._skipCloseDragFillSmartTag=!1,i._commandManager().execute({cmd:"fill",sheetName:i.name(),startRange:n._fillStartRange,fillRange:n._currentFillRange,autoFillType:t,fillDirection:n._currentFillDirection}),this._smartTagContainer.trigger("fillTypeChanged",t))},i.prototype._isOpen=function(){return!!l("."+A).length},i}(c);function S(t){return t?"data:image/png;base64,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":"data:image/png;base64,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"}var M=function(t){function i(i,n,r){var e=t.call(this,i,h(n.parent._host))||this;e.PM=n,e._fillInfo=r;var u=e._tagContainer=e._getContainer().addClass("sm-sheet-smart-tag-default "+b+" sm-sheet-no-select ui-widget-header"+d);return e._smartTag=l(Object(s.createElement)("img")).attr("src",S(0)).css(C,O).appendTo(u),e._smartTagDown=l(Object(s.createElement)("img")).attr("src",S(1)).css([C,y],[O,"none"]).appendTo(u),e}return a(i,t),i.prototype._doMouseEvent=function(t,i,n){var r=this.PM._isTouchMode,e=l(i),u=this._menuDialog,o=this._smartTagDown,s=r?"38px":"32px",a=r?"24px":"18px";u&&u._isOpen()||(t?e.addClass("ui-state-hover sm-sheet-smart-tag-hover"):e.removeClass("ui-state-hover sm-sheet-smart-tag-hover"),e.css([R,F],[t?s:a,a]),n||(t?o.show():o.hide()))},i.prototype._registerEvent=function(){var t=this,i=t._tagContainer,n=f(),r=s.browser.safari&&(n.ipad||n.iphone);i.bind("mouseover",function(i){t._doMouseEvent(!0,i.elementItem,r)}).bind("mouseout",function(i){t._doMouseEvent(!1,i.elementItem,r)}),i.bind("click",function(i){var n=l(i.elementItem),e=t._menuDialog,u=t._smartTagDown;if(e&&e._isOpen())r&&u.hide(),n.removeClass(w),t._closeMenu();else{r&&u.show(),n.addClass(w),t._openMenu();var o=t._menuContainer,s=o&&o.find("input[type=radio]")[t._fillInfo.fillType];s&&!s.checked&&(s.checked=!0,l(s).trigger("change"))}}),v.bind("keydown.ui-fill",function(i){27===i.keyCode&&(t._menuDialog&&t._menuDialog._isOpen()?t._closeMenu():t.close(),Object(s.cancelDefault)(i))})},i.prototype._open=function(){var t=this._tagContainer,i=this._fillInfo,n=this.PM._isTouchMode,r=n?"3px":"0px",e=n?"24px":"18px";t&&(t.css([O,"top"],[i.x,i.y])(this)._show(),this._registerEvent(),this._smartTag.css(j,r),this._smartTagDown.css(F,e),this._reset())},i.prototype._openMenu=function(){var t=this.PM;this._menuDialog||(this._menuDialog=new T(t.parent._getContainerDiv(),t),this._menuContainer=this._menuDialog._getContainer());var i=this._tagContainer,n=i.css(O),r=i.css("top"),e=parseFloat(r),u=this._menuDialog,o=this._fillInfo;u._fillType=o.fillType,isNaN(e)||(r=e+i.height()+2),this._menuContainer.css([O,"top"],[n,r]),u._show(),u._attachEvent(),u._smartTagContainer.unbind("fillTypeChanged").bind("fillTypeChanged",function(t,i){o.fillType=i})},i.prototype._closeMenu=function(){var t=this._menuDialog;t&&(t._dettachEvent(),t.close())},i.prototype._reset=function(){var t=this._menuDialog,i=this._tagContainer;t&&(t._isOpen()&&i.trigger("click"),i.trigger("mouseout"))},i.prototype.close=function(){var i=this.PM;this._reset(),v.unbind("keydown.ui-fill"),t.prototype.close.call(this),i&&i.MI()},i}(c);i.default=M},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),n.d(i,"state",function(){return e}),n.d(i,"STATES",function(){return u});var r=n(3),e=(0,n.n(r).a.makeState)(),u={dragFillIndicatorRect:"_dragFillIndicatorRect",dragOldRect:"_dragOldRect",insertDragRect:"_insertDragRect"}},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i._paintDragFillIndicator=function(t,i,n,r,e,a){var c=t.PM,h=c.LM(),f=c.parent,v=f&&f._themeVersion,d=function(t,i,n){var r=t.PM,e=i.x,u=i.y,o=i.width,a=i.height,l=r._getActiveSelectedRange(),c=r.LM(),h=4,f=-2.5;n>2007&&(h=5,f=-3);var v=new s(-4,-4,h,h);-1===l.col?(v.x=c._frozenX,v.y=u+a+f):-1===l.row?(v.x=e+o+f,v.y=c._frozenY):(v.x=e+o+f,v.y=u+a+f);return v}(t,e,v),g=d.x,A=d.y,p=d.width,m=d.height,w=h.MB(n,r);if((!a||d.intersectRect(a))&&d.intersectRect(w)){var b=-1.5;v>2007&&(b=-1);var C=new s(g+b,A+b,p+2,m+2);C.x=Math.max(C.x,w.x),C.y=Math.max(C.y,w.y),t.LD([l({rect:C})]),i.save(),a&&!a.containsRect(d)&&(i.rect(a.x,a.y,a.width,a.height),i.clip()),i.beginPath(),i.fillStyle=Object(o._getColor)(c,c.getSelectionBorderColor()),i.fillRect(g,A,p,m),Object(u.state)(u.STATES.dragFillIndicatorRect,new s(d.x,d.y,4,4)),i.beginPath(),i.restore()}},i._paintDragRectangle=function(t,i){var n=i.x,r=i.y,e=n+i.width,u=r+i.height;A(t,n,r,e,r),A(t,n,u,e,u),A(t,n,r,n,u),A(t,e,r,e,u)},i._paintDragInsertLine=f,i._paintDragDropRectangle=v,i._paintDragDropIndicator=g,i._refreshDragDropIndicator=function(t){var i=t.PM,n=i._currentTarget;if(!n||!n.dragInfo)return;var r=t._getCtx(),e=i.LM(),o=i.OK._actualDragRange,a=i.OK._dragRect;-1===a.row&&(a.col=o.col);-1===a.col&&(a.row=o.row);var l=i._getRangeWholeRect(o),c=i.frozenTrailingColumnCount(),h=i.frozenTrailingRowCount(),f=i.H()-c,v=i.G()-h,d=e.MB(1,1);c>0&&o.col+o.colCount<=f&&l.x+l.width>d.x+d.width&&l.intersectRect(d)&&(l=l.getIntersectRect(d));h>0&&o.row+o.rowCount<=v&&l.y+l.height>d.y+d.height&&l.intersectRect(d)&&(l=l.getIntersectRect(d));var A=new s(e._frozenX,e._frozenY,e._frozenTrailingX+e._frozenTrailingWidth,e._frozenTrailingY+e._frozenTrailingHeight);l.width>0&&l.height>0?(a.x=l.x,a.y=l.y,a.width=l.width-1,a.height=l.height-1,g(t,r,A)):0!==l.width&&0!==l.height||(a.x=l.x,a.y=l.y,a.width=l.width,a.height=l.height,g(t,r,A));!0===i.OK._isDragInsert?Object(u.state)(u.STATES.dragOldRect,Object(u.state)(u.STATES.insertDragRect)):Object(u.state)(u.STATES.dragOldRect,new s(a.x,a.y,a.width,a.height))};var r=n(1),e=n.n(r),u=n(11),o=n(0),s=e.a.Rect,a=e.a._createLine,l=e.a._Directive_CopyBuffer,c=e.a._Directive_RepaintSelection,h="#71a1e6";function f(t,i){t.save(),t.strokeStyle=h,t.beginPath();var n=0===i.height?.1:i.height,r=0===i.width?.1:i.width;t.rect(i.x,i.y,r,n),t.closePath(),t.lineWidth=2,t.lineJoin="miter",t.stroke(),t.restore()}function v(t,i){t.save(),t.strokeStyle=h,t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.closePath(),t.lineWidth=2,t.lineJoin="miter",t.setLineDash([4,4]),t.stroke(),t.restore()}function d(t,i,n){var r=t.PM;t.LD([l({rect:i,clipRect:n}),c({range:r._getActiveSelectedRange(),clipRect:n})])}function g(t,i,n){var r=t.PM,e=r.OK._dragRect,o=e.hitTarget;if(e&&o){var a=e.hitCol,l=e.hitRow,c=r.OK._isDragInsert,h=Object(u.state)(u.STATES.dragOldRect);if(i.save(),!0!==c||-1!==e.row&&-1!==e.col)h&&d(t,new s(h.x-2,h.y-2,h.width+4,h.height+4),n),v(i,e);else if(-1===e.row&&-1!==e.col){var g=r.NE(0).findCol(a);if(g||(g=r.NE(1).findCol(a)),g||(g=r.NE(2).findCol(a)),g){var A=g.x,p=g.width;e.col=a,o.x>A+p/2&&(e.col<r._getLastFullyVisibleColumn()||e.col===r._getLastVisualColumn())&&(A=g.x+g.width,e.col++),h&&0===h.width||(h=r.OK._dragRect),h&&d(t,new s(h.x-2,h.y-2,h.width+4,h.height+4),n);var m=new s(A,e.y,0,e.height);Object(u.state)(u.STATES.insertDragRect,m),f(i,m)}}else if(-1!==e.row&&-1===e.col){var w=r._getRowLayout(0).findRow(l);if(w||(w=r._getRowLayout(1).findRow(l)),w||(w=r._getRowLayout(2).findRow(l)),w){var b=w.y,C=w.height;e.row=l,o.y>b+C/2&&(e.row<r._getLastFullyVisibleRow()||e.row===r._getLastVisualRow())&&(b=w.y+w.height,e.row++),h&&0===h.height||(h=r.OK._dragRect),h&&d(t,new s(h.x-2,h.y-2,h.width+4,h.height+4),n);m=new s(e.x,b,e.width,0);Object(u.state)(u.STATES.insertDragRect,m),f(i,m)}}i.beginPath(),i.restore()}}function A(t,i,n,r,e){var u;t.globalCompositeOperation="source-over",t.strokeStyle=h,t.save(),i===r?(t.rect(i-2,n,7,Math.abs(e-n)),t.clip(),t.beginPath(),n<e?(n-=3,e+=3):(n+=3,e-=3),u=a(i,n,r,e,"black",2)):n===e&&(t.rect(i,n-2,Math.abs(r-i),7),t.clip(),t.beginPath(),i<r?(i-=3,r+=3):(i+=3,r-=3),u=a(i,n,r,e,"black",1)),u.LY(t),t.stroke(),t.beginPath(),t.restore()}},function(t,i,n){"use strict";n.d(i,"a",function(){return r}),n.d(i,"d",function(){return e}),n.d(i,"e",function(){return u}),n.d(i,"f",function(){return o}),n.d(i,"c",function(){return s}),n.d(i,"b",function(){return a});var r={copyCells:0,fillSeries:1,fillFormattingOnly:2,fillWithoutFormatting:3,clearValues:4,auto:5},e={left:0,right:1,up:2,down:3},u={column:0,row:1},o={direction:0,linear:1,growth:2,date:3,auto:4},s={day:0,weekday:1,month:2,year:3},a={FILL:"fill",DRAG_DROP:"dragDrop"}},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.install=function(t){Object(r._CopyProperty)(t.Worksheet.prototype,e.sheetEx),Object(r._CopyProperty)(t.Worksheet.prototype,u.sheetEx),Object(r._CopyProperty)(t._SheetEventHandler.prototype,u.sheetEventHandlerExt),Object(h.a)(),Object(c.a)(),g("Fill")},i.initSpread=function(t){var i=t.B();i&&Object(e.regiterCmds)(i._commandManager())},n.d(i,"SR",function(){return A}),n.d(i,"_FillDialog",function(){return p}),n.d(i,"_FillImp",function(){return m}),n.d(i,"_getValType",function(){return w});var r=n(0),e=n(9),u=(n.n(e),n(22)),o=(n.n(u),n(4)),s=n(10),a=n(7),l=n.n(a),c=n(23),h=n(24),f=n(1),v=n.n(f),d=n(13);n.d(i,"AutoFillType",function(){return d.a}),n.d(i,"FillDirection",function(){return d.d}),n.d(i,"FillSeries",function(){return d.e}),n.d(i,"FillType",function(){return d.f}),n.d(i,"FillDateUnit",function(){return d.c}),n.d(i,"COMMANDS",function(){return d.b});var g=v.a.activateFeatures;var A=o.SR,p=s.default,m=l.a,w=r.getValType},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={CopyCells:"Copy Cells",FillSeries:"Fill Series",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",Exp_NumberOnly:"Only works for Numbers",Exp_RangeContainsMergedCell:"Range should not have merged cells.",Exp_TargetContainsMergedCells:"Target range should not have merged cells.",Exp_MergedCellsIdentical:"This operation requires the merged cells to be identically sized.",Exp_FillRangeContainsMergedCell:"There are merged cells in target range, please unmerge cells and then drag fill range.",Exp_FillCellsReadOnly:"The cells you are trying to fill are protected and therefore read-only.",Exp_ChangeMergedCell:"Cannot change part of merged cell.",Exp_ColumnReadOnly:"The column you are trying to change is protected and therefore read-only.",Exp_RowReadOnly:"The row you are trying to change is protected and therefore read-only.",Exp_CellReadOnly:"The cell you are trying to change is protected and therefore read-only.",Exp_RangeIsNull:"range is null",Exp_ChangePartOfArray:"Cannot change part of an array."}},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(17),e=n(18),u=n(19),o=n(20),s=n(21);n.d(i,"NumberSource",function(){return r.a}),n.d(i,"DaySource",function(){return e.a}),n.d(i,"MonthSource",function(){return u.a}),n.d(i,"SerialStringSource",function(){return o.a}),n.d(i,"DateSource",function(){return s.a})},function(t,i,n){"use strict";var r,e=n(5),u=n(0),o=n(3),s=n.n(o),a=n(2),l=n.n(a),c=n(4),h=n(6),f=n.n(h),v=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),d=s.a._isNullOrUndefined,g=s.a._toDouble,A=l.a._trendSerial,p=l.a._trend,m=f.a.Convert,w=function(t){function i(i){var n=t.call(this,i)||this;return n._indexes=[],n._innerValues=[],n._type=null,n._startIndex=d(i)?-1:i,n}return v(i,t),i.prototype.increase=function(t,i){var n=Object(u.getValType)(t);if(this._isSerialNumber(n)){var r=t.split(".");return r[r.length-1]=String(+r[r.length-1]+i),r.join(".")}return t+i},i.prototype.trend=function(t,i,n,r,e,u,o,s){var a=[t,i,n,r,e,u,o,s];return this._isSerialNumber()?A.apply(null,a):p.apply(null,a)},i.prototype._values=function(){var t,i,n=[],r=this._innerValues,e=r?r.length:0;for(t=0;t<e;t++)i=r[t],n.push("object"===this._type?this._toDateTime(i):i);return n},i.prototype._insert=function(t,i,n){var r=n;if(!Object(u.isNumber)(r))throw new Error(Object(c.sR)().Exp_NumberOnly);d(this._type)&&(this._type=Object(u.getValType)(r)),this._isSerialNumber()||(r=g(r)),this._indexes.splice(t,0,i),this._innerValues.splice(t,0,r)},i.prototype.add=function(t,i){var n=i;d(this._type)&&(this._type=Object(u.getValType)(n)),this._isSerialNumber()||(n=g(n)),this._indexes.push(t),this._innerValues.push(n)},i.prototype._toActualValue=function(t){return this._type===u.DATE_STRING?this._toDateTime(t):t},i.prototype._toDateTime=function(t){var i=null;if(t instanceof Date)i=t;else if(m)try{i=m._toDateTime(t)}catch(n){Object(u.printException)(n),i=t}return i},i.prototype._isSerialNumber=function(t){return-1!==(t=t||this._type).indexOf(u.SER_NUMBER_STRING)},i}(e.a);i.a=w},function(t,i,n){"use strict";var r,e=n(5),u=n(0),o=n(3),s=n.n(o),a=n(2),l=n.n(a),c=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),h=l.a._DayList,f=l.a._DayListAlias,v=l.a._DayLen,d=l.a._getDayByIndex,g=s.a._isNullOrUndefined,A=function(t){function i(i){var n=t.call(this,i)||this;return n._indexes=[],n._innerValues=[],n._type=null,n._useSundayAlias=!1,n._startIndex=g(i)?-1:i,n._days=h,n._dayAlias=f,n._dayLength=v,n._SundayAlias="天",n}return c(i,t),i.prototype.valueConverter=function(){var t,i,n=this,r=this._innerValues;return r&&r.length?r.map(function(r,e){if(r=n._getDayNumber(String(r)),i=n._useSundayAlias?n._dayAlias.indexOf(String(r)):n._days.indexOf(String(r)),t=0===e?i:t,e>0)for(;i<t;)i+=n._dayLength;return i}):null},i.prototype.getTrendOrGrowthValue=function(i,n,r,e,u){if(u=u||this.valueConverter(),e=e||this._indexes2(),i&&u&&e){var o=u.length%this._dayLength||this._dayLength,s=0-o==-1?-2:0-o;u=u.slice(s),e=e.slice(s),u=u.slice(s),e=e.slice(s)}return t.prototype.getTrendOrGrowthValue.call(this,i,n,r,e,u)},i.prototype.increase=function(t,i){var n=this._getDayNumber(t),r=n===this._SundayAlias?6:this._days.indexOf(n);return r+=i,(this._type===u.DATE_STRING?t.slice(0,2):t[0])+d(r)},i.prototype.add=function(i,n){this._useSundayAlias||this._getDayNumber(n)!==this._SundayAlias||(this._useSundayAlias=!0),t.prototype.add.call(this,i,n)},i.prototype.resultConverter=function(t){var i=d(t,this._useSundayAlias);return i?i=this._type===u.DAY_STRING?"星期"+i:"周"+i:null},i.prototype._getDayNumber=function(t){return t[t.length-1]},i}(e.a);i.a=A},function(t,i,n){"use strict";var r,e=n(5),u=n(3),o=n.n(u),s=n(2),a=n.n(s),l=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),c=a.a._getMonthByIndex,h=a.a._MonthListAlias,f=a.a._MonthList,v=o.a._isNullOrUndefined,d=function(t){function i(i){var n=t.call(this,i)||this;return n._monthInNumber=!1,n._MonthLen=12,n._indexes=[],n._innerValues=[],n._type=null,n._startIndex=v(i)?-1:i,n}return l(i,t),i.prototype.increase=function(t,i){t=this._getMonthNumber(t);var n=this._isMonthInNumber(t),r=n?h.indexOf(t):f.indexOf(t);return c(r+i,n)+"月"},i.prototype.add=function(i,n){!this._monthInNumber&&this._isMonthInNumber(n)&&(this._monthInNumber=!0),t.prototype.add.call(this,i,n)},i.prototype.valueConverter=function(){var t,i,n=this,r=this._innerValues;return r&&r.length?r.map(function(r,e){if(r=String(r).replace("月",""),i=n._isMonthInNumber(r)?h.indexOf(r):f.indexOf(r),t=0===e?i:t,e>0)for(;i<t;)i+=n._MonthLen;return i}):null},i.prototype.getTrendOrGrowthValue=function(i,n,r,e,u){if(u=u||this.valueConverter(),e=e||this._indexes2(),i&&u&&e){var o=u.length%this._MonthLen||this._MonthLen;u=u.slice(0-o),e=e.slice(0-o)}return t.prototype.getTrendOrGrowthValue.call(this,i,n,r,e,u)},i.prototype.resultConverter=function(t){var i;return(i=c(t,this._monthInNumber))?i+"月":null},i.prototype._isMonthInNumber=function(t){return/^\d/.test(t.replace("月",""))},i.prototype._getMonthNumber=function(t){return t.replace("月","")},i}(e.a);i.a=d},function(t,i,n){"use strict";var r,e=n(5),u=n(3),o=n.n(u),s=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),a=o.a._isNullOrUndefined,l=function(t){function i(i){var n=t.call(this,i)||this;return n._indexes=[],n._innerValues=[],n._type=null,n._prefixReg=/\d+$/,n._startIndex=a(i)?-1:i,n}return s(i,t),i.prototype.valueConverter=function(){var t=this,i=this._innerValues;if(i&&i.length){var n=[];return i.forEach(function(i){var r=t.getPrefixRegMatch(String(i));r&&r[0]&&n.push(Number(r[0]))}),n}return null},i.prototype.increase=function(t,i){var n=this.getPrefixRegMatch(t);return n?t.slice(0,n.index)+(Number(n[0])+i):null},i.prototype.patternMatch=function(t){if(!this._dataCount())return!0;var i=this.getInvalidZeroCnt(String(this._innerValues[0])),n=this.getInvalidZeroCnt(t),r=i!==n&&0!==i&&0!==n;return this.getPrefix(String(this._innerValues[0]))===this.getPrefix(t)&&!r},i.prototype.resultConverter=function(t){t=Math.abs(Number(t)).toString();for(var i=this.getPrefix(String(this._innerValues[0])),n=String(this._innerValues[0]).replace(i,"");t.length<n.length;)t="0"+t;return i+t},i.prototype.getPrefix=function(t){var i=this.getPrefixRegMatch(t);return i?t.slice(0,i.index):""},i.prototype.getInvalidZeroCnt=function(t){for(var i=this.getPrefixRegMatch(t),n=0,r=i&&i[0];r&&"0"===r[n];)n++;return n},i.prototype.getPrefixRegMatch=function(t){return t.match(this._prefixReg)},i}(e.a);i.a=l},function(t,i,n){"use strict";var r,e=n(5),u=n(0),o=n(3),s=n.n(o),a=n(2),l=n.n(a),c=n(4),h=n(6),f=n.n(h),v=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),d=s.a._isNullOrUndefined,g=s.a._toDouble,A=l.a._trend,p=l.a._DateTimeHelper,m=f.a.Convert,w=function(t){function i(i){var n=t.call(this,i)||this;return n._indexes=[],n._innerValues=[],n._type=u.DATE_STRING,n._startIndex=d(i)?-1:i,n}return v(i,t),i.prototype.increase=function(t,i){return t+i},i.prototype.trend=function(t,i,n,r,e,o,s,a){for(var l,c=[],h=[],f=[],v=[],d=0,g=t[0].length;d<g;d++)t[0][d]=Math.floor(t[0][d]),l=this._toDateTime(t[0][d]),c.push(l.getFullYear()),h.push(l.getMonth()+1),v.push(12*l.getFullYear()+l.getMonth()+1),f.push(l.getDate());var m=Object(u.isAllSame)(c),w=Object(u.isAllSame)(h);if(!(!Object(u.isAllSame)(f)||m&&w)){var b=[],C=f[0],O=i[0].length,y=i[0][O-1],R=(y-i[0][0])/(O-1);if(m&&!w)if(Object(u.isSameStep)(h))for(var F=c[0],j=h[1]-h[0],D=0,T=n[0];D<T.length;D++){(V=((I=T[D])-y)/R*j+h[h.length-1])>12&&(F+=Math.floor(V/12),V%=12),b.push([p._toOADate(new Date(F,V-1,C))])}else b=this._copyFromKnowY(t,i,n);else if(!m&&w)if(Object(u.isSameStep)(c))for(var S=c[1]-c[0],M=0,_=n[0];M<_.length;M++){var N=((I=_[M])-y)/R*S+c[c.length-1];b.push([p._toOADate(new Date(N,h[0]-1,C))])}else b=this._copyFromKnowY(t,i,n);else if(Object(u.isSameStep)(v)){F=c[c.length-1],j=v[1]-v[0];for(var x=0,k=n[0];x<k.length;x++){(V=((I=k[x])-y)/R*j+h[h.length-1])>12&&(F+=Math.floor(V/12),V%=12),b.push([p._toOADate(new Date(F,V-1,C))])}}else if(Object(u.isSameStep)(c)&&Object(u.isSameStep)(h)){j=h[1]-h[0],S=c[1]-c[0];for(var E=0,B=n[0];E<B.length;E++){var I,V;N=((I=B[E])-y)/R*S+c[c.length-1];(V=(I-y)/R*j+h[h.length-1])>12&&(N+=Math.floor(V/12),V%=12),b.push([p._toOADate(new Date(N,V-1,C))])}}else b=this._copyFromKnowY(t,i,n);return b}if(!Object(u.isSameStep)(t[0]))return this._copyFromKnowY(t,i,n);var U=[t,i,n,r,e,o,s,a];return A.apply(null,U)},i.prototype._copyFromKnowY=function(t,i,n){for(var r=[],e=0,u=n[0].length;e<u;e++)r.push([t[0][(n[0][e]-i[0][0])%i[0].length]]);return r},i.prototype._values=function(){for(var t=[],i=this._innerValues,n=i?i.length:0,r=0;r<n;r++)t.push(i[r]);return t},i.prototype._insert=function(t,i,n){var r=n;if(!Object(u.isNumber)(r))throw new Error(Object(c.sR)().Exp_NumberOnly);d(this._type)&&(this._type=Object(u.getValType)(r)),this._indexes.splice(t,0,i),this._innerValues.splice(t,0,g(r))},i.prototype.add=function(t,i){var n=i;d(this._type)&&(this._type=Object(u.getValType)(n)),this._indexes.push(t),this._innerValues.push(g(n))},i.prototype._toActualValue=function(t){return this._toDateTime(t)},i.prototype._toDateTime=function(t){var i=null;if(t instanceof Date)i=t;else if(m)try{i=m._toDateTime(t)}catch(n){Object(u.printException)(n),i=t}return i},i}(e.a);i.a=w},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.sheetEx=i.sheetEventHandlerExt=void 0;var r=n(4),e=v(n(10)),u=n(11),o=n(12),s=v(n(1)),a=v(n(6)),l=v(n(2)),c=v(n(7)),h=v(n(8)),f=n(0);function v(t){return t&&t.__esModule?t:{default:t}}var d=s.default._Directive_CopyBuffer,g=s.default._Directive_RepaintSelection,A=s.default.GC$,p=f._createRange,m=s.default._supportsCalc,w=s.default.Events,b=l.default._Types._isNullOrUndefined,C=s.default._getFeatureManager,O=s.default.HookNames,y=C("Worksheet"),R=Math.min,F=Math.abs,j=Math.max,D="drag";function T(t){return t.rowViewportIndex}function S(t){return t.colViewportIndex}function M(t){return t.hitTestType}function _(t,i){return t.G(i)}function N(t,i){return t.H(i)}function x(t){return t.colCount}function k(t){return t.rowCount}function E(t,i,n,r,e,u,o,s,a,l,c,h){var f=i?w.DragDropBlock:w.DragDropBlockCompleted,v={sheet:t,sheetName:t._name,fromRow:n,fromCol:r,toRow:e,toCol:u,rowCount:o,colCount:s,copy:a,insert:l,copyOption:c,collectedCells:h},d=i?"dragDropBlock":"dragDropBlockCompleted";return i&&(v.cancel=!1),y.SY(O.Worksheet[d],this,v),t.NC(f,v),v.cancel}function B(t){var i=t.sheet,n=t.fromRow,e=t.fromCol,u=t.rowCount,o=t.colCount,s=t.toRow,a=t.toCol,l=t.isDragInsert,c=t.isDragCopy,h=i.options.dragDropCopyToOptions||16383,f=l&&-1===n?void 0:{},v="",d=3,g=!1,A=!1,b=!1;if(i.NC(w.BeforeDragDrop,t),!(v=t.invalidMessage)||0===v.length){var C=i._getActualRange(p(n,e,u,o)),O=i._getActualRange(p(s,a,u,o)),y=!i.isRangeEditable(C),R=!i.isRangeEditable(O);(y||R)&&(g=!0,i.parent.options.showPermissionError&&i.parent.options.showPermissionError({ranges:y?[C]:[O]})),!l||-1!==n&&-1!==e?s===n&&a===e||((i._hasPartSpans(n,e,u,o)||i._hasPartSpans(s,a,u,o))&&(g=!0,v=(0,r.sR)().Exp_ChangeMergedCell),g||m&&(i._hasPartArrayFormulas(n,e,u,o)||i._hasPartArrayFormulas(s,a,u,o))&&(g=!0,d=4,v=(0,r.sR)().Exp_ChangePartOfArray),g||(c||i.isRangeReadable(C)?c||i.isRangeEditable(O)||(i.parent.options.showPermissionError&&i.parent.options.showPermissionError({ranges:[O]}),A=!0):(i.parent.options.forbidCopyCallback&&i.parent.options.forbidCopyCallback(),A=!0)),g||(A||(A=E(i,!0,n,e,s,a,u,o,c,!1,h,f)),A||(b=i._commandManager().execute({cmd:"dragDrop",sheetName:i.name(),fromRow:n,fromColumn:e,toRow:s,toColumn:a,rowCount:u,columnCount:o,copy:c,insert:!1,option:h,collectedCells:f}))&&E(i,!1,n,e,s,a,u,o,c,!1,h,f))):e>=0&&n<0?(c&&(a<=e||a>=e+o)||!c&&(a<e||a>e+o))&&((i._hasPartSpans(-1,e,-1,o)||i._hasPartSpans(-1,a,-1,0))&&(g=!0,v=(0,r.sR)().Exp_ChangeMergedCell),g||(A=E(i,!0,-1,e,-1,a,-1,o,c,!0,h,f))||(b=i._commandManager().execute({cmd:"dragDrop",sheetName:i.name(),fromRow:-1,fromColumn:e,toRow:-1,toColumn:a,rowCount:-1,columnCount:o,copy:c,insert:!0,option:h,collectedCells:f}))&&E(i,!1,-1,e,-1,a,-1,o,c,!0,h,f)):n>=0&&e<0&&(c&&(s<=n||s>=n+u)||!c&&(s<n||s>n+u))&&((i._hasPartSpans(n,-1,u,-1)||i._hasPartSpans(s,-1,0,-1))&&(g=!0,v=(0,r.sR)().Exp_ChangeMergedCell),g||(A=E(i,!0,n,-1,s,-1,u,-1,c,!0,h,f))||(b=i._commandManager().execute({cmd:"dragDrop",sheetName:i.name(),fromRow:n,fromColumn:-1,toRow:s,toColumn:-1,rowCount:u,columnCount:-1,copy:self._isDragCopy,insert:!0,option:h,collectedCells:f}))&&E(i,!1,n,-1,s,-1,u,-1,c,!0,h,f))}b||(self._dragRect={},i.ST()),g&&v&&i._raiseInvalidOperation(d,v)}i.sheetEventHandlerExt={_startDragDropping:function(t){if(!this._isDragDropping){var i=this.PM,n=i._getCanvas();n&&(n.style.cursor="-webkit-grabbing");var r=null;if(1===i._selectionModel.length?r=i._selectionModel.data[0]:i._selectionModel.length<1&&(r=i._getSpanModel().get(i._activeRowIndex,i._activeColIndex)),r){this._isDragDropping=!0;var e,u=i._getActiveSelectedRange(),o=-1===u.row||-1===u.col;this._isDragInsert=o&&!this.shift,this._isWorking=!0,this._dragDropFromRange=r,e=-1===t.rowViewportIndex||-1===t.rowViewportIndex?i.getRangeRect(1,1,r):i.getRangeRect(T(t),S(t),r);var s=this._dragRect;s.x=e.x,s.y=e.y,s.width=e.width-1,s.height=e.height-1,s.row=r.row,s.col=r.col,s.rowCount=k(r),s.colCount=x(r);var a=i._getActualRange(r),l=t.row,c=t.col;l<a.row&&(l=a.row),l>=a.row+k(a)&&(l=a.row+k(a)-1),c<a.col&&(c=a.col),c>=a.col+x(a)&&(c=a.col+x(a)-1),s.hitRow=l,s.hitCol=c,s.rowOffset=l-a.row,s.colOffset=c-a.col,this._startHitInfo={_scrollRowViewportIndex:T(t),_scrollColViewportIndex:S(t),_hitTestType:M(t)},this._startScroll()}}},_continueDragDropping:function(){if(this._startHitInfo&&this._isWorking&&this._isDragDropping&&this._dragDropFromRange){var t=this._mousePosition,i=this._dragRect,n=i.width/2,r=i.x+n,e=i.height/2,u=i.y+e;i.hitTarget={x:t.x,y:t.y};var o=this._getHitRowIndex(),s=this._getHitColumnIndex(),a=!1;(F(r-t.x)>n+5||F(u-t.y)>e+5)&&(a=!0),o>=0&&s>=0&&a&&this._updateDragDropRect(o,s),this._continueScroll()}},_updateDragDropRect:function(t,i){if(this._isDragDropping&&this._dragDropFromRange){var n=this.PM,r=this._dragRect,e=n._getActiveSelectedRange();-1===e.row&&-1!==e.col?(r.row=-1,r.col=j(0,R(N(n)-x(r),i-r.colOffset))):-1!==e.row&&-1===e.col?(r.row=j(0,R(_(n)-k(r),t-r.rowOffset)),r.col=-1):(r.row=r.row<0?-1:j(0,R(_(n)-k(r),t-r.rowOffset)),r.col=r.col<0?-1:j(0,R(N(n)-x(r),i-r.colOffset))),r.hitRow=t,r.hitCol=i;var u=n._getActualRange(r),s=this._oldDragRange;if(!(s&&u.row===s.row&&u.col===s.col&&k(u)===k(s)&&x(u)===x(s)&&u.row>n._getFirstVisualRow()&&u.col>n._getFirstVisualColumn()&&u.row+k(u)-1<n._getLastVisualRow()&&u.col+x(u)-1<n._getLastVisualColumn())){this._actualDragRange=u,(0,o._refreshDragDropIndicator)(n._render),this._oldDragRange=u;var a=n.parent;if(a&&a.options.showDragDropTip){var l=r.x+r.width+5,c=r.y+r.height+5;a._showTooltip(this._getDragDropRectString(u),l,c)}}}},_getDragDropRectString:function(t){if(t&&m){var i,n,r,e,u,o=this.PM,s=o._getActiveSelectedRange(),l=o.getActiveRowIndex(),c=o.getActiveColumnIndex();if(l=l<0?0:l,c=c<0?0:c,1===k(s)&&1===x(s))i=a.default._createCellExpression(null,null,t.row-l,t.col-c,!0,!0);else-1===s.row&&s.col>=0?(n=e=a.default.BAND_INDEX_CONST,r=t.col-c,u=t.col-c+x(s)-1):-1===s.col&&s.row>=0?(r=u=a.default.BAND_INDEX_CONST,n=t.row-l,e=t.row-l+k(s)-1):s.row>=0&&s.col>=0&&(n=t.row-l,e=t.row-l+k(s)-1,r=t.col-c,u=t.col-c+x(s)-1),i=a.default._createRangeExpression(null,null,n,r,e,u,!0,!0,!0,!0);return o._getCalcServiceInternal().unparse(o._getSheetSource(),i,l,c)}},_stopDragDrop:function(){var t=this.PM,i=t._getCanvas();i&&(i.style.cursor="-webkit-grab");var n=null;this._startHitInfo=null,this._stopScroll();var r=t._getActiveSelectedRange();(n=r&&(k(r)>0||x(r)>0)?{r:r.row,c:r.col,rc:k(r),cc:x(r)}:{r:t._activeRowIndex,c:t._activeColIndex,rc:1,cc:1},!0===this._isDragDropping&&!0===this._isWorking)&&B({sheet:t,fromRow:n.r,fromCol:n.c,rowCount:n.rc,colCount:n.cc,toRow:this._dragRect.row,toCol:this._dragRect.col,isDragInsert:this._isDragInsert,isDragCopy:this._isDragCopy});this._isWorking=!1,this._isDragDropping=!1,this._dragDropFromRange=null,this._isDragInsert=!1,this._isDragCopy=!1,this._oldDragRange=null,this._removeTooltip()},_startDragFill:function(t){!0!==this._isDraggingFill&&!0!==this._isWorking&&(this._updateDragFillStartRange(),this._fillStartRange&&(t.sheet.NC(w.DragFillStart),this._currentFillRange=void 0,this._isWorking=!0,this._isDraggingFill=!0,this._isDragAroundIndicator=!0,this._dragStartRowViewport=t,this._dragStartColumnViewport=S(t),this._dragToRowViewport=T(t),this._dragToColumnViewport=S(t),this._updateDragStartRangeViewports(),this._startHitInfo={_scrollRowViewportIndex:T(t),_scrollColViewportIndex:S(t),_hitTestType:M(t)},this._startScroll()))},_updateDragStartRangeViewports:function(){var t=this.PM.frozenRowCount(),i=function(t){return t.frozenColumnCount()}(this.PM),n=this._dragFillStartTopRow();n>=0&&n<t?this._dragFillStartTopRowViewport=0:n>=t&&n<=_(this.PM)&&(this._dragFillStartTopRowViewport=1),this._isDragFillWholeColumns()?this._dragFillStartBottomRowViewport=1:this._dragFillStartBottomRowViewport=this._dragStartRowViewport;var r=this._dragFillStartLeftColumn();r>=0&&r<i?this._dragFillStartLeftColumnViewport=0:r>=i&&r<=N(this.PM)&&(this._dragFillStartLeftColumnViewport=1),this._isDragFillWholeRows()?this._dragFillStartRightColumnViewport=1:this._dragFillStartRightColumnViewport=this._dragStartColumnViewport},_continueDragFill:function(){if(this._startHitInfo&&this._isDraggingFill&&this._isWorking&&this._fillStartRange){if(this._dragToRowViewport=this._getHitRowViewportIndex(),this._dragToColumnViewport=this._getHitColumnViewportIndex(),this._dragToRow=this._getHitRowIndex(),this._dragToColumn=this._getHitColumnIndex(),this._dragToRow>=0&&this._dragToColumn>=0){this._updateCurrentFillSettings(),this._updateCurrentFillRange();var t=this.PM.parent,i=!1;this._getDragFillFrameRange()&&(i=this._validateFillRange(this._fillStartRange,this._currentFillRange,!0)),t&&t.options.showDragFillTip&&i&&this._showDragFillTooltip(),this._refreshDragFill()}this._continueScroll()}},_getDragFillTooltipContent:function(){var t,i=this.PM,n=this._fillStartRange,r=this._currentFillRange,e=i.parent.options.defaultDragFillType,u=this._getAutoFillType(3===e?5:e),o=this._getCurrentFillDirection(),s=this._getDragFillFrameRange();if(1===u){t=0===o||1===o?1:0;var a=new c.default(i)._fillAuto(s,t,!0),f=this._getAvailableRange(o,r,n);if(!i.isRangeReadable(f))return"";var v=i.getActualStyle(f.row,f.col),d=v.cellType||i.XR(),g=v.formatter||v._autoFormatter,A=h.default&&h.default.GeneralFormatter;if(a instanceof Date&&A){var p=v.formatter||v._autoFormatter;p||(p=l.default.CultureManager.YB().DateTimeFormat.shortDatePattern+" hh:mm:ss"),g=new A(p,0)}var m=this._startHitInfo,w=3;m&&(w=m._hitTestType);var b={sheet:i,row:f.row,col:f.col,sheetArea:w,quotePrefix:v.quotePrefix};return d.format(a,g,{},b)}return 0===u?(f=this._getAvailableRange(o,r,n),i.isRangeReadable(f)?i.getFormula(f.row,f.col)?null:i.getText(f.row,f.col):""):null},_getAvailableRange:function(t,i,n){var r=n.row,e=n.col,u=k(n),o=x(n),s=p(r,e,1,1);if(3===t){var a=k(i)%u;a=0===a?r+u-1:r+a-1,s.row=a,s.col=e}else 1===t?(a=0===(a=x(i)%o)?e+o-1:e+a-1,s.row=r,s.col=a):0===t?(a=0===(a=x(i)%o)?e:e+o-a,s.row=r,s.col=a):2===t&&(a=0===(a=k(i)%u)?r:r+u-a,s.row=a,s.col=e);return s},_showDragFillTooltip:function(){var t,i,n,r=this.PM;if(4===this._getAutoFillType()||this._isDragFillWholeRows()||this._isDragFillWholeColumns())return this._removeTooltip(),null;var e=this._getCurrentFillDirection(),u=this._getDragFillFrameRange(),o=r._getRangeWholeRect(u);n=this._getDragFillTooltipContent(),3===e?(t=o.x+o.width+3,i=o.y+o.height+3):1===e?(t=o.x+o.width+3,i=o.y+o.height+3):0===e?(t=o.x+3,i=o.y+o.height+3):2===e&&(t=o.x+o.width+3,i=o.y+3),this._showTooltip(n,t,i)},_refreshDragFill:function(){this._clearDragFill(),this._refreshSelectionBorder(),this._paintDragFill(),this._oldDragFillFrameRange=this._getDragFillFrameRange()},_clearDragFill:function(){var t=this.PM;if(this._oldDragFillFrameRange){var i=t._getRangeWholeRect(this._oldDragFillFrameRange);i.x-=2,i.y-=2,i.width+=4,i.height+=4,t.LD([d({rect:i})])}},_refreshSelectionBorder:function(){this.PM.LD([g({range:this._fillStartRange})])},_paintDragFill:function(){var t=this.PM,i=t._render,n=this._getDragFillFrameRange();if(n){var r=i._getCtx(),e=t._getRangeWholeRect(n);r.save(),r.beginPath(),(0,o._paintDragRectangle)(r,e),r.restore()}},_updateCurrentFillRange:function(){this._currentFillRange=this._getCurrentFillRange()},_isDragFillWholeRows:function(){return-1===this._fillStartRange.col&&-1!==this._fillStartRange.row},_isDragFillWholeColumns:function(){return-1===this._fillStartRange.row&&-1!==this._fillStartRange.col},_isDragClear:function(){return 4===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillRange:function(){var t=-1,i=-1,n=-1,r=-1;switch(this._currentFillDirection){case 0:this._isDragFillWholeColumns()?(t=-1,n=-1):(t=this._dragFillStartTopRow(),n=k(this._fillStartRange)),i=this._dragToColumn,r=this._dragFillStartLeftColumn()-i;break;case 1:this._isDragFillWholeColumns()?(t=-1,n=-1):(t=this._dragFillStartTopRow(),n=k(this._fillStartRange)),i=this._dragFillStartRightColumn()+1,r=this._dragToColumn-i+1;break;case 2:t=this._dragToRow,n=this._dragFillStartTopRow()-t,this._isDragFillWholeRows()?(i=-1,r=-1):(i=this._dragFillStartLeftColumn(),r=x(this._fillStartRange));break;case 3:t=this._dragFillStartBottomRow()+1,n=this._dragToRow-t+1,this._isDragFillWholeRows()?(i=-1,r=-1):(i=this._dragFillStartLeftColumn(),r=x(this._fillStartRange));break;case 5:t=this._dragToRow,n=this._dragFillStartBottomRow()-t+1,this._isDragFillWholeRows()?(i=-1,r=-1):(i=this._dragFillStartLeftColumn(),r=x(this._fillStartRange));break;case 4:this._isDragFillWholeColumns()?(t=-1,n=-1):(t=this._fillStartRange.row,n=k(this._fillStartRange)),i=this._dragToColumn,r=this._dragFillStartRightColumn()-i+1}return p(t,i,j(n,1),j(r,1))},_dragFillStartBottomRowLayout:function(){var t=this._dragFillStartBottomRow();return-1!==t?this.PM._getRowLayout(this._dragFillStartBottomRowViewport).findRow(t):null},_dragFillToViewportBottomRowLayout:function(){return this.PM._getRowLayout(this._dragToRowViewport).findRow(this._dragFillToViewportBottomRow())},_dragFillToViewportBottomRow:function(){return this.PM.getViewportBottomRow(this._dragToRowViewport)},_dragFillStartRightColumnLayout:function(){var t=this._dragFillStartRightColumn();return-1!==t?this.PM.NE(this._dragFillStartRightColumnViewport).findCol(t):null},_dragFillToViewportRightColumnLayout:function(){return this.PM.NE(this._dragToColumnViewport).findCol(this._dragFillToViewportRightColumn())},_dragFillToViewportRightColumn:function(){return this.PM.SW(this._dragToColumnViewport)},_updateCurrentFillSettings:function(){var t,i,n=this._isDragFillWholeRows(),r=this._isDragFillWholeColumns(),e=A(this.PM._getCanvas()).offset(),o=this._mousePosition.e,s=this._mousePosition.x,a=this._mousePosition.y,l=o.pageX-e.left,c=o.pageY-e.top,h=!1;if(n||r)r?this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=4:this._dragToColumn<this._dragFillStartLeftColumn()?this._currentFillDirection=0:this._dragToColumn>this._dragFillStartRightColumn()&&(this._currentFillDirection=1):n&&(this._dragToRow>=this._dragFillStartTopRow()&&this._dragToRow<=this._dragFillStartBottomRow()?this._currentFillDirection=5:this._dragToRow<this._dragFillStartTopRow()?this._currentFillDirection=2:this._dragToRow>this._dragFillStartBottomRow()&&(this._currentFillDirection=3));else if(this._dragToRow>=this._dragFillStartTopRow()&&this._dragToRow<=this._dragFillStartBottomRow())if(this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn())if(t=F(this._dragToColumn-this._dragFillStartRightColumn()),(i=F(this._dragToRow-this._dragFillStartBottomRow()))>t)this._currentFillDirection=5;else if(i<t)this._currentFillDirection=4;else{var f=this._dragFillStartBottomRowLayout();if(f||(f=this._dragFillToViewportBottomRowLayout()),a>f.y+f.height)this._currentFillDirection=3;else{var v=this._dragFillStartRightColumnLayout();v||(v=this._dragFillToViewportRightColumnLayout());var d=v.x+v.width-s,g=f.y+f.height-a;l>=v.x&&l<=v.x+v.width&&c>=f.y&&c<=f.y+f.height?this._currentFillDirection=d>=g?4:5:h=!0}}else this._dragToColumn<this._dragFillStartLeftColumn()?this._currentFillDirection=0:this._dragToColumn>this._dragFillStartRightColumn()&&(this._currentFillDirection=1);else this._dragToRow<this._dragFillStartTopRow()?this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=2:this._dragToColumn<this._dragFillStartLeftColumn()?(t=F(this._dragToColumn-this._dragFillStartLeftColumn()),i=F(this._dragToRow-this._dragFillStartTopRow()),this._currentFillDirection=i>=t?2:0):this._dragToColumn>this._dragFillStartRightColumn()&&(t=F(this._dragToColumn-this._dragFillStartRightColumn()),i=F(this._dragToRow-this._dragFillStartTopRow()),this._currentFillDirection=i>=t?2:1):this._dragToRow>this._dragFillStartBottomRow()&&(this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=3:this._dragToColumn<this._dragFillStartLeftColumn()?(t=F(this._dragToColumn-this._dragFillStartLeftColumn()),i=F(this._dragToRow-this._dragFillStartBottomRow()),this._currentFillDirection=i>=t?3:0):this._dragToColumn>this._dragFillStartRightColumn()&&(t=F(this._dragToColumn-this._dragFillStartRightColumn()),i=F(this._dragToRow-this._dragFillStartBottomRow()),this._currentFillDirection=i>=t?3:1));var p=(0,u.state)(u.STATES.dragFillIndicatorRect);if(p){var m=this._dragFillStartBottomRow(),w=this._dragFillStartRightColumn(),b=m+1,C=w+1,O=this.PM.getRowHeight(m,3),y=this.PM.SS(w,3),j=this.PM.getRowHeight(b,3),D=this.PM.SS(C,3),T=p.x+p.width/2-R(10,y/2),S=p.x+p.width/2+R(10,D/2),M=p.y+p.height/2-R(10,O/2),_=p.y+p.height/2+R(10,j/2),N=!1;n||r?r?N=T<=l&&l<=S:n&&(N=M<=c&&c<=_):N=T<=l&&l<=S&&M<=c&&c<=_,N||h?(this._isDragAroundIndicator=!0,this._currentFillDirection=4):this._isDragAroundIndicator=!1}},_dragFillStartTopRow:function(){return this._fillStartRange?-1===this._fillStartRange.row?0:this._fillStartRange.row:-1},_dragFillStartBottomRow:function(){return this._fillStartRange?-1===this._fillStartRange.row?_(this.PM)-1:this._fillStartRange.row+k(this._fillStartRange)-1:-1},_dragFillStartLeftColumn:function(){return this._fillStartRange?-1===this._fillStartRange.col?0:this._fillStartRange.col:-1},_dragFillStartRightColumn:function(){return this._fillStartRange?-1===this._fillStartRange.col?N(this.PM)-1:this._fillStartRange.col+x(this._fillStartRange)-1:-1},_getRealFillRange:function(t,i,n,r){n=(0,f._fixRange)(t,n);var e=0===r||1===r,u={};(t._rowFilter?t._rowFilter._getFilterArgs().filteredOutRows:[]).forEach(function(t){u[t]=!0});for(var o=i.row,s=i.rowCount,a=i.col,l=i.colCount,c=n.row,h=n.col,v=n.rowCount,d=n.colCount,g=t._spanModel,A=c+v-1,m=h+d-1,w=[],b=0;b<s;b++)w.push(o+b);w.filter(function(t){return!u[t]});var C=m,O=A,y=0;for(var R=c;R<=A;R++)if(u[R])y++;else for(var F=h;F<=m;F++){var j=e?R:w[(R-c-y)%w.length],D=e?(F-a)%l+a:F,T=g.getSpans(p(j,D,1,1))[0]||{},S=T.rowCount,M=T.colCount,_=T.row,N=T.col;S&&M&&j===_&&D===N&&(O=Math.max(R+S-1,O),C=Math.max(F+M-1,C))}return p(c,h,O-c+1,C-h+1)},_endDragFill:function(){var t=this.PM;if(this._startHitInfo=null,this._stopScroll(),this._removeTooltip(),this._isDraggingFill&&this._isWorking){this._isDraggingFill=!1,this._isWorking=!1;var i=this._getDragFillFrameRange();if(i&&this._fillStartRange&&this._currentFillRange){var n=!0;t.isRangeReadable(this._fillStartRange)||(t.parent.options.forbidCopyCallback&&t.parent.options.forbidCopyCallback(),n=!1);var r=this._getRealFillRange(t,this._fillStartRange,this._currentFillRange,this._currentFillDirection);if(t.isRangeEditable(r)||(t.parent.options.showPermissionError&&t.parent.options.showPermissionError({ranges:[r]}),n=!1),!(n=n&&this._currentFillRange&&this._validateFillRange(this._fillStartRange,r))||this._isDragAroundIndicator)this._resetDragFill(),this._refreshSelection(i);else{var e=this._getAutoFillType();t._commandManager().execute({cmd:"fill",sheetName:t.name(),startRange:t.OK._fillStartRange,fillRange:this._currentFillRange,realFillRange:r,autoFillType:e,fillDirection:t.OK._getCurrentFillDirection()}),!this._isCancelDragFill&&this._isDragFill()&&t.parent.options.showDragFillSmartTag&&4!==this._currentDragFillType?this._showDragFillSmartTag(this._currentDragFillType):this._refreshSelection(i),this._resetDragFill()}}}else this._resetDragFill()},_showDragFillSmartTag:function(t){var i=this.PM,n=(0,u.state)(u.STATES.dragFillIndicatorRect),r={x:n.x+n.width,y:n.y+n.height,fillType:t};i._fillDialog=new e.default(i.parent._getContainerDiv(),i,r),i._fillDialog._open()},_updateDragFillStartRange:function(){var t=this.PM;1===t._selectionModel.length?this._fillStartRange=t._selectionModel.data[0]:t._activeRowIndex>=0&&t._activeColIndex>=0&&(this._fillStartRange=p(t._activeRowIndex,t._activeColIndex,1,1))},_resetDragFill:function(){this._isWorking=!1,this._isDraggingFill=!1},_refreshSelection:function(t){this.PM._render._repaintSelection(t)},_getAutoFillType:function(t){var i=this.PM;void 0!==t||i.parent.options.defaultDragFillType;if(this._isDragClear())return 4;if(1===k(this._fillStartRange)&&1===x(this._fillStartRange)&&!this._isDragFillWholeColumns()&&!this._isDragFillWholeRows()){var n=this._fillStartRange.row,r=this._fillStartRange.col,e=!!i.getFormula(n,r),u=i.getFormatter(n,r)||i.getAutoFormatter(n,r);return this._isControlPressed||!e&&(h.default.isDateFormatter(u)||h.default.isTimeFormatter(u))?1:0}return this._isControlPressed?0:1},_getDragFillFrameRange:function(){if(!this._fillStartRange)return null;if(this._isDragClear())return this._fillStartRange;if(!this._currentFillRange)return null;var t=0,i=0,n=0,r=0;return this._isVerticalDragFill()?(t=2===this._currentFillDirection?this._currentFillRange.row:this._fillStartRange.row,i=k(this._fillStartRange)+k(this._currentFillRange),n=this._fillStartRange.col,r=x(this._fillStartRange)):(t=this._fillStartRange.row,i=k(this._fillStartRange),n=0===this._currentFillDirection?this._currentFillRange.col:this._fillStartRange.col,r=x(this._fillStartRange)+x(this._currentFillRange)),p(t,n,i,r)},_validateFillRange:function(t,i,n){function e(t,i,n,r,e){for(var u=0;u<n.rowCount;u++){for(var o=0;o<n.colCount;o++){var s=t.getSpan(n.row+u,n.col+o);if(!s||s.rowCount!==i.rowCount||s.colCount!==i.colCount||(0,f.spanContainsFilteredRow)(s))return!1;r&&(o+=i.colCount)}e&&(u+=i.rowCount)}return!0}var u=this.PM,o=!0,s="";return u._getSpanModel().hasSpans(i.row,i.col,k(i),x(i))&&!function(t,i,n){var r=i.row,u=i.rowCount,o=i.col,s=i.colCount,a=n.row,l=n.rowCount,c=n.col,h=n.colCount,v=r===a&&u===l,d=o===c&&s===h;if(!v&&!d)return!1;var g=t.getSpan(r,o);return!(!g||(0,f.spanContainsFilteredRow)(g)||!e(t,g,i,v,d))&&!t._getSpanModel().hasPartSpans(a,c,l,h)&&e(t,g,n,v,d)}(u,t,i)&&(o=!1,s=(0,r.sR)().Exp_FillRangeContainsMergedCell),o&&(u.isRangeEditable(i)||(o=!1,s=(0,r.sR)().Exp_FillCellsReadOnly)),o||n||u._raiseInvalidOperation(2,s),o},_isDragFill:function(){return this._isIncreaseFill()||this._isDecreaseFill()},_isIncreaseFill:function(){return 3===this._currentFillDirection||1===this._currentFillDirection},_isDecreaseFill:function(){return 0===this._currentFillDirection||2===this._currentFillDirection},_isVerticalDragFill:function(){return 2===this._currentFillDirection||3===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillDirection:function(){var t=this._currentFillDirection;return t>=0&&t<=3?t:4===t?0:5===t?2:3},_getDragInfo:function(t,i,n){var r=null,e=T(t),o=S(t);if(b(e)||b(o))return r;var s=this.PM,a=s.parent,l=s._getActiveSelectedRange();if(-1===l.row&&-1===l.col)return r;if(-1===e&&-1!==o)return 1===s._selectionModel.length&&-1===l.row&&-1!==l.col&&l.col<=t.col&&l.col+l.colCount-1>=t.col?{action:D,side:"header"}:r;if(-1!==e&&-1===o)return 1===s._selectionModel.length&&-1!==l.row&&-1===l.col&&l.row<=t.row&&l.row+l.rowCount-1>=t.row?{action:D,side:"header"}:r;if(e>=0&&o>=0&&1===s._selectionModel.length){if(this._inGrayArea(e,o,i,n))return r;var c=s.getRangeRect(e,o,l);if(c.x-4<i&&i<c.x+4&&c.y<=n&&n<c.y+c.height&&(r={action:D,side:"left"}),!r){var h=(0,u.state)(u.STATES.dragFillIndicatorRect);h&&h.x<=i&&i<=h.x+h.width&&h.y<=n&&n<=h.y+h.height&&(r={action:D,side:"corner"})}r||c.x+c.width-4<i&&i<c.x+c.width+4&&c.y<=n&&n<c.y+c.height&&(r={action:D,side:"right"}),r||c.y-4<n&&n<c.y+4&&c.x<=i&&i<c.x+c.width&&(r={action:D,side:"top"}),r||c.y+c.height-4<n&&n<c.y+c.height+4&&c.x<=i&&i<c.x+c.width&&(r={action:D,side:"bottom"}),r&&(i<c.x||i>c.x+c.width||n<c.y||n>c.y+c.height)&&(r.outside=!0)}return a&&a.options.allowUserDragDrop||r&&"corner"!==r.side&&(r.side=null),a&&a.options.allowUserDragFill||r&&"corner"===r.side&&(r.side=null),r}},i.sheetEx={dragDrop:B}},function(t,i,n){"use strict";i.a=function(){l.register(h,{priority:1e3,exclusive:!0},{DBClick:{handler:function(){return f.doDoubleClickFill()},canHandle:function(t,i){return f.canTriggerDbClickFill(t,i)}}})};var r=n(0),e=n(1),u=n.n(e),o=n(13),s=n(8),a=n.n(s),l=u.a._SheetEventHandler.eventManager,c=r._createRange,h="DoubleClickAutoFill",f={_fillStartRange:null,_currentFillRange:null,PM:null,doDoubleClickFill:function(){var t=this.PM;if(this._fillStartRange=t._selectionModel.data[0],!this.isFillStartRangeEmpty(this._fillStartRange)){var i=this.getDoubleClickFillFrameRange();if(i){var n=this._fillStartRange.row+this._fillStartRange.rowCount,r=i.rowCount-this._fillStartRange.rowCount;if(this._currentFillRange=c(n,i.col,r,i.colCount),t.isRangeReadable(this._fillStartRange)){var e=this._fillStartRange,u=e.rowCount,s=e.colCount,l=e.row,h=e.col,f=!1;if(1===u&&1===s){var v=t.getFormatter(l,h)||t.getAutoFormatter(l,h);f=!a.a.isDateFormatter(v)||t.getFormula(l,h)}t._commandManager().execute({cmd:"fill",sheetName:t.name(),startRange:this._fillStartRange,fillRange:this._currentFillRange,realFillRange:this._currentFillRange,autoFillType:f?o.a.copyCells:o.a.fillSeries,fillDirection:o.d.down})}else t.parent.options.forbidCopyCallback&&t.parent.options.forbidCopyCallback(void 0,[this._fillStartRange])}}},canTriggerDbClickFill:function(t,i){this.PM=i;var n=i.NK(),r=i.hitTest(t.pageX-n.left,t.pageY-n.top).dragInfo;return!!r&&"corner"===r.side},isRowFilteredOut:function(t){var i=this.PM;return(i._rowFilter?i._rowFilter._getFilterArgs().filteredOutRows:[]).includes(t)},getFillReferenceAreaRowCount:function(t,i){for(var n=this.PM.G(),r=0,e=t;e<n;e++){if(!this.isNotEmptyCell(e,i,"referenceArea")&&!this.isRowFilteredOut(e)){for(;this.isRowFilteredOut(e-1);)e--,r--;break}r++}return r},getWholeRangeRowCount:function(t,i,n,r){for(var e=this.PM,u=e.G(),o=t+n;o<u;o++)for(var s=i;s<i+r;s++)if((this.isNotEmptyCell(o,s,"toBeFilled")||this.isCellMerged(o,s,e)||this.isCellLocked(o,s,e))&&!this.isRowFilteredOut(o))return o-t;return u-t},isValidCellValue:function(t){return!!t||0===t||!1===t},isCellLocked:function(t,i,n){var r=n.getSpan(t,i),e=r?r.row:t,u=r?r.col:i;return!n.isRangeEditable(e,u,1,1)},isNotEmptyCell:function(t,i,n){var r=this.PM.getValue(t,i),e=this.PM.K(t,i);return"toBeFilled"===n?!!(this.isValidCellValue(r)||e&&e.backgroundImage):"fillStart"===n?!!(this.isValidCellValue(r)||e&&(e.backgroundImage||e.backColor)):this.isValidCellValue(r)},isCellMerged:function(t,i,n){var r=n.getSpan(t,i);return!!r&&(r.colCount>1||r.rowCount>1)},isFillStartRangeEmpty:function(t){for(var i=t.row,n=t.rowCount,r=t.col,e=t.colCount,u=i;u<i+n;u++)for(var o=r;o<r+e;o++)if(this.isNotEmptyCell(u,o,"fillStart"))return!1;return!0},getDoubleClickFillFrameRange:function(){var t=this.PM;if(1===t._selectionModel.data.length){var i=t._selectionModel.data[0],n=i.row,r=i.col,e=i.rowCount,u=i.colCount,o=this.getFillReferenceAreaRowCount(n,r-1),s=this.getFillReferenceAreaRowCount(n,r+u),a=this.getWholeRangeRowCount(n,r,e,u);if(o>e)return c(n,r,Math.min(o,a),u);if(s>e)return c(n,r,Math.min(s,a),u)}return null}}},function(t,i,n){"use strict";i.a=function(){l("Worksheet").register("fill",c)};var r,e=n(12),u=n(1),o=n.n(u),s=n(9),a=(n.n(s),o.a.HookNames),l=o.a._getFeatureManager,c=((r={name:"fill"})[a.Worksheet.setHost]=function(t){t&&Object(s.regiterCmds)(this._commandManager())},r[a.Worksheet.dispose]=function(){var t=this._fillDialog;t&&t.close()},r._setMetaKeyStateOnEvent=function(t){var i=t.e,n=this.PM;if(!0===this._isDragDropping){var r=n._getActiveSelectedRange(),u=this._isDragInsert,o=this._isDragCopy;-1===r.row||-1===r.col?this._isDragInsert=!i.shiftKey:this._isDragInsert=!1,this._isDragCopy=i.ctrlKey,u===this._isDragInsert&&o===this._isDragCopy||Object(e._refreshDragDropIndicator)(n._render)}},r._onPaintSelectionBorder=function(t){var i=t.ctx,n=t.rowViewportIndex,r=t.colViewportIndex,u=t.selectRect,o=t.clipRect;Object(e._paintDragFillIndicator)(this,i,n,r,u,o)},r)}])}},2563:function(t,i,n){"use strict";(function(t){var r,e=n(1),u=n.n(e),o=n(3),s=n(2564),a=n(1864),l=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),c=o.sheets.CellAppendant.AppendantComponent,h=o.sheets.Events,f=function(i){function n(n){var r=i.call(this,n)||this;return r.fillSelection=null,r.showFillOption=function(){r.setState({show:!0})},r.containRange=function(t,i){var n=i.row,r=i.col,e=i.rowCount,u=i.colCount,o=t.row,s=t.col,a=t.rowCount,l=t.colCount;return o<=n&&s<=r&&a>=e&&l>=u},r.handleSelectionChange=function(t){!r.state.show||r.fillSelection&&!r.containRange(t.newSelections[0],r.fillSelection)?r.hideFillOption():r.fillSelection=t.newSelections[0]},r.handleFullApply=function(t){var i,n,e=t.rows,u=t.cols,o=Object(a.getCachedOriginFillParams)(),s=null===(i=o)||void 0===i?void 0:i.srcRange,l=null===(n=o)||void 0===n?void 0:n.realFillRange;if(s&&l){var c=Math.max(s.row+s.rowCount-1,l.row+l.rowCount-1),h=Math.max(s.col+s.colCount-1,l.col+l.colCount-1);if(e&&e.length)if(e.some(function(t){return t.index<=c}))return r.hideFillOption();if(u&&u.length)u.some(function(t){return t.index<=h})&&r.hideFillOption()}},r.hideFillOption=function(t){t&&["dragFill","fillEnhance","intelligentFillAreaShortCut","validation"].includes(t.label)||r.state.show&&(r.setState({show:!1}),r.fillSelection=null,Object(a.deleteCachedFillInfo)())},r.offEventListener=function(){var i=r.props.A;i.off(h.AfterSelectionChanged,r.handleSelectionChange),i.off(h.EditStarted,r.hideFillOption),i.off(h.CellClick,r.hideFillOption),i.off(h.IV,r.hideFillOption),i.off(h.FloatingObjectClick,r.hideFillOption),i.off(h.BeforeChange,r.hideFillOption),i.off(h.AfterSheetFullApply,r.handleFullApply),t(i.container).off("contextmenu",r.hideFillOption)},r.state={show:!1},r}return l(n,i),n.prototype.componentDidMount=function(){var i=this,n=this.props.A;n.on(h.AfterSelectionChanged,this.handleSelectionChange),n.on(h.BeforeChange,this.hideFillOption),n.on(h.AfterFill,this.showFillOption),n.on(h.EditStarted,this.hideFillOption),n.on(h.CellClick,this.hideFillOption),n.on(h.IV,this.hideFillOption),n.on(h.FloatingObjectClick,this.hideFillOption),n.on(h.AfterSheetFullApply,this.handleFullApply),n.isRendered?t(n.container).on("contextmenu",this.hideFillOption):n.on(h.Rendered,function(){t(n.container).on("contextmenu",i.hideFillOption)})},n.prototype.componentWillUnmount=function(){this.offEventListener()},n.prototype.render=function(){var t=this.props.A,i=this.state.show;return u.a.createElement(s.a,{A:t,show:i})},n}(c);i.a=f}).call(i,n(25))},2564:function(t,i,n){"use strict";var r,e,u,o=n(0),s=n.n(o),a=n(1),l=n.n(a),c=n(3),h=n(1864),f=n(2249),v=n(2368),d=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),g=c.sheets.Core,A=g.Spread.Sheets,p=c.sheets,m=p.Events,w=p.range,b=p.track,C=p.spread.setSpreadFocus,O=g.Spread.Sheets.CellTypes.Text;!function(t){t[t.COPY=0]="COPY",t[t.COPY_SEQUENCE=1]="COPY_SEQUENCE",t[t.ONLY_STYLE=2]="ONLY_STYLE",t[t.WITHOUT_STYLE=3]="WITHOUT_STYLE",t[t.INTELLIGENT=4]="INTELLIGENT"}(u||(u={}));var y=((e={})[u.COPY]="0151",e[u.COPY_SEQUENCE]="0152",e[u.ONLY_STYLE]="0153",e[u.WITHOUT_STYLE]="0154",e[u.INTELLIGENT]="0155",e),R=function(t){function i(i){var n=t.call(this,i)||this;return n.enableOrderSort=!1,n.fillArgs=null,n.isEnableOrderSort=function(){var t=Object(h.getCachedOriginFillParams)();if(!t)return!1;var i=t.srcRange,r=i.row,e=i.col,u=i.rowCount,o=i.colCount,s=n.props.A.spread.B();n.enableOrderSort=!1;for(var a=0;a<u;a++)for(var l=0;l<o;l++){var c=r+a,f=e+l,v=s.getValue(c,f),d=s.K(c,f),A=s.E.getCellType(c,f),p=(0,g.Spread.Sheets.Fill._getValType)(v);if(A instanceof O&&p&&!d.formula){n.enableOrderSort=!0;break}}return n.enableOrderSort},n.isEnableIntlligentFill=function(){var t,i=Object(h.getCachedOriginFillParams)();return!!i&&((null===(t=i.srcRange)||void 0===t?void 0:t.colCount)<2&&(i.fillDirection===A.Fill.FillDirection.up||i.fillDirection===A.Fill.FillDirection.down))},n.genFillOption=function(){n.RESET_FILL_OPTION[n.RESET_FILL_OPTION.length-1].enable=n.isEnableIntlligentFill(),n.RESET_FILL_OPTION[1].enable=n.isEnableOrderSort()},n.getDefaultFillType=function(){var t=Object(h.getCachedOriginFillParams)(),i=t.srcRange,r=t.fillDirection,e=t.autoFillType,o=r===A.Fill.FillDirection.left||r===A.Fill.FillDirection.right;return o&&i.colCount>1||!o&&i.rowCount>1?n.enableOrderSort?u.COPY_SEQUENCE:u.COPY:e&&n.enableOrderSort?u.COPY_SEQUENCE:u.COPY},n.updatePosition=function(t){if(t&&t.fillRange||n.props.show){void 0===n.state.currentFilType&&n.setState({currentFilType:n.getDefaultFillType()});var i=n.props.A.spread.B().E.getSelections()[0],r=i.row+i.rowCount-1,e=i.col+i.colCount-1;n.props.A.emit(m.CellAppendantPositionChanged,{cell:{row:r,col:e}})}},n.toggleFillOption=function(){var t=n.props.A.container;n.setState({showFillOptionItems:!n.state.showFillOptionItems},function(){if(n.state.showFillOptionItems){var i=t.querySelector("#sm-canvas-container").getBoundingClientRect(),r=i.right,e=i.bottom,u=n.refs.list,o=n.refs.btn.getBoundingClientRect().width,s=u.getBoundingClientRect(),a=s.right,l=s.bottom,c=s.width,h=s.height;a>r&&(u.style.left=o-c+"px"),l>e&&(u.style.top=-(h+3)+"px")}else n.props.A.spread.gcSpread.focus(!0)})},n.fill=function(t){b(2,y[t]);var i=n.props.A,r=i.spread.B().E;C(i.spread.gcSpread,r,!0),n.setState({showFillOptionItems:!1});var e=Object(h.getCachedOriginFillParams)();if(e){var o=e.srcRange,s=e.fillDirection,a=e.originCells,l=e.fillRange,c=Object(h.getCopyFillCells)(),d=w.createRange(o.row,o.col,o.rowCount,o.colCount);if(l=w.createRange(l.row,l.col,l.rowCount,l.colCount),n.updateFillMenuPosition(n.fillArgs),t!==u.INTELLIGENT)if(n.setState({currentFilType:t}),t!==u.COPY&&t!==u.COPY_SEQUENCE){var g=Object(v.b)({A:i,E:r,type:t,originCells:a,copyFillCells:c,cachedAttributes:Object(h.getCachedOriginAttributes)(),cachedOps:Object(h.getCachedFillOps)()});i.actions.calcOperator({operator:g,isCalcInWorker:Object.keys(a).length>1e3,label:"fillEnhance"})}else r._commandManager().execute({cmd:"fill",sheetName:r.name(),startRange:d,fillRange:l,autoFillType:t,fillDirection:s,srcRange:d});else{var A=d.row,p=A!==l.row?d.rowCount+l.rowCount:d.rowCount,m=d.col,O=m!==l.col?d.colCount+l.colCount:d.colCount;Object(f.a)(i,r,[{row:A,rowCount:p,col:m,colCount:O}])&&n.setState({currentFilType:t})}}},n.updateFillMenuPosition=function(t){setTimeout(function(){return n.updatePosition(t)})},n.afterFill=function(t){n.fillArgs=t,n.updateFillMenuPosition(t)},n.state={showFillOptionItems:!1,currentFilType:void 0},n.RESET_FILL_OPTION=[{value:s()("复制单元格"),type:u.COPY,enable:!0},{value:s()("以序列方式填充"),type:u.COPY_SEQUENCE,enable:!0},{value:s()("仅填充格式"),type:u.ONLY_STYLE,enable:!0},{value:s()("不带格式填充"),type:u.WITHOUT_STYLE,enable:!0},{value:s()("智能填充"),type:u.INTELLIGENT,enable:!0}],n}return d(i,t),i.prototype.componentDidMount=function(){this.props.A.on(m.AfterFill,this.afterFill)},i.prototype.componentWillReceiveProps=function(t){if(!t.show){this.state.showFillOptionItems&&this.toggleFillOption();var i=this.refs.list;i.style.top="auto",i.style.left="auto",this.fillArgs=null,this.setState({currentFilType:void 0})}},i.prototype.componentWillUpdate=function(t,i){if(!i.showFillOptionItems){var n=this.refs.list;n.style.top="auto",n.style.left="auto"}},i.prototype.render=function(){var t=this,i=this.state.currentFilType,n=Object(h.getCachedOriginFillParams)();return n&&n.originCells&&this.genFillOption(),l.a.createElement("div",{className:"fill-reset-wrapper"+(this.props.show?"":" hide"),"data-show-type":this.props.show?"active":""},l.a.createElement("div",{ref:"btn",className:"fill-reset-btn"+(this.state.showFillOptionItems?" show-fill-reset-list":""),onClick:this.toggleFillOption},l.a.createElement("span",{className:"fill-icon"}),l.a.createElement("span",{className:"menu-item-selected-icon"})),l.a.createElement("div",{ref:"list",className:"fill-reset-menu "+(this.state.showFillOptionItems?"":"hide")},this.RESET_FILL_OPTION.map(function(n,r){return n.enable?l.a.createElement("div",{className:"fill-reset-item"+(n.type===i?" selected":""),key:r,onClick:function(){return t.fill(n.type)}},l.a.createElement("span",{className:"item--check "+(n.type===i?"checked":"")}),n.value):null})))},i}(a.Component);i.a=R}});