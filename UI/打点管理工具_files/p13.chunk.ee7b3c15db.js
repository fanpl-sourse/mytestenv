webpackJsonpSm_name_([5],{1939:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,n,e,i,s,b,p,m,y,O,g){var w=n.guid,j=e.id,S=function(t,n,e){return new c.b({A:t,guid:n.guid,currentUserId:e})}(t,n,j),k=function(t,n,e,r){var i=t&&t.permissions,s=i&&i.commentable,u=i&&i.editable,c=o()(t,["id","type","teamId"]);return e.then(function(e){return new e({user:n,file:c,permission:s||u?"editable":"readonly",guid:t.guid,ws:r,praiseEnable:!0,mention:{user:n,file:t,service:{searchApi:"/lizard-api/search",recentContacts:"/lizard-api/users/mine/recent_contacts",recentFiles:"/lizard-api/files/recent",tell:"/lizard-api/legacy_notifications/mention/{userId}"},serviceHeaders:{}}})})}(n,e,i,s),_=function(t,n,e,r,i,o,s,u){var c=e.guid,f=e.type,h="/lizard-api/files/"+c+"/revert",l="/lizard-api/files/"+c+"/doc_histories",v="/lizard-api/files/"+c+"/docSidebarInfo",b="/lizard-api/files/"+c+"/snapshot",p="/lizard-api/files/"+c+"/sheet_histories?from={from}&to={to}",m="/lizard-api/files/"+c+"/authors",y="/lizard-api/files/"+c+"/revisions",O="/lizard-api/files/"+c+"/revert",g="/lizard-api/files/"+c+"/revisions/{id}",w=Object(a.a)(t);n.JL({A:t,guid:c,fileType:f,loadHistoryUrl:v,revertUrl:h,contactUrl:m,addDocHistoryUrl:l,closeHistorySidebar:function(){return d(n,s(),u)}}),n.JK({A:t,historyEditor:w,guid:c,currentUserId:r,fileType:e.type,loadHistoryUrl:v,snapshotUrl:b,loadStepsUrl:p,contactUrl:m});var j=Object(a.a)(t);return n.JM({A:t,guid:c,currentUserId:r,canManageVersionItem:(e.permissions||{}).manageable,fileType:e.type,loadVersionListUrl:y,revertVersionUrl:O,deleteVersionUrl:g,updateVersionUrl:g,closeHistorySidebar:function(){return d(n,s(),u)}}),n.JN({A:t,historyEditor:j,guid:c,currentUserId:r,fileType:e.type,loadHistoryUrl:v,snapshotUrl:b,loadStepsUrl:p}),w}(t,S,n,j,0,0,y,O);return function(t,n,e,i,o,s,a,b,p){var m=u()(p,{showSidebar:function(t){return function(t,n,e,r){Object(l.default)(2,"0049");var i=n.sidebar,o=i&&i.S()===c.a.History;e===h.SidebarType.HISTORY&&o?(r(h.SidebarType.NONE),v(n)):(t&&i&&i.setActiveTab(t),e!==h.SidebarType.HISTORY&&(r(h.SidebarType.HISTORY),function(t){var n=t.sidebar;if(n&&(n.show(),n.S()===c.a.History)){var e=t.historyList;e&&e.previewFirstItem()}}(n)))}(t,e,a(),b)},RS:function(){return function(t,n,e){n===h.SidebarType.HISTORY&&(e(h.SidebarType.NONE),v(t))}(e,a(),b)},Events:r,TabItems:c.a});e.JJ({A:t,guid:o,appList:[{tag:c.a.Discord,name:s("讨论"),component:new f.a({discord:i})},{tag:c.a.History,name:s("历史"),component:e.historyList},{tag:c.a.Version,name:s("版本"),component:e.versionList}],closeHistorySidebar:function(){return d(e,a(),b)},swtichSidebarTab:function(t,n){var o=e&&e.sidebar;if(o)if(t&&t!==n&&m.emit(r.HideSidebar,t),n&&m.emit(r.ShowSidebar,n),o.setActiveTab(n),n===c.a.Discord){i.then(function(t){return t.emit(t.constructor.events.SHOW)});var s=e.historyList,u=e.versionList,a=e.versionPreview,f=e.historyPreview;f&&f.hide(),a&&a.hide(),s&&s.destory(),u&&u.destory()}else t===c.a.Discord&&i.then(function(t){return t.emit(t.constructor.events.HIDE)})}}),e.render(n)}(t,b,S,k,w,p,y,O,g),{historyEditor:_,commonDiscord:k,historySidebar:S,historyEmitter:g}};var r,i=e(70),o=e.n(i),s=e(38),u=e.n(s),c=e(2657),a=e(2263),f=e(2698),h=e(249),l=e(27);function d(t,n,e){var r=t.versionPreview,i=t.historyPreview,o=t.sidebar;o&&o.hide(),n===h.SidebarType.HISTORY&&(e(h.SidebarType.NONE),v(t)),i&&i.hide(),r&&r.hide()}function v(t){var n=t.sidebar;n&&n.hide()}!function(t){t.HideSidebar="hideSidebar",t.ShowSidebar="showSidebar"}(r||(r={}))},2150:function(t,n,e){"use strict";n.d=function(t,n,e){var r=c(n,JSON.parse(e.content).changeset).getIter();for(;r.hasNext();){var i=r.next(),o=i.getAttributes();if(!a(i,o)){var s=t.spread.getSheet(o.id);if(!s)continue;var u=t.permissions.query.canRevertRange({sheetId:o.id,range:{row:0,col:0,rowCount:s.G(),colCount:s.H()}});if(!u)return!0}}return!1},n.f=function(t,n){for(var e=0;e<n.length;++e)if(f(n[e]))return n[e].id===t;return!1},n.e=f,e.d(n,"b",function(){return h}),e.d(n,"c",function(){return l}),e.d(n,"a",function(){return d});var r=e(63),i=e(29),o=e(39),s=e(3),u=e(32),c=s.sheets.changeset.unpack;function a(t,n){return!n&&!r.default.isNumber(t.data)}function f(t){return 2===t.history_type||2===t.historyType}var h=Object(i.a)(Object(o.a)(function(t,n){return"loading"===n.status})),l=Object(i.a)(Object(o.a)(function(t,n){return"succeed"===n.status}),Object(u.a)(function(t,n){return n.result})),d=Object(i.a)(Object(o.a)(function(t,n){return"failed"===n.status}),Object(u.a)(function(t,n){return n}))},2180:function(t,n,e){"use strict";e.d(n,"b",function(){return r}),e.d(n,"a",function(){return i});var r="@TOGGLE_SIDEBAR",i="@SWITCH_TAB"},2208:function(t,n,e){"use strict";n.a=function(t){return Object(r.a)(function(n,e){Promise.resolve(t(n,e)).then(n.trigger).catch(n.trigger)})};var r=e(344)},2209:function(t,n,e){"use strict";(function(t){e.d(n,"i",function(){return N}),e.d(n,"d",function(){return C}),e.d(n,"e",function(){return D}),e.d(n,"g",function(){return E}),e.d(n,"h",function(){return T}),e.d(n,"f",function(){return I}),e.d(n,"c",function(){return A}),e.d(n,"b",function(){return H});var r,i,o,s,u,c,a,f=e(3),h=e(39),l=e(32),d=e(29),v=e(7),b=e(346),p=e(2208),m=e(2670),y=e(2150),O=e(18),g=e(2259),w=e(2261),j=e(344),S=e(52),k=this&&this.__assign||function(){return(k=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},_=f.sheets.ajax.ajax,P=f.sheets.changeset,L=P.unpack,M=P.compose,R=function(t){return Object(O.b)("historyPreview")(t+"historyPreview")},N=R("@showPreview"),C=R("@hidePreview"),D=R("@initState"),E=R("@setSelectedItem"),T=R("@setStep"),I=R("@setLoading"),A=R("@destory"),H=R("loadBaseRev"),F=R("onLoadBaseRev"),V=R("doShowPreview"),U=R("onLoadSnapShot"),x={isShowPreview:[!1,(r={},r[N]=function(){return!0},r[C]=function(){return!1},r[A]=function(){return!1},r)],initData:[{},(i={},i[D]=function(t,n){return k(k({},t),n)},i)],isLoadingPreview:[!1,(o={},o[E]=function(){return!0},o[N]=function(){return!0},o.showPreview=function(){return!1},o[I]=function(t,n){return n},o)],baseDelta:[null,{showPreview:function(t,n){var e=n.baseDelta;return void 0===e?null:e}}],curDelta:[null,{showPreview:function(t,n){return n.curDelta}}],sheetId:[{},{showPreview:function(t,n){return{id:n.sheetId}}}],steps:[[],(s={},s[N]=function(){return[]},s[E]=function(){return[]},s.loadHistoryDetailSucceed=function(t,n){return n},s)],curStep:[null,(u={showPreview:function(){return null}},u[T]=function(t,n){return n},u)],failTimesCheck:[0,(c={},c[N]=function(){return 0},c[E]=function(){return 0},c[H]=function(t){return t+1},c)],instance:[null,{"@injectEditorToStore":function(t,n){return n.A}}]},z=((a={searchBaseRev:[N,H,Object(d.a)(Object(S.a)(),Object(h.a)(function(t){var n=t.get;return Object(y.e)(n("::history.selected"))}),Object(j.a)(function(t){var n=t.trigger,e=t.get,r=Object(w.c)(e("::history.list"),e("::history.selected.id"));if(Object(b.e)(r)){var i=e("::history.isLastPage"),o=e("initData.guid"),s=e("::history.list");return n(i?Object(v.c)(V):Object(v.c)(F,{isLastPage:i,guid:o,length:s.length,baseRev:r}))}n(Object(v.c)(U,r))}))],loadSnapshot:[U,Object(d.a)(Object(l.a)(function(t,n){var e=t.get,r=e("initData.snapshotUrl"),i=e("initData.headers");return Object(m.b)({url:r,rev:n.value,headers:i})}),Object(p.a)(_),y.c,Object(j.a)(function(t,n){var e=t.trigger,r=t.get;return e(Object(v.c)(V,L(r("initData.fileType"),n)))}))],showPreview:[V,Object(d.a)(Object(h.a)(function(t){return null!=(0,t.get)("::history.selected.id")}),Object(l.a)(function(t,n){var e=t.get,r=e("initData.fileType"),i=e("::history.selected"),o=L(r,JSON.parse(i.content).changeset),s=n?M(r,n,o):o;return{sheetId:o.length>1?Object(w.g)(o):void 0,curDelta:s,baseDelta:n}}))],loadHistoryDetailSucceed:["showPreview",Object(d.a)(Object(l.a)(function(t){var n=t.get,e=n("initData.loadStepsUrl"),r=JSON.parse(n("::history.selected.content")).range,i=n("initData.headers");return Object(m.a)({url:e,range:r,headers:i})}),Object(p.a)(_),y.c)]})[H]=[F,Object(d.a)(Object(h.a)(function(n,e){var r=n.get,i=e.isLastPage,o=r("failTimesCheck"),s=o>=5;return!i&&s&&t({guid:r("initData.guid")},"history loadBaseRev failed "+o,0,0,{name:"ERR_SHEET_HISTORY_LOAD_BASEREV"}),!i&&!s}),Object(l.a)(function(t,n){var e=t.get,r=n.length,i=e("initData.loadHistoryUrl");return Object(g.a)({url:i,start:r,headers:e("initData.headers")})}),Object(p.a)(_),y.c)],a);n.a={namespace:"historyPreview",reducers:x,events:z}}).call(n,e(48))},2210:function(t,n,e){"use strict";e.d(n,"b",function(){return b}),e.d(n,"a",function(){return d});var r=e(196),i=(e.n(r),e(771)),o=e(772),s=e(775),u=e(2260),c=e(2678),a=e(2209),f=e(2382),h=e(2262),l=e(3).sheets.log.Raven,d=Object(i.a)([c.a,a.a,u.a,f.a,h.a]),v=Object(r.applyMiddleware)(Object(s.a)(function(t){t.action;var n=t.error;l.captureException(n)})),b=Object(o.a)({module:d,enhancer:v})},2255:function(t,n,e){"use strict";var r,i=e(1),o=e.n(i),s=e(6),u=e.n(s),c=e(194),a=(e.n(c),e(18)),f=e(771),h=e(772),l=e(3),d=e(2256),v=e(2257),b=e(2258),p=e(0),m=e.n(p),y=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),O=this&&this.__assign||function(){return(O=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},g=function(t,n){return Object(c.connect)(function(n,e){var r=t.select({isShow:"sidebar.isShow",activeTab:"sidebar.activeTab"},n);return O(O({},r),e)},function(){return n})(b.a)},w="sidebar",j=function(t){function n(e){var r=t.call(this,{name:w,Constructor:n,config:e})||this;return r.store=Object(h.a)({module:Object(f.a)([d.a])}),r.actions=Object(a.a)(r.store.dispatch,v),r.Connected=g(r.store,r.actions),r.options=e,e.container&&r.render(e.container),r.install(),r}return y(n,t),n.prototype.setLocale=function(t){m.a.setLocaleSync(t)},n.prototype.render=function(t){var n=this.store,e=this.Connected;u.a.render(o.a.createElement(c.Provider,{store:n},o.a.createElement(e,O({},O(O({},this.options),{container:t})))),t)},n.prototype.show=function(t){this.isShown=!0,t&&this.setActiveTab(t),this.actions.toggleSidebarAction(!0)},n.prototype.hide=function(){this.isShown=!1,this.actions.toggleSidebarAction(!1)},n.prototype.setActiveTab=function(t){t&&!this.options.appList.some(function(n){return n.tag===t})||this.actions.switchTabAction(t)},n.prototype.S=function(){var t=this.store;return t.select("sidebar.activeTab",t.getState())},n}(l.sheets.Plugin);n.a=j},2256:function(t,n,e){"use strict";var r,i,o=e(2180),s={isShow:[!1,(r={},r[o.b]=function(t,n){return n},r)],activeTab:["",(i={},i[o.a]=function(t,n){return n},i)]};n.a={namespace:"sidebar",reducers:s}},2257:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e.d(n,"toggleSidebarAction",function(){return o}),e.d(n,"switchTabAction",function(){return s});var r=e(7),i=e(2180),o=function(t){return Object(r.c)(i.b,t)},s=function(t){return Object(r.c)(i.a,t)}},2258:function(t,n,e){"use strict";var r,i=e(1),o=e.n(i),s=e(163),u=(e.n(s),e(63)),c=e(3),a=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),f=c.sheets.utils.preventWheelBack,h=function(t){function n(n){var e=t.call(this,n)||this;return e.onClose=function(){e.setState({shouldUpdateCnt:!1}),e.props.toggleSidebarAction(!1),e.props.switchTabAction(null),e.props.appList.forEach(function(t){var n=t.component;n.destory&&n.destory()}),u.default.isFunction(e.props.onClose)&&e.props.onClose()},e.state={shouldUpdateCnt:!1,tabListLength:{}},e}return a(n,t),n.prototype.componentDidMount=function(){var t=this;this.props.appList.forEach(function(n){var e=n.tag,r=n.component,i=t.refs.smSidebarList.querySelector(".sm-sidebar-applist-"+e);i&&r.render(i,{getListLength:t.getListLength.bind(t,e)}),e===t.props.activeTab&&r.show()}),f(this.refs.smSidebarList,!0)},n.prototype.getListLength=function(t,n){var e=this.state.tabListLength;e[t]=n,this.setState({tabListLength:e})},n.prototype.componentWillReceiveProps=function(t){var n=this;this.props.activeTab!==t.activeTab&&(u.default.isFunction(this.props.onTabSwitch)&&this.props.onTabSwitch(this.props.activeTab,t.activeTab),t.appList.forEach(function(e){var r=e.tag,i=e.component;r===n.props.activeTab&&i.hide(),r===t.activeTab&&i.show()})),this.props.isShow&&!t.isShow&&this.onClose(),!this.props.isShow&&t.isShow&&t.appList.forEach(function(t){var n=t.component;n.reload&&n.reload()})},n.prototype.onClick=function(t){t!==this.props.activeTab&&(u.default.isFunction(this.props.onTabSwitch)?this.props.onTabSwitch(this.props.activeTab,t):this.props.switchTabAction(t))},n.prototype.render=function(){var t=this,n=this.props,e=n.activeTab,r=n.isShow,i=n.appList,u=void 0===i?[]:i,c=this.state.tabListLength;return o.a.createElement("div",{className:Object(s.className)({"sm-sheet-editor-sidebar":!0,show:r}),ref:"smSidebarList"},o.a.createElement("div",{className:"doc-history-title spreadsheet"},u.map(function(n){var r=n.tag,i=n.name,s=e===r;return o.a.createElement("span",{key:r,className:"s-title-text s-title-text-"+r+" "+(s?"active":""),onClick:function(){return t.onClick(r)}},i+" "+(null!=c[r]?"("+c[r]+")":""))}),o.a.createElement("span",{className:"icon-close hicon doc-sidebar-close",onClick:this.onClose.bind(this)})),u.map(function(t){var n=t.tag;return o.a.createElement("div",{key:n,className:"sm-sidebar sm-sidebar-applist-"+n+" "+(n!==e?"hide":"")})}))},n}(i.Component);n.a=h},2259:function(t,n,e){"use strict";e.d(n,"a",function(){return o}),e.d(n,"b",function(){return s});var r=e(801),i=e.n(r),o=function(t){var n=t.url,e=t.start,r=t.pageSize;return{url:n,method:"GET",params:{count:e,pageSize:void 0===r?30:r},headers:t.headers}},s=function(t){var n=t.url,e=t.id,r=t.headers;return{url:n,method:"POST",params:i.a.stringify({dhId:e}),headers:r}}},2260:function(t,n,e){"use strict";(function(t){e.d(n,"d",function(){return E}),e.d(n,"m",function(){return T}),e.d(n,"e",function(){return I}),e.d(n,"k",function(){return A}),e.d(n,"c",function(){return H}),e.d(n,"h",function(){return F}),e.d(n,"i",function(){return V}),e.d(n,"l",function(){return U}),e.d(n,"g",function(){return x}),e.d(n,"n",function(){return z}),e.d(n,"f",function(){return B}),e.d(n,"j",function(){return J}),e.d(n,"b",function(){return q});var r,i,o,s,u,c,a,f,h,l=e(0),d=e.n(l),v=e(3),b=e(32),p=e(29),m=e(2208),y=e(7),O=e(2259),g=e(2150),w=e(18),j=e(2209),S=e(39),k=e(344),_=e(52),P=this&&this.__assign||function(){return(P=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},L=v.sheets.ajax.ajax,M=v.sheets.alert,R=v.sheets.utils,N=M.showAlert,C=R.dateTime.format,D=function(t){return Object(w.b)("historyList")(t+"historyList")},E=D("@initState"),T=D("@toggleListShow"),I=D("@loadHistory"),A=D("@setSelected"),H=D("@destory"),F=D("@revert"),V=D("@scroll"),U=D("@toggleHightLight"),x=D("@previewFirstItem"),z=D("@toggleRenderFilter"),B=D("loadHistorySucceed"),J=D("scrollSucceed"),q=D("fetchFirstEditHistory"),G=D("doPreviewFirstItem"),W=D("noEditHistory"),Y={isShowList:[!1,(r={},r[T]=function(t,n){return n},r)],initData:[{},(i={},i[E]=function(t,n){return P(P({},t),n)},i)],isLoadingList:[!1,(o={},o[I]=function(){return!0},o.setListLoading=function(){return!0},o[B]=function(){return!1},o[x]=function(){return!0},o)],isOnScroll:[!1,(s={},s[V]=function(){return!0},s.setOnScrollLoading=function(){return!0},s[J]=function(){return!1},s)],previewFirstItem:[!1,(u={},u[x]=function(){return!0},u[T]=function(t,n){return n&&t},u[H]=function(){return!1},u)],isReverting:[!1,(c={},c[F]=function(){return!0},c.onRevertSucceed=function(){return!1},c.onRevertFailed=function(){return!1},c)],revertItem:[{},(a={},a[F]=function(t,n){return n},a.onRevertSucceed=function(){return{}},a.onRevertFailed=function(){return{}},a)],failTimesCheck:[0,(f={},f[G]=function(){return 0},f[q]=function(t){return t+1},f)]},$=((h={loadHistory:[I,Object(p.a)(Object(m.a)(L))],setListLoading:["loadHistory",g.b]})[B]=["loadHistory",g.c],h.onScroll=[V,Object(p.a)(Object(m.a)(L))],h.setOnScrollLoading=["onScroll",g.b],h[J]=["onScroll",g.c],h[G]=[B,q,Object(p.a)(Object(_.a)(),Object(S.a)(function(t){return(0,t.get)("previewFirstItem")}),Object(k.a)(function(n){var e=n.trigger,r=n.get,i=r("::history.list"),o=i.filter(g.e)[0];if(o)return e(Object(y.c)(j.i,o));var s=r("::history.isLastPage"),u=r("failTimesCheck");if(u>=5)return N({type:"error",title:i.length?d()("请求编辑历史失败!"):d()("请求历史失败")}),t({guid:r("initData.guid"),isLastPage:s,historyListLen:i.length},"history fetchFirstEditHistory failed "+u,0,0,{name:"ERR_SHEET_HISTORY_FETCH_FIRST_EDIT_HISTORY"});e(Object(y.c)(W))}))],h[q]=[W,Object(p.a)(Object(b.a)(function(t){var n=t.get;return Object(O.a)({url:n("initData.loadHistoryUrl"),start:n("::history.list.length"),headers:n("initData.headers")})}),Object(m.a)(L),g.c)],h.onRevert=[F,Object(p.a)(Object(b.a)(function(t){var n=t.get;return Object(O.b)({url:n("initData.revertUrl"),id:n("revertItem.id"),headers:n("initData.headers")})}),Object(m.a)(L))],h.onRevertSucceed=["onRevert",Object(p.a)(g.c,Object(b.a)(function(t,n){var e=t.get,r=n.result;return N({title:d()("已还原到 ")+C(e("revertItem.updated_at"),!0)+d()(" 的内容")}),r}))],h.onRevertFailed=["onRevert",Object(p.a)(g.a,Object(b.a)(function(n,e){var r=n.get;N({title:e.error&&e.error.message||d()("还原失败，请稍候再试"),type:"error"}),t({guid:r("initData.guid"),err:e&&JSON.stringify(e)},"history revert",0,0,{name:"ERR_SHEET_HISTORY_REVERT_FAILED"})}))],h);n.a={namespace:"historyList",reducers:Y,events:$}}).call(n,e(48))},2261:function(t,n,e){"use strict";(function(t){e.d(n,"i",function(){return I}),n.a=function(t,n,e,r,i){var o=T.highLight,s=T.userRanges,u={},c=e.getIter(),a=0;for(;c.hasNext();){var h=c.next();if("object"==typeof h.data){var l=D(n,h),d=l.cellsData,v=h.getAttributes(),b=v.id||A(r,a);u[b]=d||[],a++}else a+=h.data}o[t]={userId:i,cells:u},s[t]=function(t,n){var e,r,i,o={},s=[],u="",c=-1,a={};return Object.keys(t).reduce(function(o,h){for(var l in s=t[h],o[h]={},a={},Object.keys(s).forEach(function(t){r=s[t],e=r[3]||{},i=n||E(e),c=null==i?-1:i,u=f.a.stringifyPosition(r[0],r[1]),a[c]=a[c]||[],a[c][u]=!0}),a)o[h][l]=H(a[l]);return o},o),o}(u,i)},n.j=function(t){var n=t.B().guid(),e=M(t,n);R({obj:e,suspendEvent:!0,suspendCalcService:!0,func:function(){}})()},n.f=function(t){var n=t.cooperation,e=t.currentId,r=t.spread.B().guid(),i=T.highLight[e]||{},o=i.cells||{},u=i.userId,c=o[r];return function(t,n,e){void 0===n&&(n=[]);var r={},i=function(t,n){var e=p()(t);return p()(e.color.map(function(t){return Math.round(t*n+255*(1-n))})).hex()};return n&&n.forEach(function(n){var o=n[0],u=n[1],c=n[3];r[o+"-"+u]=function(n){var r=e||E(n);return i(s()(r)?"#fff0cf":t.userColor(r),.5)}(c)}),r}(n,c,u)},n.b=function(t,n,e){var r,i=T.userRanges[n]||{},o=e.B();R({obj:o,suspendEvent:!0,suspendCalcService:!0,func:function(){if(h.a.removeAllCollabs(o),void 0!==(r=i[o.guid()])){var n=Object.keys(r)[0],e=r[n],s={color:t.userColor(n)};e&&e.length&&e.forEach(function(t){var n=N(t.cells),e=n.row,r=n.col,i=n.rowCount,u=n.colCount;h.a.addCollabBorder(o,{range:{row:e,col:r,rowCount:i,colCount:u,endRow:e+i-1,endCol:r+u-1},userInfo:s},!0)})}}})()},n.d=function(n,e,r,i){var o=t(i).offset(),s=o.left,u=o.top;return n.hitTest(e-s,r-u)},e.d(n,"h",function(){return U}),e.d(n,"k",function(){return x}),n.e=function(t,n){var e,r,i=n.getIter(),o="",s=t.getIter();for(;i.hasNext();)if("remove"!==(e=i.next()).action){var u=e.length;if(r=e.getAttributes(),"object"==typeof e.data)return s.next().getAttributes().id;r&&r.id&&(o=r.id),c(s,u)}return o||void 0;function c(t,n){for(var e=0;t.hasNext()&&e<n;)t.next(),e++}},n.g=function(t){var n=t.getIter(),e=[t.getIter().next()];for(;n.hasNext();){var r=n.next();if("object"==typeof r.data||"insert"===r.action){e.push(r);break}c()(r.getAttributes()).length>1&&e.push(r)}var i=e[e.length-1];return i&&i.getAttributes().id},n.c=function(t,n){for(var e=t.filter(m.e),r=!1,i=0,o=e.length;i<o;i++){var s=e[i],u=s.id;if(!(u>n))if(u!==n){if(r)return Object(d.b)(JSON.parse(s.content).range[1])}else r=!0}return d.a};var r=e(0),i=e.n(r),o=e(19),s=e.n(o),u=e(92),c=e.n(u),a=e(82),f=e.n(a),h=e(816),l=e(2671),d=e(346),v=e(3),b=e(2672),p=e.n(b),m=e(2150),y=this&&this.__makeTemplateObject||function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},O=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e(function(t){t(n)})).then(s,u)}c((r=r.apply(t,n||[])).next())})},g=this&&this.__generator||function(t,n){var e,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(t,s)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},w=v.sheets.changeset,j=v.sheets,S=j.contact,k=j.spread,_=j.perf,P=j.range,L=S.getContactById,M=k.getSheetById,R=_.paintWrap,N=P.transformCellsToRange,C=w.findRawTableOpInCsByIndex,D=w.changeset2Actions;function E(t){return t.authorId||t.userId||t.userID}var T={highLight:{},userRanges:{}},I=function(t){var n=t.url,e=t.sheet,r=t.cooperation,o=t.cell,s=t.collabUsers,u=t.id;return O(void 0,void 0,Promise,function(){var t,c,a,l,d,v,b,p,m,w,j,S,k,_,P,M;return g(this,function(R){switch(R.label){case 0:if(t=(T.userRanges[u]||{})[e.guid()],h.a.removeCollabName(e),!t||!o||null==o.row||null==o.col)return[2];for(b in c=f.a.stringifyPosition(o.row,o.col),v=[],t)v.push(b);p=0,R.label=1;case 1:if(!(p<v.length))return[3,7];if(m=v[p],-1===(a=Number(m)))return[3,6];w=t[m],j=0,S=w.length,R.label=2;case 2:return j<S?(k=w[j])&&k.cells[c]?(_=k.topCell,P=_.row,M=_.col,l={row:P,col:M,endRow:P,endCol:M},[4,function(t,n,e){return O(this,void 0,Promise,function(){var r;return g(this,function(i){switch(i.label){case 0:return(r=n&&n[t]&&{name:n[t]})?[2,r]:[4,L({contactId:t.toString(),url:e})];case 1:return[2,i.sent()]}})})}(a,s,n)]):[3,4]:[3,5];case 3:return(d=R.sent()).name=function(t,n){if(n!==i()("路人"))return n;var e=Math.abs(t)+"";return i()(V||(V=y(["路人-",""],["路人-",""])),e.substr(Math.max(e.length-5,0),5))}(a,d.name),d.color=r.userColor(m),[3,5];case 4:return j++,[3,2];case 5:if(l)return[3,7];R.label=6;case 6:return p++,[3,1];case 7:return l&&h.a.addCollabName(e,{range:l,userInfo:d}),[2]}})})};function A(t,n){var e=C(t,n);return e&&e.getAttributes().id}function H(t){var n={},e={},r=function(r){var i=e[r],o=n[i];o||((o={})[r]=!0,n[i=r]=o,e[r]=i),l.b.forEach(function(s){var u=function(t,n){var e=f.a.parsePosition(t),r=e.row,i=e.col;switch(n){case l.e:r--;break;case l.d:i++;break;case l.a:r++;break;case l.c:i--}return r<0||i<0?null:f.a.stringifyPosition(r,i)}(r,s);if(u&&t[u]){var c=e[u];c?c!==i&&function(t,r){var i=n[t],o=n[r];for(var s in o)e[s]=t,i[s]=!0;delete n[r]}(i,c):(e[u]=i,o[u]=!0)}})};for(var i in t)r(i);var o=[];for(var s in n){var u=n[s];o.push({topCell:F(u),cells:u})}return o}function F(t){return Object.keys(t).map(function(t){return f.a.parsePosition(t)}).sort(function(t,n){return t.col!==n.col?n.col-t.col:t.row-n.row})[0]}var V,U=function(n){var e=n.selector;t(e).css("display","none")},x=function(n){var e=n.selector;t(e).css("display","block")}}).call(n,e(25))},2262:function(t,n,e){"use strict";(function(t){e.d(n,"h",function(){return I}),e.d(n,"b",function(){return A}),e.d(n,"c",function(){return H}),e.d(n,"f",function(){return F}),e.d(n,"g",function(){return V}),e.d(n,"d",function(){return U}),e.d(n,"e",function(){return x});var r,i,o,s,u,c,a,f,h,l=e(0),d=e.n(l),v=e(3),b=e(487),p=e.n(b),m=e(7),y=e(29),O=e(2208),g=e(2150),w=e(2679),j=e(32),S=e(52),k=e(39),_=e(18),P=e(2680),L=e(344),M=this&&this.__assign||function(){return(M=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},R=v.sheets.changeset,N=v.sheets.ajax.ajax,C=R.unpack,D=R.compose,E=v.sheets.alert.showAlert,T=function(t){return Object(_.b)("versionPreview")(t+"versionPreview")},I=T("@showPreview"),A=T("@hidePreview"),H=T("@init"),F=T("@setCurStep"),V=T("@setLoading"),U=T("loadPrevHistory"),x=T("refreshHistory"),z=T("_LoadPrevHistory"),B=T("_collectDelta"),J=T("_refresh"),q=T("_checkRange"),G={isShowPreview:[!1,(r={},r[I]=function(){return!0},r[A]=function(){return!1},r)],initData:[{},(i={},i[H]=function(t,n){return M(M({},t),n)},i)],isLoadingPreview:[!1,(o={},o[I]=function(){return!0},o.handlePreview=function(){return!1},o[V]=function(t,n){return n},o)],selected:[{},(s={},s[A]=function(){return{}},s[I]=function(t,n){return n},s)],prevId:[-1,{searchBaseVersion:function(t,n){var e=(void 0===n?{}:n).docHistoryId;return void 0===e?-1:e},handlePreview:function(){return-1}}],baseRev:[null,{searchBaseVersion:function(t,n){var e=(void 0===n?{}:n).rev;return void 0===e?null:e}}],sheetId:[{},(u={},u[I]=function(){return{}},u.handlePreview=function(t,n){return{id:n.sheetId}},u)],curDelta:[null,{handlePreview:function(t,n){return n.curDelta}}],baseDelta:[null,{handlePreview:function(t,n){return n.baseDelta}}],historyDelta:[{},{collectDelta:function(t,n){return n}}],steps:[[],(c={},c[I]=function(){return[]},c.loadVersionStepSucceed=function(t,n){return n},c)],curStep:[null,(a={},a[F]=function(t,n){return n},a)],failTimesCheck:[0,(f={},f[I]=function(){return 0},f.reCheck=function(t){return t+1},f)]},W=((h={searchBaseVersion:[I,Object(y.a)(Object(j.a)(function(t){var n=t.get;return n("::versionList.list").filter(function(t){return t.docHistoryId<n("selected.docHistoryId")})[0]}))],checkHistoryRange:["searchBaseVersion",q,Object(y.a)(Object(S.a)(),Object(L.a)(function(t){var n=t.trigger,e=t.get,r=e("::history.list").filter(g.e),i=e("prevId"),o=r[r.length-1],s=r[0],u=!1,c=!1;return-1!==i?(u=!o||o.id>i,c=!s||s.id<=i):u=!o||!!o,u||c?c?n(Object(m.c)(J)):e("::history.isLastPage")?n(Object(m.c)(B,{editHistories:r})):void n(Object(m.c)(z)):n(Object(m.c)(B,{editHistories:r}))}))],collectDelta:[B,Object(y.a)(Object(j.a)(function(t,n){var e=t.get,r=n.editHistories;return Object(w.a)(e("initData.fileType"),e("selected.docHistoryId"),e("prevId"),r.reverse())}))]})[U]=[z,Object(y.a)(Object(j.a)(function(t){var n=t.get;return Object(P.a)({url:n("initData.loadHistoryUrl"),start:n("::history.list.length"),headers:n("initData.headers")})}),Object(O.a)(N),g.c)],h[x]=[J,Object(y.a)(Object(j.a)(function(t){var n=t.get;return Object(P.a)({url:n("initData.loadHistoryUrl"),start:0,headers:n("initData.headers")})}),Object(O.a)(N),g.c)],h.reCheck=[U,x,Object(y.a)(Object(S.a)(),Object(k.a)(function(n){var e=n.get,r=e("failTimesCheck"),i=r>=5;return i&&(E({title:d()("版本加载失败，请稍后重试。")}),t({guid:e("initData.guid")},"version reCheck failed "+r,0,0,{name:"ERR_SHEET_VERSION_RECHECK"})),!i}),Object(L.a)(function(t){return(0,t.trigger)(Object(m.c)(q))}))],h.isHasBaseRev=["collectDelta",Object(y.a)(Object(k.a)(function(t){return null!=(0,t.get)("baseRev")}),Object(j.a)(function(t){var n=t.get;return Object(P.c)({url:n("initData.snapshotUrl"),rev:n("baseRev"),headers:n("initData.headers")})}),Object(O.a)(N),g.c,Object(j.a)(function(t,n){var e=t.get;return C(e("initData.fileType"),n)}))],h.hasNoBaseRev=["collectDelta",Object(y.a)(Object(k.a)(function(t){return null==(0,t.get)("baseRev")}),Object(j.a)(function(){return null}))],h.handlePreview=["hasNoBaseRev","isHasBaseRev",Object(y.a)(Object(S.a)(),Object(j.a)(function(t,n){var e=t.get,r=e("initData.fileType"),i=e("historyDelta"),o=C(r,i.delta),s=n?D(r,n,o):o;return{sheetId:i.sheet,curDelta:s,baseDelta:n||null}}))],h.steps=["handlePreview",Object(y.a)(Object(j.a)(function(t){var n=t.get,e=n("baseRev")||0;return Object(P.b)({url:n("initData.loadStepsUrl"),range:[e+1,n("selected.rev")],headers:n("initData.headers")})}),Object(O.a)(N))],h.loadVersionStepSucceed=["steps",g.c],h),Y={history:["selected","historyDelta",function(t,n){return p()({},t,n,{id:t.docHistoryId,history_type:2})}]};n.a={namespace:"versionPreview",reducers:G,events:W,selectors:Y}}).call(n,e(48))},2263:function(t,n,e){"use strict";n.a=function(t){var n=t.permissions.query.shimo.getUserPermission(),e=t.permissions.query.shimo.getFilePermission(),r=new o.Editor({isDisableFx:!1,editable:!1,commentable:!1,disableWorker:!0,isAllowOfflineEdit:!1,disableRenderOptimization:!1,user:n,file:e,localeConfig:{locale:t.getLocale()},linkClickCallback:t.linkClickCallback}),h={};return n&&e&&r.RV({user:n,file:e}),r.on(c.Rendered,function(t,n){a.forEach(function(e){var r=e[0],i=e[1],o=t.F.get(r);if(o&&!h[r]){var c={};if(i){var a=i.needConfig,f=u(i,["needConfig"]);a&&Object.assign(c,s({},o.config)),Object.assign(c,f)}!function(t,n,e){new t.Constructor(s(s({},e),{A:n}))}(o,n,c),h[r]=!0}})}.bind(null,t,r)),r.R.RR(f.JC,function(n){var e=n.action,r=t.permissions.query.shimo.getFilePermission();return{copy:r&&r.permissions&&!r.permissions.copyable?i()("根据企业设置，你没有权限复制内容，请联系文件所有者或企业管理员"):"",cut:i()("不能剪切历史预览表格"),paste:i()("不能粘贴至历史预览表格")}[e]}),r};var r=e(0),i=e.n(r),o=e(3),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},u=this&&this.__rest||function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]])}return e},c=o.sheets.Events,a=[["FilterViewport",{disabled:!0,needConfig:!0}],["PivotTable",{disableEvents:!0,needConfig:!0}],["CustomNames",{readonly:!0,needConfig:!1}],["HighlightPosition",{stateCacheKey:"sm-sheet-history-highlight-position",needConfig:!1}],["Comment",{needConfig:!0}],["ChartV2",null],["StatusBar",null],["ZoomScale",null],["CombineSheets",null],["WaterMark",{needConfig:!0}],["Remarks",null],["DateMention",{readonly:!0,needConfig:!0}],["DataValidation",null],["IterCalculation",null],["Outline",null]],f=(o.Editor,o.sheets.Hooks)},2373:function(t,n){t.exports={"还原":"Restore","请求编辑历史失败!":"Failed to request editing history!","请求历史失败":"Failed to request history","已还原到 ":"Has been restored to "," 的内容":" content of","还原失败，请稍候再试":"Failed to restore. Please retry later","路人":"Passer-by","路人-%s":"Passer-by -%s","高亮修改区域":"Highlight modifier area","取消筛选效果":"Cancel filter effect","邀请了 %s":"Invited %s","加入了文档":"to join the document","将表格 “%1” 重命名为 “%2”":'Rename "%1" to "%2"',"对 %s 取消了共享":"Canceled sharing for %s","将公开链接设置为只读":"Set public link to read-only","将公开链接设置为可写":"Set public link to writable","禁用了公开链接":"Public link disabled","创建了表格副本":"Created copy of table","把表格转让给 %s":"Transfer table to %s","保存了历史版本":"Previous version saved","将历史版本 “%1” 重命名为 “%2”":'Rename previous version "%1" to "%2"',"删除了历史版本 “%s”":'Deleted previous version "%s"',"锁定了表格 “%s”":'Locked table "%s"',"解锁了表格 “%s”":'Unlocked table "%s"',"编辑了锁定 “%s”":'Edited locked "%s"',"锁定了单元格 “%1-%2”":'Locked cell "%1-%2"',"解锁了单元格 “%1-%2”":'Unlocked cell "%1-%2"',"编辑了锁定 “%1-%2”":'Edited locked "%1-%2"',"删除了工作表 “%s”":'Deleted sheet "%s"',"创建了工作表 “%s”":'Created sheet "%s"',"创建了工作表 “%s” 的副本":'Created copy of sheet "%s"',"创建了表单 “%s”":'Created form "%s"',"删除了表单 “%s”":'Deleted form "%s"',"将公开链接设置为仅企业内部只读":"Set public link to read-only within enterprise","将公开链接设置为仅企业内部可写":"Set public link to writable within enterprise","开启了访问密码":"Access password enabled","关闭了访问密码":"Access password disabled","更换了访问密码":"Access password changed","创建了表格":"Created table","将表格还原到":"Restore table to","的内容":" content of","编辑了表格":"Edited table","点击预览历史":"Click to preview history","工作表已被锁定":"Sheet has been locked","当前工作表已被锁定，您无法还原历史。如需进行还原，请与该表格的所有者联系":"You cannot restore history because current sheet has been locked. If you need to restore it, please contact cell owner.","还原表格":"Restore table","该版本与当前表格内容一致，确认还原吗？":"This version is consistent with the content of the current form. Are you sure to restore?","确认将表格还原到 %s的内容吗？":"Are you sure to restore table to content of %s?","历史还原中,请稍等":"Restoring history. Please wait","停止编辑 1 分钟，会自动保存为一段历史":"Stop editing for 1 minute, it will be automatically saved as a history","版本":"Ver.","当前历史片段的数据可能已损坏，无法预览":"The data for the current history fragment may be corrupted and cannot be previewed.","共 %s 条编辑记录":"Totally %s entries of edit record","共 %s 条编辑记录, 查看第":"Totally %s entries of edit record. View No.","条":"entry"}},2374:function(t,n){t.exports={"还原":"復元","请求编辑历史失败!":"編集履歴のリクエストに失敗しました！","请求历史失败":"履歴のリクエストに失敗","已还原到 ":"復元しました"," 的内容":"の内容","还原失败，请稍候再试":"復元に失敗しました、少し待ってから再試行してください","路人":"通行人","路人-%s":"通行人-%s","高亮修改区域":"変更範囲をハイライト表示","取消筛选效果":"フィルタ効果を解除","邀请了 %s":" %sを招待しました","加入了文档":"ドキュメントに加わりました","将表格 “%1” 重命名为 “%2”":" スプレッドシート“%1” の名前を “%2”に変更","对 %s 取消了共享":" %sの共有を解除しました","将公开链接设置为只读":"公開リンクを閲覧のみに設定","将公开链接设置为可写":"公開リンクを書き込み可能に設定","禁用了公开链接":"公開リンクを無効にしました","创建了表格副本":"スプレッドシートのコピーを作成しました","把表格转让给 %s":"スプレッドシートを %sに移転しました","保存了历史版本":"版を保存しました","将历史版本 “%1” 重命名为 “%2”":"版 “%1”の名前を“%2”に変更しました","删除了历史版本 “%s”":"版“%s”を削除しました","锁定了表格 “%s”":"スプレッドシート“%s”をロックしました","解锁了表格 “%s”":"スプレッドシート“%s”のロックを解除しました","编辑了锁定 “%s”":"ロックされた“%s”を編集しました","锁定了单元格 “%1-%2”":"セル“%1-%2”をロックしました","解锁了单元格 “%1-%2”":"セル“%1-%2”のロックを解除しました","编辑了锁定 “%1-%2”":"ロックされた“%1-%2”を編集しました","删除了工作表 “%s”":"シート“%s”を削除しました","创建了工作表 “%s”":"シート“%s”を作成しました","创建了工作表 “%s” 的副本":"シート“%s”のコピーを作成しました","创建了表单 “%s”":"フォーム“%s”を作成しました","删除了表单 “%s”":"フォーム“%s”を削除しました","将公开链接设置为仅企业内部只读":"公開リンクを社内のみ・閲覧のみに設定","将公开链接设置为仅企业内部可写":"公開リンクを社内のみ・書き込み可能に設定","开启了访问密码":"アクセスコードが有効になりました","关闭了访问密码":"アクセスコードが無効になりました","更换了访问密码":"アクセスコードを変更しました","创建了表格":"スプレッドシートを作成しました","将表格还原到":"スプレッドシートを~に復元","的内容":"の内容","编辑了表格":"スプレッドシートを編集しました","点击预览历史":"クリックして履歴をプレビュー","工作表已被锁定":"シートはロックされています","当前工作表已被锁定，您无法还原历史。如需进行还原，请与该表格的所有者联系":"現在のシートはロックされているため、履歴を復元できません。復元するには、このスプレッドシートの所有者に連絡してください。","还原表格":"スプレッドシートを復元する","该版本与当前表格内容一致，确认还原吗？":"この版は現在の内容と同じです、復元しますか？","确认将表格还原到 %s的内容吗？":"%sの内容に復元しますか？","历史还原中,请稍等":"履歴の復元中、お待ちください","停止编辑 1 分钟，会自动保存为一段历史":"編集が1分間ストップすると、自動的に履歴が保存されます","版本":"バージョン","当前历史片段的数据可能已损坏，无法预览":"現在の履歴項目のデータは破損している可能性があります、プレビューできません","共 %s 条编辑记录":"計 %s 件の編集記録","共 %s 条编辑记录, 查看第":"計 %s 件の編集記録、~を表示","条":"件目","讨论":"話し合い","历史":"履歴"}},2375:function(t,n){t.exports={"星期日":"Sunday","星期一":"Monday","星期二":"Tuesday","星期三":"Wednesday","星期四":"Thursday","星期五":"Friday","星期六":"Saturday","不能重复创建版本":"Cannot repeatedly create version","创建失败":"Failed to create","版本创建成功，可在「更多」-「查看历史」-「版本」中查看":'Version created successfully. You can check it in "More"-"View history"-"versions"',"保存版本":"Save version","删除失败，请稍候再试":"Failed to delete. Please retry later","已还原到 ":"Has been restored to "," 的内容":" content of","还原失败，请稍候再试":"Failed to restore. Please retry later","当前历史片段的数据可能已损坏，无法预览":"The data for the current history fragment may be corrupted and cannot be previewed.","版本加载失败，请稍后重试。":"Failed to load. Please retry later.","版本名称不能为空":"Version name cannot be empty","删除版本":"Delete version","确认删除历史版本“%s”吗？<br>该删除不会影响表格内容。":'Are you sure to delete previous version "%s"? <br>Such deletion will not affect sheet contents.',"保存了版本":"Saved version","删除":"Delete","点击预览版本":"Click to preview version","工作表已被锁定":"Sheet has been locked","当前工作表已被锁定，您无法还原历史。如需进行还原，请与该表格的所有者联系":"You cannot restore history because current sheet has been locked. If you need to restore it, please contact cell owner.","版本还原中,请稍等":"Restoring version. Please wait","还原表格":"Restore table","确认将表格还原到历史版本 %s 吗？":"Are you sure to restore sheet to previous version %s？","这里会显示所有保存的版本":"All saved versions will be shown here","保存当前版本":"Save current version","还原":"Restore"}},2376:function(t,n){t.exports={"星期日":"日曜日","星期一":"月曜日","星期二":"火曜日","星期三":"水曜日","星期四":"木曜日","星期五":"金曜日","星期六":"土曜日","不能重复创建版本":"版を繰り返し作成することはできません","创建失败":"作成に失敗","版本创建成功，可在「更多」-「查看历史」-「版本」中查看":"版の作成に成功しました、「その他」-「履歴を表示」-「版」で表示できます","保存版本":"版を保存","删除失败，请稍候再试":"削除に失敗しました、少し待ってから再試行してください","已还原到 ":"復元しました"," 的内容":"の内容","还原失败，请稍候再试":"復元に失敗しました、少し待ってから再試行してください","当前历史片段的数据可能已损坏，无法预览":"現在の履歴項目のデータは破損している可能性があります、プレビューできません","版本加载失败，请稍后重试。":"版のロードに失敗しました、少し待ってから再試行してください。","版本名称不能为空":"版の名前を空白にすることはできません","删除版本":"版を削除","确认删除历史版本“%s”吗？<br>该删除不会影响表格内容。":"版“%s”を削除しますか？<br>この削除はスプレッドシートの内容には影響しません。","保存了版本":"版を保存しました","删除":"削除","点击预览版本":"クリックして版をプレビュー","工作表已被锁定":"シートはロックされています","当前工作表已被锁定，您无法还原历史。如需进行还原，请与该表格的所有者联系":"現在のシートはロックされているため、履歴を復元できません。復元するには、このスプレッドシートの所有者に連絡してください。","版本还原中,请稍等":"版の復元中、お待ちください","还原表格":"スプレッドシートを復元する","确认将表格还原到历史版本 %s 吗？":"版 %s に復元しますか？","这里会显示所有保存的版本":"ここに保存されたすべての版が表示されます","保存当前版本":"現在の版を保存","还原":"復元"}},2377:function(t,n,e){"use strict";var r=function(){function t(t){var n=t.rootSelector,e=t.content,r=t.className;this.root=document.querySelector(n),this.tip=null,this.content=e||"",this.className=r||""}return t.prototype.init=function(){if(this.root){var t=document.createElement("div");t.className="s-tooltip "+this.className,t.innerHTML=this.content,this.tip=t,this.root.appendChild(t)}},t.prototype.show=function(t){var n=this;void 0===t&&(t={}),this.tip&&(this.tip.style.display="block",this.tip.style.visibility="visible",Object.keys(t).forEach(function(e){n.tip&&(n.tip.style[e]=t[e])}))},t.prototype.hide=function(){this.tip&&(this.tip.style.display="none",this.tip.style.visibility="hidden")},t.prototype.showInCenter=function(t){if(this.tip||this.init(),this.tip&&this.root&&t){var n=t.getBoundingClientRect(),e=this.tip.getBoundingClientRect(),r=this.root.getBoundingClientRect(),i={top:n.top-r.top+(n.height-e.height)/2+"px"};this.show(i)}},t}();n.a=r},2378:function(t,n,e){"use strict";n.a=function(t){var n=t.toggleHighlight,e=t.isHighlight,r=t.toggleRenderFilter,o=t.isRenderFilter;return s.a.createElement("div",{className:"s-footer",ref:"footer"},s.a.createElement("div",{className:"s-footer-item"},s.a.createElement("span",{className:"s-footer-checkbox s-toolbar-icon s-toolbar-icon-checkbox"+(e?"-checked":""),onClick:n}),s.a.createElement("span",{className:"s-footer-text",onClick:n},i()("高亮修改区域"))),s.a.createElement("div",{className:"s-footer-item"},s.a.createElement("span",{className:"s-footer-checkbox s-toolbar-icon s-toolbar-icon-checkbox"+(o?"":"-checked"),onClick:r}),s.a.createElement("span",{className:"s-footer-text",onClick:r},i()("取消筛选效果"))))};var r=e(0),i=e.n(r),o=e(1),s=e.n(o)},2379:function(t,n,e){"use strict";e.d(n,"a",function(){return s});var r=e(2669),i=e(2210),o=e(18);e.d(n,"c",function(){return i.b}),e.d(n,"b",function(){return i.a});var s=Object(o.a)(i.b.dispatch,r)},2380:function(t,n,e){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},2381:function(t,n,e){var r=e(2380),i={};for(var o in r)r.hasOwnProperty(o)&&(i[r[o]]=o);var s=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var u in s)if(s.hasOwnProperty(u)){if(!("channels"in s[u]))throw new Error("missing channels property: "+u);if(!("labels"in s[u]))throw new Error("missing channel labels property: "+u);if(s[u].labels.length!==s[u].channels)throw new Error("channel and label counts mismatch: "+u);var c=s[u].channels,a=s[u].labels;delete s[u].channels,delete s[u].labels,Object.defineProperty(s[u],"channels",{value:c}),Object.defineProperty(s[u],"labels",{value:a})}s.rgb.hsl=function(t){var n,e,r=t[0]/255,i=t[1]/255,o=t[2]/255,s=Math.min(r,i,o),u=Math.max(r,i,o),c=u-s;return u===s?n=0:r===u?n=(i-o)/c:i===u?n=2+(o-r)/c:o===u&&(n=4+(r-i)/c),(n=Math.min(60*n,360))<0&&(n+=360),e=(s+u)/2,[n,100*(u===s?0:e<=.5?c/(u+s):c/(2-u-s)),100*e]},s.rgb.hsv=function(t){var n,e,r,i,o,s=t[0]/255,u=t[1]/255,c=t[2]/255,a=Math.max(s,u,c),f=a-Math.min(s,u,c),h=function(t){return(a-t)/6/f+.5};return 0===f?i=o=0:(o=f/a,n=h(s),e=h(u),r=h(c),s===a?i=r-e:u===a?i=1/3+n-r:c===a&&(i=2/3+e-n),i<0?i+=1:i>1&&(i-=1)),[360*i,100*o,100*a]},s.rgb.hwb=function(t){var n=t[0],e=t[1],r=t[2];return[s.rgb.hsl(t)[0],100*(1/255*Math.min(n,Math.min(e,r))),100*(r=1-1/255*Math.max(n,Math.max(e,r)))]},s.rgb.cmyk=function(t){var n,e=t[0]/255,r=t[1]/255,i=t[2]/255;return[100*((1-e-(n=Math.min(1-e,1-r,1-i)))/(1-n)||0),100*((1-r-n)/(1-n)||0),100*((1-i-n)/(1-n)||0),100*n]},s.rgb.keyword=function(t){var n=i[t];if(n)return n;var e,o,s,u=1/0;for(var c in r)if(r.hasOwnProperty(c)){var a=r[c],f=(o=t,s=a,Math.pow(o[0]-s[0],2)+Math.pow(o[1]-s[1],2)+Math.pow(o[2]-s[2],2));f<u&&(u=f,e=c)}return e},s.keyword.rgb=function(t){return r[t]},s.rgb.xyz=function(t){var n=t[0]/255,e=t[1]/255,r=t[2]/255;return[100*(.4124*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.3576*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*n+.7152*e+.0722*r),100*(.0193*n+.1192*e+.9505*r)]},s.rgb.lab=function(t){var n=s.rgb.xyz(t),e=n[0],r=n[1],i=n[2];return r/=100,i/=108.883,e=(e/=95.047)>.008856?Math.pow(e,1/3):7.787*e+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(e-r),200*(r-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]},s.hsl.rgb=function(t){var n,e,r,i,o,s=t[0]/360,u=t[1]/100,c=t[2]/100;if(0===u)return[o=255*c,o,o];n=2*c-(e=c<.5?c*(1+u):c+u-c*u),i=[0,0,0];for(var a=0;a<3;a++)(r=s+1/3*-(a-1))<0&&r++,r>1&&r--,o=6*r<1?n+6*(e-n)*r:2*r<1?e:3*r<2?n+(e-n)*(2/3-r)*6:n,i[a]=255*o;return i},s.hsl.hsv=function(t){var n=t[0],e=t[1]/100,r=t[2]/100,i=e,o=Math.max(r,.01);return e*=(r*=2)<=1?r:2-r,i*=o<=1?o:2-o,[n,100*(0===r?2*i/(o+i):2*e/(r+e)),100*((r+e)/2)]},s.hsv.rgb=function(t){var n=t[0]/60,e=t[1]/100,r=t[2]/100,i=Math.floor(n)%6,o=n-Math.floor(n),s=255*r*(1-e),u=255*r*(1-e*o),c=255*r*(1-e*(1-o));switch(r*=255,i){case 0:return[r,c,s];case 1:return[u,r,s];case 2:return[s,r,c];case 3:return[s,u,r];case 4:return[c,s,r];case 5:return[r,s,u]}},s.hsv.hsl=function(t){var n,e,r,i=t[0],o=t[1]/100,s=t[2]/100,u=Math.max(s,.01);return r=(2-o)*s,e=o*u,[i,100*(e=(e/=(n=(2-o)*u)<=1?n:2-n)||0),100*(r/=2)]},s.hwb.rgb=function(t){var n,e,r,i,o,s,u,c=t[0]/360,a=t[1]/100,f=t[2]/100,h=a+f;switch(h>1&&(a/=h,f/=h),e=1-f,r=6*c-(n=Math.floor(6*c)),0!=(1&n)&&(r=1-r),i=a+r*(e-a),n){default:case 6:case 0:o=e,s=i,u=a;break;case 1:o=i,s=e,u=a;break;case 2:o=a,s=e,u=i;break;case 3:o=a,s=i,u=e;break;case 4:o=i,s=a,u=e;break;case 5:o=e,s=a,u=i}return[255*o,255*s,255*u]},s.cmyk.rgb=function(t){var n=t[0]/100,e=t[1]/100,r=t[2]/100,i=t[3]/100;return[255*(1-Math.min(1,n*(1-i)+i)),255*(1-Math.min(1,e*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i))]},s.xyz.rgb=function(t){var n,e,r,i=t[0]/100,o=t[1]/100,s=t[2]/100;return e=-.9689*i+1.8758*o+.0415*s,r=.0557*i+-.204*o+1.057*s,n=(n=3.2406*i+-1.5372*o+-.4986*s)>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,e=e>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(n=Math.min(Math.max(0,n),1)),255*(e=Math.min(Math.max(0,e),1)),255*(r=Math.min(Math.max(0,r),1))]},s.xyz.lab=function(t){var n=t[0],e=t[1],r=t[2];return e/=100,r/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116)-16,500*(n-e),200*(e-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},s.lab.xyz=function(t){var n,e,r,i=t[0],o=t[1],s=t[2];n=o/500+(e=(i+16)/116),r=e-s/200;var u=Math.pow(e,3),c=Math.pow(n,3),a=Math.pow(r,3);return e=u>.008856?u:(e-16/116)/7.787,n=c>.008856?c:(n-16/116)/7.787,r=a>.008856?a:(r-16/116)/7.787,[n*=95.047,e*=100,r*=108.883]},s.lab.lch=function(t){var n,e=t[0],r=t[1],i=t[2];return(n=360*Math.atan2(i,r)/2/Math.PI)<0&&(n+=360),[e,Math.sqrt(r*r+i*i),n]},s.lch.lab=function(t){var n,e=t[0],r=t[1];return n=t[2]/360*2*Math.PI,[e,r*Math.cos(n),r*Math.sin(n)]},s.rgb.ansi16=function(t){var n=t[0],e=t[1],r=t[2],i=1 in arguments?arguments[1]:s.rgb.hsv(t)[2];if(0===(i=Math.round(i/50)))return 30;var o=30+(Math.round(r/255)<<2|Math.round(e/255)<<1|Math.round(n/255));return 2===i&&(o+=60),o},s.hsv.ansi16=function(t){return s.rgb.ansi16(s.hsv.rgb(t),t[2])},s.rgb.ansi256=function(t){var n=t[0],e=t[1],r=t[2];return n===e&&e===r?n<8?16:n>248?231:Math.round((n-8)/247*24)+232:16+36*Math.round(n/255*5)+6*Math.round(e/255*5)+Math.round(r/255*5)},s.ansi16.rgb=function(t){var n=t%10;if(0===n||7===n)return t>50&&(n+=3.5),[n=n/10.5*255,n,n];var e=.5*(1+~~(t>50));return[(1&n)*e*255,(n>>1&1)*e*255,(n>>2&1)*e*255]},s.ansi256.rgb=function(t){if(t>=232){var n=10*(t-232)+8;return[n,n,n]}var e;return t-=16,[Math.floor(t/36)/5*255,Math.floor((e=t%36)/6)/5*255,e%6/5*255]},s.rgb.hex=function(t){var n=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(n.length)+n},s.hex.rgb=function(t){var n=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!n)return[0,0,0];var e=n[0];3===n[0].length&&(e=e.split("").map(function(t){return t+t}).join(""));var r=parseInt(e,16);return[r>>16&255,r>>8&255,255&r]},s.rgb.hcg=function(t){var n,e,r=t[0]/255,i=t[1]/255,o=t[2]/255,s=Math.max(Math.max(r,i),o),u=Math.min(Math.min(r,i),o),c=s-u;return n=c<1?u/(1-c):0,e=c<=0?0:s===r?(i-o)/c%6:s===i?2+(o-r)/c:4+(r-i)/c+4,e/=6,[360*(e%=1),100*c,100*n]},s.hsl.hcg=function(t){var n=t[1]/100,e=t[2]/100,r=1,i=0;return(r=e<.5?2*n*e:2*n*(1-e))<1&&(i=(e-.5*r)/(1-r)),[t[0],100*r,100*i]},s.hsv.hcg=function(t){var n=t[1]/100,e=t[2]/100,r=n*e,i=0;return r<1&&(i=(e-r)/(1-r)),[t[0],100*r,100*i]},s.hcg.rgb=function(t){var n=t[0]/360,e=t[1]/100,r=t[2]/100;if(0===e)return[255*r,255*r,255*r];var i,o=[0,0,0],s=n%1*6,u=s%1,c=1-u;switch(Math.floor(s)){case 0:o[0]=1,o[1]=u,o[2]=0;break;case 1:o[0]=c,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=u;break;case 3:o[0]=0,o[1]=c,o[2]=1;break;case 4:o[0]=u,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=c}return i=(1-e)*r,[255*(e*o[0]+i),255*(e*o[1]+i),255*(e*o[2]+i)]},s.hcg.hsv=function(t){var n=t[1]/100,e=n+t[2]/100*(1-n),r=0;return e>0&&(r=n/e),[t[0],100*r,100*e]},s.hcg.hsl=function(t){var n=t[1]/100,e=t[2]/100*(1-n)+.5*n,r=0;return e>0&&e<.5?r=n/(2*e):e>=.5&&e<1&&(r=n/(2*(1-e))),[t[0],100*r,100*e]},s.hcg.hwb=function(t){var n=t[1]/100,e=n+t[2]/100*(1-n);return[t[0],100*(e-n),100*(1-e)]},s.hwb.hcg=function(t){var n=t[1]/100,e=1-t[2]/100,r=e-n,i=0;return r<1&&(i=(e-r)/(1-r)),[t[0],100*r,100*i]},s.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},s.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},s.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},s.gray.hsl=s.gray.hsv=function(t){return[0,0,t[0]]},s.gray.hwb=function(t){return[0,100,t[0]]},s.gray.cmyk=function(t){return[0,0,0,t[0]]},s.gray.lab=function(t){return[t[0],0,0]},s.gray.hex=function(t){var n=255&Math.round(t[0]/100*255),e=((n<<16)+(n<<8)+n).toString(16).toUpperCase();return"000000".substring(e.length)+e},s.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}},2382:function(t,n,e){"use strict";(function(t){e.d(n,"e",function(){return L}),e.d(n,"i",function(){return M}),e.d(n,"d",function(){return R}),e.d(n,"f",function(){return N}),e.d(n,"c",function(){return C}),e.d(n,"b",function(){return D}),e.d(n,"h",function(){return E}),e.d(n,"g",function(){return T}),e.d(n,"j",function(){return I});var r,i,o,s,u,c,a,f,h=e(0),l=e.n(h),d=e(2208),v=e(29),b=e(2383),p=e(2150),m=e(32),y=e(18),O=e(3),g=this&&this.__assign||function(){return(g=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},w=O.sheets.ajax.ajax,j=O.sheets.alert,S=O.sheets.utils,k=j.showAlert,_=S.dateTime.format,P=function(t){return Object(y.b)("versionList")(t+"versionList")},L=P("@loadVersion"),M=P("@toggleListShow"),R=P("@initData"),N=P("@reload"),C=P("@destory"),D=P("@delete"),E=P("@setSelected"),T=P("@revertVersion"),I=P("@updateVersion"),A={isShowList:[!1,(r={},r[M]=function(t,n){return n},r)],initData:[{},(i={},i[R]=function(t,n){return g(g({},t),n)},i)],shouldReload:[!1,(o={},o[N]=function(t,n){return n},o[C]=function(){return!1},o)],deleteItemId:[null,(s={},s[D]=function(t,n){return n},s.deleteVersionSucceed=function(){return null},s.deleteVersionFailed=function(){return null},s)],isLoadingList:[!1,(u={},u[L]=function(){return!0},u.setVersionLoading=function(){return!0},u.loadVersionSucceed=function(){return!1},u[D]=function(){return!0},u.deleteVersionSucceed=function(){return!1},u.deleteVersionFailed=function(){return!1},u)],list:[[],{loadVersionSucceed:function(t,n){return n.reverse().map(function(t){return t})},deleteVersionSucceed:function(t,n){return t.filter(function(t){return t.id!==n})}}],selected:[{},(c={},c[C]=function(){return{}},c[E]=function(t,n){return n||{}},c)],isReverting:[!1,(a={},a[T]=function(){return!0},a.onRevertSucceed=function(){return!1},a.onRevertFailed=function(){return!1},a)],revertItem:[{},(f={},f[T]=function(t,n){return n},f.onRevertSucceed=function(){return{}},f.onRevertFailed=function(){return{}},f)]},H={loadVersionList:[L,Object(v.a)(Object(m.a)(function(t,n){var e=t.get,r=n.url;return Object(b.c)({url:r,headers:e("initData.headers")})}),Object(d.a)(w))],setVersionLoading:["loadVersionList",p.b],loadVersionSucceed:["loadVersionList",p.c],onDeleteVesion:[D,Object(v.a)(Object(m.a)(function(t){var n=t.get;return Object(b.a)({url:n("initData.deleteVersionUrl"),id:n("deleteItemId"),headers:n("initData.headers")})}),Object(d.a)(w))],deleteVersionSucceed:["onDeleteVesion",Object(v.a)(p.c,Object(m.a)(function(t){return(0,t.get)("deleteItemId")}))],deleteVersionFailed:["onDeleteVesion",Object(v.a)(p.a,Object(m.a)(function(t,n){k({title:n.error&&n.error.message||l()("删除失败，请稍候再试"),type:"error"})}))],onRevert:[T,Object(v.a)(Object(m.a)(function(t){var n=t.get;return Object(b.b)({url:n("initData.revertVersionUrl"),id:n("revertItem.docHistoryId"),headers:n("initData.headers")})}),Object(d.a)(w))],onRevertSucceed:["onRevert",Object(v.a)(p.c,Object(m.a)(function(t,n){var e=t.get,r=n.result;return k({title:l()("已还原到 ")+_(e("revertItem.updated_at"),!0)+l()(" 的内容")}),r}))],onRevertFailed:["onRevert",Object(v.a)(p.a,Object(m.a)(function(n,e){var r=n.get;k({title:e.error&&e.error.message||l()("还原失败，请稍候再试"),type:"error"}),t({guid:r("initData.guid"),err:e&&JSON.stringify(e)},"version revert",0,0,{name:"ERR_SHEET_VERSION_REVERT_FAILED"})}))],onUpdateVersion:[I,Object(v.a)(Object(m.a)(function(t,n){var e=t.get,r=n.id,i=n.label;return Object(b.d)({url:e("initData.updateVersionUrl"),id:r,label:i,headers:e("initData.headers")})}),Object(d.a)(w))]};n.a={namespace:"versionList",reducers:A,events:H}}).call(n,e(48))},2383:function(t,n,e){"use strict";e.d(n,"c",function(){return o}),e.d(n,"a",function(){return s}),e.d(n,"b",function(){return u}),e.d(n,"d",function(){return c});var r=e(801),i=e.n(r),o=function(t){return{url:t.url,method:"GET",headers:t.headers}},s=function(t){var n=t.url,e=t.id,r=t.headers;return{url:n=n.replace("{id}",e.toString()),method:"DELETE",headers:r}},u=function(t){var n=t.url,e=t.id,r=t.headers;return{url:n,method:"POST",params:i.a.stringify({dhId:e}),headers:r}},c=function(t){var n=t.url,e=t.id,r=t.label,o=t.headers;return{url:n=n.replace("{id}",e.toString()),method:"PATCH",params:i.a.stringify({label:r}),headers:o}}},2384:function(t,n,e){"use strict";e.d(n,"a",function(){return s});var r=e(2683),i=e(2210),o=e(18);e.d(n,"c",function(){return i.b}),e.d(n,"b",function(){return i.a});var s=Object(o.a)(i.b.dispatch,r)},2385:function(t,n,e){"use strict";(function(t,r){var i,o=e(0),s=e.n(o),u=e(1),c=e.n(u),a=e(3),f=e(2261),h=e(2684),l=this&&this.__extends||(i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),d=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e(function(t){t(n)})).then(s,u)}c((r=r.apply(t,n||[])).next())})},v=this&&this.__generator||function(t,n){var e,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(t,s)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},b=a.sheets.changeset,p=a.sheets,m=p.sheet,y=p.loading,O=p.Events,g=p.utils.dateTime,w=m.scrollToCellByCS,j=b.unpack,S=b.compose,k=y.Loading,_=g.autoRefresh,P=g.format,L=function(n){function e(t){var e=n.call(this,t)||this;return e.onSwitchSheet=function(){e.toggleHightLight(e.props.highLight)},e.onChangeStyleOnPaintingCell=function(t){var n=t.style,r=t.source,i=t.cell;if("history"===r){var o=i.row,s=i.col;if(3===i.sheetArea&&null!=e.currentId&&e.Q&&e.props.highLight){var u=e.highlightCellsData[o+"-"+s];n.foreColor="",n.backColor=u}}},e.onMouseMove=function(t){var n=t.pageX,r=t.pageY,i=e.spread&&e.spread.gcSpread.B();if(i){var o=e.props.wrapperClass,s=Object(f.d)(i,n,r,"."+o+" .sm-history-preview #sm-canvas-container"),u=s.row,c=s.col,a=e.hoverCell;a&&a.row===u&&a.col===c||e._afterHoveredCellChanged(s)}},e.onMouseOut=function(){e._afterHoveredCellChanged({row:-1,col:-1})},e.spread=null,e.A=t.previewEditor,e.currentId=null,e.Q=null,e.syncSheetZoom=e.syncSheetZoom.bind(e),e.fileType=t.fileType||-4,e.highlightCellsData={},e.state={rendering:!1},e}return l(e,n),e.prototype.componentWillReceiveProps=function(t){return d(this,void 0,Promise,function(){var n,e,r,i=this;return v(this,function(o){switch(o.label){case 0:return n=this.props,e=n.isPreview,r=n.wrapperClass,e&&!t.isPreview&&(this.A.spread&&this.A.spread.reset(),Object(f.h)({selector:"."+r})),!e&&t.isPreview&&(this.A.emit(O.JD,{isPreviewShownBefore:!1}),Object(f.k)({selector:"."+r})),t.isPreview&&n.curDelta!==t.curDelta&&t.curDelta?(this.curStepCs=t.curDelta,this.spread?[4,this.initSpread(t)]:[3,2]):[3,3];case 1:return o.sent(),[3,3];case 2:setTimeout(function(){i.initSpread(t)}),o.label=3;case 3:return t.isPreview&&n.curStep!==t.curStep&&t.curStep?[4,this.showHistorySetp(t.curStep)]:[3,5];case 4:o.sent(),o.label=5;case 5:return t.isPreview&&n.highLight!==t.highLight&&this.spread&&this.toggleHightLight(t.highLight,!0),[2]}})})},e.prototype.componentDidMount=function(){this.A.on(O.IV,this.onSwitchSheet),this.A.on(O.ChangeStyleOnPaintingCell,this.onChangeStyleOnPaintingCell),_("#s-history-wrap .s-history-head"),t(this.refs.wrap).on("mousemove","#sm-canvas-container-viewport",this.onMouseMove).on("mouseout","#sm-canvas-container-viewport",this.onMouseOut);var n=this.props;n.initStateAction({fileType:this.fileType,snapshotUrl:n.snapshotUrl,loadStepsUrl:n.loadStepsUrl,loadHistoryUrl:n.loadHistoryUrl,headers:n.headers})},e.prototype.componentWillUnmount=function(){this.A.off(O.IV,this.onSwitchSheet),this.A.off(O.ChangeStyleOnPaintingCell,this.onChangeStyleOnPaintingCell),t(this.refs.wrap).off("mousemove",this.onMouseMove).off("mouseout",this.onMouseOut)},e.prototype.initSpread=function(t){return d(this,void 0,Promise,function(){var n,e;return v(this,function(r){switch(r.label){case 0:return n=t.selected.userId,e="string"==typeof n?n.split(",").map(Number):[],[4,this.setContent({sheetId:t.sheetId.id,file:t.curDelta,currentCs:j(this.fileType,JSON.parse(t.selected.content).changeset),currentId:t.selected.id,userId:1===e.length?e[0]:void 0})];case 1:return r.sent(),setTimeout(this.syncSheetZoom),[2]}})})},e.prototype.syncSheetZoom=function(){var t=this.props.A.spread.B().E.zoom(),n=this.A.spread,e=n&&n.B();e&&e.actions.changeSheetZoom(t)},e.prototype.showHistorySetp=function(t){var n=t.cs,e=t.curStep;return d(this,void 0,Promise,function(){var t,r;return v(this,function(i){switch(i.label){case 0:return t=this.props.cooperation,r=j(this.fileType,e.delta),this.curStepCs=S(this.fileType,this.curStepCs,n),[4,this.setContent({sheetId:Object(f.e)(this.curStepCs,r),file:this.curStepCs,currentCs:r,currentId:e.rev,userId:e.userId})];case 1:return i.sent(),this.spread&&Object(f.b)(t,e.rev,this.spread.gcSpread),[2]}})})},e.prototype.setContent=function(n){var e=n.sheetId,i=n.file,o=n.currentId,s=n.currentCs,u=n.userId;return d(this,void 0,Promise,function(){var n,c,a,h,l;return v(this,function(d){switch(d.label){case 0:this.setState({rendering:!0}),n=this.props,c=n.container,a=n.highLight,h=this.fileType,this.currentId=o,this.Q=i,Object(f.a)(o,h,s,i,u),d.label=1;case 1:return d.trys.push([1,7,,8]),this.spread?[3,3]:[4,this.A.render({fileType:h,content:i,container:t(c).find(".sm-history-preview")[0],activeSheetId:e,spreadOptions:{isHistoryPreview:!0,rightPadding:0,allowScrollByPixel:!0,showPermissionError:function(){return null}}})];case 2:return d.sent(),this.spread=this.A.spread,this.toggleHightLight(a),[3,6];case 3:return[4,this.A.setContent(i)];case 4:return d.sent(),[4,this.A.spread.TK(String(e))];case 5:d.sent(),d.label=6;case 6:return this.props.injectEditorToStore({A:this.A}),this.props.setEditorFilterRenderStatus(),[3,8];case 7:return l=d.sent(),r({error:l},"",0,0,{name:"ERR_SHEET_HISTORY_SET_EDITOR_CONTENT_FAILED"}),[3,8];case 8:return w(this.spread.gcSpread.B(),h,s),this.setState({rendering:!1}),[2]}})})},e.prototype.toggleHightLight=function(t,n){this.props.setPreviewLoadingAction(!0),null!=this.currentId&&this.Q&&(this.highlightCellsData=t?Object(f.f)({cooperation:this.props.cooperation,currentId:this.currentId,spread:this.spread.gcSpread}):{},n&&Object(f.j)(this.spread.gcSpread),this.props.setPreviewLoadingAction(!1))},e.prototype._afterHoveredCellChanged=function(t){var n=this.props,e=n.contactUrl,r=n.highLight,i=n.cooperation,o=n.users;this.hoverCell=t;var s=t.row,u=void 0===s?-1:s,c=t.col,a=void 0===c?-1:c,h=this.spread&&this.spread.gcSpread.B();r&&u>=0&&a>=0&&h&&this.currentId&&Object(f.i)({url:e,id:this.currentId,sheet:h,cooperation:i,cell:t,collabUsers:o})},e.prototype.render=function(){var t=this.props,n=t.isPreview,e=t.baseDelta,r=t.isLoading,i=t.A,o=t.steps,u=t.onSetCurStepAction,a=t.selected,f=t.wrapperClass,l=this.state.rendering,d=i.isRendered&&this.spread,v=r||!d||l;return c.a.createElement("div",{className:f},c.a.createElement("div",{id:"s-history-wrap"},c.a.createElement(k,{isShow:n&&v,wrapperClass:"s-history-loading",imgClass:"s-history-loading-img"}),n&&c.a.createElement("div",{className:"s-history-head"},c.a.createElement(h.a,{items:o,baseDelta:e,historyStepChange:u,fileType:this.fileType}),"sm-sheet-editor-history"===f&&c.a.createElement("span",null,c.a.createElement("span",{className:"sm-sheet-history-header-title"},a&&P(a.updated_at,!0)||""),c.a.createElement("span",{className:"sm-sheet-history-header-info"},s()("停止编辑 1 分钟，会自动保存为一段历史"))),"sm-sheet-editor-version"===f&&c.a.createElement("div",null,c.a.createElement("span",{className:"sm-sheet-history-header-title"},s()("版本")+": "+a.label))),c.a.createElement("div",{className:"s-history-body"},c.a.createElement("div",{className:"sm-history-preview",ref:"wrap"}))))},e}(u.Component);n.a=L}).call(n,e(25),e(48))},2386:function(t,n,e){"use strict";e.d(n,"a",function(){return s});var r=e(2689),i=e(2210),o=e(18);e.d(n,"c",function(){return i.b}),e.d(n,"b",function(){return i.a});var s=Object(o.a)(i.b.dispatch,r)},2387:function(t,n,e){"use strict";n.b=function(t){var n=t?new Date(t):new Date,e=[i()("星期日"),i()("星期一"),i()("星期二"),i()("星期三"),i()("星期四"),i()("星期五"),i()("星期六")],r=n.getMinutes(),o=n.getHours();return r<10&&(r="0"+r),o<10&&(o="0"+o),n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate()+" "+e[n.getDay()]+" "+o+":"+r},n.a=function(t,n){if(!t)return t;for(var e=n||32,r=/[^\x00-\xff]/,i=t.split(""),o=i.length,s=0,u=0,c=0;c<o;c++){var a=r.test(i[c])?2:1;if(s+a>e)break;u=c+1,s+=a}return t.substr(0,u)};var r=e(0),i=e.n(r)},2388:function(t,n,e){"use strict";e.d(n,"a",function(){return s});var r=e(2697),i=e(2210),o=e(18);e.d(n,"c",function(){return i.b}),e.d(n,"b",function(){return i.a});var s=Object(o.a)(i.b.dispatch,r)},2389:function(t,n,e){"use strict";e.d(n,"c",function(){return d}),e.d(n,"a",function(){return v}),e.d(n,"b",function(){return h});var r=e(196),i=(e.n(r),e(771)),o=e(18),s=e(772),u=e(775),c=e(2700),a=e(2701),f=e(3).sheets.log.Raven,h=Object(i.a)([c.a]),l=Object(r.applyMiddleware)(Object(u.a)(function(t){t.action;var n=t.error;f.captureException(n)})),d=Object(s.a)({module:h,enhancer:l}),v=Object(o.a)(d.dispatch,a)},2657:function(t,n,e){"use strict";e.d(n,"a",function(){return i});var r,i,o=e(0),s=e.n(o),u=(e(2658),e(1)),c=e.n(u),a=e(6),f=e.n(a),h=e(2661),l=e(3),d=e(2255),v=e(2662),b=e(2685),p=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),m=this&&this.__assign||function(){return(m=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},y=(l.sheets.root,l.sheets.path),O=l.sheets.Plugin,g=(y.setByPath,"HistorySidebarSkeleton");!function(t){t.History="history",t.Discord="discord",t.Version="version"}(i||(i={}));var w=function(t){function n(e){var r=t.call(this,{name:g,Constructor:n,config:e})||this;r.options=e;var o=e.A,u=e.guid,c=e.history,a=e.version,f=[];if(c){var h=m(m({},c),e);r.JL(h),r.JK(h),f.push({tag:i.History,name:s()("历史"),component:r.historyList})}if(a){h=m(m({},a),e);r.JM(h),r.JN(h),f.push({tag:i.Version,name:s()("版本"),component:r.versionList})}return f.length&&r.JJ({A:o,guid:u,appList:f}),e.container&&r.render(e.container),r.install(),r}return p(n,t),n.prototype.setLocale=function(t){s.a.setLocaleSync(t)},n.prototype.render=function(t){f.a.render(c.a.createElement(h.a,m({},m(m({},this.options),{container:t,historyPreview:this.historyPreview,sidebar:this.sidebar,versionPreview:this.versionPreview}))),t)},n.prototype.show=function(t){void 0===t&&(t=i.History),this.sidebar&&this.sidebar.show(t)},n.prototype.hide=function(){this.sidebar&&this.sidebar.hide()},n.prototype.JL=function(t){var n=this,e=t.toggleHistoryHightLight,r=t.onSelectHistory,i=t.closeHistorySidebar,o=t.toggleHistoryRenderFilter||function(){return n.historyList&&n.historyList.toggleRenderFilter()},s=i||function(){n.sidebar&&n.sidebar.hide(),n.historyPreview&&n.historyPreview.hide(),n.versionPreview&&n.versionPreview.hide()},u=r||function(t){n.historyList&&n.historyList.setSelectedItem(t),n.historyPreview&&n.historyPreview.show(t),n.versionList&&n.versionList.setSelectedItem(null),n.versionPreview&&n.versionPreview.hide()},c=m({toggleHighLight:(e||function(){return n.historyList&&n.historyList.toggleHighLight()}).bind(this),toggleRenderFilter:o.bind(this),afterRevert:s.bind(this),onSelectHistory:u.bind(this)},t);this.historyList=new v.a(c)},n.prototype.JM=function(t){var n=this,e=t.toggleHistoryHightLight,r=t.onSelectVersion,i=t.closeHistorySidebar,o=t.toggleHistoryRenderFilter,s=r||function(t){n.versionList&&n.versionList.setSelectedItem(t),n.versionPreview&&n.versionPreview.show(t),n.historyList&&n.historyList.setSelectedItem(null),n.historyPreview&&n.historyPreview.hide()},u=e||function(){n.historyList&&n.historyList.toggleHighLight()},c=o||function(){return n.historyList&&n.historyList.toggleRenderFilter()},a=m({afterRevert:(i||function(){n.sidebar&&n.sidebar.hide(),n.historyPreview&&n.historyPreview.hide(),n.versionPreview&&n.versionPreview.hide()}).bind(this),onSelectVersion:s.bind(this),toggleHighLight:u.bind(this),toggleRenderFilter:c.bind(this)},t);this.versionList=new b.a(a)},n.prototype.JJ=function(t){var n=this,e=t.A,r=t.guid,i=t.appList,o=t.closeHistorySidebar,s=t.swtichSidebarTab,u=o||function(){n.sidebar&&n.sidebar.hide(),n.historyPreview&&n.historyPreview.hide(),n.versionPreview&&n.versionPreview.hide()};this.sidebar=new d.a({A:e,guid:r,appList:i,onClose:u.bind(this),onTabSwitch:s})},n.prototype.JK=function(t){this.historyPreview=new v.b(t)},n.prototype.JN=function(t){this.versionPreview=new b.b(t)},n.prototype.isShown=function(){return!!this.sidebar&&!!this.sidebar.isShown},n.prototype.isPreviewing=function(){var t=!1;return this.historyPreview&&(t=t||!!this.historyPreview.isShown()),this.versionPreview&&(t=t||!!this.versionPreview.isShown()),t},n}(O);n.b=w},2658:function(t,n,e){"use strict";var r=e(2659),i=e.n(r),o=e(2660),s=e.n(o),u=e(2373),c=e.n(u),a=e(2374),f=e.n(a),h=e(2375),l=e.n(h),d=e(2376),v=e.n(d),b=this&&this.__assign||function(){return(b=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)};b(b(b({},i.a),c.a),l.a),b(b(b({},s.a),f.a),v.a)},2659:function(t,n){t.exports={"历史":"History","版本":"Ver.","根据企业设置，你没有权限复制内容，请联系文件所有者或企业管理员":"According to enterprise settings, you don't have permission to copy contents. Please contact owner of the file or enterprise administrator","不能剪切历史预览表格":"Cannot cut history preview table","不能粘贴至历史预览表格":"Cannot paste to history preview table"}},2660:function(t,n){t.exports={"历史":"履歴","版本":"バージョン","根据企业设置，你没有权限复制内容，请联系文件所有者或企业管理员":"企業の設定により、コピーする権限がありません。ファイル所有者または企業の管理者に連絡してください","不能剪切历史预览表格":"履歴のプレビューの切り取りはできません","不能粘贴至历史预览表格":"履歴のプレビューへの貼り付けはできません"}},2661:function(t,n,e){"use strict";var r,i=e(1),o=e.n(i),s=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return s(n,t),n.prototype.componentDidMount=function(){var t=this.props,n=t.sidebar,e=t.historyPreview,r=t.versionPreview;n&&n.render(this.refs.smHistorySidebarSkelenton.querySelector(".sm-sidebar")),e&&e.render(this.refs.smHistorySidebarSkelenton.querySelector(".sm-history-preview-container")),r&&r.render(this.refs.smHistorySidebarSkelenton.querySelector(".sm-version-preview-container"))},n.prototype.render=function(){return o.a.createElement("div",{ref:"smHistorySidebarSkelenton"},o.a.createElement("div",{className:"sm-history-preview-container"}),o.a.createElement("div",{className:"sm-version-preview-container"}),o.a.createElement("div",{className:"sm-sidebar"}))},n}(i.Component);n.a=u},2662:function(t,n,e){"use strict";e(2663);var r=e(2664),i=e(2681);e.d(n,"a",function(){return r.a}),e.d(n,"b",function(){return i.a})},2663:function(t,n,e){"use strict";var r=e(0),i=e.n(r),o=e(2373),s=e.n(o),u=e(2374),c=e.n(u);i.a.addLocaleResource("en-US",s.a),i.a.addLocaleResource("ja-JP",c.a),i.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2664:function(t,n,e){"use strict";var r,i=e(0),o=e.n(i),s=e(1),u=e.n(s),c=e(194),a=(e.n(c),e(2665)),f=e(2379),h=e(3),l=e(6),d=e.n(l),v=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),b=this&&this.__assign||function(){return(b=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},p=h.sheets.ajax.ajax,m=h.sheets.Plugin,y=(h.Editor,"HistoryList"),O=function(t){function n(e){var r=t.call(this,{name:y,Constructor:n,config:e})||this;return r.options=e,e.container&&r.render(e.container),r.install(),r}return v(n,t),n.prototype.setLocale=function(t){o.a.setLocaleSync(t)},n.prototype.render=function(t){d.a.render(u.a.createElement(c.Provider,{store:f.c},u.a.createElement(a.a,b({},b(b({},this.options),{container:t})))),t)},n.prototype.show=function(){f.a.toggleListShowAction(!0)},n.prototype.hide=function(){f.a.toggleListShowAction(!1)},n.prototype.previewFirstItem=function(){f.a.previewFirstItemAction()},n.prototype.destory=function(){f.a.destoryAction()},n.prototype.toggleHighLight=function(){f.a.toggleHighLightAction()},n.prototype.toggleRenderFilter=function(){f.a.toggleRenderFilter()},n.prototype.setSelectedItem=function(t){f.a.setSelectedAction(t)},n.prototype.isShown=function(){return f.c.select("historyList.isShowList",f.c.getState())},n.prototype.addHistory=function(t){var n=t.action,e=t.options,r=void 0===e?{}:e;return p(null,{method:"POST",url:this.options.addDocHistoryUrl,params:{content:JSON.stringify(b({action:n},r))}})},n}(m);n.a=O},2665:function(t,n,e){"use strict";var r=e(194),i=(e.n(r),e(2666)),o=e(2379),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},u=o.b.select;n.a=Object(r.connect)(function(t,n){var e=u({isShow:"historyList.isShowList",isLoading:"historyList.isLoadingList",isOnScroll:"historyList.isOnScroll",list:"history.list",isLastPage:"history.isLastPage",users:"history.users",selected:"history.selected",highLight:"history.highLight",isReverting:"historyList.isReverting",revertItem:"historyList.revertItem",isRenderFilter:"history.isRenderFilter"},t);return s(s({},e),n)},function(){return o.a})(i.a)},2666:function(t,n,e){"use strict";var r,i,o=e(0),s=e.n(o),u=e(1),c=e.n(u),a=e(347),f=e.n(a),h=e(2667),l=e(2377),d=e(2378),v=e(2150),b=e(3),p=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),m=this&&this.__makeTemplateObject||function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},y=b.sheets,O=y.loading,g=y.alert,w=y.track,j=y.utils,S=O.Loading,k=g.showAlert,_=g.confirm,P=j.dateTime,L=P.autoRefresh,M=P.format,R=function(t){function n(n){var e=t.call(this,n)||this;return e.onScroll=e._onScroll.bind(e),e.fileType=n.fileType||-4,e}return p(n,t),n.prototype.componentWillReceiveProps=function(t){if(this.props.isShow!==t.isShow&&(f.a.notify("newdoc:history:"+(t.isShow?"show":"hide")),t.isShow)){var n=t.loadHistoryUrl,e=t.guid,r=t.loadHistoryAction,i=t.headers,o=t.A.F.get("FilterViewport");o&&o.instance.quitFilterViewport(),r({url:n,guid:e,start:0,headers:i})}this.props.isReverting&&!t.isReverting&&"function"==typeof this.props.afterRevert&&this.props.afterRevert()},n.prototype.componentDidMount=function(){var t=this.props,n=t.guid,e=t.loadHistoryUrl,r=t.revertUrl,i=t.headers;this.props.initStateAction({guid:n,fileType:this.fileType,loadHistoryUrl:e,revertUrl:r,headers:i}),L("#sheet-view .s-list-history"),this.tooltip=new l.a({rootSelector:".sm-sidebar-applist-history",content:s()("点击预览历史"),className:"s-tooltip-history"}),this.tooltip.init()},n.prototype.onPreview=function(t){var n=this.props.selected||{};Object(v.e)(t)&&t.id!==n.id&&this.props.onSelectHistory(t)},n.prototype._onScroll=function(){if(!this.props.isOnScroll){var t=this.refs.sList,n=t.scrollTop,e=t.scrollHeight,r=this.refs.footer.offsetTop,i=this.props,o=i.isLastPage,s=i.list,u=i.loadHistoryUrl,c=i.headers;e-n-r<=50&&!o&&this.props.scrollAction({url:u,guid:this.props.guid,start:s.length,headers:c})}},n.prototype.handleRevert=function(t){var n=this,e=this.props,r=e.list,o=e.revertItem,u=e.A;if(u.permissions.query.U()&&t.id!==o.id){var c=this.fileType;if(Object(v.d)(u,c,t))return _({title:s()("工作表已被锁定"),description:s()("当前工作表已被锁定，您无法还原历史。如需进行还原，请与该表格的所有者联系")});var a=t.updated_at,f=M(a,!0);_({title:s()("还原表格"),description:Object(v.f)(t.id,r)?s()("该版本与当前表格内容一致，确认还原吗？"):s()(i||(i=m(["确认将表格还原到 ","的内容吗？"],["确认将表格还原到 ","的内容吗？"])),f),confirmFun:function(){k({title:s()("历史还原中,请稍等"),autoHide:!1}),n.props.revertAction(t)}}),w(2,"0050")}},n.prototype.handleTooltip=function(t,n,e){if(Object(v.e)(t)&&this.tooltip)return n?void this.tooltip.showInCenter(e.currentTarget):this.tooltip.hide()},n.prototype.toggleHighLight=function(){this.props.toggleHighLight()},n.prototype.render=function(){var t=this,n=this.props,e=n.guid,r=n.isShow,i=n.selected,o=n.list,s=n.isLoading,u=n.isOnScroll,a=n.highLight,f=n.users,l=n.A,v=n.isReverting,b=n.contactUrl,p=n.isRenderFilter,m=n.toggleRenderFilter;return c.a.createElement("div",{className:"s-list-history "+(r?"":"hide-list"),ref:"sList",onScroll:this.onScroll},c.a.createElement(S,{isShow:v,wrapperClass:"s-history-loading s-revert-loading",imgClass:"s-history-loading-img"}),r&&c.a.createElement("div",{className:"s-list"},S({isShow:s,wrapperClass:"s-sidebar-loading s-sidebar-loading-history",imgClass:"s-sidebar-loading-img"}),o.map(function(n){return c.a.createElement(h.a,{key:n.id,guid:e,history:n,users:f,selected:i,contactUrl:b,handlePreview:t.onPreview.bind(t),handleTooltip:t.handleTooltip.bind(t),isDisableRevert:!l.permissions.query.U(),handleRevert:t.handleRevert.bind(t)})}),S({isShow:u,wrapperClass:"s-sidebar-loading s-sidebar-loading-history",imgClass:"s-sidebar-loading-img"})),r&&Object(d.a)({isHighlight:a,toggleHighlight:this.toggleHighLight.bind(this),isRenderFilter:p,toggleRenderFilter:m}))},n}(u.Component);n.a=R},2667:function(t,n,e){"use strict";var r,i,o,s,u,c,a,f,h,l,d,v,b,p,m,y,O,g,w=e(0),j=e.n(w),S=e(1),k=e.n(S),_=e(2668),P=e(2150),L=e(3),M=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),R=this&&this.__makeTemplateObject||function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},N=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e(function(t){t(n)})).then(s,u)}c((r=r.apply(t,n||[])).next())})},C=this&&this.__generator||function(t,n){var e,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(t,s)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},D=L.sheets.contact,E=L.sheets.utils,T=D.getContactById,I=E.dateTime.format,A=function(t){function n(n){var e=t.call(this,n)||this;return e.state={userName:"",inviteeName:"",deletedUserName:"",newOwnerName:""},e.handleMouseEnter=e._handleMouseEnter.bind(e),e.handleMouseLeave=e._handleMouseLeave.bind(e),e.handleClick=e._handleClick.bind(e),e}return M(n,t),n.prototype.componentDidMount=function(){this.setHistoryNames(this.props.history)},n.prototype.componentWillReceiveProps=function(t){var n=this.props.history;n.id===t.history.id&&n.content===t.history.content||this.setHistoryNames(t.history)},n.prototype.getUserName=function(t){return N(this,void 0,Promise,function(){var n,e=this;return C(this,function(r){switch(r.label){case 0:return t?(n=this.props.users||{},[4,Promise.all(t.toString().split(",").map(function(t){return N(e,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return n[t]?[2,n[t]]:[4,T({contactId:t,url:this.props.contactUrl})];case 1:return[2,e.sent().name]}})})}))]):[2,""];case 1:return[2,r.sent().join("、")]}})})},n.prototype.setHistoryNames=function(t){return N(this,void 0,Promise,function(){var n,e,r,i,o;return C(this,function(s){switch(s.label){case 0:return n=JSON.parse(t.content),[4,this.getUserName(t.user_id)];case 1:return e=s.sent(),[4,this.getUserName(n.invitee)];case 2:return r=s.sent(),[4,this.getUserName(n.deletedUser)];case 3:return i=s.sent(),[4,this.getUserName(n.newOwner)];case 4:return o=s.sent(),this.setState({userName:e,inviteeName:r,deletedUserName:i,newOwnerName:o}),[2]}})})},n.prototype.componentWillUnmount=function(){this.state={userName:"",inviteeName:"",deletedUserName:"",newOwnerName:""}},n.prototype.render=function(){var t,n=this.props,e=n.history,r=n.isDisableRevert,w=n.handleRevert,S=this.state,L=S.userName,M=S.inviteeName,N=S.deletedUserName,C=S.newOwnerName,D=I(e.updated_at),E=this._itemClass(e),T=JSON.parse(e.content);if(1===e.history_type)switch(T.action){case"invite":t=j()(i||(i=R(["邀请了 ",""],["邀请了 ",""])),M);break;case"join":t=j()("加入了文档");break;case"rename":t=j()(o||(o=R(["将表格 “","” 重命名为 “","”"],["将表格 “","” 重命名为 “","”"])),T.before,T.after);break;case"deleteShare":t=j()(s||(s=R(["对 "," 取消了共享"],["对 "," 取消了共享"])),N);break;case"set_doc_readonly":t=j()("将公开链接设置为只读");break;case"set_doc_editable":t=j()("将公开链接设置为可写");break;case"set_doc_private":t=j()("禁用了公开链接");break;case"createCopy":t=j()("创建了表格副本");break;case"transferOwnership":t=j()(u||(u=R(["把表格转让给 ",""],["把表格转让给 ",""])),C);break;case"createRevision":t=j()("保存了历史版本");break;case"renameRevision":t=j()(c||(c=R(["将历史版本 “","” 重命名为 “","”"],["将历史版本 “","” 重命名为 “","”"])),T.before,T.after);break;case"deleteRevision":t=j()(a||(a=R(["删除了历史版本 “","”"],["删除了历史版本 “","”"])),T.label);break;case"lock_sheet":t=j()(f||(f=R(["锁定了表格 “","”"],["锁定了表格 “","”"])),T.sheetName);break;case"unlock_sheet":t=j()(h||(h=R(["解锁了表格 “","”"],["解锁了表格 “","”"])),T.sheetName);break;case"update_lock":t=j()(l||(l=R(["编辑了锁定 “","”"],["编辑了锁定 “","”"])),T.sheetName);break;case"lock_cell":t=j()(d||(d=R(["锁定了单元格 “","-","”"],["锁定了单元格 “","-","”"])),T.sheetName,T.range);break;case"unlock_cell":t=j()(v||(v=R(["解锁了单元格 “","-","”"],["解锁了单元格 “","-","”"])),T.sheetName,T.range);break;case"update_lock_cell":t=j()(b||(b=R(["编辑了锁定 “","-","”"],["编辑了锁定 “","-","”"])),T.sheetName,T.range);break;case"delete_sheet":t=j()(p||(p=R(["删除了工作表 “","”"],["删除了工作表 “","”"])),T.name);break;case"create_sheet":t=j()(m||(m=R(["创建了工作表 “","”"],["创建了工作表 “","”"])),T.name);break;case"copy_sheet":t=j()(y||(y=R(["创建了工作表 “","” 的副本"],["创建了工作表 “","” 的副本"])),T.name);break;case"create_form":t=j()(O||(O=R(["创建了表单 “","”"],["创建了表单 “","”"])),T.name);break;case"delete_form":t=j()(g||(g=R(["删除了表单 “","”"],["删除了表单 “","”"])),T.name);break;case"set_doc_enterprise_readonly":t=j()("将公开链接设置为仅企业内部只读");break;case"set_doc_enterprise_editable":t=j()("将公开链接设置为仅企业内部可写");break;case"turn_on_password":t=j()("开启了访问密码");break;case"turn_off_password":t=j()("关闭了访问密码");break;case"reset_password":t=j()("更换了访问密码")}else if(2===e.history_type)switch(!0){case T.range&&1===T.range[0]&&1===T.range[1]:t=j()("创建了表格");break;case T.revert:var A=I(T.time,!0);t=k.a.createElement("span",null,j()("将表格还原到"),k.a.createElement("span",{className:"history-content-time"},A),j()("的内容"));break;default:t=j()("编辑了表格")}return k.a.createElement("div",{className:E,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick},k.a.createElement("div",{className:"s-content-container"},k.a.createElement("div",null,k.a.createElement("div",{className:"s-history-content"},k.a.createElement("span",{className:"s-author"},L)," ",t),k.a.createElement("span",{className:"s-time","data-time":e.updated_at},D),k.a.createElement("div",{style:{clear:"both"}})),Object(P.e)(e)&&Object(_.a)(e,r,w)))},n.prototype._handleMouseEnter=function(t){var n=this.props,e=n.history;(0,n.handleTooltip)(e,!0,t)},n.prototype._handleMouseLeave=function(t){var n=this.props,e=n.history;(0,n.handleTooltip)(e,!1,t)},n.prototype._handleClick=function(t){var n=this.props,e=n.history;(0,n.handlePreview)(e)},n.prototype._itemClass=function(t){var n=this.props.selected;return"s-history-item"+(2===t.history_type?" edit":"")+(n.id===t.id?" selected":"")},n}(S.Component);n.a=A},2668:function(t,n,e){"use strict";n.a=function(t,n,e){return s.a.createElement("div",{className:"s-action-bar-wrap"},s.a.createElement("div",{className:"s-action-bar"+(n?" disabled":""),onClick:function(n){n.stopPropagation(),e(t)}},s.a.createElement("span",{className:"hicon icon-recover"}),i()("还原")),s.a.createElement("div",{style:{clear:"both"}}))};var r=e(0),i=e.n(r),o=e(1),s=e.n(o)},2669:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e.d(n,"initStateAction",function(){return s}),e.d(n,"toggleListShowAction",function(){return u}),e.d(n,"loadHistoryAction",function(){return c}),e.d(n,"setSelectedAction",function(){return a}),e.d(n,"scrollAction",function(){return f}),e.d(n,"previewFirstItemAction",function(){return h}),e.d(n,"revertAction",function(){return l}),e.d(n,"toggleHighLightAction",function(){return d}),e.d(n,"toggleRenderFilter",function(){return v}),e.d(n,"destoryAction",function(){return b});var r=e(7),i=e(2259),o=e(2260),s=function(t){return Object(r.c)(o.d,t)},u=function(t){return Object(r.c)(o.m,t)},c=function(t){return Object(r.c)(o.e,i.a(t))},a=function(t){return Object(r.c)(o.k,t)},f=function(t){return Object(r.c)(o.i,i.a(t))},h=function(){return Object(r.c)(o.g)},l=function(t){return Object(r.c)(o.h,t)},d=function(){return Object(r.c)(o.l)},v=function(){return Object(r.c)(o.n)},b=function(){return Object(r.c)(o.c)}},2670:function(t,n,e){"use strict";e.d(n,"a",function(){return r}),e.d(n,"b",function(){return i});var r=function(t){var n=t.url,e=t.range,r=t.headers,i=e[0],o=e[1];return{url:n=n.replace("{from}",i.toString()).replace("{to}",o.toString()),method:"GET",headers:r}},i=function(t){return{url:t.url,method:"GET",params:{rev:t.rev},headers:t.headers}}},2671:function(t,n,e){"use strict";e.d(n,"e",function(){return r}),e.d(n,"d",function(){return i}),e.d(n,"a",function(){return o}),e.d(n,"c",function(){return s}),e.d(n,"b",function(){return u});var r="top",i="right",o="bottom",s="left",u=[r,i,o,s]},2672:function(t,n,e){"use strict";var r=e(2673),i=e(2676),o=[].slice,s=["keyword","gray","hex"],u={};Object.keys(i).forEach(function(t){u[o.call(i[t].labels).sort().join("")]=t});var c={};function a(t,n){if(!(this instanceof a))return new a(t,n);if(n&&n in s&&(n=null),n&&!(n in i))throw new Error("Unknown model: "+n);var e,f;if(t)if(t instanceof a)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if("string"==typeof t){var h=r.get(t);if(null===h)throw new Error("Unable to parse color from string: "+t);this.model=h.model,f=i[this.model].channels,this.color=h.value.slice(0,f),this.valpha="number"==typeof h.value[f]?h.value[f]:1}else if(t.length){this.model=n||"rgb",f=i[this.model].channels;var d=o.call(t,0,f);this.color=l(d,f),this.valpha="number"==typeof t[f]?t[f]:1}else if("number"==typeof t)t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,255&t],this.valpha=1;else{this.valpha=1;var v=Object.keys(t);"alpha"in t&&(v.splice(v.indexOf("alpha"),1),this.valpha="number"==typeof t.alpha?t.alpha:0);var b=v.sort().join("");if(!(b in u))throw new Error("Unable to parse color from object: "+JSON.stringify(t));this.model=u[b];var p=i[this.model].labels,m=[];for(e=0;e<p.length;e++)m.push(t[p[e]]);this.color=l(m)}else this.model="rgb",this.color=[0,0,0],this.valpha=1;if(c[this.model])for(f=i[this.model].channels,e=0;e<f;e++){var y=c[this.model][e];y&&(this.color[e]=y(this.color[e]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function f(t,n,e){return(t=Array.isArray(t)?t:[t]).forEach(function(t){(c[t]||(c[t]=[]))[n]=e}),t=t[0],function(r){var i;return arguments.length?(e&&(r=e(r)),(i=this[t]()).color[n]=r,i):(i=this[t]().color[n],e&&(i=e(i)),i)}}function h(t){return function(n){return Math.max(0,Math.min(t,n))}}function l(t,n){for(var e=0;e<n;e++)"number"!=typeof t[e]&&(t[e]=0);return t}a.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var n=this.model in r.to?this:this.rgb(),e=1===(n=n.round("number"==typeof t?t:1)).valpha?n.color:n.color.concat(this.valpha);return r.to[n.model](e)},percentString:function(t){var n=this.rgb().round("number"==typeof t?t:1),e=1===n.valpha?n.color:n.color.concat(this.valpha);return r.to.rgb.percent(e)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},n=i[this.model].channels,e=i[this.model].labels,r=0;r<n;r++)t[e[r]]=this.color[r];return 1!==this.valpha&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,1!==this.valpha&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,1!==this.valpha&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new a(this.color.map(function(t){return function(n){return function(t,n){return Number(t.toFixed(n))}(n,t)}}(t)).concat(this.valpha),this.model)},alpha:function(t){return arguments.length?new a(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:f("rgb",0,h(255)),green:f("rgb",1,h(255)),blue:f("rgb",2,h(255)),hue:f(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:f("hsl",1,h(100)),lightness:f("hsl",2,h(100)),saturationv:f("hsv",1,h(100)),value:f("hsv",2,h(100)),chroma:f("hcg",1,h(100)),gray:f("hcg",2,h(100)),white:f("hwb",1,h(100)),wblack:f("hwb",2,h(100)),cyan:f("cmyk",0,h(100)),magenta:f("cmyk",1,h(100)),yellow:f("cmyk",2,h(100)),black:f("cmyk",3,h(100)),x:f("xyz",0,h(100)),y:f("xyz",1,h(100)),z:f("xyz",2,h(100)),l:f("lab",0,h(100)),a:f("lab",1),b:f("lab",2),keyword:function(t){return arguments.length?new a(t):i[this.model].keyword(this.color)},hex:function(t){return arguments.length?new a(t):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(255&t[0])<<16|(255&t[1])<<8|255&t[2]},luminosity:function(){for(var t=this.rgb().color,n=[],e=0;e<t.length;e++){var r=t[e]/255;n[e]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*n[0]+.7152*n[1]+.0722*n[2]},contrast:function(t){var n=this.luminosity(),e=t.luminosity();return n>e?(n+.05)/(e+.05):(e+.05)/(n+.05)},level:function(t){var n=this.contrast(t);return n>=7.1?"AAA":n>=4.5?"AA":""},dark:function(){var t=this.rgb().color;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var t=this.rgb(),n=0;n<3;n++)t.color[n]=255-t.color[n];return t},lighten:function(t){var n=this.hsl();return n.color[2]+=n.color[2]*t,n},darken:function(t){var n=this.hsl();return n.color[2]-=n.color[2]*t,n},saturate:function(t){var n=this.hsl();return n.color[1]+=n.color[1]*t,n},desaturate:function(t){var n=this.hsl();return n.color[1]-=n.color[1]*t,n},whiten:function(t){var n=this.hwb();return n.color[1]+=n.color[1]*t,n},blacken:function(t){var n=this.hwb();return n.color[2]+=n.color[2]*t,n},grayscale:function(){var t=this.rgb().color,n=.3*t[0]+.59*t[1]+.11*t[2];return a.rgb(n,n,n)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var n=this.hsl(),e=n.color[0];return e=(e=(e+t)%360)<0?360+e:e,n.color[0]=e,n},mix:function(t,n){var e=t.rgb(),r=this.rgb(),i=void 0===n?.5:n,o=2*i-1,s=e.alpha()-r.alpha(),u=((o*s==-1?o:(o+s)/(1+o*s))+1)/2,c=1-u;return a.rgb(u*e.red()+c*r.red(),u*e.green()+c*r.green(),u*e.blue()+c*r.blue(),e.alpha()*i+r.alpha()*(1-i))}},Object.keys(i).forEach(function(t){if(-1===s.indexOf(t)){var n=i[t].channels;a.prototype[t]=function(){if(this.model===t)return new a(this);if(arguments.length)return new a(arguments,t);var e,r="number"==typeof arguments[n]?n:this.valpha;return new a((e=i[this.model][t].raw(this.color),Array.isArray(e)?e:[e]).concat(r),t)},a[t]=function(e){return"number"==typeof e&&(e=l(o.call(arguments),n)),new a(e,t)}}}),t.exports=a},2673:function(t,n,e){var r=e(2380),i=e(2674),o={};for(var s in r)r.hasOwnProperty(s)&&(o[r[s]]=s);var u=t.exports={to:{},get:{}};function c(t,n,e){return Math.min(Math.max(n,t),e)}function a(t){var n=t.toString(16).toUpperCase();return n.length<2?"0"+n:n}u.get=function(t){var n,e;switch(t.substring(0,3).toLowerCase()){case"hsl":n=u.get.hsl(t),e="hsl";break;case"hwb":n=u.get.hwb(t),e="hwb";break;default:n=u.get.rgb(t),e="rgb"}return n?{model:e,value:n}:null},u.get.rgb=function(t){if(!t)return null;var n,e,i,o=[0,0,0,1];if(n=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=n[2],n=n[1],e=0;e<3;e++){var s=2*e;o[e]=parseInt(n.slice(s,s+2),16)}i&&(o[3]=parseInt(i,16)/255)}else if(n=t.match(/^#([a-f0-9]{3,4})$/i)){for(i=(n=n[1])[3],e=0;e<3;e++)o[e]=parseInt(n[e]+n[e],16);i&&(o[3]=parseInt(i+i,16)/255)}else if(n=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(e=0;e<3;e++)o[e]=parseInt(n[e+1],0);n[4]&&(o[3]=parseFloat(n[4]))}else{if(!(n=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(n=t.match(/(\D+)/))?"transparent"===n[1]?[0,0,0,0]:(o=r[n[1]])?(o[3]=1,o):null:null;for(e=0;e<3;e++)o[e]=Math.round(2.55*parseFloat(n[e+1]));n[4]&&(o[3]=parseFloat(n[4]))}for(e=0;e<3;e++)o[e]=c(o[e],0,255);return o[3]=c(o[3],0,1),o},u.get.hsl=function(t){if(!t)return null;var n=t.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(n){var e=parseFloat(n[4]);return[(parseFloat(n[1])+360)%360,c(parseFloat(n[2]),0,100),c(parseFloat(n[3]),0,100),c(isNaN(e)?1:e,0,1)]}return null},u.get.hwb=function(t){if(!t)return null;var n=t.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(n){var e=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,c(parseFloat(n[2]),0,100),c(parseFloat(n[3]),0,100),c(isNaN(e)?1:e,0,1)]}return null},u.to.hex=function(){var t=i(arguments);return"#"+a(t[0])+a(t[1])+a(t[2])+(t[3]<1?a(Math.round(255*t[3])):"")},u.to.rgb=function(){var t=i(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},u.to.rgb.percent=function(){var t=i(arguments),n=Math.round(t[0]/255*100),e=Math.round(t[1]/255*100),r=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+n+"%, "+e+"%, "+r+"%)":"rgba("+n+"%, "+e+"%, "+r+"%, "+t[3]+")"},u.to.hsl=function(){var t=i(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},u.to.hwb=function(){var t=i(arguments),n="";return t.length>=4&&1!==t[3]&&(n=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+n+")"},u.to.keyword=function(t){return o[t.slice(0,3)]}},2674:function(t,n,e){"use strict";var r=e(2675),i=Array.prototype.concat,o=Array.prototype.slice,s=t.exports=function(t){for(var n=[],e=0,s=t.length;e<s;e++){var u=t[e];r(u)?n=i.call(n,o.call(u)):n.push(u)}return n};s.wrap=function(t){return function(){return t(s(arguments))}}},2675:function(t,n){t.exports=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))}},2676:function(t,n,e){var r=e(2381),i=e(2677),o={};Object.keys(r).forEach(function(t){o[t]={},Object.defineProperty(o[t],"channels",{value:r[t].channels}),Object.defineProperty(o[t],"labels",{value:r[t].labels});var n=i(t);Object.keys(n).forEach(function(e){var r=n[e];o[t][e]=function(t){var n=function(n){if(void 0===n||null===n)return n;arguments.length>1&&(n=Array.prototype.slice.call(arguments));var e=t(n);if("object"==typeof e)for(var r=e.length,i=0;i<r;i++)e[i]=Math.round(e[i]);return e};return"conversion"in t&&(n.conversion=t.conversion),n}(r),o[t][e].raw=function(t){var n=function(n){return void 0===n||null===n?n:(arguments.length>1&&(n=Array.prototype.slice.call(arguments)),t(n))};return"conversion"in t&&(n.conversion=t.conversion),n}(r)})}),t.exports=o},2677:function(t,n,e){var r=e(2381);function i(t){var n=function(){for(var t={},n=Object.keys(r),e=n.length,i=0;i<e;i++)t[n[i]]={distance:-1,parent:null};return t}(),e=[t];for(n[t].distance=0;e.length;)for(var i=e.pop(),o=Object.keys(r[i]),s=o.length,u=0;u<s;u++){var c=o[u],a=n[c];-1===a.distance&&(a.distance=n[i].distance+1,a.parent=i,e.unshift(c))}return n}function o(t,n){return function(e){return n(t(e))}}function s(t,n){for(var e=[n[t].parent,t],i=r[n[t].parent][t],s=n[t].parent;n[s].parent;)e.unshift(n[s].parent),i=o(r[n[s].parent][s],i),s=n[s].parent;return i.conversion=e,i}t.exports=function(t){for(var n=i(t),e={},r=Object.keys(n),o=r.length,u=0;u<o;u++){var c=r[u];null!==n[c].parent&&(e[c]=s(c,n))}return e}},2678:function(t,n,e){"use strict";var r,i,o,s,u,c,a=e(29),f=e(52),h=e(32),l=e(2260),d=e(2209),v=e(2262),b={list:[[],(r={},r[l.f]=function(t,n){var e=n.histories.reverse(),r=t[0]||{},i=e[0]||{},o=t[t.length-1]||{},s=e[e.length-1]||{};return r.id>=i.id&&o.id<=s.id&&r.content===i.content?t:e},r[l.j]=function(t,n){var e=n.histories;return t.concat(e.reverse())},r[d.b]=function(t,n){var e=n.histories;return t.concat(e.reverse())},r[l.b]=function(t,n){var e=n.histories;return t.concat(e.reverse())},r[v.d]=function(t,n){var e=n.histories;return t.concat(e.reverse())},r[v.e]=function(t,n){return n.histories.reverse()},r)],isLastPage:[!1,(i={},i[l.f]=function(t,n){return n.isLastPage},i[l.j]=function(t,n){return n.isLastPage},i[d.b]=function(t,n){return n.isLastPage},i[l.b]=function(t,n){return n.isLastPage},i[v.d]=function(t,n){return n.isLastPage},i[v.e]=function(t,n){return n.isLastPage},i)],users:[{},(o={},o[l.j]=function(t,n){var e=n.users;return Object.assign(t,e)},o[l.f]=function(t,n){var e=n.users;return Object.assign(t,e)},o[l.b]=function(t,n){var e=n.users;return Object.assign(t,e)},o[v.d]=function(t,n){var e=n.users;return Object.assign(t,e)},o[v.e]=function(t,n){var e=n.users;return Object.assign(t,e)},o)],selected:[{},(s={},s[l.k]=function(t,n){return n||{}},s[d.i]=function(t,n){return n},s[l.c]=function(){return{}},s)],highLight:[!0,(u={},u[l.l]=function(t){return!t},u)],isRenderFilter:[!0,(c={},c[l.n]=function(t){return!t},c)]},p={HN:[l.n,Object(a.a)(Object(f.a)(),Object(h.a)(function(t){var n=t.get,e=n("::historyPreview.instance");if(e){var r=n("isRenderFilter"),i=e.F.get("FilterViewport");if(i){var o=i.instance;r?o.reRenderFilter():o.hideFilter()}}}))],_toggleRenderFilter:[l.n,"@setEditorFilterRenderStatus",Object(a.a)(Object(f.a)(),Object(h.a)(function(t){var n=t.get,e=n("isRenderFilter"),r=n("::historyPreview.instance");r&&(r.spreadOptions.isRenderFilter=e)}))]};n.a={namespace:"history",reducers:b,events:p}},2679:function(t,n,e){"use strict";e.d(n,"a",function(){return h});var r=e(0),i=e.n(r),o=e(3),s=e(2261),u=o.sheets.changeset,c=u.unpack,a=u.compose,f=o.sheets.alert.showAlert,h=function(t,n,e,r){e=e||-1;for(var o,u=null,h=0,l=r.length;h<l;h++){var d=r[h],v=d.id;if(v>n)break;if(!(v<=e)){var b=JSON.parse(d.content).changeset,p=c(t,b);u=u?a(t,u,p):p,o=p}}var m=null;o.length>1&&(m=Object(s.g)(o));try{u.validate&&u.validate()}catch(t){throw f({type:"error",title:i()("当前历史片段的数据可能已损坏，无法预览")}),t}return{content:JSON.stringify({changeset:u}),delta:u,sheet:m}}},2680:function(t,n,e){"use strict";e.d(n,"a",function(){return r}),e.d(n,"c",function(){return i}),e.d(n,"b",function(){return o});var r=function(t){var n=t.url,e=t.start,r=t.pageSize;return{url:n,method:"GET",params:{count:e,pageSize:void 0===r?30:r},headers:t.headers}},i=function(t){return{url:t.url,method:"GET",params:{rev:t.rev},headers:t.headers}},o=function(t){var n=t.url,e=t.range,r=t.headers,i=e[0],o=e[1];return{url:n=n.replace("{from}",i.toString()).replace("{to}",o.toString()),method:"GET",headers:r}}},2681:function(t,n,e){"use strict";var r,i=e(0),o=e.n(i),s=e(1),u=e.n(s),c=e(194),a=(e.n(c),e(2682)),f=e(2384),h=e(3),l=e(6),d=e.n(l),v=e(798),b=e.n(v),p=e(2263),m=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},O=h.sheets,g=O.Events,w=O.Plugin,j=(h.Editor,"HistoryPreview"),S=function(t){function n(e){var r=t.call(this,{name:j,Constructor:n,config:e})||this;return r.options=e,r.cooperation=new b.a.ColorPalette(e.currentUserId),r.A=e.historyEditor||Object(p.a)(e.A),e.container&&r.render(e.container),r.install(),r}return m(n,t),n.prototype.setLocale=function(t){o.a.setLocaleSync(t)},n.prototype.render=function(t){d.a.render(u.a.createElement(c.Provider,{store:f.c},u.a.createElement(a.a,y({},y(y({},this.options),{container:t,cooperation:this.cooperation,previewEditor:this.A})))),t)},n.prototype.show=function(t){f.a.togglePreviewAction(!0,t),this.A.emit(g.JD)},n.prototype.hide=function(){f.a.togglePreviewAction(!1),this.A.emit(g.JE)},n.prototype.destory=function(){f.a.destoryAction()},n.prototype.isShown=function(){return f.c.select("historyPreview.isShowPreview",f.c.getState())},n}(w);n.a=S},2682:function(t,n,e){"use strict";var r=e(194),i=(e.n(r),e(2384)),o=e(2385),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},u=i.b.select;n.a=Object(r.connect)(function(t,n){var e=u({isPreview:"historyPreview.isShowPreview",isLoading:"historyPreview.isLoadingPreview",selected:"history.selected",steps:"historyPreview.steps",curStep:"historyPreview.curStep",users:"history.users",baseDelta:"historyPreview.baseDelta",curDelta:"historyPreview.curDelta",sheetId:"historyPreview.sheetId",highLight:"history.highLight",isRenderFilter:"history.isRenderFilter"},t);return s(s({wrapperClass:"sm-sheet-editor-history"},e),n)},function(){return i.a})(o.a)},2683:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e.d(n,"initStateAction",function(){return o}),e.d(n,"togglePreviewAction",function(){return s}),e.d(n,"onSetSelectedItem",function(){return u}),e.d(n,"onSetCurStepAction",function(){return c}),e.d(n,"setPreviewLoadingAction",function(){return a}),e.d(n,"destoryAction",function(){return f}),e.d(n,"injectEditorToStore",function(){return h}),e.d(n,"setEditorFilterRenderStatus",function(){return l});var r=e(7),i=e(2209),o=function(t){return Object(r.c)(i.e,t)},s=function(t,n){return t?Object(r.c)(i.i,n||{}):Object(r.c)(i.d)},u=function(){return Object(r.c)(i.g)},c=function(t){return Object(r.c)(i.h,t)},a=function(t){return Object(r.c)(i.f,t)},f=function(){return Object(r.c)(i.c)},h=function(t){return Object(r.c)("@injectEditorToStore",t)},l=function(){return Object(r.c)("@setEditorFilterRenderStatus")}},2684:function(t,n,e){"use strict";var r,i,o,s=e(0),u=e.n(s),c=e(1),a=e.n(c),f=e(31),h=e.n(f),l=e(82),d=e.n(l),v=e(3),b=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),p=this&&this.__makeTemplateObject||function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},m=v.sheets.changeset,y=v.sheets.alert.showAlert,O=m.compose,g=m.genEmptyDelta,w=m.unpack,j=function(t){function n(n){var e=t.call(this,n)||this;return e.onInputChange=function(t){e.setState({inputValue:t.target.value})},e.onBlur=function(){e.setState({inputValue:e.current})},e.onKeyDown=function(t){if("Enter"===t.key){var n=e.props.items.length,r=+t.target.value;!isNaN(r)&&r>0&&r<=n?e._showStep(r):e.setState({inputValue:e.current})}},e.init=!0,e.state={inputValue:e.props.current||0},e.current=e.props.current||0,e}return b(n,t),Object.defineProperty(n,"defaultProps",{get:function(){return{current:0,items:[],baseDelta:new d.a.Delta,wrapClassName:"",fileType:-4}},enumerable:!0,configurable:!0}),n.prototype.componentDidMount=function(){this.goPrev=this._changeHistory.bind(this,-1),this.goNext=this._changeHistory.bind(this,1)},n.prototype.componentWillReceiveProps=function(t){this.props.items!==t.items&&(this.init=!0,this.current=0)},n.prototype._changeHistory=function(t){var n=this.current,e=this.props.items.length;-1===t?1===n||0===n?n=e:n-=1:1===t&&(n===e?n=1:n+=1),this._showStep(n)},n.prototype._showStep=function(t){var n=this.current;if(n!==t){var e=this.props,r=e.items,i=e.historyStepChange,o=this._getStepCS(n,t);if(o){var s=r[t-1];this.init=!1,i&&i({cs:o,curStep:s}),this.current=t,this.setState({inputValue:t})}}},n.prototype._getStepCS=function(t,n){var e=this.props,r=e.items,i=e.baseDelta,o=e.fileType,s=this.init,c=s||t>n,a=[],f=[],h=g(o),l=g(o);if(t===n)return l;if(s?(f=r.slice(0,n),a=r.slice(n)):t<n?f=r.slice(t,n):(f=r.slice(0,n),a=r.slice(n,t)),f.forEach(function(t){l=O(o,l,w(o,t.delta))}),a.forEach(function(t){h=O(o,h,w(o,t.delta))}),!c)return l;try{return i=i||g(o),O(o,i,l).invert(h)}catch(t){y({title:u()("当前历史片段的数据可能已损坏，无法预览"),type:"error"})}},n.prototype.render=function(){var t=this.state.inputValue,n=this.props,e=n.wrapClassName,r=n.items.length;if(0===r)return null;var s="sm-history-head-item "+(e||""),c=this.init,f=h()({hisBtn:!0,hisBtnPrev:!0}),l=h()({hisBtn:!0,hisBtnNext:!0});return a.a.createElement("div",{className:s},c?a.a.createElement("span",null,u()(i||(i=p(["共 "," 条编辑记录"],["共 "," 条编辑记录"])),r)):a.a.createElement("span",null,u()(o||(o=p(["共 "," 条编辑记录, 查看第"],["共 "," 条编辑记录, 查看第"])),r),a.a.createElement("input",{className:"sm-form-control",value:t,onChange:this.onInputChange,onBlur:this.onBlur,onKeyDown:this.onKeyDown}),u()("条")),r>1&&a.a.createElement("span",null,a.a.createElement("span",{className:f,onClick:this.goPrev}),a.a.createElement("span",{className:l,onClick:this.goNext})))},n}(c.Component);n.a=j},2685:function(t,n,e){"use strict";e(2686);var r=e(2687),i=e(2695);e.d(n,"a",function(){return r.a}),e.d(n,"b",function(){return i.a})},2686:function(t,n,e){"use strict";var r=e(0),i=e.n(r),o=e(2375),s=e.n(o),u=e(2376),c=e.n(u);i.a.addLocaleResource("en-US",s.a),i.a.addLocaleResource("ja-JP",c.a),i.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2687:function(t,n,e){"use strict";var r,i=e(0),o=e.n(i),s=e(1),u=e.n(s),c=e(194),a=(e.n(c),e(2688)),f=e(2386),h=e(3),l=e(6),d=e.n(l),v=e(2387),b=e(2383),p=e(2694),m=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},O=h.sheets,g=O.alert,w=O.track,j=O.Plugin,S=O.ajax,k=g.showAlert,_=(h.Editor,"VersionList"),P=function(t){function n(e){var r=t.call(this,{name:_,Constructor:n,config:e})||this;return r.getMenuConfig=function(){return Object(p.a)({createVersion:r.createVersion.bind(r)})},r.options=e,e.container&&r.render(e.container),r.install(),r}return m(n,t),n.prototype.setLocale=function(t){o.a.setLocaleSync(t)},n.prototype.render=function(t,n){void 0===n&&(n={}),this.options=y(y({},this.options),n),d.a.render(u.a.createElement(c.Provider,{store:f.c},u.a.createElement(a.a,y({},y(y({},this.options),{container:t,createVersion:this.createVersion.bind(this)})))),t)},n.prototype.show=function(){f.a.toggleListShowAction(!0)},n.prototype.hide=function(){f.a.toggleListShowAction(!1)},n.prototype.destory=function(){f.a.destoryAction()},n.prototype.toggleHighLight=function(){f.a.toggleHighLightAction()},n.prototype.setSelectedItem=function(t){f.a.setSelectedAction(t)},n.prototype.reload=function(){f.a.reloadAction(!0)},n.prototype.createVersion=function(){var t=Object(b.d)({url:this.options.updateVersionUrl,id:"",label:"",headers:{}}).url;return S.ajax(null,{url:t,params:{label:Object(v.b)()},method:"POST"}).then(function(t){if(t instanceof Error){var n=t.response.status,e=t.response.data,r="";return 400===n?r=o()("不能重复创建版本"):403===n?r=e.error:500===n&&(r=o()("创建失败")),k({title:r,type:"error"}),Promise.reject()}return t&&!t.error?(k({title:o()("版本创建成功，可在「更多」-「查看历史」-「版本」中查看")}),w(2,"0048"),Promise.resolve()):(k({title:t.error||o()("创建失败"),type:"error"}),Promise.reject())})},n.prototype.isShown=function(){return f.c.select("versionList.isShowList",f.c.getState())},n}(j);n.a=P},2688:function(t,n,e){"use strict";var r=e(194),i=(e.n(r),e(2386)),o=e(2690),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},u=i.b.select;n.a=Object(r.connect)(function(t,n){var e=u({isShow:"versionList.isShowList",list:"versionList.list",isLoading:"versionList.isLoadingList",highLight:"history.highLight",selected:"versionList.selected",isReverting:"versionList.isReverting",revertItem:"versionList.revertItem",shouldReload:"versionList.shouldReload",isRenderFilter:"history.isRenderFilter"},t);return s(s({},e),n)},function(){return i.a})(o.a)},2689:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e.d(n,"initStateAction",function(){return o}),e.d(n,"toggleListShowAction",function(){return s}),e.d(n,"loadVersionListAction",function(){return u}),e.d(n,"onDeleteAction",function(){return c}),e.d(n,"onRevertAction",function(){return a}),e.d(n,"updateVersionAction",function(){return f}),e.d(n,"reloadAction",function(){return h}),e.d(n,"destoryAction",function(){return l}),e.d(n,"setSelectedAction",function(){return d});var r=e(7),i=e(2382),o=function(t){return Object(r.c)(i.d,t)},s=function(t){return Object(r.c)(i.i,t)},u=function(t){return Object(r.c)(i.e,{url:t})},c=function(t){return Object(r.c)(i.b,t)},a=function(t){return Object(r.c)(i.g,t)},f=function(t){return Object(r.c)(i.j,t)},h=function(t){return Object(r.c)(i.f,t)},l=function(){return Object(r.c)(i.c)},d=function(t){return Object(r.c)(i.h,t)}},2690:function(t,n,e){"use strict";var r,i,o=e(0),s=e.n(o),u=e(1),c=e.n(u),a=e(2691),f=e.n(a),h=e(2377),l=e(2378),d=e(2692),v=e(3),b=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),p=this&&this.__makeTemplateObject||function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},m=v.sheets,y=m.alert,O=m.loading,g=y.showAlert,w=y.confirm,j=O.Loading,S=function(t){function n(n){var e=t.call(this,n)||this;return e.fileType=n.fileType||-4,e}return b(n,t),n.prototype.componentDidMount=function(){var t=this.props,n=t.guid,e=t.initStateAction,r=t.loadVersionListUrl,i=t.revertVersionUrl,o=t.deleteVersionUrl,u=t.updateVersionUrl,c=t.headers;e({guid:n,fileType:this.fileType,loadVersionListUrl:r,revertVersionUrl:i,deleteVersionUrl:o,updateVersionUrl:u,headers:c}),this.tooltip=new h.a({rootSelector:".s-list-version",content:s()("点击预览版本"),className:"s-tooltip-version"}),this.tooltip.init()},n.prototype.componentWillReceiveProps=function(t){var n=this.props,e=n.isShow,r=n.list,i=n.getListLength,o=n.shouldReload;(!e&&t.isShow||!o&&t.shouldReload)&&(0,t.loadVersionListAction)(t.loadVersionListUrl);r.length!==t.list.length&&i&&i(t.list.length),this.props.isReverting&&!t.isReverting&&"function"==typeof this.props.afterRevert&&this.props.afterRevert()},n.prototype.handlePreview=function(t){var n=this.props.selected||{};if(t.id!==n.id){var e=this.props.onSelectVersion;"function"==typeof e&&e(t)}},n.prototype.handleTooltip=function(t,n,e){if(this.tooltip)return n?void this.tooltip.showInCenter(e.currentTarget):this.tooltip.hide()},n.prototype.handleRevert=function(t){var n=this.props,e=n.onRevertAction,r=n.A,o=n.revertItem;if(r.permissions.query.U()&&t.id!==o.id){if((this.props.A.spread.gcSpread.sheets||[]).some(function(t){return!r.permissions.query.canRevertRange({sheetId:t.guid,range:{row:0,col:0,rowCount:t.G(),colCount:t.H()}})}))return w({title:s()("工作表已被锁定"),description:s()("当前工作表已被锁定，您无法还原历史。如需进行还原，请与该表格的所有者联系")});w({confirmFun:function(){g({title:s()("版本还原中,请稍等"),autoHide:!1}),e(t)},title:s()("还原表格"),description:s()(i||(i=p(["确认将表格还原到历史版本 "," 吗？"],["确认将表格还原到历史版本 "," 吗？"])),t.label)}),f()(2,"0050")}},n.prototype.deleteItem=function(t){this.props.onDeleteAction(t)},n.prototype.createVersion=function(){var t=this;this.props.createVersion().then(function(){var n=t.props;(0,n.loadVersionListAction)(n.loadVersionListUrl)})},n.prototype.updateVersion=function(t){this.props.updateVersionAction(t)},n.prototype.render=function(){var t=this,n=this.props,e=n.isShow,r=n.isLoading,i=n.list,o=n.selected,u=n.highLight,a=n.toggleHighLight,f=n.A,h=n.isReverting,v=n.canManageVersionItem,b=n.currentUserId,p=n.toggleRenderFilter,m=n.isRenderFilter;n.createVersion;return c.a.createElement("div",{className:"s-list-version "+(e?"":"hide-list")},!!i.length&&c.a.createElement("div",{className:"s-version-save-tool"},c.a.createElement("div",{className:"tool__content",onClick:this.createVersion.bind(this)},c.a.createElement("span",{className:"icon--add"}),c.a.createElement("span",{className:"tool__title"},s()("保存当前版本")))),c.a.createElement(j,{isShow:h,wrapperClass:"s-history-loading s-revert-loading",imgClass:"s-history-loading-img"}),e&&c.a.createElement("div",{className:"s-list "+(i.length?"list-padding":"")},j({isShow:r,wrapperClass:"s-sidebar-loading s-sidebar-version-loading",imgClass:"s-sidebar-loading-img"}),i.length?i.map(function(n,e){return c.a.createElement(d.a,{key:n.id,version:n,selected:o.docHistoryId,canManageVersionItem:v,currentUserId:b,handleDelete:t.deleteItem.bind(t),handlePreview:t.handlePreview.bind(t),handleTooltip:t.handleTooltip.bind(t),isDisableRevert:!f.permissions.query.U(),updateVersion:t.updateVersion.bind(t),handleRevert:t.handleRevert.bind(t)})}):!r&&c.a.createElement("div",null,c.a.createElement("div",{className:"s-version-empty"},c.a.createElement("p",null,s()("这里会显示所有保存的版本")),c.a.createElement("button",{className:"sm-btn sm-btn-primary sm-version-save",onClick:this.createVersion.bind(this)},s()("保存当前版本")))),Object(l.a)({isHighlight:u,toggleHighlight:a,toggleRenderFilter:p,isRenderFilter:m})))},n}(u.Component);n.a=S},2691:function(t,n,e){"use strict";function r(t,n){if(n){var e=[];for(var r in n)e.push(r+"="+n[r]);e.length>0&&(t+="?"+e.join("&"))}var i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");i.onreadystatechange=function(){if(4===i.readyState)return i.responseText},i.open("GET",t,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send()}var i,o="https://statistics.shimo.im",s=(i=window.navigator.userAgent.toLowerCase(),window.ActiveXObject||/firefox|Safari|Chrome/i.test(i)?0:/shimo-iphone-app/g.test(i)?1:/shimo-android-app/g.test(i)?2:/micromessenger/g.test(i)?3:/(ipad|iphone|ipod)/g.test(i)?4:/(android)/g.test(i)?5:/dingtalk/i.test(i)?6:7);t.exports=function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(1!==String(t).length||4!==String(n).length)throw new Error("params is error, please check the parmas");if(window.D&&cow.domain){if("shimo.im"!==cow.domain&&"shimo.run"!==cow.domain)return!1}else if("shimo.im"!==location.hostname&&"staging.shimo.run"!==location.hostname)return!1;if(!e.userId){if(!window.D||!window.D.P)throw new Error("params is error, userId is required");e.userId=cow.P.id}return e.fileId||window.D&&window.D.Q&&(e.fileId=cow.Q.guid),r("timing"===e.type?o+"/timing":o+"/increment",{name:""+t+s+n,uid:e.userId,fileId:e.fileId,value:e.value||1})}},2692:function(t,n,e){"use strict";(function(t){var r,i,o=e(0),s=e.n(o),u=e(804),c=e.n(u),a=e(1),f=e.n(a),h=e(3),l=e(2387),d=e(2693),v=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),b=this&&this.__makeTemplateObject||function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},p=h.sheets.alert,m=p.showAlert,y=p.confirm,O=function(n){function e(t){var e=n.call(this,t)||this;return e.state={status:"normal",inputWidth:"100%"},e.startEdit=e._startEdit.bind(e),e.onKeyDown=e._onKeyDown.bind(e),e.onInput=e._onInput.bind(e),e.deleteVersion=e._deleteVersion.bind(e),e.versionClick=e._versionClick.bind(e),e.handleMouseEnter=e._handleMouseEnter.bind(e),e.handleMouseLeave=e._handleMouseLeave.bind(e),e.endEdit=e._endEdit.bind(e),e}return v(e,n),e.prototype.componentDidMount=function(){this.adjustInputWidth()},e.prototype._startEdit=function(){var t=this;this.setState({status:"edit"}),setTimeout(function(){t.refs.title.focus(),document.execCommand("selectAll",!1,void 0)})},e.prototype._endEdit=function(){this.setState({status:"normal"});var t=this.refs.title.value;if(!c()(t))return this.resetInput();!(t===this.props.version.label)&&this.updateVersion(t)},e.prototype._onKeyDown=function(t){13===t.keyCode&&t.target.blur()},e.prototype._onInput=function(t){var n=t.target.value;this.cutOff(n),this.adjustInputWidth()},e.prototype.resetInput=function(){this.refs.title.value=this.props.version.label,this.adjustInputWidth(),m({title:s()("版本名称不能为空"),type:"error"})},e.prototype._deleteVersion=function(){var t=this.props,n=t.handleDelete,e=t.version,r=e.id,o=e.label;y({title:s()("删除版本"),description:s()(i||(i=b(["确认删除历史版本“","”吗？<br>该删除不会影响表格内容。"],["确认删除历史版本“","”吗？<br>该删除不会影响表格内容。"])),o),confirmFun:function(){n(r)}})},e.prototype.updateVersion=function(t){var n=this.props.version;n.label=t,this.props.updateVersion({id:n.id,label:t})},e.prototype.hasPermission=function(){var t=this.props.canManageVersionItem,n=this.props.currentUserId===this.props.version.user_id;return t||n},e.prototype._versionClick=function(n){var e=t(n.target),r=e.parents(),i=["s-version-title-edit","s-version-delete"];"edit"===this.state.status&&i.push("s-version-title"),!i.some(function(t){return e.hasClass(t)||r.hasClass(t)})&&this.props.handlePreview(this.props.version)},e.prototype._handleMouseEnter=function(t){var n=this.props;(0,n.handleTooltip)(n.version,!0,t)},e.prototype._handleMouseLeave=function(t){var n=this.props;(0,n.handleTooltip)(n.version,!1,t)},e.prototype.getNameWidth=function(){var t=this.refs.title.value,n=document.createElement("span");n.style.fontSize="12px",n.innerText=t,document.body.appendChild(n);var e=n.offsetWidth;return document.body.removeChild(n),e},e.prototype.adjustInputWidth=function(){var t=this.getNameWidth();this.setState({inputWidth:Math.min(t,194).toString()+"px"})},e.prototype.cutOff=function(t){t&&(this.refs.title.value=Object(l.a)(t,32))},e.prototype.render=function(){var t=this.props,n=t.version,e=t.selected,r=t.isDisableRevert,i=t.handleRevert,o=n.label,u=n.User,c=n.docHistoryId,a=u.name,h=this.state,l=h.status,v=h.inputWidth,b="edit"===l,p=this.hasPermission(),m=c===e?"active":"";return f.a.createElement("div",{className:"s-version-item "+m,onClick:this.versionClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},f.a.createElement("div",{className:"s-content-container"},f.a.createElement("div",{className:"s-vertion-title-container"},f.a.createElement("input",{ref:"title",className:"s-version-title",readOnly:!b,style:{width:v},defaultValue:o,maxLength:32,onBlur:this.endEdit,onKeyDown:this.onKeyDown,onInput:this.onInput}),p&&f.a.createElement("span",{onClick:this.startEdit,className:"s-version-title-edit s-toolbar-icon s-toolbar-icon-edit"})),f.a.createElement("div",{className:"s-version-content"},f.a.createElement("span",{className:"s-author"},a)," ",s()("保存了版本")),p&&f.a.createElement("div",{className:"s-version-delete",onClick:this.deleteVersion},f.a.createElement("span",{className:"icon-trash-delete s-version-delete-icon"}),s()("删除")),Object(d.a)(n,r,i)))},e}(a.Component);n.a=O}).call(n,e(25))},2693:function(t,n,e){"use strict";n.a=function(t,n,e){return s.a.createElement("div",{className:"s-action-bar-wrap"},s.a.createElement("div",{className:"s-action-bar"+(n?" disabled":""),onClick:function(n){n.stopPropagation(),e(t)}},s.a.createElement("span",{className:"hicon icon-recover"}),i()("还原")),s.a.createElement("div",{style:{clear:"both"}}))};var r=e(0),i=e.n(r),o=e(1),s=e.n(o)},2694:function(t,n,e){"use strict";var r,i=e(0),o=e.n(i),s=e(1),u=e.n(s),c=e(21),a=function(t){return t.isEditing||!t.permission.U};function f(t){return u.a.createElement(c.j,{disabled:a(t)},u.a.createElement(c.b,{icon:"save",tooltip:o()("保存版本"),onTap:r.createVersion}))}function h(t){return u.a.createElement(c.i,{disabled:a(t)},u.a.createElement(c.b,{icon:"save",tooltip:o()("保存版本"),onTap:r.createVersion}),u.a.createElement("br",null),u.a.createElement("span",null,o()("保存版本")))}n.a=function(t){return r=t,{singleTool:f,doubleTool:h}}},2695:function(t,n,e){"use strict";var r,i=e(0),o=e.n(i),s=e(1),u=e.n(s),c=e(194),a=(e.n(c),e(798)),f=e.n(a),h=e(2696),l=e(2388),d=e(3),v=e(6),b=e.n(v),p=e(2263),m=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},O=d.sheets,g=O.Events,w=O.Plugin,j=(d.Editor,"VersionPreview"),S=function(t){function n(e){var r=t.call(this,{name:j,Constructor:n,config:e})||this;return r.options=e,r.cooperation=new f.a.ColorPalette(e.currentUserId),r.A=e.historyEditor||Object(p.a)(e.A),e.container&&r.render(e.container),r.install(),r}return m(n,t),n.prototype.setLocale=function(t){o.a.setLocaleSync(t)},n.prototype.render=function(t){b.a.render(u.a.createElement(c.Provider,{store:l.c},u.a.createElement(h.a,y({},y(y({},this.options),{container:t,cooperation:this.cooperation,previewEditor:this.A})))),t)},n.prototype.show=function(t){l.a.togglePreviewAction(!0,t),this.A.emit(g.JF)},n.prototype.hide=function(){l.a.togglePreviewAction(!1),this.A.emit(g.JG)},n.prototype.isShown=function(){return l.c.select("versionPreview.isShowPreview",l.c.getState())},n}(w);n.a=S},2696:function(t,n,e){"use strict";var r=e(194),i=(e.n(r),e(2388)),o=e(2385),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},u=i.b.select;n.a=Object(r.connect)(function(t,n){var e=u({isPreview:"versionPreview.isShowPreview",isLoading:"versionPreview.isLoadingPreview",steps:"versionPreview.steps",curStep:"versionPreview.curStep",users:"history.users",baseDelta:"versionPreview.baseDelta",curDelta:"versionPreview.curDelta",sheetId:"versionPreview.sheetId",highLight:"history.highLight",selected:"versionPreview.history=",isRenderFilter:"history.isRenderFilter"},t);return s(s({wrapperClass:"sm-sheet-editor-version"},e),n)},function(){return i.a})(o.a)},2697:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e.d(n,"initStateAction",function(){return o}),e.d(n,"togglePreviewAction",function(){return s}),e.d(n,"onSetCurStepAction",function(){return u}),e.d(n,"setPreviewLoadingAction",function(){return c}),e.d(n,"injectEditorToStore",function(){return a}),e.d(n,"setEditorFilterRenderStatus",function(){return f});var r=e(7),i=e(2262),o=function(t){return Object(r.c)(i.c,t)},s=function(t,n){return t?Object(r.c)(i.h,n||{}):Object(r.c)(i.b)},u=function(t){return Object(r.c)(i.f,t)},c=function(t){return Object(r.c)(i.g,t)},a=function(t){return Object(r.c)("@injectEditorToStore",t)},f=function(){return Object(r.c)("@setEditorFilterRenderStatus")}},2698:function(t,n,e){"use strict";var r=e(1),i=e.n(r),o=e(194),s=(e.n(o),e(6)),u=e.n(s),c=e(2699),a=e(2389),f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},h=function(){function t(t){this.options=t,t.container&&this.render(t.container)}return t.prototype.render=function(t,n){void 0===n&&(n={}),this.options=f(f({},this.options),n),u.a.render(i.a.createElement(o.Provider,{store:a.c},i.a.createElement(c.a,f({},f(f({},this.options),{container:t})))),t)},t.prototype.show=function(){a.a.toggleAction(!0)},t.prototype.hide=function(){a.a.toggleAction(!1)},t}();n.a=h},2699:function(t,n,e){"use strict";var r=e(194),i=(e.n(r),e(2389)),o=e(2702),s=e.n(o),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},c=i.b.select;n.a=Object(r.connect)(function(t,n){var e=c({isShow:"discord.isShow"},t);return u(u({},e),n)},function(){return i.a})(s.a)},2700:function(t,n,e){"use strict";n.a={namespace:"discord",reducers:{isShow:[!1,{"@toggle":function(t,n){return n}}]}}},2701:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e.d(n,"toggleAction",function(){return i});var r=e(7),i=function(t){return Object(r.c)("@toggle",t)}},2702:function(t,n,e){Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=c(e(14)),o=e(1),s=c(o),u=e(163);function c(t){return t&&t.__esModule?t:{default:t}}var a=function(t){function n(t){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.getCnt=function(t){"function"==typeof e.props.getListLength&&e.props.getListLength(t)},e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,o.Component),r(n,null,[{key:"propTypes",get:function(){return{isShow:i.default.bool,discord:i.default.any,getListLength:i.default.func}}}]),r(n,[{key:"componentDidMount",value:function(){var t=this;this.props.discord.then(function(n){t.commonDiscordInst=n,t.events=n.constructor.events,n.render(t.discordContainer),n.on(t.events.TOTAL,t.getCnt)})}},{key:"componentWillUnmount",value:function(){this.commonDiscordInst&&this.commonDiscordInst.off(this.events.TOTAL,this.getCnt)}},{key:"render",value:function(){var t=this,n=this.props.isShow;return s.default.createElement("div",{className:(0,u.className)({"s-list":!0,"s-list-discord":!0,"hide-list":!n}),ref:function(n){t.discordContainer=n}})}}]),n}();n.default=a,t.exports=n.default}});