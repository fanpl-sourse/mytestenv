webpackJsonpSm_name_([3],{1946:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=e(0),o=e.n(i),a=e(3),c=(e(3026),e(3029)),u=e(3030),s=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),f=a.sheets,l=(f.root,f.path),d=f.Plugin,h=(l.setByPath,a.Editor,"ChartV2"),v=function(n){function t(e){var r=e.A,i=e.onSidebarVisibilityChange,o=n.call(this,{name:h,Constructor:t,config:arguments[0]})||this;o.A=r;var a=u.a.create({A:r});if(o.command=a.command,i&&a.on("ChartSidebarVisibilityChanged",i),o.install(),r.charts=a,r.isRendered){r.getSheetsMetaIterator().then(function(n){a.command.applySpreadUpdate(n)});var c=r.spread.B();if(c&&c.E){var s=c.E.zoom();1!==s&&a.command.setZoomRatio(s)}}return o}return s(t,n),t.prototype.getMenuConfig=function(){var n=this;return Object(c.a)({onCreateChart:function(){var t=n.A.spread.B();if(t){var e=t.E,r=e.name(),i=e.getSelections().map(function(n){return{sheetName:r,range:n}}),o=n.command.addChartFromSelection({references:i});o&&(n.command.showSidebar({chartId:o}),n.command.setActiveSeries({sheetId:e.guid(),selected:{chartId:o}}),n.command.commitChange(),a.sheets.track(2,"0075"))}}})},t.prototype.setLocale=function(n){o.a.setLocaleSync(n)},t.prototype.updateConfig=function(){},t}(d);t.default=v},2107:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i,o,a=e(0),c=e.n(a),u=e(2137),s=e(2123),f=e(2168),l=e(2334),d=e(2144),h=e(2118),v=e(2140),b=e(2167),g=e(2430),p=e(2192),m=e(2231),y=e(2157),O=e(2139),j=e(2124),x=e(2134),w=this&&this.__makeTemplateObject||function(n,t){return Object.defineProperty?Object.defineProperty(n,"raw",{value:t}):n.raw=t,n},C=this&&this.__assign||function(){return(C=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},M=this&&this.__rest||function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e};!function(n){var t={row:"rowCount",col:"colCount"},e={row:"col",col:"row"},r={row:"colCount",col:"rowCount"},a=function(n,i){for(var o,a=n.sheetName,c=n.range,u=[],s=c[i],f=c[i]+c[t[i]],l=s;l<f;l++)u.push({sheetName:a,range:(o={},o[i]=l,o[t[i]]=1,o[e[i]]=c[e[i]],o[r[i]]=c[r[i]],o)});return u},N=function(n){return a(n,"row")},I=function(n){return a(n,"col")},S=function(n){return n},D=function(n){var t=n.length,e=n[0]?n[0].length:0;return Object(u.a)(e).map(function(e){return Object(u.a)(t).map(function(t){return n[t][e]})})},k=function(n){return n[0][0]};n.getSingleSheetName=function(n){var t=Object(l.a)(n.map(function(n){return n.sheetName}));if(1===t.length)return t[0]};var z,L,T,A,E=function(n,t){return n.row===t.row&&n.rowCount===t.rowCount&&t.col+t.colCount<=n.col},B=function(n,t){return n.col===t.col&&n.colCount===t.colCount&&t.row+t.rowCount<=n.row};n.excludeHiddenRowCol=function(n){var t=n.length,e=n[0]?n[0].length:0,r=function(n){return!n.isHidden},i=Object(u.a)(t).map(function(t){return n[t].some(r)}),o=Object(u.a)(e).map(function(t){return n.some(function(n){return r(n[t])})});return n.filter(function(n,t){return i[t]}).map(function(n){return n.filter(function(n,t){return o[t]})})},function(n){var t={type:"empty",value:void 0,text:"",format:"",isHidden:!1,span:void 0},e={type:"empty",value:void 0,text:"",format:"",isHidden:!0,span:void 0};n.empty=function(n,r){return void 0===n&&(n=!1),void 0===r&&(r=void 0),r?C(C({},n?e:t),{span:r}):n?e:t},n.getValue=function(n){if(n)switch(n.type){case"empty":return;case"number":return n.value;case"text":return;case"date":return n.oadate;default:return Object(d.b)(n)}}}(z=n.DataItems||(n.DataItems={})),function(n){n.updateByCombinedSeries=function(n,t,e){return[]};var t=!0;n.switchRowColumn={getStatus:function(n){var e=A.extractUnionRange(n),r=A.getSeriesOrientaton(n);return{isAvailable:Boolean(e&&e.length>0&&null!=r),isActive:t}},switch:function(n,e){var r=A.extractUnionRange(n),i=A.getSeriesOrientaton(n);if(Boolean(r&&r.length>0&&("horizonal"===i||"vertical"===i))){var o=A.extractUnionSeries(n),a={horizonal:"vertical",vertical:"horizonal"}[i];if(o){var c=o.dataRange,u=o.seriesLabel,s={size:[],dataRange:c,seriesLabel:o.categoryLabel,categoryLabel:u},f=A.splitSeriesRefs(s,a);return t=!t,f}var l=A.extractSeries(r,e,{orientation:a});return t=!t,l.series}}},n.firstAs={getStatus:function(n,t){var e=A.extractUnionSeries(t);if(!e)return{isAvailable:!1};var r=A.orientationFallback(A.getSeriesOrientaton(t));if(!r)return{isAvailable:!1};var i=e.dataRange.map(function(n){return n.range})[0],o=e[n].map(function(n){return n.range})[0],a=(e["seriesLabel"===n?"categoryLabel":"seriesLabel"].map(function(n){return n.range})[0],{seriesLabel:{horizonal:"col",vertical:"row"},categoryLabel:{horizonal:"row",vertical:"col"}}[n][r]),c={row:"rowCount",col:"colCount"}[a];return o?1===o[c]&&i[c]>=1&&o[a]+1===i[a]?{isAvailable:!0,isActive:!0,rowOrColIndex:o[a],rowOrColType:a}:{isAvailable:!1}:i[c]>=2?{isAvailable:!0,isActive:!1,rowOrColIndex:i[a],rowOrColType:a}:{isAvailable:!1}},switch:function(n,t){var e=function(){return t},r=A.extractUnionSeries(t);if(!r)return e();var i=A.getSeriesOrientaton(r),o="amibiguous"===i||"complex"===i?O.a.defaultOrientation:i,a=r.dataRange.map(function(n){return n.range})[0],c=r[n].map(function(n){return n.range})[0],u="seriesLabel"===n?"categoryLabel":"seriesLabel",s=r[u].map(function(n){return n.range})[0],f={seriesLabel:{horizonal:"col",vertical:"row"},categoryLabel:{horizonal:"row",vertical:"col"}}[n][o],l="row"===f?"col":"row",d={row:"rowCount",col:"colCount"}[f],h={row:"rowCount",col:"colCount"}[l],v=r.dataRange[0].sheetName,b=function(t){var r,i,c,b,g=t?[{sheetName:v,range:(r={},r[f]=a[f],r[d]=1,r[l]=a[l],r[h]=a[h],r)}]:[],p=[{sheetName:v,range:(i={},i[f]=a[f]+(t?1:-1),i[d]=a[d]+(t?-1:1),i[l]=a[l],i[h]=a[h],i)}],m=s?[{sheetName:v,range:(c={},c[f]=s[f]+(t?1:-1),c[d]=s[d]+(t?-1:1),c[l]=s[l],c[h]=s[h],c)}]:[],y=((b={size:[],dataRange:p})[n]=g,b[u]=m,b);return A.isSimpleSeries(y,o)?A.splitSeriesRefs(y,o):e()};return c?1===c[d]&&a[d]>=1&&c[f]+1===a[f]?b(!1):e():a[d]>=2?b(!0):e()}},n.draggingOrResizingSeriesRefs=function(t,e,r,i){var o=A.extractUnionSeries([t]);if(!o)return t[e]=[r],t;var a=Object(g.a)(o),c=a.categoryLabel,u=a.seriesLabel,s=a.dataRange;if("dataRange"!==e){var f=Object(g.a)(s[0]),l=f.range,d=f.sheetName;return E(s[0].range,t[e][0].range)&&(l.row=r.range.row,l.rowCount=r.range.rowCount),B(s[0].range,t[e][0].range)&&(l.col=r.range.col,l.colCount=r.range.colCount),n.draggingOrResizingSeriesRefs(t,"dataRange",{range:l,sheetName:d},i)}var h=[c,u].find(function(n){return n[0]&&E(s[0].range,n[0].range)}),v=h&&h[0].range,b=[c,u].find(function(n){return n[0]&&B(s[0].range,n[0].range)}),p=b&&b[0].range,m=s[0],y=m.sheetName,O=m.range,j=O.row,x=O.col,w=O.rowCount,M=O.colCount;(x=Math.max(r.range.col,v?v.col+v.colCount:0),"resize"===i)&&(M=Math.max(r.range.col+r.range.colCount-1,v?v.col+v.colCount:0)-x+1);(j=Math.max(r.range.row,p?p.row+p.rowCount:0),"resize"===i)&&(w=Math.max(r.range.row+r.range.rowCount-1,p?p.row+p.rowCount:0)-j+1);return v&&(v.row=j,v.rowCount=w),p&&(p.col=x,p.colCount=M),C(C({},t),{categoryLabel:c,seriesLabel:u,dataRange:[{sheetName:y,range:{row:j,col:x,rowCount:w,colCount:M}}]})}}(n.Operations||(n.Operations={})),function(n){var i=function(n){return{type:"complex",range:Object(m.e)(n)}},o=function(t){var e=n.getVerticalLayout(t);if(e)return{type:"vertical",range:e.range,mapRules:e.mapRules}},a=function(t){var e=n.getHorizonalLayout(t);if(e)return{type:"horizonal",range:e.range,mapRules:e.mapRules}};n.get1dLayout=function(n,i){var o,a;if(n.length){var c=i,u=e[i],s=t[i],f=r[i],d=Object(l.a)(n.map(function(n){return n[f]}));if(!(d.length>1)){for(var h=n.slice().sort(m.b),v=0,g=[],p=0;p<h.length;p++){var y=h[p],O=((o={})[u]=0-y[u],o[c]=v-y[c],o);g.push({origin:y,offset:O}),v+=y[s]}return{range:((a={})[c]=0,a[u]=0,a[s]=Object(b.a)(n.map(function(n){return n[s]})),a[f]=d[0],a),mapRules:g}}}},n.getHorizonalLayout=function(t){return n.get1dLayout(t,"col")},n.getVerticalLayout=function(t){return n.get1dLayout(t,"row")},n.getGridLayout=function(n){var t=Object(f.a)(n);if(t.length){for(var e=[],r=[],i={},o=function(n){return n.split(":").map(function(n){return Number(n)})},a=function(n,t){var e=o(n),r=e[0],i=e[1],a=o(t),c=a[0],u=a[1];return!(i<c||u<r)},c=function(n,t){var e=o(n),r=e[0],i=(e[1],o(t)),a=i[0];i[1];return r-a},u=function(n){var t=n[0];return n[1]-t+1},s=function(n){var o=t[n],c=o.row,u=o.col,s=o.rowCount,f=o.colCount,l=[c,c+s-1].join(":");if(!e.includes(l)){if(e.some(function(n){return a(n,l)}))return{value:void 0};e.push(l)}var d=[u,u+f-1].join(":");if(!r.includes(d)){if(r.some(function(n){return a(n,d)}))return{value:void 0};r.push(d)}if(i[l]||(i[l]={}),i[l][d])return{value:void 0};i[l][d]=!0},l=0;l<t.length;l++){var d=s(l);if("object"==typeof d)return d.value}if(e.every(function(n){return r.every(function(t){return Boolean(i[n]&&i[n][t])})})){for(var h=e.slice().sort(c).map(o),v=r.slice().sort(c).map(o),g=[],p=0,m=0;m<h.length;m++){var y=h[m],O=y[0],j=y[1]-O+1,x=0;for(l=0;l<v.length;l++){var w=v[l],C=w[0],M=w[1]-C+1,N={row:O,col:C,rowCount:j,colCount:M},I={row:p-O,col:x-C};g.push({origin:N,offset:I}),x+=M}p+=j}return{rowSegments:h,colSegments:v,range:{row:0,col:0,rowCount:Object(b.a)(h.map(u)),colCount:Object(b.a)(v.map(u))},mapRules:g.slice().sort(T.compareRule)}}}},n.detectRangesPattern=function(t){if(0===t.length)return{type:"none"};if(1===t.length)return{type:"single",range:t[0]};if(Object(m.i)(t))return i(t);var e=n.getGridLayout(t);if(e)return{type:"grid",range:e.range,mapRules:e.mapRules};var r=1===Object(l.a)(t.map(function(n){return n.rowCount})).length,c=1===Object(l.a)(t.map(function(n){return n.colCount})).length;if(c&&!r)return o(t)||i(t);if(r&&!c)return a(t)||i(t);if(r&&c){var u=Object(m.i)(t.map(function(n){return{col:n.col,colCount:n.colCount,row:0,rowCount:1}})),s=Object(m.i)(t.map(function(n){return{row:n.row,rowCount:n.rowCount,col:0,colCount:1}}));return u&&!s?o(t)||i(t):s&&!u&&a(t)||i(t)}return i(t)}}(L=n.RangePatterns||(n.RangePatterns={})),function(n){n.getMappedReader=function(n,t){var e=n.readData,r=t.map(function(n){return Object(m.j)(n.origin,n.offset)});return{readData:function(n){var i=n.sheetName,o=n.range,a=r.findIndex(function(n){return Object(m.c)(n,o)});if(-1!==a){var c=t[a].offset;return e({sheetName:i,range:Object(m.j)(o,Object(m.d)(c))})}var s=o.row,f=o.col,l=o.rowCount,d=o.colCount;return Object(u.a)(l).map(function(n){return Object(u.a)(d).map(function(o){var a={row:s+n,col:f+o,rowCount:1,colCount:1},c=r.findIndex(function(n){return Object(m.c)(n,a)});if(-1!==c){var u=t[c].offset;return e({sheetName:i,range:Object(m.j)(a,Object(m.d)(u))})[0][0]}return h.b,z.empty(!0,void 0)})})}}},n.reverseMapRange=function(n,t){return Object(s.a)(n.map(function(n){var e=n.origin,r=n.offset,i=Object(m.j)(e,r),o=Object(m.h)(i,t);if(o)return Object(m.j)(o,Object(m.d)(r))}))},n.compareRule=function(n,t){return Object(m.b)(Object(m.j)(n.origin,n.offset),Object(m.j)(t.origin,t.offset))}}(T=n.RangeMapping||(n.RangeMapping={})),function(t){var e=Object(v.a)("chart:series"),r=function(n){return Object(f.a)(Object(f.a)([].concat(n).map(function(n){var t=n.dataRange,e=n.seriesLabel,r=n.categoryLabel,i=n.size;return Object(f.a)([t,e,r,i])})))};t.getRangeOrientation=function(n){var t=n.rowCount,e=n.colCount;return t>e?"vertical":t<e?"horizonal":"amibiguous"},t.unifyOrientation=function(n){var t=Object(l.a)(n).filter(function(n){return"amibiguous"!==n});switch(t.length){case 0:return"amibiguous";case 1:return t[0];default:return"complex"}};var a=function(n,t){return n.length<t?n:n.substr(0,t)+"..."};t.orientationFallback=function(n){switch(n){case"horizonal":case"vertical":return n;case"amibiguous":return O.a.defaultOrientation;case"complex":return;default:return Object(d.b)(n)}},t.getSeriesLabel=function(n,e,r,u){var s=(u||{}).fillDefault,l=void 0===s||s;if(!n.seriesLabel.length)return l?c()(i||(i=w(["系列",""],["系列",""])),e+1):"";var d=t.orientationFallback(t.getSeriesOrientaton(n))||{horizonal:"vertical",vertical:"horizonal"}[t.unifyOrientation(n.seriesLabel.map(function(n){return n.range}).map(t.getRangeOrientation))]||O.a.defaultOrientation,h=Object(f.a)(Object(f.a)(n.seriesLabel.map(function(n){var t=n.sheetName,e=n.range,r=e.row,i=e.col,o=e.rowCount,a=e.colCount;return"horizonal"===d?{sheetName:t,range:{row:r,col:i,rowCount:1,colCount:a}}:{sheetName:t,range:{row:r,col:i,rowCount:o,colCount:1}}}).map(function(n){return r.readData(n)}))).map(function(n){return n.text}).join(" ")||(l?c()(o||(o=w(["系列",""],["系列",""])),e+1):"");return a(h,50)},t.getCategoryLabels=function(n,e){if(!n.categoryLabel.length)return[];var r=t.orientationFallback(t.getSeriesOrientaton(n))||{horizonal:"horizonal",vertical:"vertical"}[t.unifyOrientation(n.categoryLabel.map(function(n){return n.range}).map(t.getRangeOrientation))]||O.a.defaultOrientation;return Object(f.a)(n.categoryLabel.map(e.readData).map(function(n){return"horizonal"===r?D(n):S(n)}))},t.getCategoryLabelText=function(n,e,r){var i=(r||{}).fillDefault,o=void 0!==i&&i,c=t.getCategoryLabels(n,e).map(function(n){var t=n.map(function(n){return n.text}).join(" ");return a(t,50)});if(o){var s=t.getDataItemsCount(n);return Object(u.a)(s).map(function(n){return c[n]||String(n+1)})}return c},t.getDataItems=function(n,e){if(!n.dataRange.length)return[];var r=t.orientationFallback(t.getSeriesOrientaton(n))||{horizonal:"horizonal",vertical:"vertical"}[t.unifyOrientation(n.dataRange.map(function(n){return n.range}).map(t.getRangeOrientation))]||O.a.defaultOrientation,i=Object(f.a)(n.dataRange.map(function(n){return"horizonal"===r?D(e.readData(n)):S(e.readData(n))}));return Object(f.a)(Object(f.a)(i))},t.getDataItemsCount=function(n){return t.getDataItems(n,{readData:function(n){var t=n.range,e=t.rowCount,r=t.colCount;return Object(u.a)(e).map(function(){return Object(u.a)(r).map(function(){return z.empty(!0,void 0)})})}}).length},t.evaluateSeries=function(t,e){return t.map(function(t,r){return C(C({},t),{value:{dataRange:n.Series.getDataItems(t,e),seriesLabel:n.Series.getSeriesLabel(t,r,e),categoryLabelItems:n.Series.getCategoryLabels(t,e),categoryLabel:n.Series.getCategoryLabelText(t,e)}})}).filter(function(n){return n.value.dataRange.length>0})},t.isSimpleSeries=function(n,e){void 0===e&&(e=t.getSeriesOrientaton(n));var r=n.dataRange,i=n.seriesLabel,o=n.categoryLabel;if(!(1===r.length&&i.length<=1&&o.length<=1))return!1;var a=r[0].range,c=i[0]&&i[0].range,u=o[0]&&o[0].range,s=(!c||E(a,c))&&(!u||B(a,u)),f=(!c||B(a,c))&&(!u||E(a,u));switch(e){case"horizonal":return s;case"vertical":return f;default:return s||f}},t.extractUnionRange=function(t){var e=r(t),i=n.getSingleSheetName(e);if(null==i)return[];var o=e.map(function(n){return n.range}),a=Object(m.f)(o),c=Object(s.a)(a.map(function(n){return Object(m.e)(n)}));switch(L.detectRangesPattern(c).type){case"single":case"horizonal":case"vertical":case"grid":return c.map(function(n){return{sheetName:i,range:n}});default:return}},t.extractUnionSeries=function(e){if(e.length){var i=n.getSingleSheetName(r(e));if(null!=i){var o=function(n){return 1===n.length?n[0]:void 0},a=function(n){var t=n.map(o);if(t.every(Boolean)){var e=Object(m.g)(t.map(function(n){return n.range}));return e&&{reference:{sheetName:i,range:e.range},direction:e.direction}}},c=a(e.map(function(n){return n.dataRange}));if(c){var u,s,f=c.direction,d=c.reference;if(e.some(function(n){return n.seriesLabel.length>0})){var h=a(e.map(function(n){return n.seriesLabel}));if(!h)return;var v=h.direction,b=h.reference;if(v&&v!==f)return;if("left"===f||"right"===f){if(!B(d.range,b.range))return;u=b}else if("top"===f||"bottom"===f){if(!E(d.range,b.range))return;u=b}else{if(!E(d.range,b.range)&&!B(d.range,b.range))return;u=b}}if(e.some(function(n){return n.categoryLabel.length>0})){var g=e.map(function(n){return o(n.categoryLabel)});if(!g.every(Boolean))return;var p=Object(l.a)(g.map(function(n){return x.a.stringify(n)}));if(1!==p.length)return;var y=x.a.parse(p[0])[0];if("left"===f||"right"===f){if(!E(d.range,y.range))return;s=y}else if("top"===f||"bottom"===f){if(!B(d.range,y.range))return;s=y}else{if(!E(d.range,y.range)&&!B(d.range,y.range))return;s=y}}var O=j.a.createSeriesRefs([d],u?[u]:[],s?[s]:[]);return t.isSimpleSeries(O)?O:void 0}}}};var h=function(n){var e=n.dataRange,r=n.seriesLabel,i=n.categoryLabel;if(1===e.length&&r.length<=1&&i.length<=1){var o=e[0].range,a=r[0]&&r[0].range,c=i[0]&&i[0].range,u=(!a||E(o,a))&&(!c||B(o,c)),s=(!a||B(o,a))&&(!c||E(o,c));if(a||c){if(u)return"horizonal";if(s)return"vertical"}}return t.unifyOrientation(n.dataRange.map(function(n){return n.range}).map(t.getRangeOrientation))};t.getSeriesOrientaton=function(e){var i=r(e);if(null==n.getSingleSheetName(i))return"complex";if(Array.isArray(e)&&e.every(function(n){return 1===n.dataRange.length&&0===n.categoryLabel.length&&0===n.seriesLabel.length})){var o=Object(m.g)(e.map(function(n){return n.dataRange[0].range}));if(o&&o.direction)return{left:"vertical",right:"vertical",top:"horizonal",bottom:"horizonal"}[o.direction]}return t.unifyOrientation([].concat(e).map(h))},t.detectSeriesFormat=function(n,e){var r,i=t.evaluateSeries(n,e)[0];if(i)return t.getDataItems(i,{readData:function(n){if(!r){var t=e.readData(n),i=t[0]&&t[0][0];i&&i.format&&(r=i.format)}return[]}}),r},t.splitSeriesRefs=function(t,e){var i=r(t);if(null==n.getSingleSheetName(i))throw new Error("cannot create series across sheet");switch(e){case"horizonal":var o=t.seriesLabel[0]&&N(t.seriesLabel[0]);return N(t.dataRange[0]).map(function(n,e){return j.a.createSeriesRefs([n],o?[o[e]]:[],t.categoryLabel)});case"vertical":var a=t.seriesLabel[0]&&I(t.seriesLabel[0]);return I(t.dataRange[0]).map(function(n,e){return j.a.createSeriesRefs([n],a?[a[e]]:[],t.categoryLabel)});default:return Object(d.b)(e)}},t.trimEmptyPaddings=function(n,t){for(var e=n.sheetName,r=n.range,i=r.row,o=r.rowCount,a=r.col,c=r.colCount,s=i+o-1,f=a+c-1,l=function(n){return"empty"!==k(t.readData(n)).type};i<=s;i++){if(Object(u.a)(f-a+1).map(function(n,t){return{sheetName:e,range:{row:i,col:a+t,rowCount:1,colCount:1}}}).some(l))break}for(;s>=i;s--){if(Object(u.a)(f-a+1).map(function(n,t){return{sheetName:e,range:{row:s,col:a+t,rowCount:1,colCount:1}}}).some(l))break}if(!(i>s)){for(;a<=f;a++){if(Object(u.a)(s-i+1).map(function(n,t){return{sheetName:e,range:{row:i+t,col:a,rowCount:1,colCount:1}}}).some(l))break}for(;f>=a;f--){if(Object(u.a)(s-i+1).map(function(n,t){return{sheetName:e,range:{row:i+t,col:f,rowCount:1,colCount:1}}}).some(l))break}if(!(a>f))return{sheetName:e,range:{row:i,col:a,rowCount:s-i+1,colCount:f-a+1}}}},t.extractSeriesFromSingleRef=function(n,e,r){var i=(r||{}).trimPaddings,o=void 0===i||i?t.trimEmptyPaddings(n,e):n;if(!o||x.a.isReferenceEmpty(o))return{orientation:"amibiguous",series:[]};for(var a=o.sheetName,c=o.range,u=c.row,s=c.col,f=c.rowCount,l=s+c.colCount-1,d=u+f-1,h="empty",v=function(n,t){var r=k(e.readData({sheetName:a,range:{row:n,col:t,rowCount:1,colCount:1}}));if(!r.span)return{type:r.type,span:void 0};var i=n-r.span.rowIndex,o=t-r.span.colIndex,c=k(e.readData({sheetName:a,range:{row:i,col:o,rowCount:1,colCount:1}}));return{type:c.type,span:c.span}},b=d;b>=u;){var g=v(b,l);if("empty"===h)"empty"!==g.type&&(h=g.type);else if("empty"!==g.type&&g.type!==h)break;b-=g.span?g.span.rowCount:1}b++;for(var p=l;p>=s;){g=v(d,p);if("empty"===h)"empty"!==g.type&&(h=g.type);else if("empty"!==g.type&&g.type!==h)break;p-=g.span?g.span.colCount:1}var m={row:b,col:++p,rowCount:d-b+1,colCount:l-p+1},y=r&&r.orientation||t.getRangeOrientation(m)||O.a.defaultOrientation,j="amibiguous"===y?O.a.defaultOrientation:y,w={row:u,col:m.col,rowCount:b-u,colCount:m.colCount},C={row:m.row,col:s,rowCount:m.rowCount,colCount:p-s},M="horizonal"===j?{dataRange:[{sheetName:a,range:m}],seriesLabel:x.a.isReferenceEmpty({sheetName:a,range:C})?[]:[{sheetName:a,range:C}],categoryLabel:x.a.isReferenceEmpty({sheetName:a,range:w})?[]:[{sheetName:a,range:w}],size:[]}:{dataRange:[{sheetName:a,range:m}],seriesLabel:x.a.isReferenceEmpty({sheetName:a,range:w})?[]:[{sheetName:a,range:w}],categoryLabel:x.a.isReferenceEmpty({sheetName:a,range:C})?[]:[{sheetName:a,range:C}],size:[]};if(!t.isSimpleSeries(M,j))throw new Error("expected seriesRefs to be SimpleSeries");return{series:t.splitSeriesRefs(M,j),orientation:j}},t.extractSeries=function(r,i,o){e("extractSeries:start",r,o);var a=n.getSingleSheetName(r);if(null==a)return{orientation:"amibiguous",series:[]};var c=L.detectRangesPattern(r.map(function(n){return n.range}));switch(e("extractSeries:pattern",c),c.type){case"none":return{orientation:"amibiguous",series:[]};case"single":case"complex":var u=c.range;return t.extractSeriesFromSingleRef({sheetName:a,range:u},i,o);case"grid":case"horizonal":case"vertical":u=c.range;var l=c.mapRules,h=T.getMappedReader(i,l),v=t.extractSeriesFromSingleRef({sheetName:a,range:u},h,o),b=v.orientation,g=v.series,m=g.map(function(n){return Object(p.a)(n,function(n){return Object(s.a)(Object(f.a)(n.map(function(n){var t=n.range,e=n.sheetName;return T.reverseMapRange(l,t).map(function(n){return{range:n,sheetName:e}})})))})});return e("extractSeries:multirange",{orientation:b,series:g,reversedSeries:m}),{orientation:b,series:m};default:return Object(d.b)(c)}}}(A=n.Series||(n.Series={})),function(n){n.aggregateCount=function(n){var t=new Set;n.forEach(function(n){var e=n.value;M(n,["value"]);e.dataRange.forEach(function(n){if("empty"!==n.type){var e=n.text;t.add(e)}})});var e=Object(y.a)(t),r=n.map(function(n,t){var e=n.value,r=M(n,["value"]),i={};return e.dataRange.forEach(function(n){if("empty"!==n.type){var t=n.text;i[t]||(i[t]=0),i[t]++}}),C({count:i,value:e},r)}),i=r[0]?r[0].count:{},o=e.sort(function(n,t){return(i[t]||0)-(i[n]||0)});return r.map(function(n){var t=n.value,e=n.count,r=M(n,["value","count"]),i=t.seriesLabel,a=o.map(function(n){return[n,e[n]||0]}),c={dataRange:a.map(function(n){n[0];var t=n[1];return{type:"number",text:String(t),value:t,format:"General",isHidden:!1,span:void 0}}),seriesLabel:i,categoryLabelItems:a.map(function(n){var t=n[0];n[1];return[{type:"text",text:t,value:t,format:"General",isHidden:!1,span:void 0}]}),categoryLabel:a.map(function(n){var t=n[0];n[1];return t})};return C({count:e,value:c},r)})}}(n.SeriesProcessors||(n.SeriesProcessors={}))}(r||(r={}))},2118:function(n,t,e){"use strict";var r;e.d(t,"a",function(){return r}),e.d(t,"c",function(){return i}),e.d(t,"b",function(){return o}),e.d(t,"e",function(){return a}),e.d(t,"d",function(){return c}),function(n){n.debug="debug",n["debug-with-stack"]="debug-with-stack",n["debug-chart-layout"]="debug-chart-layout",n["debug-text-wrap"]="debug-text-wrap"}(r||(r={}));var i=function(n){return location.href.includes(n+"=1")},o=i(r.debug),a=/(iphone|ipad|android)/gi.test(navigator.userAgent),c="ActiveXObject"in window},2123:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n){return n.filter(Boolean)}},2124:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(2129),o=e(2137),a=e(2123),c=e(2168),u=(e(2334),e(2144)),s=e(3032),f=e(2193),l=e(2140),d=e(2138),h=e(2431),v=e(2194),b=(e(2231),e(2432)),g=e(2133),p=e(2139),m=e(2134),y=this&&this.__assign||function(){return(y=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)};!function(n){n.ChartType=p.a.ChartType,function(n){n[n.top=1]="top",n[n.right=2]="right",n[n.left=3]="left",n[n.bottom=4]="bottom"}(n.LegendPosition||(n.LegendPosition={})),function(n){n[n.primary=0]="primary",n[n.secondary=1]="secondary"}(n.AxisGroup||(n.AxisGroup={})),n.createSeriesRefs=function(n,t,e,r){return void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===r&&(r=[]),{seriesLabel:t,categoryLabel:e,dataRange:n,size:r}},n.getCharts=function(n){return n.charts},n.getChartById=function(n,t){return n.charts.find(function(n){return n.id===t})},n.getChartsBySheet=function(n,t){return n?n.charts.filter(function(n){return n.sheetId===t}):[]},n.isChartTypeEqual=function(n,t){return Object(d.a)(n.settings.chartType,t.settings.chartType)},n.isChartSettingEqual=function(n,t){return Object(d.a)(n.settings,t.settings)},n.getChartSize=function(n){var t=n.position;return{width:t.width,height:t.height}},n.isChartSizeEqual=function(t,e){return Object(d.a)(n.getChartSize(t),n.getChartSize(e))},n.getInitialState=function(){return{editingChartId:void 0,activeSeries:{},zoomRatio:1,charts:[]}},n.mapChart=function(n,t){return Object(v.a)(n,function(n){n.charts=Object(a.a)(n.charts.map(t))})};n.reduce=Object(l.b)("chart:model:reduce",function(t,e){switch(e.type){case"applySpreadContent":return Object(v.a)(t,function(n){n.charts=Object(c.a)(e.payload.map(function(n){var t=n.sheetId,e=n.attrs;return b.a.fromSheetAttrs(e,t)}))});case"applySpreadUpdate":return Object(v.a)(t,function(n){e.payload.forEach(function(t){for(var e=t.sheetId,r=t.attrs,i=function(t,r){if(b.a.isChartAttrKey(t)){var i=t.split("-")[1];if(r===b.a.DELETE)n.charts=n.charts.filter(function(n){return n.id!==i});else{var o=b.a.fromChartAttr(t,r,e),a=n.charts.findIndex(function(n){return n.id===i});-1!==a?n.charts[a]=o:n.charts.push(o)}}},o=0,a=Object.entries(r||{});o<a.length;o++){var c=a[o];i(c[0],c[1])}})});case"addChart":return Object(v.a)(t,function(n){e.payload.charts.forEach(function(t){n.charts.find(function(n){return n.id===t.id})||n.charts.push(t)})});case"deleteChart":var r=e.payload.charts.map(function(n){return n.id});return n.mapChart(t,function(n){return r.includes(n.id)?null:n});case"updateChart":var i=e.payload.charts;return n.mapChart(t,function(n){return i.find(function(t){return t.id===n.id})||n});case"patchChart":var o=e.payload.charts;return n.mapChart(t,function(n){var t=o.find(function(t){return t.id===n.id});return t?y(y({},n),t):n});case"deleteSheet":var f=e.payload.sheetId;return Object(v.a)(t,function(n){n.charts=n.charts.filter(function(n){return n.sheetId!==f})});case"duplicateSheet":var l=e.payload,d=l.oldSheetId,h=l.newSheetId,g=l.oldSheetName,p=l.newSheetName,O=function(n){return n.sheetName===g?y(y({},n),{sheetName:p}):n},j=n.getChartsBySheet(t,d).map(function(t){return Object(v.a)(t,function(t){t.sheetId=h,t.id=n.generateChartId(),t.settings.series.forEach(function(n){["categoryLabel","seriesLabel","dataRange","size"].forEach(function(t){n[t]=n[t].map(O).map(m.a.appendRefId)})})})});return Object(v.a)(t,function(n){var t;(t=n.charts).push.apply(t,j)});case"updateReference":var x=e.payload.updates;return n.mapChart(t,function(n){var t=x.find(function(t){return t.chartId===n.id});if(!t)return n;var e=t.reference,r=t.description;switch(r.type){case"series":var i=r.property,o=r.seriesId,c=r.refId,f=n.settings.series.findIndex(function(n){return n.id===o}),l=n.settings.series[f];if(l){var d=Object(a.a)(l[i].map(function(n){return n.id===c?e&&y(y({},e),{id:c}):n})).filter(Object(s.a)(m.a.isReferenceEmpty));l[i]=d,"dataRange"===i&&0===d.length&&(n.settings.series=n.settings.series.filter(function(n){return n.id!==o}))}return n;default:return Object(u.b)(r.type)}});case"setEditingChart":var w=e.payload.chartId;return Object(v.a)(t,function(n){w&&n.charts.find(function(n){return n.id===w}),n.editingChartId=w});case"setActiveSeries":return Object(v.a)(t,function(n){var t=e.payload,r=t.sheetId,i=t.selected;i?n.activeSeries[r]=i:delete n.activeSeries[r]});case"setZoomRatio":return Object(v.a)(t,function(n){n.zoomRatio=e.payload});case"updatePermission":return t;default:return Object(u.b)(e)}}),n.cloneChart=function(t){return Object(v.a)(t,function(t){t.id=n.generateChartId()})},n.generateChartId=function(){return Object(f.a)(17)};var t=function(n,t,e,r){return Boolean(t&&t===g.a.getColorFromTheme(n,e,r))};n.createSeries=function(n){var e=n.seriesRefs,r=n.chartType,a=n.colorTheme,c=n.chartToInherit,u=n.reader;return e.map(function(n,s){var l=n.seriesLabel,d=n.categoryLabel,h=n.dataRange,v=n.size,b=m.a.appendRefId,y=c&&c.settings.series[s],O=y&&y.color,j=c&&y&&O&&!t(c.settings.colorTheme,O,s,c.settings.series.length)?O:g.a.getColorFromTheme(a,s,e.length),x=[],w=i.a[r];if(w.attributes.useSectorColor){var C=u?w.attributes.getSectors(n,p.a.defaultColorTheme,u).length:"sectorColors"in n?n.sectorColors.length:16;x=Object(o.a)(C).map(function(n){var e=y&&y.sectorColors,r=e&&e[n];return c&&r&&e&&!t(c.settings.colorTheme,r,n,e.length)?r:g.a.getColorFromTheme(a,n,C)})}return{id:"id"in n?n.id:Object(f.a)(),seriesLabel:l.map(b),categoryLabel:d.map(b),dataRange:h.map(b),size:v.map(b),seriesType:r,axisGroup:p.a.defaultAxisGroup,color:j,sectorColors:x}})},n.normalizeState=function(n,t,e){var r=t.spread.sheets.map(function(n){return n.id});return Object(v.a)(n,function(n){if(n.charts=n.charts.filter(function(n){return r.includes(n.sheetId)}).sort(function(n,t){return n.sheetId<t.sheetId?-1:n.sheetId>t.sheetId?1:n.id<t.id?-1:n.id>t.id?1:0}),n.editingChartId){var t=n.charts.find(function(t){return t.id===n.editingChartId});t&&e(t)||(n.editingChartId=void 0)}n.activeSeries=Object(h.a)(n.activeSeries,function(t,i){if(!r.includes(i))return!1;if(!t)return!1;var o=t.chartId,a=t.seriesId,c=n.charts.find(function(n){return n.id===o});return!(!c||!e(c))&&(c.sheetId===i&&!(a&&!c.settings.series.find(function(n){return n.id===a})))})})}}(r||(r={}))},2129:function(n,t,e){"use strict";e.d(t,"a",function(){return Un});var r,i=e(0),o=e.n(i),a=e(319),c=e.n(a),u=e(2133),s=e(2139),f=e(2107),l=e(2123),d=e(2192),h=e(3036),v=e(3037),b=e.n(v),g=e(3038),p=e.n(g),m=e(3039),y=e.n(m),O=e(3040),j=e.n(O),x=e(3041),w=e.n(x),C=e(3042),M=e.n(C),N=e(3043),I=e.n(N),S=e(3044),D=e.n(S),k=e(3045),z=e.n(k),L=e(3046),T=e.n(L),A=e(3047),E=e.n(A),B=e(3048),R=e.n(B),Q=e(3049),Z=e.n(Q),P=e(3050),G=e.n(P),H=e(3051),F=e.n(H),Y=e(3052),V=e.n(Y),_=e(3053),U=e.n(_),W=e(3054),J=e.n(W),X=e(3055),K=e.n(X),$=e(3056),q=e.n($),nn=e(3057),tn=e.n(nn),en=e(3058),rn=e.n(en),on=e(3059),an=e.n(on),cn=e(3060),un=e.n(cn),sn=e(3061),fn=e.n(sn),ln=e(3062),dn=e.n(ln),hn=e(3063),vn=e.n(hn),bn=this&&this.__assign||function(){return(bn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},gn=function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.LineChart})},pn=function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.BarChart})},mn=function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.PieChart})},yn=function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.ScatterChart})},On={type:s.a.ChartType.line,name:function(){return o()("折线图")},icon:vn.a,load:gn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0},suggestion:{match:function(n){var t=n[0];if(t){var e=f.a.Series.getDataItemsCount(t),r=t.value.dataRange.filter(function(n){return"empty"!==n.type}).pop();return e>10&&r&&"number"===r.type?{}:void 0}}}},jn={type:s.a.ChartType.lineStacked,name:function(){return o()("堆积折线图")},icon:U.a,load:gn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isValueStacked:!0}},xn={type:s.a.ChartType.lineStacked100,name:function(){return o()("% 堆积折线图")},icon:J.a,load:gn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isValueStacked:!0,isValuePercent:!0}},wn={type:s.a.ChartType.lineMarkers,name:function(){return o()("带标记的折线图")},icon:K.a,load:gn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0}},Cn={type:s.a.ChartType.lineMarkersStacked,name:function(){return o()("带标记的堆积折线图")},icon:q.a,load:gn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isValueStacked:!0}},Mn={type:s.a.ChartType.lineStacked100,name:function(){return o()("带标记的 % 堆积折线图")},icon:tn.a,load:gn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isValueStacked:!0,isValuePercent:!0}},Nn={type:s.a.ChartType.area,name:function(){return o()("面积图")},icon:dn.a,load:gn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0}},In={type:s.a.ChartType.areaStacked,name:function(){return o()("堆积面积图")},icon:an.a,load:gn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isValueStacked:!0}},Sn={type:s.a.ChartType.areaStacked100,name:function(){return o()("% 堆积面积图")},icon:un.a,load:gn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isValueStacked:!0,isValuePercent:!0}},Dn={type:s.a.ChartType.barClustered,name:function(){return o()("条形图")},icon:G.a,load:pn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isBarLike:!0,isAxisInverted:!0,supportSummaryCount:!0}},kn={type:s.a.ChartType.barStacked,name:function(){return o()("堆积条形图")},icon:F.a,load:pn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isBarLike:!0,isValueStacked:!0,isAxisInverted:!0,supportSummaryCount:!0}},zn={type:s.a.ChartType.barStacked100,name:function(){return o()("% 堆积条形图")},icon:V.a,load:pn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isBarLike:!0,isValueStacked:!0,isValuePercent:!0,isAxisInverted:!0,supportSummaryCount:!0}},Ln={type:s.a.ChartType.columnClustered,name:function(){return o()("柱形图")},icon:M.a,load:pn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isBarLike:!0,isRectangular:!0,supportSummaryCount:!0},suggestion:{match:function(n){var t=n[n.length-1];if(t){var e=t.value.dataRange.filter(function(n){return"empty"!==n.type}).pop();return e&&"text"===e.type?{summaryCount:!0}:void 0}}}},Tn={type:s.a.ChartType.columnStacked,name:function(){return o()("堆积柱形图")},icon:D.a,load:pn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isBarLike:!0,isRectangular:!0,isValueStacked:!0,supportSummaryCount:!0}},An={type:s.a.ChartType.columnStacked100,name:function(){return o()("% 堆积柱形图")},icon:E.a,load:pn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isBarLike:!0,isRectangular:!0,isValueStacked:!0,isValuePercent:!0,supportSummaryCount:!0}},En={type:s.a.ChartType.pie,name:function(){return o()("饼图")},icon:p.a,load:mn,defaultSettings:{dataLabels:!0},attributes:{isValuePercent:!0,isSingleSeries:!0,useSectorColor:!0,supportSummaryCount:!0}},Bn={type:s.a.ChartType.doughnut,name:function(){return o()("环形图")},icon:rn.a,load:mn,defaultSettings:{dataLabels:!0},attributes:{isValuePercent:!0,useSectorColor:!0,supportSummaryCount:!0}},Rn={type:s.a.ChartType.xyScatter,name:function(){return o()("散点图")},icon:b.a,load:yn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isXyValueAxis:!0}},Qn={type:s.a.ChartType.bubble,name:function(){return o()("气泡图")},icon:j.a,load:yn,defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isXyValueAxis:!0}},Zn={type:s.a.ChartType.stockOHLC,name:function(){return o()("股价图")},icon:fn.a,load:function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.CandlestickChart})},defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isBarLike:!0,hideLegend:!0}},Pn={type:s.a.ChartType.chinaMap,name:function(){return o()("省份地图")},icon:y.a,load:function(){return Promise.all([e.e(30).then(e.bind(null,2122)),e.e(34).then(e.bind(null,3233))]).then(function(n){var t=n[0],e=n[1];return t.ChinaMapChart.setup(e),t.ChinaMapChart})},defaultSettings:{dataLabels:!0},attributes:{hideLegend:!0,isColorMonochrome:!0,isSingleSeries:!0}},Gn={type:s.a.ChartType.funnel,name:function(){return o()("漏斗图")},icon:w.a,load:function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.FunnelChart})},defaultSettings:{dataLabels:!0},attributes:{isSingleSeries:!0,useSectorColor:!0}},Hn={type:s.a.ChartType.sunburst,name:function(){return o()("旭日图")},icon:I.a,load:function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.SunburstChart})},defaultSettings:{dataLabels:!0},attributes:{isSingleSeries:!0,useSectorColor:!0,getSectors:function(n,t,e){var r=c()(Object(l.a)(f.a.Series.getCategoryLabels(n,e).map(function(n){return n[0]?n[0].text:""})));return r.map(function(e,i){return{label:e,color:"sectorColors"in n&&n.sectorColors[i]||u.a.getColorFromTheme(t,i,r.length)}})}},suggestion:{match:function(n){if(1===n.length&&n.every(function(n){var t=n.value.categoryLabelItems[0];return t&&t.length>=2}))return{}}}},Fn={type:s.a.ChartType.gauge,name:function(){return o()("仪表盘")},icon:z.a,load:function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.GaugeChart})},defaultSettings:{dataLabels:!0},attributes:{hideLegend:!0,isSingleSeries:!0,useSectorColor:!0,getSectors:function(n,t,e){var r=f.a.Series.getCategoryLabelText(n,e);return[{label:r[0]||"1",color:"sectorColors"in n&&n.sectorColors[0]||u.a.getColorFromTheme(t,0,r.length)}]}}},Yn={type:s.a.ChartType.histogram,name:function(){return o()("直方图")},icon:R.a,load:function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.HistogramChart})},defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isBarLike:!0,isValueStacked:!0,isSingleSeries:!0}},Vn={type:s.a.ChartType.waterfall,name:function(){return o()("瀑布图")},icon:Z.a,load:function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.WaterfallChart})},defaultSettings:{dataLabels:!1},attributes:{isRectangular:!0,isBarLike:!0,isValueStacked:!0,isSingleSeries:!0,useSectorColor:!0,getSectors:function(n,t,e){return[{label:o()("正值"),color:"sectorColors"in n&&n.sectorColors[0]||u.a.getColorFromTheme(t,0,8)},{label:o()("负值"),color:"sectorColors"in n&&n.sectorColors[1]||u.a.getColorFromTheme(t,1,8)}]}}},_n={type:s.a.ChartType.gantt,name:function(){return o()("甘特图")},icon:T.a,load:function(){return e.e(30).then(e.bind(null,2122)).then(function(n){return n.GanttChart})},defaultSettings:{dataLabels:!1},attributes:{useSeriesColor:!0,isRectangular:!0,isBarLike:!0,isAxisInverted:!0,xAxisPosition:"top",isValueStacked:!0,hideLegend:!0},suggestion:{match:function(n){if(2===n.length&&n.every(function(n){var t=n.value.dataRange.filter(function(n){return"empty"!==n.type}).pop();return t&&"date"===t.type}))return{}}}},Un=Object(d.a)(((r={})[s.a.ChartType.line]=On,r[s.a.ChartType.lineStacked]=jn,r[s.a.ChartType.lineStacked100]=xn,r[s.a.ChartType.lineMarkers]=wn,r[s.a.ChartType.lineMarkersStacked]=Cn,r[s.a.ChartType.lineMarkersStacked100]=Mn,r[s.a.ChartType.area]=Nn,r[s.a.ChartType.areaStacked]=In,r[s.a.ChartType.areaStacked100]=Sn,r[s.a.ChartType.columnClustered]=Ln,r[s.a.ChartType.columnStacked]=Tn,r[s.a.ChartType.columnStacked100]=An,r[s.a.ChartType.barClustered]=Dn,r[s.a.ChartType.barStacked]=kn,r[s.a.ChartType.barStacked100]=zn,r[s.a.ChartType.pie]=En,r[s.a.ChartType.doughnut]=Bn,r[s.a.ChartType.xyScatter]=Rn,r[s.a.ChartType.bubble]=Qn,r[s.a.ChartType.stockOHLC]=Zn,r[s.a.ChartType.chinaMap]=Pn,r[s.a.ChartType.funnel]=Gn,r[s.a.ChartType.sunburst]=Hn,r[s.a.ChartType.gauge]=Fn,r[s.a.ChartType.histogram]=Yn,r[s.a.ChartType.waterfall]=Vn,r[s.a.ChartType.gantt]=_n,r),function(n){return bn(bn({},n),{attributes:Object(d.a)(h.a,function(t,e){return null==n.attributes[e]?t:n.attributes[e]})})})},2133:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(2137),o=e(2123),a=e(2144),c=e(2230),u=e(2167),s=e(2138);!function(n){var t=function(n){return("00"+n).slice(-2)};n.atPosition=function(n,t,e,r){return r<=1?n:Math.floor(n+(t-n)*Object(c.a)(0,e/(r-1),1))},n.isSameColor=function(t,e){var r="string"==typeof t?n.parse(t):t,i="string"==typeof e?n.parse(e):e;return Boolean(r&&i&&Object(s.a)(r,i))},n.parse=function(n){return/^#/i.test(n)?e(n):/^rgba?/i.test(n)?r(n):e("#"+n)},n.parseMulti=function(t){return Object(o.a)(t.split(",").map(n.parse))};var e=function(n){var t=n.replace(/^#/i,"");if(/^\w{6,8}$/.test(t)){var e=[t.slice(0,2),t.slice(2,4),t.slice(4,6),t.slice(6,8)].map(function(n){return null==n?n:""!==n?Number.parseInt(n,16):void 0}),r=e[0],i=e[1],o=e[2],a=e[3];return[r,i,o].every(function(n){return"number"==typeof n&&n==n})?{r:r,g:i,b:o,a:a}:void 0}},r=function(n){if(/^rgba?/i.test(n)){var t=n.replace(/^rgba?/i,"").slice(1,-1).split(/, ?/).map(function(n){return Number(n)});return{r:t[0],g:t[1],b:t[2],a:t[3]}}};n.toHex=function(e){if("string"==typeof e){var r=n.parse(e);return r?n.toHex(r):""}var i=e.r,o=e.g,a=e.b,c=e.a;return"#"+[i,o,a].map(function(n){return t(Math.round(Number(n)).toString(16))}).join("").toUpperCase()+(null==c?"":t(Math.round(255*Number(c)).toString(16)).toUpperCase())},n.mix=function(t){var e=Object(u.a)(t.map(function(n){return n.ratio}));if(0===e)return"#000000";var r=t.reduce(function(t,r){var i=t.r,o=t.g,a=t.b,c="string"==typeof r.color?n.parse(r.color)||{r:0,g:0,b:0}:r.color;return{r:i+=c.r*(r.ratio/e),g:o+=c.g*(r.ratio/e),b:a+=c.b*(r.ratio/e)}},{r:0,g:0,b:0}),i=r.r,o=r.g,a=r.b;return n.toHex({r:i,g:o,b:a})},n.BLACK="#000000",n.WHITE="#ffffff",n.MULTICOLOR_COLORS=[["#739DE3","#85C1C8","#C8C77E","#F5C855","#F39354","#E16C64","#5675AA","#639095","#95955E","#B7953F","#B66E3E","#A8504A","#ABC4EE","#B6DADE","#DEDDB2","#F9DE99","#F8BE98","#EDA7A2"],["#90A7C3","#DBC297","#94A48B","#BB7679","#B291BE","#E09F6B","#6B7D92","#A49171","#6E7A68","#8C585A","#856C8E","#A77750","#BCCADB","#E9DAC0","#BFC8B9","#D6ADAF","#D1BDD8","#ECC5A6"],["#FF9792","#FFDA70","#B6D09D","#73D0EC","#D0B7DE","#A4BAC4","#BF716D","#BFA353","#889B75","#569BB0","#9B89A6","#7A8B92","#FFC1BE","#FFE9A9","#D3E3C4","#ABE3F4","#E3D4EB","#C8D6DB"],["#56B0DB","#0057A0","#A19385","#94D7A6","#FFCA82","#CC6644","#4083A4","#004177","#786E63","#6EA17C","#BF9761","#984C32","#9AD0E9","#669AC6","#C7BEB6","#BFE7CA","#FFDFB4","#E0A38F"]];var f=[["RGB(92, 139, 217)","RGB(222, 232, 247)"],["RGB(111, 189, 198)","RGB(226, 242, 244)"],["RGB(167, 184, 82)","RGB(237, 241, 220)"],["RGB(245, 190, 30)","RGB(253, 242, 210)"],["RGB(220, 110, 110)","RGB(248, 226, 226)"],["RGB(103, 107, 111)","RGB(225, 225, 226)"]];n.MONOCHROME_COLORS=f.map(function(t){return Object(o.a)(t.map(n.parse)).map(n.toHex)}),n.inferColorTheme=function(t){if(t.length){var e=(t=t.map(function(n){return n.toUpperCase()}))[0].toUpperCase(),r=t[t.length-1].toUpperCase(),i=n.MONOCHROME_COLORS.find(function(n,t){var i=f[t];return n.includes(e)||n.includes(r)||i.includes(e)||i.includes(r)});if(i)return{type:"monochrome",colors:i};var o=n.MULTICOLOR_COLORS.map(function(n){return{matchCount:n.filter(function(n){return t.includes(n)}).length,colors:n}}).sort(function(n,t){return t.matchCount-n.matchCount})[0];return o.matchCount>0?{type:"multicolor",colors:o.colors}:void 0}},n.getColorFromTheme=function(t,e,r){switch(t.type){case"monochrome":var i=t.colors.map(n.parse),o=i[0],c=i[1],u=["r","g","b"].map(function(t){return n.atPosition(o[t],c[t],e,Math.max(3,r))}),s=u[0],f=u[1],l=u[2];return n.toHex({r:s,g:f,b:l});case"multicolor":var d=t.colors.length;return t.colors[e%d];default:return Object(a.b)(t)}},n.getColorsFromTheme=function(t,e){return Object(i.a)(e).map(function(r){return n.getColorFromTheme(t,r,e)})},n.isSameColorTheme=function(n,t){return Object(s.a)(n,t)}}(r||(r={}))},2134:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(2123),o=e(2334),a=e(2433),c=e(2193),u=e(2138),s=e(2118),f=this&&this.__assign||function(){return(f=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},l=" *:[]?\\/%'\"()|{}#@!;$^（）:,+-^=<>&".split("");!function(n){n.generateRefId=function(){return Object(c.a)()},n.appendRefId=function(t){return f(f({},t),{id:"id"in t?t.id:n.generateRefId()})},n.compareReferenceRecord=function(n,t){return n.key<t.key?-1:n.key>t.key?1:0},n.isReferenceEqual=function(n,t){return Object(u.a)(n,t)},n.isReferenceEmpty=function(n){return n.range.rowCount<=0||n.range.colCount<=0},n.parseRange=function(n){var t=n.split(":").map(function(n){return n.split("$").join("")}),e=t[0],r=t[1],i=[e,void 0===r?e:r].map(function(n){return Object(a.a)(n)}),o=i[0],c=i[1];if(o&&c)return{row:o.row,col:o.column,rowCount:c.row-o.row+1,colCount:c.column-o.column+1}};var t=function(e,r,i){var o=/^(((?:(?:[^',!]|(?:''))+)|(?:'(?:(?:[^']|(?:''))+)'))!)?(\$?[a-zA-Z]+\$?\d+(?::\$?[a-zA-Z]+\$?\d+)?)/gi.exec(e);if(o){var a=o[0],c=function(t,e){if(-1===t.indexOf("#REF")){var r=t.lastIndexOf("!");if(-1===r){var i=n.parseRange(t);return i&&{sheetName:e&&e.sheetName||"",range:i}}var o=t.substr(0,r),a=t.substr(r+1);if(o&&a){o.startsWith("'")&&o.endsWith("'")&&(o=o.slice(1,-1)),o=o.replace(/''/gi,"'");var c=n.parseRange(a);if(c)return{sheetName:o,range:c}}}}(a,i);if(null!=c){var u=a.length,s=r.concat(c);return e.length>u?","===e[u]?t(e.substr(u+1),s,i):void 0:s}}};n.parse=function(n,e){if(n&&"string"==typeof n){n.startsWith("(")&&n.endsWith(")")&&(n=n.slice(1,-1));var r=t(n,[],e);return!r||r.some(function(n){return null==n})?void s.b:r}},n.parseWatchFormula=function(t){var e=/^([\w_-]+)\(['"'](.+)['"'], *(.+)\)$/gi.exec(t);if(e){e[0],e[1];var r=e[2],i=e[3];if(r&&i){var o=r;if("#REF!"===i)return{key:o,reference:void 0};var a=n.parse(i);if(a)return{key:o,reference:a[0]}}}},n.stringify=function(n,t){if(n){var e=Object(i.a)([].concat(n)),r=(t||{}).parentheses,c=void 0===r||r,u=e.map(function(n){var t=n.sheetName,e=n.range,r=e.row,i=e.col,c=e.rowCount,u=e.colCount,s=Object(a.b)(r,i),f=Object(a.b)(r+c-1,i+u-1),d=Object(o.a)([s,f]).join(":");return(l.some(function(n){return t.includes(n)})||/(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])/gi.test(t)||""===t)&&(t="'"+t.replace(/'/gi,"''")+"'"),t+"!"+d}).join(",");return e.length>1&&c?"("+u+")":u}}}(r||(r={}))},2137:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n){if(n<0)throw new Error("size should >= 0");for(var t=[],e=0;e<n;e++)t.push(e);return t}},2138:function(n,t,e){"use strict";e.d(t,"a",function(){return i});var r=e(43),i=e.n(r).a},2139:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(2133);!function(n){var t;!function(n){n[n.pie=10]="pie",n[n.doughnut=3]="doughnut",n[n.chinaMap=101]="chinaMap",n[n.funnel=111]="funnel",n[n.sunburst=121]="sunburst",n[n.gauge=131]="gauge",n[n.gantt=132]="gantt",n[n.columnClustered=12]="columnClustered",n[n.columnStacked=13]="columnStacked",n[n.columnStacked100=14]="columnStacked100",n[n.barClustered=18]="barClustered",n[n.barStacked=19]="barStacked",n[n.barStacked100=20]="barStacked100",n[n.line=9]="line",n[n.lineStacked=24]="lineStacked",n[n.lineStacked100=25]="lineStacked100",n[n.lineMarkers=26]="lineMarkers",n[n.lineMarkersStacked=27]="lineMarkersStacked",n[n.lineMarkersStacked100=28]="lineMarkersStacked100",n[n.area=8]="area",n[n.areaStacked=37]="areaStacked",n[n.areaStacked100=38]="areaStacked100",n[n.stockOHLC=50]="stockOHLC",n[n.xyScatter=1]="xyScatter",n[n.bubble=11]="bubble",n[n.histogram=141]="histogram",n[n.waterfall=142]="waterfall"}(t=n.ChartType||(n.ChartType={})),n.getChartName=function(n){for(var e in t){if(t.hasOwnProperty(e))if(t[e]===n)return e}return""},n.CHART_TYPES=[t.columnClustered,t.columnStacked,t.columnStacked100,t.barClustered,t.barStacked,t.barStacked100,t.line,t.lineStacked,t.lineStacked100,t.lineMarkers,t.lineMarkersStacked,t.lineMarkersStacked100,t.area,t.areaStacked,t.areaStacked100,t.pie,t.doughnut,t.xyScatter,t.bubble,t.stockOHLC,t.chinaMap,t.funnel,t.sunburst,t.gauge,t.histogram,t.waterfall,t.gantt],n.defaultOrientation="horizonal",n.defaultColorTheme={type:"multicolor",colors:i.a.MULTICOLOR_COLORS[0]},n.defaultColorThemeMonochrome={type:"monochrome",colors:i.a.MONOCHROME_COLORS[0]},n.defaultWidth=572,n.defaultHeight=394,n.defaultChartType=function(e){return e&&n.CHART_TYPES.includes(e)?e:t.columnClustered},n.defaultAxisGroup=0,n.defaultChartAxes=function(){return{primaryCategory:{majorGridLine:{visible:!1},title:{text:""}},primaryValue:{majorGridLine:{visible:!0},title:{text:""}}}},n.suggestionPriorities=[n.ChartType.barClustered,n.ChartType.gantt,n.ChartType.sunburst,n.ChartType.line]}(r||(r={}))},2140:function(n,t,e){"use strict";e.d(t,"a",function(){return s}),e.d(t,"b",function(){return f}),e.d(t,"c",function(){return l});var r=e(2335),i=e(2118),o=e(245),a=e.n(o),c=this&&this.__spreadArrays||function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),i=0;for(t=0;t<e;t++)for(var o=arguments[t],a=0,c=o.length;a<c;a++,i++)r[i]=o[a];return r},u=function(){},s=function(n){return i.b?a()(n):u},f=function(n,t,e){if(!i.b)return t;var o=s(n);return Object(r.a)({onCalled:function(n){o.apply(void 0,n)},onReturned:function(n){o(n)},onError:function(n){if(o(" <ERROR> "),i.b)debugger},self:e})(t)},l=function(n,t,e,o){if(void 0===e&&(e=!1),void 0===o&&(o=[]),!i.b)return n;var a={},u=function(n){return a[n]||(a[n]=s(t+":"+n)),a[n]},f=Object(r.b)(n,{onCalled:function(n,t){if(!o.includes(t))if(Object(i.c)(i.a["debug-with-stack"])){var e=function(n){try{throw new Error("FAKE_ERROR")}catch(t){return t.stack.split("\n").slice(n).map(function(n){return n.replace(/^\s*at\s*/,"")}).join("\n")}}(4);u(t).apply(void 0,c(n,[e]))}else u(t).apply(void 0,n)},onReturned:function(n,t,e){},onError:function(n,t,r){if(u(r)(" <ERROR> "),e)debugger}});if("undefined"!=typeof window){var l=window;l.logged||(l.logged={}),l.logged[t]=n}return f}},2141:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n,t){if("object"!=typeof n||null==n||"object"!=typeof t||null==t)return n||t;for(var e=0,i=Object.entries(t);e<i.length;e++){var o=i[e],a=o[0],c=o[1];void 0!==c&&(Array.isArray(c)?n[a]=c:"object"==typeof c&&null!=c?(null==n[a]&&(n[a]={}),r(n[a],c)):n[a]=c)}return n}},2144:function(n,t,e){"use strict";e.d(t,"b",function(){return i}),e.d(t,"a",function(){return o}),e.d(t,"c",function(){return a});var r=e(2118),i=function(n){throw new TypeError("Unexpected type:"+JSON.stringify(n))},o=function(n,t){if(!n)throw new Error(t)},a=function(n){r.b}},2157:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n){var t=[];return n.forEach(function(n){return t.push(n)}),t}},2167:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n){return n.reduce(function(n,t){return n+t},0)}},2168:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n){var t;return(t=[]).concat.apply(t,n)}},2192:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n,t){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=t(n[r],r));return e}},2193:function(n,t,e){"use strict";e.d(t,"a",function(){return a});var r=e(2137),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=i.length,a=function(n){return void 0===n&&(n=8),Object(r.a)(n).map(function(n){return i[Math.floor(Math.random()*o)]}).join("")}},2194:function(n,t,e){"use strict";e.d(t,"a",function(){return a});var r=e(809),i=e(90),o=e.n(i),a=e(2118).d?function(n,t){var e=o()(n);return t(e),e}:r.a},2195:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n,t,e){var r=e.needUpdate,i=e.add,o=e.remove,a=void 0===o?function(){return null}:o,c=e.update,u=void 0===c?function(n,t){var e=a(n);return e||i(t)}:c,s=e.keep,f=void 0===s?function(n){return n}:s,l=e.getKeyA,d=e.getKeyB,h=new Map;n.forEach(function(n){h.set(l(n),n)});var v=new Map;t.forEach(function(n){v.set(d(n),n)});var b=[];return h.forEach(function(n,t){var e=v.get(t);e&&(r(n,e)?b.push(u(n,e)):b.push(f(n,e)),h.delete(t),v.delete(t))}),h.forEach(function(n){b.push(a(n))}),v.forEach(function(n){b.push(i(n))}),b.filter(function(n){return null!==n})}},2230:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n,t,e){return Math.max(n,Math.min(e,t))}},2231:function(n,t,e){"use strict";e.d(t,"i",function(){return u}),e.d(t,"e",function(){return s}),e.d(t,"h",function(){return l}),e.d(t,"g",function(){return h}),e.d(t,"b",function(){return v}),e.d(t,"c",function(){return b}),e.d(t,"f",function(){return g}),e.d(t,"d",function(){return p}),e.d(t,"j",function(){return m}),e.d(t,"a",function(){return y});var r=e(2138),i=e(2168),o=e(2192),a=this&&this.__assign||function(){return(a=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},c=this&&this.__spreadArrays||function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),i=0;for(t=0;t<e;t++)for(var o=arguments[t],a=0,c=o.length;a<c;a++,i++)r[i]=o[a];return r},u=function(n){if(n.length<2)return!1;for(var t=0;t<n.length-1;t++)for(var e=t+1;e<n.length;e++){var r=n[t],i=n[e];if(d(r,i))return!0}return!1},s=function(n){if(0!==n.length){var t=Math.min.apply(Math,n.map(function(n){return n.row})),e=Math.max.apply(Math,n.map(function(n){return n.row+n.rowCount-1})),r=Math.min.apply(Math,n.map(function(n){return n.col}));return{row:t,col:r,rowCount:e-t+1,colCount:Math.max.apply(Math,n.map(function(n){return n.col+n.colCount-1}))-r+1}}},f=function(n,t){if(n.colCount===t.colCount&&n.col===t.col){var e=n.row+n.rowCount-1,r=t.row+t.rowCount-1;if(i=n.row===r+1?"top":t.row===e+1?"bottom":void 0)return{direction:i,range:{row:Math.min(n.row,t.row),col:n.col,colCount:n.colCount,rowCount:n.rowCount+t.rowCount}}}if(n.rowCount===t.rowCount&&n.row===t.row){var i,o=n.col+n.colCount-1,a=t.col+t.colCount-1;if(i=n.col===a+1?"left":t.col===o+1?"right":void 0)return{direction:i,range:{col:Math.min(n.col,t.col),row:n.row,rowCount:n.rowCount,colCount:n.colCount+t.colCount}}}},l=function(n,t){var e=Math.max(n.row,t.row),r=Math.min(n.row+n.rowCount-1,t.row+t.rowCount-1),i=Math.max(n.col,t.col),o=r-e+1,a=Math.min(n.col+n.colCount-1,t.col+t.colCount-1)-i+1;return e>=0&&i>=0&&o>0&&a>0?{row:e,rowCount:o,col:i,colCount:a}:void 0},d=function(n,t){var e=Math.max(n.row,t.row),r=Math.min(n.row+n.rowCount-1,t.row+t.rowCount-1),i=Math.max(n.col,t.col),o=Math.min(n.col+n.colCount-1,t.col+t.colCount-1);return e>=0&&i>=0&&r-e+1>0&&o-i+1>0},h=function(n){var t,e=n[0],r=n.slice(1);if(!r.length)return e&&{range:e,direction:void 0};for(var i=0;i<r.length;i++){var o=r[i],a=f(e,o);if(!a)return;if(t&&t!==a.direction)return;t=a.direction,e=a.range}return e&&{range:e,direction:t}},v=function(n,t){return n.row-t.row||n.col-t.col},b=function(n,t){return Object(r.a)(l(n,t),t)},g=function(n){var t=[];return n.forEach(function(n){var e=t.filter(function(t){return t.some(function(t){return!function(n,t){var e=n.row+n.rowCount-1,r=n.col+n.colCount-1,i=t.row+t.rowCount-1,o=t.col+t.colCount-1;return n.row>i+1||t.row>e+1||n.col>o+1||t.col>r+1||i===n.row-1&&t.col===r+1||e===t.row-1&&n.col===o+1||i===n.row-1&&o===n.col-1||e===t.row-1&&r===t.col-1}(t,n)})}),r=c(Object(i.a)(e),[n]);t=c(t.filter(function(n){return!e.includes(n)}),[r])}),t},p=function(n){return Object(o.a)(n,function(n){return-n})},m=function(n,t){var e=n.row,r=n.col;return a(a({},n),{row:e+t.row,col:r+t.col})},y=function(n){for(var t=n.slice(),e=function(){var n;if(t.some(function(e){return t.some(function(t){if(e===t)return!1;var r=h([e,t]);return!!r&&(n={a:e,b:t,ab:r.range},!0)})}),!n)return"break";var e=n.a,r=n.b,i=n.ab;(t=t.filter(function(n){return n!==e&&n!==r})).push(i)};;){if("break"===e())break}return t}},2334:function(n,t,e){"use strict";t.a=function(n,t){return Object.values(Object(r.a)(n,t))};var r=e(3031)},2335:function(n,t,e){"use strict";t.a=o,t.b=function(n,t){for(var e in n){var i=n[e];if("constructor"!==e&&"function"==typeof i){var a=o(r(r({},t),{self:n,fnName:e}));n[e]=a(i)}}return n};var r=this&&this.__assign||function(){return(r=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},i=function(n){return"function"==typeof(n&&n.then)};function o(n){var t=n.onCalled,e=n.onReturned,r=n.onError,o=n.fnName,a=n.self,c=void 0===a?null:a;return function(n){return function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];t&&t(a,o||n.name);try{var s=n.apply(c,a);return i(s)?s.then(function(t){return e&&e(t,a,o||n.name),t},function(t){var e=!0;if(r&&r(t,a,o||n.name,function(){e=!1}),e)throw t}):(e&&e(s,a,o||n.name),s)}catch(t){var f=!0;if(r&&r(t,a,o||n.name,function(){f=!1}),f)throw t;return}}}}},2352:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=n[0];return t.forEach(function(t,e){r+=t,r+=n[e+1]}),r}},2360:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(){var n={};return{on:function(t,e){n[t]||(n[t]=[]),n[t].includes(e)||n[t].push(e)},off:function(t,e){n[t]&&(n[t]=n[t].filter(function(n){return n!==e}))},emit:function(t,e){n[t]&&n[t].forEach(function(n){n(e)})},removeAllListeners:function(){n={}}}}},2361:function(n,t,e){"use strict";e.d(t,"c",function(){return s}),e.d(t,"d",function(){return f}),e.d(t,"a",function(){return l}),e.d(t,"b",function(){return d});var r=e(1),i=e.n(r),o=e(3265),a=(e.n(o),e(2193)),c=this&&this.__assign||function(){return(c=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},u=this&&this.__rest||function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e},s=function(n){var t=n.label,e=n.error,o=n.inline,s=n.children,h=u(n,["label","error","inline","children"]),v=Object(r.useState)(function(){return Object(a.a)(8)})[0];return i.a.createElement("div",{className:"chart-input-field "+(o?"is-inline":"")},s||i.a.createElement(i.a.Fragment,null,t?i.a.createElement(f,{htmlFor:"input-"+v,label:t}):null,i.a.createElement(l,c({id:"input-"+v},h)),e?i.a.createElement(d,{error:e}):null))},f=function(n){var t=n.label,e=u(n,["label"]);return i.a.createElement("label",c({className:"chart-label"},e),t)},l=function(n){var t=n.onCommit,e=u(n,["onCommit"]),o=Object(r.useRef)(null),a=function(){o&&o.current&&(o.current.value=null==e.defaultValue?"":String(e.defaultValue))};return Object(r.useEffect)(a,[e.defaultValue||""]),i.a.createElement("input",c({ref:o,className:"chart-input",key:"string"==typeof e.defaultValue?e.defaultValue:void 0,type:"text"},e,{onKeyPress:function(n){"Enter"===n.key&&(t&&!1===t(n.target.value)&&a());e.onKeyPress&&e.onKeyPress(n)},onBlur:function(n){t&&(!1===t(n.target.value)&&a());e.onBlur&&e.onBlur(n)}}))},d=function(n){var t=n.error;return i.a.createElement("div",{className:"chart-error"},t)}},2362:function(n,t,e){"use strict";e.d(t,"b",function(){return s}),e.d(t,"a",function(){return f});var r=e(0),i=e.n(r),o=e(1),a=e.n(o),c=e(3270),u=(e.n(c),this&&this.__assign||function(){return(u=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)}),s=function(n){var t=n.showSelectedIcon,e=n.onChange,r=n.children,c=Object(o.useState)(!1),s=c[0],l=c[1],d=Object(o.useRef)(null);Object(o.useEffect)(function(){var n=function(n){n&&n.target&&s&&d.current&&(n.target===d.current||d.current.contains(n.target)||l(!1))};return s?document.addEventListener("click",n):document.removeEventListener("click",n),function(){document.removeEventListener("click",n)}},[s]);var h=a.a.Children.toArray(r),v=a.a.Children.map(r,function(n){var t=n&&n.props&&n.props.children;return"function"==typeof t?u(u({},n),{props:u(u({},n.props),{children:t({role:"option"})})}):n}),b=h.find(function(n){return n&&n.props&&n.props.selected}),g=b&&b.props.children;return a.a.createElement("div",{className:"chart-select "+(s?"is-active":"")+" "+(t?"show-checkmark":""),ref:d},a.a.createElement("div",{className:"current-option f-v-center",onClick:function(){l(!s)}},a.a.createElement("div",{className:"current-option-content f-1"},g?"function"==typeof b.props.children?b.props.children({role:"selected"}):b.props.children:i()("请选择")),a.a.createElement("div",{className:"icon-dropdown"})),s&&a.a.createElement("div",{className:"option-list",onClick:function(n){var t=function(n,t,e){for(var r=n;r&&r!==t;){if(e(r))return r;r=r.parentElement}}(n&&n.target,d.current,function(n){return n.classList.contains("chart-select-option")});t&&null!=t.dataset.value&&"true"!==t.dataset.disabled&&(e(t.dataset.value),l(!1))}},v&&v.length?v:a.a.createElement(f,{value:"empty",disabled:!0,selected:!1},a.a.createElement("div",{className:"option-empty"},i()("没有选项")))))},f=function(n){var t=n.value,e=n.disabled,r=n.selected,i=n.children;return a.a.createElement("div",{className:"chart-select-option f-v-center","data-value":t,"data-selected":r,"data-disabled":e},i)}},2430:function(n,t,e){"use strict";e.d(t,"b",function(){return r}),e.d(t,"c",function(){return i}),e.d(t,"a",function(){return o});var r=JSON.parse,i=JSON.stringify,o=function(n){return r(i(n))}},2431:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n,t){var e={};for(var r in n)n.hasOwnProperty(r)&&t(n[r],r)&&(e[r]=n[r]);return e}},2432:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(2129),o=e(2123),a=e(2168),c=e(3033),u=e(2195),s=e(2193),f=e(2138),l=e(2141),d=e(3034),h=e(2430),v=e(3035),b=e(2133),g=e(2139),p=e(2124),m=e(2134),y=this&&this.__assign||function(){return(y=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)};!function(n){n.DELETE=null,n.toSeriesTuple=function(n){var t,e=n.seriesLabel,r=n.categoryLabel,o=n.dataRange,a=n.size,c=n.seriesType,u=n.axisGroup,s=n.color,f=n.sectorColors;return t=i.a[c].attributes.useSectorColor?f.join(","):s,[m.a.stringify(e),m.a.stringify(r),m.a.stringify(o),m.a.stringify(a),c,u,t]};n.toSeriesObjects=function(n){var t,e,r=n[0],o=n[1],a=n[2],u=n[3],f=n[4],l=n[5],d=n[6],h=m.a.appendRefId,v=function(n){var t=b.a.parse(n);if(!t)return"";var e=t.r,r=t.g,i=t.b;return b.a.toHex({r:e,g:r,b:i})};i.a[f].attributes.useSectorColor?(t=void 0,e=d?d.split(",").map(v):[]):(t=d?v(d):void 0,e=[]);var g=m.a.parse(r)||[],p=m.a.parse(o)||[],O=m.a.parse(u)||[],j=m.a.parse(a)||[],x={id:Object(s.a)(),seriesLabel:g.map(h),categoryLabel:p.map(h),dataRange:j.map(h),size:[],seriesType:f,axisGroup:l,color:t,sectorColors:e};if(O.length){var w=function(n,t){if(n.length===t.length&&n.length>0)return Object(c.a)(n,t).map(function(n){var t=n[0],e=n[1];if(t.sheetName===e.sheetName&&t.range.rowCount===e.range.rowCount&&t.range.colCount===e.range.colCount)return{row:e.range.row-t.range.row,col:e.range.col-t.range.col}}).reduce(function(n,t){if(n&&t&&n.row===t.row&&n.col===t.col)return t})}(j,O);return[x,{id:Object(s.a)(),seriesLabel:g.map(function(n){return w?function(n,t){var e=t.range,r=e.row,i=e.col;return{sheetName:t.sheetName,range:y(y({},t.range),{row:r+n.row,col:i+n.col})}}(w,n):n}).map(h),categoryLabel:p.map(h),dataRange:O.map(h),size:[],seriesType:f,axisGroup:l,color:t,sectorColors:e}]}return[x]},n.isChartAttrKey=function(n){return/^chart-\w+$/.test(n)},n.getChartAttrKey=function(n){return"chart-"+n},n.fromChartAttr=function(t,e,r){var i=t.split("-")[1],c=Object(h.b)(e),u=g.a.defaultChartType(c.chartType),s=Object(a.a)(c.series.map(n.toSeriesObjects)),f=c.colorTheme||b.a.inferColorTheme(Object(o.a)(s.map(function(n){return n.color})))||g.a.defaultColorTheme,d=c.relativePosition||[0,0,0,0,500,300],m={id:i,sheetId:r,position:{row:d[0],col:d[1],rowOffset:d[2],colOffset:d[3],width:d[4],height:d[5]},settings:y(y({},Object(v.a)(c,["position","relativePosition"])),{chartType:u,axes:Object(l.a)(g.a.defaultChartAxes(),c.axes||{}),colorTheme:f,summaryCount:"boolean"==typeof c.summaryCount&&c.summaryCount,plotVisibleDataOnly:"boolean"!=typeof c.plotVisibleDataOnly||c.plotVisibleDataOnly,series:s})},O=p.a.createSeries({seriesRefs:s,chartType:u,colorTheme:f,chartToInherit:m});return m.settings.series=O,m},n.fromSheetAttrs=function(t,e){return t=t||{},Object.keys(t).filter(n.isChartAttrKey).filter(function(n){return t[n]}).map(function(r){return n.fromChartAttr(r,t[r],e)})};n.toSheetAttrs=function(t){var e={};return t.forEach(function(t){var r=t.id,i=t.settings,o=t.position,a=n.getChartAttrKey(r),c=[o.row,o.col,o.rowOffset,o.colOffset,o.width,o.height],u=[];u=i.chartType===p.a.ChartType.bubble?function(t){if(0===t.length)return[];if(1===t.length)return[n.toSeriesTuple(t[0])];for(var e=[],r=0;r<t.length;r+=2){var i=t[r],o=t[r+1];if(i&&o){var a=n.toSeriesTuple(y(y({},i),{size:o.dataRange}));e.push(a)}}return e}(i.series):i.series.map(n.toSeriesTuple);var s=y(y({},i),{relativePosition:c,series:u});e[a]=Object(h.c)(s)}),e},n.getSheetsAttrs=function(n){for(var t=[],e=n.getIter();e.hasNext();){var r=e.next().getAttributes(),i=String(r.id);t.push({sheetId:i,attrs:r})}return t};n.createSheetAttrDiff=function(t,e){var r=Object.entries(t||{}),i=Object.entries(e||{}),o=Object(u.a)(r,i,{getKeyA:function(n){return n[0]},getKeyB:function(n){return n[0]},needUpdate:function(n,t){return e=n[1],r=t[1],!(null===e&&null===r||null!==e&&null!==r&&Object(f.a)(Object(h.b)(e),Object(h.b)(r)));var e,r},add:function(n){return n},remove:function(t){return[t[0],n.DELETE]},update:function(n,t){return t},keep:function(){return null}});return 0===o.length?void 0:Object(d.a)(o)},n.createChangeOperators=function(t,e,r){return Object(o.a)(t.map(function(t){var i=n.toSheetAttrs(p.a.getChartsBySheet(e,t)),o=n.toSheetAttrs(p.a.getChartsBySheet(r,t)),a=n.createSheetAttrDiff(i,o);if(a)return{fnName:"chart2Cs",params:[t,a]}}))}}(r||(r={}))},2433:function(n,t,e){"use strict";e.d(t,"c",function(){return r}),e.d(t,"b",function(){return i}),e.d(t,"a",function(){return o});var r=function(n){if(!(n>=0))throw new Error("Invalid column: "+n);for(var t=n+1,e="";t>0;){var r=(t-1)%26;e=String.fromCharCode(r+65)+e,t=Math.floor((t-r)/26)}return e},i=function(n,t){if(!(n>=0&&t>=0))throw new Error("Invalid cell position "+n+":"+t);for(var e=t+1,r="";e>0;){var i=(e-1)%26;r=String.fromCharCode(i+65)+r,e=Math.floor((e-i)/26)}return r+(n+1)},o=function(n){for(var t=0,e=0,r=0;r<n.length;r++){var i=n[r].charCodeAt(0);if(i>=65&&i<=90)e=26*e+i-64;else{if(!(i>=48&&i<=57))return;t=10*t+i-48}}return{row:t-1,column:e-1}}},2507:function(n,t,e){"use strict";e.d(t,"a",function(){return u}),e.d(t,"c",function(){return f}),e.d(t,"b",function(){return l});var r=e(2129),i=e(2139),o=e(3234),a=this&&this.__awaiter||function(n,t,e,r){return new(e||(e=Promise))(function(i,o){function a(n){try{u(r.next(n))}catch(n){o(n)}}function c(n){try{u(r.throw(n))}catch(n){o(n)}}function u(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e(function(n){n(t)})).then(a,c)}u((r=r.apply(n,t||[])).next())})},c=this&&this.__generator||function(n,t){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(n,a)}catch(n){o=[6,n],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},u=function(n,t){var e=r.a[n],i=r.a[t];return e.load===i.load},s=function(n){return a(void 0,void 0,Promise,function(){var t;return c(this,function(i){return(t=r.a[n])?[2,t.load()]:[2,e.e(33).then(e.bind(null,3235)).then(function(n){return n.DebugChart})]})})},f=Object(o.a)(s),l=function(){return a(void 0,void 0,void 0,function(){var n,t,r,o,a,u;return c(this,function(c){switch(c.label){case 0:return[4,e.e(30).then(e.bind(null,2122))];case 1:c.sent(),n=[],t=0,r=i.a.CHART_TYPES,c.label=2;case 2:return t<r.length?(o=r[t],a=[o],[4,s(o)]):[3,5];case 3:u=c.sent(),n.push({params:a,result:u}),c.label=4;case 4:return t++,[3,2];case 5:return f.fill(n),[2]}})})}},2508:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(2123),o=e(2144),a=e(2168);!function(n){n.UNION_SERIES_ID="UNI_SERIES",n.UNION_SERIES_REFERENCE_ID="UNI_SERIES_REF",n.generateReferenceKey=function(n,t){switch(t.type){case"series":return[n,t.type,t.seriesId,t.property,t.refId].join(":");default:return Object(o.b)(t.type)}},n.parseReferenceKey=function(n){var t=n.split(":"),e=t[0],r=t[1],i=t.slice(2);if(e&&r)switch(r){case"series":return{chartId:e,description:{type:"series",seriesId:i[0],property:i[1],refId:i[2]}};default:return}},n.createSeriesRefRecords=function(t,e){if(!e)return[];var r=e.seriesLabel,o=e.categoryLabel,c=e.dataRange,u=e.size;return Object(i.a)(Object(a.a)(Object.entries({seriesLabel:r,categoryLabel:o,dataRange:c,size:u}).map(function(r){var i=r[0],o=r[1];return Object(a.a)(o).map(function(r){return{key:n.generateReferenceKey(t.id,{type:"series",seriesId:"id"in e?e.id:n.UNION_SERIES_ID,property:i,refId:"id"in r?r.id:n.UNION_SERIES_REFERENCE_ID}),reference:r}})})))},n.collectChartReferences=function(t){return Object(a.a)(t.settings.series.map(function(e){return n.createSeriesRefRecords(t,e)}))}}(r||(r={}))},2509:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n,t){var e;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];e&&(clearTimeout(e),e=void 0),e=window.setTimeout(function(){n.apply(t.self||null,r),e=void 0},t.delay)}}},2510:function(n,t,e){"use strict";e.d(t,"a",function(){return i}),e.d(t,"b",function(){return o});var r=e(3),i={addChart:function(n){return"add_chart_"+n}},o=function(n){try{if(!n)throw new TypeError("event is required");r.sheets.track.track("charts_click",{action:"click",object:n})}catch(n){}}},2511:function(n,t,e){"use strict";e.d(t,"a",function(){return s});var r=e(1),i=e.n(r),o=e(3257),a=(e.n(o),e(2193)),c=this&&this.__assign||function(){return(c=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},u=this&&this.__rest||function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e},s=function(n){var t=n.label,e=n.checked,o=n.disabled,s=n.children,l=u(n,["label","checked","disabled","children"]),d=Object(r.useState)(function(){return Object(a.a)(8)})[0];return i.a.createElement("div",{className:"chart-checkbox-field f-v-center"},s||i.a.createElement(i.a.Fragment,null,i.a.createElement(f,c({id:"checkbox-"+d,checked:e,disabled:o},l)),t?i.a.createElement("label",{htmlFor:"checkbox-"+d,className:"chart-checkbox-label "+(o?"is-disabled":"")},t):null))},f=function(n){return i.a.createElement("input",c({type:"checkbox",className:"chart-checkbox"},n))}},2512:function(n,t,e){"use strict";e.d(t,"a",function(){return a});var r,i=e(2335),o=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),a=(function(n){function t(e,r,i){var o=this.constructor,a=n.call(this,e)||this;return Error.captureStackTrace?Error.captureStackTrace(a,t):a.stack=new Error(e).stack,Object.setPrototypeOf?Object.setPrototypeOf(a,t.prototype):a.__proto__=o.prototype,a.errmsg=e,a.code=r,a.data=i,a}o(t,n)}(Error),function(n,t){var e={onError:function(e,r,i,o){if(o(),t)return t(e,n,i,r)}};return"function"==typeof n?Object(i.a)(e)(n):Object(i.b)(n,e)})},3026:function(n,t,e){"use strict";var r=e(0),i=e.n(r),o=e(3027),a=e.n(o),c=e(3028),u=e.n(c);i.a.addLocaleResource("en-US",a.a),i.a.addLocaleResource("ja-JP",u.a),i.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},3027:function(n,t){n.exports={"图表":"Charts","甘特图":"Gantt","直方图":"Histogram","地图":"Map","漏斗图":"Funnel","仪表盘":"Dashboard","瀑布图":"Waterfall","旭日图":"Sunburst","插入图表":"Insert chart","折线图":"Line chart","堆积折线图":"Stacked line chart","% 堆积折线图":"% stacked line chart","带标记的折线图":"Line chart with markers","带标记的堆积折线图":"Stacked line chart with markers","带标记的 % 堆积折线图":"% stacked line chart with markers","面积图":"Area chart","堆积面积图":"Stacked area chart","% 堆积面积图":"% stacked area chart","条形图":"Bar chart","堆积条形图":"Stacked bar","% 堆积条形图":"% stacked bar","柱形图":"Column chart","堆积柱形图":"Stacked column","% 堆积柱形图":"% stacked column","饼图":"Pie chart","环形图":"Donut chart","散点图":"Scatter chart","气泡图":"Bubble chart","股价图":"Stock chart","省份地图":"Provincial maps","正值":"Positive value","负值":"Negative value","系列%s":"Series %s","石墨图表":"Shimo chart","编辑图表":"Edit chart","另存为图片":"Save as picture","复制 Chart JSON":"Copy Chart JSON","复制 Options JSON":"Copy Options JSON","删除图表":"Delete chart","无法绘制出该图":"Unable to draw this chart","请按照开盘-盘高-盘低-收盘的顺序选择 4 个数据系列":"Please select 4 data series in order of opening-high-low-closing","请选择两列，第一列为省份名，第二列为数据。":"Please select 2 columns, the first being names of provinces and the second being data.","请选择三列，第一列为类别名，第二、三列为开始日期、结束日期。":"Please select 3 columns, the first being names of categories and the second, third being start date and end date.","开始时间":"Start time","%s 天":"%s days","结束时间":"End time","无有效数据":"No valid data","大小: %s":"Size: %s","绘制旭日图需要有类别区和数据区，类别区可以有多列。":"There should be category area and data area in sunburst chart and category area can include multiple columns.","类型与数据":"Types and data","自定义样式":"Custom style","多色":"Multicolor","单色":"Monochrome","请选择":"Please select","没有选项":"No option","不支持选取多个工作表的范围":"Selection of multiple sheet ranges not supported","引用的工作表不存在":"Quoted sheet does not exist","引用范围超出工作表范围":"Quoted range is out of sheet range","只能引用单个范围":"Can quote only one range","数据范围需为单个单元格、行或者列":"Data range should be a single cell, row or column","不能引用锁定禁止查看的单元格":"Cannot refer to a cell that is locked from viewing","范围过于复杂，无法显示":"The range is too complex to display","图表类型":"Chart type","图表颜色":"Chart color","数据范围":"Data range","数据区域":"Data region","水平(类别)轴":"Horizontal (category) axis","图例项(系列)":"Legend item (series)","添加系列":"Add series","名称":"Name","Y值":"value","汇总计数":"Summary count","切换行/列":"Switch row/column","类别名":"Name of category","系列名":"Name of series","第 %1 行作为%2":"Row No.%1 as %2","第 %1 列作为%2":"Column %1 as %2","显示隐藏值":"Show hidden value","标题和坐标轴":"Header and axis","图表标题":"Chart title","最多可输入200个字符":"Up to 200 characters can be entered","垂直(类别)轴标题":"Vertical (category) axis heading","水平(类别)轴标题":"Horizontal (category) axis heading","最多可输入100个字符":"Up to 100 characters can be entered","水平(值)轴标题":"Horizontal (value) axis heading","垂直(值)轴标题":"Vertical (value) axis heading","自定义值轴范围":"Custom value axis range","最小值":"Min","最大值":"Max","重置":"Reset","图例":"Legends","右侧":"Right side","左侧":"Left side","上方":"Upper side","下方":"Lower side","无":"None","系列":"Series","扇区":"Sector","参考线":"Guide","数据标签":"Data label","值轴网格线":"Value axis gridline","类别轴网格线":"Category axis gridline"}},3028:function(n,t){n.exports={"图表":"グラフ","甘特图":"ガントチャート","直方图":"ヒストグラム","地图":"地図グラフ","漏斗图":"じょうごグラフ","仪表盘":"ダッシュボード","瀑布图":"滝グラフ","旭日图":"サンバーストグラフ","插入图表":"グラフを挿入","折线图":"折れ線グラフ","堆积折线图":"積み上げ折れ線グラフ","% 堆积折线图":"%積み上げ折れ線グラフ","带标记的折线图":"マーカー付き折れ線グラフ","带标记的堆积折线图":"マーカー付き積み上げ折れ線グラフ","带标记的 % 堆积折线图":"マーカー付き%積み上げ折れ線グラフ","面积图":"面グラフ","堆积面积图":"積み上げ面グラフ","% 堆积面积图":"%積み上げ面グラフ","条形图":"横棒グラフ","堆积条形图":"積み上げ横棒グラフ","% 堆积条形图":"%積み上げ横棒グラフ","柱形图":"縦棒グラフ","堆积柱形图":"積み上げ縦棒グラフ","% 堆积柱形图":"%積み上げ縦棒グラフ","饼图":"円グラフ","环形图":"ドーナツグラフ","散点图":"散布図","气泡图":"バブルチャート","股价图":"株価チャート","省份地图":"省地図グラフ","正值":"正の値","负值":"負の値","系列%s":"系列%s","石墨图表":"石墨グラフ","编辑图表":"グラフを編集","另存为图片":"画像として保存","复制 Chart JSON":"Chart JSONをコピー","复制 Options JSON":"Options JSONをコピー","删除图表":"グラフを削除","无法绘制出该图":"このグラフをプロットできません","请按照开盘-盘高-盘低-收盘的顺序选择 4 个数据系列":"始値-高値-安値-終値の順で4つのデータ系列を選択してください","请选择两列，第一列为省份名，第二列为数据。":"2列選択してください、1列目は省の名前、2列目はデータです。","请选择三列，第一列为类别名，第二、三列为开始日期、结束日期。":"3列選択してください、1列目は分類項目名、2列目と3列目は開始日と終了日です。","开始时间":"開始時刻","%s 天":"%s 日","结束时间":"終了時刻","无有效数据":"有効なデータがありません","大小: %s":"サイズ：%s ","绘制旭日图需要有类别区和数据区，类别区可以有多列。":"サンバーストグラフをプロットするには分類項目範囲とデータ範囲が必要です、分類項目範囲は複数列であることができます。","类型与数据":"分類項目とデータ","自定义样式":"カスタムスタイル","多色":"多色","单色":"単色","请选择":"選択してください","没有选项":"選択アイテムがありません","不支持选取多个工作表的范围":"複数シートの範囲の選択には対応していません","引用的工作表不存在":"参照したシートが存在しません","引用范围超出工作表范围":"参照範囲がシート範囲を超えています","只能引用单个范围":"単一の範囲のみ参照できます","数据范围需为单个单元格、行或者列":"データ範囲は単一のセル、行または列である必要があります","不能引用锁定禁止查看的单元格":"閲覧禁止のロックセルは参照できません","范围过于复杂，无法显示":"範囲が複雑すぎます、表示できません","图表类型":"グラフの種類","图表颜色":"グラフの色","数据范围":"データ範囲","数据区域":"データエリア","水平(类别)轴":"横（分類項目）軸","图例项(系列)":"凡例項（系列）","添加系列":"系列を追加","名称":"名前","Y值":"Y値","汇总计数":"合計個数","切换行/列":"行 / 列を切り替える","类别名":"分類項目名","系列名":"系列名","第 %1 行作为%2":" %1 行目を%2とする","第 %1 列作为%2":" %1 列目を%2とする","显示隐藏值":"非表示の値を表示","标题和坐标轴":"タイトルと座標軸","图表标题":"グラフタイトル","最多可输入200个字符":"最大200文字まで入力できます","垂直(类别)轴标题":"縦（分類項目）軸タイトル","水平(类别)轴标题":"横（分類項目）軸タイトル","最多可输入100个字符":"最大100文字まで入力できます","水平(值)轴标题":"横（値）軸タイトル","垂直(值)轴标题":"縦（値）軸タイトル","自定义值轴范围":"カスタム値軸範囲","最小值":"最小値","最大值":"最大値","重置":"リセット","图例":"凡例","右侧":"右側","左侧":"左側","上方":"上方","下方":"下方","无":"なし","系列":"系列","扇区":"セクター","参考线":"リファレンスライン","数据标签":"データラベル","值轴网格线":"値軸グリッド線","类别轴网格线":"分類項目軸グリッド線"}},3029:function(n,t,e){"use strict";t.a=function(n){var t;return r=n,{singleTool:v,doubleTool:b,tabList:(t={},t[f.b.insert]=h,t)}};var r,i=e(0),o=e.n(i),a=e(1),c=e.n(a),u=e(42),s=e(21),f=e(79),l=function(n){return n.isEditing||!(n.permission.canReadRange&&n.permission.canEditSheet)},d=[o()("图表"),o()("甘特图"),o()("直方图"),o()("地图"),o()("漏斗图"),o()("仪表盘"),o()("瀑布图"),o()("旭日图")];function h(n){return c.a.createElement(s.e,{A:n.A,icon:"chart",disabled:l(n),text:o()("图表"),searchKey:d,onTap:function(){u.A.markAsOld(),r.onCreateChart()}},u.A.visible&&c.a.createElement("span",{className:"badge"}))}function v(n){return c.a.createElement(s.j,{disabled:l(n)},c.a.createElement(s.b,{icon:"chart",tooltip:o()("插入图表"),onTap:function(){u.A.markAsOld(),u.m.markAsOld(),r.onCreateChart()}}),")")}function b(n){return c.a.createElement(s.i,{disabled:l(n)},c.a.createElement(s.b,{icon:"chart",tooltip:o()("插入图表"),onTap:function(){u.A.markAsOld(),u.m.markAsOld(),r.onCreateChart()}}),c.a.createElement("br",null),c.a.createElement("span",null,o()("图表")))}},3030:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(0),o=e.n(i),a=e(3),c=e(2129),u=e(2507),s=e(2123),f=e(2168),l=e(2509),d=e(2118),h=e(3236),v=e(2360),b=e(3237),g=e(3238),p=e(3239),m=e(2140),y=e(2138),O=e(2194),j=e(2510),x=e(2432),w=e(2508),C=e(2139),M=e(3240),N=e(2107),I=e(3249),S=e(3284),D=e(2124),k=e(2134),z=e(3286),L=e(3287),T=this&&this.__assign||function(){return(T=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},A=this&&this.__awaiter||function(n,t,e,r){return new(e||(e=Promise))(function(i,o){function a(n){try{u(r.next(n))}catch(n){o(n)}}function c(n){try{u(r.throw(n))}catch(n){o(n)}}function u(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e(function(n){n(t)})).then(a,c)}u((r=r.apply(n,t||[])).next())})},E=this&&this.__generator||function(n,t){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(n,a)}catch(n){o=[6,n],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},B=a.sheets.Core,R=a.sheets.permission.PermissionLevel,Q=-1;!function(n){n.create=function(n){var t=n.A,e="chart:manager:"+ ++Q,r=Object(m.a)(e);if(d.b){var i=t.spread.gcSpread.commandManager();i.execute=Object(m.b)("command-"+Q,i.execute,i),window.PrintGcException=!0,window.u=B}var a,Z=D.a.getInitialState(),P={readData:function(n){return _.readData(n)}},G={Formats:{percentage:"0%"},format:function(n,t){return(_.format(n,t)||"").trim()}},H=function(n,e){var r=n.activeSeries[e];if(r){var i=r.chartId,o=r.seriesId,a=D.a.getChartById(n,i);if(a){var c=o?a.settings.series.find(function(n){return n.id===o}):N.a.Series.extractUnionSeries(a.settings.series);if(c&&N.a.Series.isSimpleSeries(c)){var u=c.dataRange[0].sheetName,s=t.spread.getSheet(e);if(s&&s.name===u)return{chart:a,series:c}}}}},F=function(n){var e="string"==typeof n?D.a.getChartById(Z,n):n,r=e&&e.sheetId;if(!r)return!1;var i=t.permissions.query.shimo.getFilePermission(),o=!i||i.permissions.editable;return!(!t.editable||!o)&&t.permissions.query.getLockPermission(r)===R.Editable},Y=z.a.create(t,{handler:Object(m.c)({onChanging:function(n){var e=t.spread.B();if(e){var r=e.id,i=H(Z,r);if(i){var o=n.next,a=n.changeType,c=w.a.parseReferenceKey(o.key);if(c){var u=N.a.Operations.draggingOrResizingSeriesRefs(i.series,c.description.property,o.reference,a);return w.a.createSeriesRefRecords(i.chart,u)}}}},onChanged:function(n){var e=t.spread.B();if(e){var r,i,o=e.id,a=D.a.createSeriesRefs([]),c=H(Z,o);if(c){var u=N.a.Series.getSeriesOrientaton(c.series);if(n.records.forEach(function(n){var t=n.key,e=n.reference,o=w.a.parseReferenceKey(t);if(o){r=o.chartId;var c=o.description,u=c.property;c.refId;a[u]=e?[e]:[],i=o.description.seriesId}}),!r||!i)throw new Error("chartId, seriesId is missing");if(!N.a.Series.isSimpleSeries(a))throw new Error("expected series to be simple");q.replaceSeries({chartId:r,seriesId:i,series:a,orientation:"amibiguous"===u||"complex"===u?C.a.defaultOrientation:u}),q.commitChange()}}}},e+":reference:edit")}),V=L.a.create(t,{handler:Object(m.c)({recordAdded:function(n,e){var r=w.a.parseReferenceKey(n.key).chartId,i=D.a.getChartById(Z,r),o=i&&t.spread.getSheet(i.sheetId).E;o&&Object(b.a)(o,e)},referenceRangeChanged:function(n,t){var e=n.key,r=n.reference,i=w.a.parseReferenceKey(e);if(i){var o=i.chartId,a=i.description;q.updateReference({updates:[{chartId:o,description:a,reference:r}]})}},referenceValueChanged:function(n){var t=n.key,e=(n.reference,w.a.parseReferenceKey(t));if(e){var r=e.chartId;U.invalidateCharts([r])}}},e+":reference")}),_=S.a.create(t,{getState:function(){return Z},canEditChart:F,handler:Object(m.c)({updateChartHosts:function(n,t){J()},addChart:function(n){q.addChart({charts:n})},deleteChart:function(n){q.deleteChart({charts:n})},selectChart:function(n,t){q.setActiveSeries({sheetId:n,selected:null!=t?{chartId:t}:void 0});var e=t&&D.a.getChartById(Z,t);e&&Z.editingChartId&&Z.editingChartId!==e.id&&F(e)&&q.showSidebar({chartId:e.id})},updateChartPosition:function(n,t){q.patchChart([{id:n,position:t}])},duplicateSheet:function(n){var e=t.spread.getSheet(n.oldSheetId).name,r=t.spread.getSheet(n.newSheetId).name;q.duplicateSheet(T(T({},n),{oldSheetName:e,newSheetName:r}))},deleteSheet:function(n){q.deleteSheet(n)},collectChangesAndMarkCommitted:function(){return q.collectChangesAndMarkCommitted()},forceRepaintCharts:function(n){return q.forceRepaintCharts(n)},dataChanged:function(){U.invalidateCharts()},permissionChanged:function(){q.updatePermission(),U.invalidateCharts()},zoom:function(n){return q.setZoomRatio(n)}},e+":environment")}),U=M.a.create({canEditChart:F,onShowSidebar:function(n){F(n)&&q.showSidebar({chartId:n})},onRemoveChart:function(n){F(n)&&(q.deleteChart({charts:[{id:n}]}),q.commitChange())},onSaveChartAsImage:function(n){var t=D.a.getChartById(Z,n);if(t){var e=U.exportDataURL(n);Object(h.a)(e,(t.settings.chartTitle||o()("石墨图表"))+".png")}},reader:P,formatter:G}),W=I.a.create(t,{reader:P,onUpdateChart:function(n){q.updateChart({charts:[n]}),q.commitChange()},onClose:function(){q.RS()}}),J=Object(l.a)(Object(g.a)(t.spread.gcSpread,["event","paint"])(function(){r("applyState");var n=Z.charts,t=Z.editingChartId,e=Z.zoomRatio,i=_.setCharts(n);U.setCharts(n,i,e),V.setWatchList(Object(f.a)(n.map(w.a.collectChartReferences))),Y.setReferenceRecords(Object(f.a)(Object(s.a)(Object.keys(Z.activeSeries).map(function(n){return H(Z,n)})).map(function(n){return w.a.createSeriesRefRecords(n.chart,n.series)}))),W.setEditingChart(null==t?void 0:D.a.getChartById(Z,t))}),{delay:16}),X=function(n){try{var e=D.a.normalizeState(D.a.reduce(Z,n),t,F);Object(y.a)(Z,e)?(Z=e,r("deep equal, skipping apply")):(Z=e,J())}catch(n){}},K=function(n){return"data-sm-chart-"+n},$={toDataURL:function(n){return D.a.getChartById(Z,n)?U.exportDataURL(n):""},toHtml:function(n){var t=D.a.getChartById(Z,n);if(!t)return"";var e=location.origin+location.pathname,r=t.position,i=r.width,o=r.height,a={src:U.exportDataURL(n),width:i,height:o},c={version:2,source:e,data:encodeURIComponent(JSON.stringify(t))},u=function(n,t){return Object.entries(n).map(function(n){var e=n[0],r=n[1];return(t?K(e):e)+'="'+r+'"'}).join(" ")};return"<img "+u(a,!1)+" "+u(c,!0)+"/>"},fromHtml:function(n){var t=document.createElement("div");if("string"==typeof n){if(!n.includes(K("version")))return[];t.innerHTML=n}else t.appendChild(n.cloneNode(!0));return t.getElementsByTagName("table").length?[]:t.innerText.trim().length?[]:Object(s.a)([].slice.apply(t.getElementsByTagName("img")).map(function(n){var t=n.dataset,e=t.smChartVersion,r=t.smChartSource,i=t.smChartData;return 2===Number(e)&&r&&i?{version:Number(e),source:r,data:JSON.parse(decodeURIComponent(i))}:void 0}))},canImport:function(n){var t,e,r=function(n){var t=n.split("/").filter(Boolean);return{protocol:t[0],host:t[1],namespace:t[2],spreadId:t[3]}};return t=location.href,e=n.source,Object(y.a)(r(t),r(e))}},q={collectChangesAndMarkCommitted:function(){var n=a!==Z&&!Object(y.a)(a,Z)?x.a.createChangeOperators(t.spread.sheets.map(function(n){return n.id}),a,Z):[];return r("collected chart change: ",n),a=Z,n},prepareForSyncPaint:function(){return A(this,void 0,Promise,function(){return E(this,function(n){switch(n.label){case 0:return[4,Object(u.b)()];case 1:return n.sent(),[2]}})})},commitChange:function(){var n=q.collectChangesAndMarkCommitted();n.length&&t.calcOperator({operator:n})},applySpreadContent:function(n){X({type:"applySpreadContent",payload:x.a.getSheetsAttrs(n)}),a=Z},applySpreadUpdate:function(n){X({type:"applySpreadUpdate",payload:x.a.getSheetsAttrs(n)}),a=Z},patchChart:function(n){X({type:"patchChart",payload:{charts:n}})},addChart:function(n){X({type:"addChart",payload:n})},addChartFromSelection:function(n){var e=t.spread.B();if(e){var r=e.E,i=C.a.defaultHeight,o=C.a.defaultChartType,a=C.a.defaultChartAxes,u=C.a.defaultColorTheme,f=C.a.defaultWidth,l=Object(p.b)(r,f,i),d=N.a.Series.extractSeries(n.references,P).series,h=N.a.Series.evaluateSeries(d,P),v=Object(s.a)(C.a.CHART_TYPES.map(function(n){var t=c.a[n];if(t.suggestion){var e=t.suggestion.match(h);if(e){var r=C.a.suggestionPriorities.indexOf(n);return-1===r&&(r=C.a.suggestionPriorities.length),{type:n,priority:r,settings:e}}}})).sort(function(n,t){return n.priority-t.priority})[0],b=v?v.type:o(),g=c.a[b],m=C.a.getChartName(b);Object(j.b)(j.a.addChart(m));var y=D.a.createSeries({seriesRefs:d,chartType:b,colorTheme:u,reader:P}),O=T(T({axes:a(),chartType:b,chartTitle:"",legendVisible:!0,legendPosition:D.a.LegendPosition.bottom,dataLabels:!1,colorTheme:u,plotVisibleDataOnly:!0,summaryCount:!1,series:y},g.defaultSettings||{}),v?v.settings:{}),x={id:D.a.generateChartId(),sheetId:e.id,position:l,settings:O};return q.addChart({charts:[x]}),x.id}},addChartFromHtml:function(n){var e=$.fromHtml(n.html).filter(function(n){return $.canImport(n)});if(e.length){var r=t.spread.B();if(!r)return;var i=r.E,o=i.guid();q.addChart({charts:e.map(function(n){return Object(O.a)(n.data,function(n){n.id=D.a.generateChartId(),n.sheetId=o,n.position=Object(p.a)(i,n.position.width,n.position.height)})})})}},updateChart:function(n){X({type:"updateChart",payload:n})},deleteChart:function(n){X({type:"deleteChart",payload:n})},duplicateSheet:function(n){X({type:"duplicateSheet",payload:n})},deleteSheet:function(n){X({type:"deleteSheet",payload:n})},updateReference:function(n){X({type:"updateReference",payload:n})},setActiveSeries:function(n){X({type:"setActiveSeries",payload:n})},replaceSeries:function(n){var t=D.a.getChartById(Z,n.chartId);if(!t)throw new Error("chart not found: "+n.chartId);if(n.seriesId===w.a.UNION_SERIES_ID){var e=Object(O.a)(t,function(t){t.settings.series=D.a.createSeries({seriesRefs:N.a.Series.splitSeriesRefs(n.series,n.orientation||N.a.Series.getSeriesOrientaton(t.settings.series)||C.a.defaultOrientation),chartType:t.settings.chartType,colorTheme:t.settings.colorTheme,chartToInherit:t,reader:P})});q.updateChart({charts:[e]})}else{e=Object(O.a)(t,function(t){var e=t.settings.series.find(function(t){return t.id===n.seriesId});if(e){var r=k.a.appendRefId;e.dataRange=n.series.dataRange.map(r),e.seriesLabel=n.series.seriesLabel.map(r),e.categoryLabel=n.series.categoryLabel.map(r),e.size=n.series.size.map(r)}});q.updateChart({charts:[e]})}},showSidebar:function(n){var t=Z.editingChartId;X({type:"setEditingChart",payload:n}),Z.editingChartId&&!t&&nn.emit("ChartSidebarVisibilityChanged",!0)},RS:function(n){void 0===n&&(n=!1);var t=Z.editingChartId;X({type:"setEditingChart",payload:{chartId:void 0}}),n||t&&!Z.editingChartId&&nn.emit("ChartSidebarVisibilityChanged",!1)},setZoomRatio:function(n){X({type:"setZoomRatio",payload:n})},updatePermission:function(){X({type:"updatePermission",payload:void 0})},forceRepaintCharts:function(n){U.invalidateCharts(n)}},nn=Object(v.a)(),tn=T(T({},nn),{query:d.b?Object(m.c)($,"chart:manager:query"):$,command:d.b?Object(m.c)(q,"chart:manager:command"):q,DEBUG:function(){return{state:Z,lastCommittedState:a,command:q}}});return t.spread.gcSpread.options.charts=tn,d.b?Object(m.c)(tn,e):tn}}(r||(r={}))},3031:function(n,t,e){"use strict";t.a=function(n,t){var e={};t?n.forEach(function(n){n[t]in e||(e[n[t]]=n)}):n.forEach(function(n){n in e||(e[n]=n)});return e}},3032:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n){return function(t){return!n(t)}}},3033:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n,t){if(n.length!==t.length)throw new Error("length mismatch");return n.map(function(n,e){return[n,t[e]]})}},3034:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r=function(n){var t={};return n.forEach(function(n){var e=n[0],r=n[1];t[e]=r}),t}},3035:function(n,t,e){"use strict";e.d(t,"a",function(){return i});var r=e(2431),i=function(n,t){return Object(r.a)(n,function(n,e){return!t.includes(e)})}},3036:function(n,t,e){"use strict";e.d(t,"a",function(){return o});var r=e(2133),i=e(2107),o={useSeriesColor:!1,useSectorColor:!1,getSectors:function(n,t,e){var o=i.a.Series.getCategoryLabelText(n,e,{fillDefault:!0});return o.map(function(e,i){return{label:e,color:"sectorColors"in n&&n.sectorColors[i]||r.a.getColorFromTheme(t,i,o.length)}})},isRectangular:!1,isBarLike:!1,isAxisInverted:!1,isXyValueAxis:!1,xAxisPosition:"bottom",isValueStacked:!1,isValuePercent:!1,hideLegend:!1,isColorMonochrome:!1,isSingleSeries:!1,supportSummaryCount:!1}},3037:function(n,t,e){n.exports=e.p+"images/chart_1.f4bcf48d80.png"},3038:function(n,t,e){n.exports=e.p+"images/chart_10.77b9a7fe65.png"},3039:function(n,t,e){n.exports=e.p+"images/chart_101.a1928f70be.svg"},3040:function(n,t,e){n.exports=e.p+"images/chart_11.679464d9c7.png"},3041:function(n,t,e){n.exports=e.p+"images/chart_111.c59d77650c.png"},3042:function(n,t,e){n.exports=e.p+"images/chart_12.1e814af889.png"},3043:function(n,t,e){n.exports=e.p+"images/chart_121.5714956b8e.png"},3044:function(n,t,e){n.exports=e.p+"images/chart_13.6605e26ca8.png"},3045:function(n,t,e){n.exports=e.p+"images/chart_131.5ff9a1531c.png"},3046:function(n,t,e){n.exports=e.p+"images/chart_132.46a0ecce59.png"},3047:function(n,t,e){n.exports=e.p+"images/chart_14.582e4864a1.png"},3048:function(n,t,e){n.exports=e.p+"images/chart_141.200e79e399.png"},3049:function(n,t,e){n.exports=e.p+"images/chart_142.5c45b1cb7f.png"},3050:function(n,t,e){n.exports=e.p+"images/chart_18.aed7491867.png"},3051:function(n,t,e){n.exports=e.p+"images/chart_19.b582489698.png"},3052:function(n,t,e){n.exports=e.p+"images/chart_20.b1b1dbfcf0.png"},3053:function(n,t,e){n.exports=e.p+"images/chart_24.810eabf225.png"},3054:function(n,t,e){n.exports=e.p+"images/chart_25.448c2a98f2.png"},3055:function(n,t,e){n.exports=e.p+"images/chart_26.8c06754e56.png"},3056:function(n,t,e){n.exports=e.p+"images/chart_27.b3a6594c71.png"},3057:function(n,t,e){n.exports=e.p+"images/chart_28.f4a0216a96.png"},3058:function(n,t,e){n.exports=e.p+"images/chart_3.9d0d556ae7.png"},3059:function(n,t,e){n.exports=e.p+"images/chart_37.ccd5275fed.png"},3060:function(n,t,e){n.exports=e.p+"images/chart_38.2f1ea60425.png"},3061:function(n,t,e){n.exports=e.p+"images/chart_50.eed004e9a4.png"},3062:function(n,t,e){n.exports=e.p+"images/chart_8.5e37c5fd1c.png"},3063:function(n,t,e){n.exports=e.p+"images/chart_9.04625bf3af.png"},3234:function(n,t,e){"use strict";e.d(t,"a",function(){return c});var r=e(2144),i=e(2360),o=this&&this.__assign||function(){return(o=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},a=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return JSON.stringify(n)},c=function(n,t){void 0===t&&(t=a);var e={},c=Object(i.a)(),u=o(o({},c),{fill:function(n){n.forEach(function(n){var r=n.params,i=n.result,o=t.apply(void 0,r);e[o]={status:"success",data:i}})},silentGet:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{return u.get.apply(u,n)}catch(n){return}},get:function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var a=t.apply(void 0,i);if(a in e){var u=e[a];switch(u.status){case"fetching":return;case"success":return u.data;case"error":throw u.error;default:return Object(r.b)(u)}}e[a]={status:"fetching"},n.apply(void 0,i).then(function(n){e[a]={status:"success",data:n},c.emit("Fulfilled",n),c.emit("Cached",void 0)},function(n){e[a]={status:"error",error:n},c.emit("Rejected",n),c.emit("Cached",void 0)})}});return u}},3236:function(n,t,e){"use strict";t.a=function(n,t){var e=document.createElement("a");e.download=t,e.href=n,document.body.appendChild(e),e.click(),document.body.removeChild(e)}},3237:function(n,t,e){"use strict";t.a=function(n,t){r.formula.formulaToExpression(n,t,0,0)};var r=e(3).sheets},3238:function(n,t,e){"use strict";e.d(t,"a",function(){return i});var r=e(2335),i=function(n,t){var e=[].concat(t),i=e.includes("paint"),o=e.includes("event"),a=e.includes("calc"),c=e.includes("all"),u=function(){(i||c)&&n.SI(),(o||c)&&n.resumeEvent(),(a||c)&&n.resumeCalcService()};return Object(r.a)({onCalled:function(){(i||c)&&n.suspendPaint(),(o||c)&&n.suspendEvent(),(a||c)&&n.suspendCalcService()},onReturned:u,onError:u})}},3239:function(n,t,e){"use strict";e.d(t,"a",function(){return a}),e.d(t,"b",function(){return c});var r=e(2167),i=0,o=1,a=function(n,t,e){return{row:n.getActiveRowIndex(),col:n.getActiveColumnIndex(),rowOffset:0,colOffset:0,width:t,height:e}},c=function(n,t,e){var a={height:[i,o].map(function(t){return n.getViewportHeight(t)}),width:[i,o].map(function(t){return n.SX(t)})},c=Object(r.a)(a.width),u=Object(r.a)(a.height);return function(n,t){var e={height:[i,o].map(function(t){return n.getViewportHeight(t)}),width:[i,o].map(function(t){return n.SX(t)}),start:{row:[i,o].map(function(t){return n.getViewportTopRow(t)}),col:[i,o].map(function(t){return n.getViewportLeftColumn(t)})},end:{row:[i,o].map(function(t){return n.getViewportBottomRow(t)}),col:[i,o].map(function(t){return n.SW(t)})}},r={row:function(t){return n.getRowHeight(t)},col:function(t){return n.SS(t)}},a=["row","col"].map(function(n){var a={row:"y",col:"x"}[n],c=e[{row:"height",col:"width"}[n]][i],u=t[a];if(u<c){for(var s=0,f=0;f<=e.end[n][i];f++){if(s+(l=r[n](f))>u)return{index:f,offset:s+l-u};s+=l}return{index:f,offset:r[n](f)}}for(s=c,f=e.start[n][o];f<=e.end[n][o];f++){var l;if(s+(l=r[n](f))>u)return{index:f,offset:s+l-u};s+=l}return{index:f,offset:r[n](f)}}),c=a[0],u=c.index,s=c.offset,f=a[1];return{row:u,col:f.index,rowOffset:s,colOffset:f.offset,width:t.width,height:t.height}}(n,{width:t,height:e,x:(c-t)/2,y:(u-e)/2})}},3240:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(2118),o=e(2195),a=e(2140),c=e(3241);!function(n){var t=0;n.create=function(n){var e="chart:controllers:"+t++,r=Object(a.a)(e),u=[],s={exportDataURL:function(n){var t=u.find(function(t){return t.id===n});return t?t.exportDataURL():""},invalidateCharts:function(n){null==n?u.forEach(function(n){n.invalidate()}):n.forEach(function(n){var t=u.find(function(t){return t.id===n});t&&t.invalidate()})},setCharts:function(t,e,i){u=Object(o.a)(u,t,{getKeyA:function(n){return n.id},getKeyB:function(n){return n.id},needUpdate:function(n,t){return!0},add:function(t){r("[add]",t);var o=c.a.create(t,n);return o.setChart(t,i),o.setDom(e[t.id]||[]),o},remove:function(n){return r("[remove]",n),n.dispose(),null},update:function(n,t){return r("[update]",n,t),n.setChart(t,i),n.setDom(e[t.id]||[]),n}})}};return i.b?Object(a.c)(s,e):s}}(r||(r={}))},3241:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(3),o=e(2507),a=e(3242),c=(e.n(a),e(2144)),u=e(2118),s=e(2195),f=e(2140),l=e(2107),d=e(3244),h=e(2124),v=e(2134),b=i.sheets.clipboard.copyToClipboard;!function(n){n.create=function(n,t){var e,r,i=t.reader,a=t.formatter,g=t.canEditChart,p=t.onShowSidebar,m=t.onRemoveChart,y=t.onSaveChartAsImage,O="chart:controller:"+n.id,j=Object(f.a)(O),x=!1,w=!0,C=1,M=[],N={},I={readData:function(t){var e=v.a.stringify(t);if(!N[e]){var r=i.readData(t),o=n.settings.plotVisibleDataOnly?l.a.excludeHiddenRowCol(r):r;N[e]=o}return N[e]}},S=function(){g(n.id)&&p(n.id)},D=function(t,e){if(void 0===e&&(e=!1),!t.renderer)try{var r=n.settings.chartType,i=o.c.get(r);i&&(j("load provider success:",r),t.renderer=i.create(t.canvasHost,{reader:I,formatter:a}))}catch(n){}t.renderer&&(e?(t.renderer.animation(!1),t.renderer.paint(n,1,!0)):(t.renderer.animation(w||t.isInView),t.renderer.paint(n,C),t.isStale=!1,setTimeout(function(){t.isInView=!0,t.renderer&&t.renderer.animation(w||t.isInView)},100)))},k=function(){window.cancelAnimationFrame(e),e=window.requestAnimationFrame(function(){x||M.filter(function(n){return n.isStale}).forEach(function(n){return D(n)})})},z=function(n){n?n.isStale=!0:M.forEach(function(n){n.isStale=!0}),N={},k()};o.c.on("Cached",k);var L=function(t){t.innerHTML="",t.dataset.chartId=n.id,t.addEventListener("dblclick",S);var e,r,i=document.createElement("div");return i.className="chartv2-chart",t.appendChild(i),u.e||(e=document.createElement("div"),t.appendChild(e),r=d.a.create(e,{canEditChart:function(){return g(n.id)},handler:{onEdit:function(){p(n.id)},onRemove:function(){m(n.id)},onExport:function(){y(n.id)},debug_onCopyChart:function(){b(JSON.stringify(n,null,2))},debug_onCopyOptions:function(){var n=M[0].renderer.DEBUG_getOptions();b(JSON.stringify(n,null,2))}}})),{canvasHost:i,menuHost:e,menu:r,host:t,isStale:!0,renderer:void 0,isInView:!1}},T=function(n){n.menu&&n.menu.dispose(),n.host.innerHTML="",n.renderer&&(n.renderer.dispose(),n.renderer=void 0,w=!1)},A={id:n.id,setDom:function(n){Object(c.a)(!x,"chart controller "+A.id+" is already disposed!");var t=[].concat(n);M=Object(s.a)(M,t,{getKeyA:function(n){return n.host},getKeyB:function(n){return n},needUpdate:function(n,t){return!t.dataset.chartId},add:function(n){return j("[dom] add ",n),L(n)},remove:function(n){return j("[dom] remove ",n),T(n),null}}),k()},setChart:function(t,e){Object(c.a)(!x,"chart controller "+A.id+" is already disposed!");var i=n.settings.chartType,a=t.settings.chartType,u=o.c.silentGet(i);i!==a?(Object(o.a)(i,a)||M.forEach(function(n){n.renderer&&(n.renderer.dispose(),n.renderer=void 0)}),z()):u&&u.shouldHardRefresh&&u.shouldHardRefresh(n,t)?(M.forEach(function(n){n.renderer&&(n.renderer.dispose(),n.renderer=void 0)}),z()):(h.a.isChartSettingEqual(n,t)||z(),h.a.isChartSizeEqual(n,t)&&e===C||(C=e,window.cancelAnimationFrame(r),r=window.requestAnimationFrame(function(){x||M.forEach(function(t){t.renderer&&t.renderer.resize(n,C)})}))),n=t},invalidate:z,dispose:function(){Object(c.a)(!x,"chart controller "+A.id+" is already disposed!"),A.setDom([]),x=!0,o.c.off("Cached",k)},exportDataURL:function(){var t=M[0];if(t)return(i=t.renderer)?i.exportDataURL():"";var e=document.createElement("div");e.style.position="fixed",e.style.left="100vw",e.style.top="0",e.style.width=n.position.width+"px",e.style.height=n.position.height+"px",document.body.appendChild(e);var r=L(e);D(r,!0);var i,o=(i=r.renderer)?i.exportDataURL():"";return T(r),e.parentElement.removeChild(e),o},DEBUG:function(){return Object(c.a)(!x,"chart controller "+A.id+" is already disposed!"),{views:M,cache:N}}};return u.b?Object(f.c)(A,O):A}}(r||(r={}))},3242:function(n,t,e){var r=e(3243);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3243:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,".chartv2-chart {\n  background: white;\n  border: 1px solid #cccccc;\n  position: absolute;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  cursor: initial; }\n",""])},3244:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i,o,a,c=e(0),u=e.n(c),s=e(3245),f=(e.n(s),e(2118)),l=e(2352),d=this&&this.__makeTemplateObject||function(n,t){return Object.defineProperty?Object.defineProperty(n,"raw",{value:t}):n.raw=t,n};!function(n){var t;!function(n){n.edit="edit",n.remove="remove",n.export="export",n.debugCopyChart="debug-copy-chart",n.debugCopyOptions="debug-copy-options"}(t||(t={}));var e=document.body.appendChild(document.createElement("div"));e.className="chartv2-menu-dropdown";var r=function(n){return Object(l.a)(a||(a=d(["\n      ",'\n      <div class="chart-menu-item" data-menu-item-id="','">\n        ',"\n      </div>\n      ","\n      ","\n      ","\n    "],["\n      ",'\n      <div class="chart-menu-item" data-menu-item-id="','">\n        ',"\n      </div>\n      ","\n      ","\n      ","\n    "])),n?Object(l.a)(i||(i=d(['\n            <div class="chart-menu-item" data-menu-item-id="','">\n              ',"\n            </div>\n          "],['\n            <div class="chart-menu-item" data-menu-item-id="','">\n              ',"\n            </div>\n          "])),t.edit,u()("编辑图表")):"",t.export,u()("另存为图片"),f.b?'<div class="chart-menu-item" data-menu-item-id="'+t.debugCopyChart+'">'+u()("复制 Chart JSON")+"</div>":"",f.b?'<div class="chart-menu-item" data-menu-item-id="'+t.debugCopyOptions+'">'+u()("复制 Options JSON")+"</div>":"",n?Object(l.a)(o||(o=d(['\n            <div class="chart-menu-separator"></div>\n            <div\n              class="chart-menu-item is-remove"\n              data-menu-item-id="','"\n            >\n              ',"\n            </div>\n          "],['\n            <div class="chart-menu-separator"></div>\n            <div\n              class="chart-menu-item is-remove"\n              data-menu-item-id="','"\n            >\n              ',"\n            </div>\n          "])),t.remove,u()("删除图表")):"")};n.create=function(n,i){var o,a=!1,c=((o={})[t.edit]=i.handler.onEdit,o[t.export]=i.handler.onExport,o[t.remove]=i.handler.onRemove,o[t.debugCopyChart]=i.handler.debug_onCopyChart,o[t.debugCopyOptions]=i.handler.debug_onCopyOptions,o),u=function(n){n.target&&(n.target===e||e.contains(n.target)||(a=!1,l()))},s=function(n){var t=n.target.dataset.menuItemId,e=c[t];e&&e(),a=!1,l()},f=function(n){a=!a,l()},l=function(){if(a){var t=n.getBoundingClientRect(),o=(t.width,t.height,t.left,t.top,t.bottom),c=t.right;e.style.display="block",e.style.top=o+15+"px",e.style.right=window.innerWidth-c-17+"px",e.innerHTML=r(i.canEditChart()),e.addEventListener("click",s),setTimeout(function(){document.addEventListener("mousedown",u),document.addEventListener("touchstart",u)},0)}else e.style.display="none",e.removeEventListener("click",s),e.innerHTML="",document.removeEventListener("mousedown",u),document.removeEventListener("touchstart",u)};return n.className="chartv2-menu-button",n.addEventListener("click",f),n.addEventListener("mousedown",function(n){return n.stopPropagation()}),l(),{render:l,dispose:function(){a=!1,l(),n.removeEventListener("click",f),n.innerHTML=""}}}}(r||(r={}))},3245:function(n,t,e){var r=e(3246);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3246:function(n,t,e){var r=e(1857);(n.exports=e(1854)(!1)).push([n.i,".chartv2-menu-button {\n  display: none;\n  width: 20px;\n  height: 20px;\n  background-size: 20px 20px;\n  position: absolute;\n  right: 7px;\n  top: 7px;\n  cursor: pointer;\n  background-image: url("+r(e(3247))+"); }\n  .chartv2-menu-button:hover {\n    background-image: url("+r(e(3248))+"); }\n\n.sm-sheet-floatingobject-selected .chartv2-menu-button {\n  display: block; }\n\n.chartv2-menu-dropdown {\n  display: none;\n  position: fixed;\n  z-index: 2000;\n  min-width: 149px;\n  background: #ffffff;\n  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.1);\n  border-radius: 3px;\n  padding: 5px 0; }\n  .chartv2-menu-dropdown:before {\n    content: '';\n    display: block;\n    border: 7px solid transparent;\n    position: absolute;\n    top: -15px;\n    left: 116px;\n    width: 0;\n    border-bottom-color: #f0f0f0; }\n  .chartv2-menu-dropdown:after {\n    content: '';\n    display: block;\n    border: 7px solid transparent;\n    position: absolute;\n    top: -14px;\n    left: 116px;\n    width: 0;\n    border-bottom-color: #fff; }\n  .chartv2-menu-dropdown .chart-menu-item {\n    font-size: 12px;\n    color: #666;\n    line-height: 32px;\n    height: 32px;\n    text-indent: 20px;\n    cursor: pointer; }\n    .chartv2-menu-dropdown .chart-menu-item:hover {\n      background: #f7f7f7; }\n    .chartv2-menu-dropdown .chart-menu-item.is-remove {\n      color: #cd4747; }\n  .chartv2-menu-dropdown .chart-menu-separator {\n    content: ' ';\n    border-bottom: 1px solid #e7cece;\n    height: 0;\n    margin: 3px 15px;\n    display: block; }\n",""])},3247:function(n,t,e){n.exports=e.p+"images/setting@2x.32d82b3548.png"},3248:function(n,t,e){n.exports=e.p+"images/setting_hover@2x.272d0b7cf0.png"},3249:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(6),o=e.n(i),a=e(1),c=e.n(a),u=e(3250);!function(n){n.create=function(n,t){var e=document.body.appendChild(document.createElement("DIV"));return e.id="chartv2-container-"+Math.floor(1e3*Math.random()),{setEditingChart:function(r){r?o.a.render(c.a.createElement(u.a,{A:n,chart:r,reader:t.reader,onChange:function(n){t.onUpdateChart(n)},onClose:function(){t.onClose()}}),e):o.a.unmountComponentAtNode(e)},destroy:function(){o.a.unmountComponentAtNode(e),e.parentElement.removeChild(e)}}}}(r||(r={}))},3250:function(n,t,e){"use strict";e.d(t,"a",function(){return h});var r=e(0),i=e.n(r),o=e(4),a=e(1),c=e.n(a),u=e(2509),s=e(3251),f=e(3254),l=(e.n(f),e(3256)),d=e(3277),h=function(n){var t=n.A,e=n.chart,r=n.reader,f=n.onClose,h=n.onChange,v=Object(a.useState)(!1),b=v[0],g=v[1],p=Object(a.useRef)(b);Object(a.useEffect)(function(){p.current=b});var m=Object(a.useState)(0),y=m[0],O=m[1];return Object(a.useEffect)(function(){var n=Object(u.a)(function(){if(!p.current){var n=t.spread.B();(n&&n.id)!==e.sheetId&&f()}},{delay:0});return t.on(o.default.IV,n),function(){t.off(o.default.IV,n)}},[]),c.a.createElement("div",{className:"chart-sidebar f-col "+(b?"is-hidden":"")},c.a.createElement("div",{className:"sidebar-header f-v-center"},c.a.createElement("div",{className:"sidebar-title f-1"},i()("编辑图表")),c.a.createElement("div",{className:"close-button",onClick:function(){return f()}})),c.a.createElement(s.a,{tabs:[{id:"data",title:i()("类型与数据"),content:function(){return c.a.createElement(l.a,{A:t,chart:e,reader:r,seriesIndex:y,setSeriesIndex:O,setIsRangeSelecting:g,onChange:h})}},{id:"style",title:i()("自定义样式"),content:function(){return c.a.createElement(d.a,{chart:e,reader:r,seriesIndex:y,setSeriesIndex:O,onChange:h})}}]}))}},3251:function(n,t,e){"use strict";e.d(t,"a",function(){return u});var r=e(1),i=e.n(r),o=e(3252),a=(e.n(o),this&&this.__assign||function(){return(a=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)}),c=this&&this.__rest||function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e},u=function(n){var t=n.tabs,e=n.defaultTabId,o=void 0===e?t[0].id:e,u=c(n,["tabs","defaultTabId"]),s=Object(r.useState)(o),f=s[0],l=s[1],d=t.find(function(n){return n.id===f})||t[0];if(!d)return i.a.createElement("div",null);var h=d.id;return i.a.createElement("div",a({className:"tab-container f-col"},u),i.a.createElement("div",{className:"tab-header f-v-center"},t.map(function(n){return i.a.createElement("div",{className:"f-1 f-row f-m-center f-c-stretch",key:n.id},i.a.createElement("div",{className:"tab-label f-center "+(n.id===h?"is-active":""),key:n.id,onClick:function(){n.isDisabled||l(n.id)}},n.title))})),i.a.createElement("div",{className:"tab-pane f-1"},d.content()))}},3252:function(n,t,e){var r=e(3253);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3253:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,".tab-container .tab-header {\n  min-height: 34px;\n  border-bottom: 1px solid #e5e5e5; }\n  .tab-container .tab-header .tab-label {\n    min-width: 50px;\n    height: 38px;\n    font-size: 12px;\n    font-weight: 600;\n    line-height: 1.5;\n    color: #a5a5a5;\n    border-bottom: 2px solid transparent;\n    margin-right: 10px;\n    user-select: none;\n    cursor: pointer; }\n    .tab-container .tab-header .tab-label.is-active {\n      color: #333333;\n      cursor: initial;\n      border-bottom: 2px solid #333333; }\n    .tab-container .tab-header .tab-label:hover {\n      color: #333333; }\n\n.tab-container .tab-pane {\n  overflow-x: hidden;\n  overflow-y: auto;\n  overflow-y: overlay; }\n  .tab-container .tab-pane::-webkit-scrollbar {\n    width: 6px;\n    background-color: transparent; }\n  .tab-container .tab-pane::-webkit-scrollbar-thumb {\n    border-radius: 3px;\n    background-color: #d8d8d8; }\n",""])},3254:function(n,t,e){var r=e(3255);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3255:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,'.chart-sidebar {\n  box-sizing: border-box;\n  position: fixed;\n  right: 0;\n  width: 350px;\n  top: 55px;\n  height: calc(100vh - 55px);\n  z-index: 1000;\n  padding: 20px 30px 0 30px;\n  color: #333333;\n  background-color: #ffffff;\n  box-shadow: 0 1px 6px #cccccc;\n  font-size: 12px;\n  font-weight: normal; }\n  .chart-sidebar *,\n  .chart-sidebar *::before,\n  .chart-sidebar *::after {\n    box-sizing: inherit; }\n  .chart-sidebar h1,\n  .chart-sidebar h2,\n  .chart-sidebar h3,\n  .chart-sidebar h4,\n  .chart-sidebar h5,\n  .chart-sidebar h6 {\n    margin: 0;\n    padding: 0; }\n  .chart-sidebar.is-hidden {\n    display: none; }\n  .chart-sidebar .sidebar-header {\n    font-size: 16px;\n    line-height: 20px;\n    font-weight: 600; }\n    .chart-sidebar .sidebar-header .close-button {\n      cursor: pointer;\n      display: block;\n      width: 16px;\n      height: 16px;\n      background-size: 12px 12px;\n      background-repeat: no-repeat;\n      background-position: center;\n      background-image: url("data:image/svg+xml;base64,PCEtLSBHZW5lcmF0ZWQgYnkgSWNvTW9vbi5pbyAtLT4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMzIgMzIiPgo8dGl0bGU+Y2xvc2U8L3RpdGxlPgo8cGF0aCBmaWxsPSIjYzJjMmMyIiBkPSJNMTYuMDI4IDE0LjE0MmwtMTQuMTQyLTE0LjE0Mi0xLjg4NiAxLjg4NiAxNC4xNDIgMTQuMTQyLTE0LjE0MiAxNC4xNDIgMS44ODYgMS44ODYgMTQuMTQyLTE0LjE0MiAxNC4xNDIgMTQuMTQyIDEuODg2LTEuODg2LTE0LjE0Mi0xNC4xNDIgMTQuMTQyLTE0LjE0Mi0xLjg4Ni0xLjg4Ni0xNC4xNDIgMTQuMTQyeiI+PC9wYXRoPgo8L3N2Zz4K"); }\n      .chart-sidebar .sidebar-header .close-button:hover {\n        background-image: url("data:image/svg+xml;base64,PCEtLSBHZW5lcmF0ZWQgYnkgSWNvTW9vbi5pbyAtLT4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMzIgMzIiPgo8dGl0bGU+Y2xvc2U8L3RpdGxlPgo8cGF0aCBmaWxsPSIjNjY2IiBkPSJNMTYuMDI4IDE0LjE0MmwtMTQuMTQyLTE0LjE0Mi0xLjg4NiAxLjg4NiAxNC4xNDIgMTQuMTQyLTE0LjE0MiAxNC4xNDIgMS44ODYgMS44ODYgMTQuMTQyLTE0LjE0MiAxNC4xNDIgMTQuMTQyIDEuODg2LTEuODg2LTE0LjE0Mi0xNC4xNDIgMTQuMTQyLTE0LjE0Mi0xLjg4Ni0xLjg4Ni0xNC4xNDIgMTQuMTQyeiI+PC9wYXRoPgo8L3N2Zz4K"); }\n  .chart-sidebar .tab-container {\n    margin-top: 15px;\n    flex-grow: 1; }\n    .chart-sidebar .tab-container .tab-pane {\n      margin: 0 -30px;\n      padding: 0 30px; }\n  .chart-sidebar .sidebar-tab section {\n    padding: 15px 0; }\n    .chart-sidebar .sidebar-tab section .section-title {\n      height: 20px;\n      line-height: 20px;\n      font-size: 12px;\n      font-weight: 500;\n      color: #333333;\n      margin-bottom: 15px; }\n    .chart-sidebar .sidebar-tab section + section {\n      border-top: 1px solid #e5e5e5; }\n\n.sm-sheet-full-screen .chart-sidebar {\n  top: 0;\n  height: 100vh; }\n',""])},3256:function(n,t,e){"use strict";e.d(t,"a",function(){return I});var r,i,o=e(0),a=e.n(o),c=e(1),u=e.n(c),s=e(2129),f=e(2133),l=e(2139),d=e(2107),h=e(2124),v=e(2134),b=e(2433),g=e(2194),p=e(2231),m=e(2510),y=e(2511),O=e(2361),j=e(3267),x=e(2362),w=e(3272),C=e(3275),M=(e.n(C),this&&this.__makeTemplateObject||function(n,t){return Object.defineProperty?Object.defineProperty(n,"raw",{value:t}):n.raw=t,n}),N=function(n,t){return function(e){var r=v.a.parse(e);if(!r)return{message:"",reset:!0};var i=d.a.getSingleSheetName(r);if(null==i)return{message:a()("不支持选取多个工作表的范围"),reset:!0};var o=n.spread.getSheetByName(i);if(!o)return{message:a()("引用的工作表不存在"),reset:!0};var c={row:0,col:0,rowCount:o.G(),colCount:o.H()};return r.every(function(n){return Object(p.c)(c,n.range)})?t.singleRange&&r.length>1?{message:a()("只能引用单个范围"),reset:!0}:t.singleLineOrCol&&r.some(function(n){return n.range.rowCount>1&&n.range.colCount>1})?{message:a()("数据范围需为单个单元格、行或者列"),reset:!0}:r.every(function(n){return o.E.isRangeReadable(n.range)})?void 0:{message:a()("不能引用锁定禁止查看的单元格"),reset:!0}:{message:a()("引用范围超出工作表范围"),reset:!0}}},I=function(n){var t=n.chart,e=n.A,o=n.reader,p=n.setIsRangeSelecting,C=n.seriesIndex,I=n.setSeriesIndex,S=n.onChange,D=s.a[t.settings.chartType],k=Object(c.useRef)(null),z=d.a.Operations.switchRowColumn.getStatus(t.settings.series),L=d.a.Series.extractUnionRange(t.settings.series),T=t.settings.series.length?v.a.stringify(L,{parentheses:!1})||a()("范围过于复杂，无法显示"):"",A=t.settings.series[C],E=v.a.stringify(A?A.categoryLabel:[],{parentheses:!1}),B=v.a.stringify(A?A.seriesLabel:[],{parentheses:!1}),R=v.a.stringify(A?A.dataRange:[],{parentheses:!1}),Q=function(n){return!s.a[n].attributes.isSingleSeries};Object(c.useEffect)(function(){if(k&&k.current){var n=k.current.querySelector(".chart-type-item.is-active");n&&(n.scrollIntoViewIfNeeded?n.scrollIntoViewIfNeeded():n.scrollIntoView&&n.scrollIntoView())}},[]),Object(c.useEffect)(function(){var n=Math.max(0,Math.min(t.settings.series.length-1,C));Q(t.settings.chartType)||(n=0),n!==C&&I(n)},[t.settings.series.length,t.settings.chartType]);return u.a.createElement("div",{className:"sidebar-tab data-tab",ref:k},u.a.createElement("section",{className:"section-chart-type"},u.a.createElement("h3",{className:"section-title"},a()("图表类型")),u.a.createElement("div",{className:"section-content"},u.a.createElement("div",{className:"current-chart-type f-v-center"},u.a.createElement("img",{className:"chart-image-sm",src:D.icon}),u.a.createElement("div",{className:"chart-type-name"},D.name())),u.a.createElement("ul",{className:"chart-type-list f-row f-wrap "},l.a.CHART_TYPES.map(function(n){var e=n===t.settings.chartType,r=s.a[n];return u.a.createElement("li",{className:"chart-type-item f-col f-c-center f-m-center "+(e?"is-active":""),key:n,onClick:function(){e||function(n){var e=l.a.getChartName(n);Object(m.b)(m.a.addChart(e));var r=t.settings.colorTheme,i=s.a[n].attributes.isColorMonochrome&&"monochrome"!==r.type?l.a.defaultColorThemeMonochrome:r,a=h.a.createSeries({seriesRefs:t.settings.series,chartType:n,colorTheme:i,chartToInherit:t,reader:o}),c=s.a[n];S(Object(g.a)(t,function(t){t.settings.chartType=n,t.settings.colorTheme=i,t.settings.series=a,Object.assign(t.settings,c.defaultSettings||{})}))}(n)}},u.a.createElement("img",{className:"chart-image",src:r.icon}),u.a.createElement("div",{className:"chart-type-name f-center",title:r.name()},u.a.createElement("span",null,r.name())))})))),u.a.createElement("section",{className:"section-color-theme"},u.a.createElement("h3",{className:"section-title"},a()("图表颜色")),u.a.createElement("div",{className:"section-content"},u.a.createElement(w.a,{colorTheme:t.settings.colorTheme,onChange:function(n){S(Object(g.a)(t,function(t){t.settings.colorTheme=n,t.settings.series=h.a.createSeries({seriesRefs:t.settings.series,chartType:t.settings.chartType,colorTheme:n,reader:o})}))},themes:{multicolor:D.attributes.isColorMonochrome?void 0:f.a.MULTICOLOR_COLORS.map(function(n){return{type:"multicolor",colors:n}}),monochrome:f.a.MONOCHROME_COLORS.map(function(n){return{type:"monochrome",colors:n}})}}))),u.a.createElement("section",{className:"section-data-range"},u.a.createElement("h3",{className:"section-title"},a()("数据范围")),u.a.createElement("div",{className:"section-content"},u.a.createElement(j.a,{label:a()("数据区域"),textValue:T,appendToValueAfterSelect:"no",A:e,singleRange:!1,resetRangeOnQuitSelect:!0,validate:N(e,{}),onCommit:function(n){var e=v.a.parse(n),r=d.a.Series.extractSeries(e,o).series,i=h.a.createSeries({seriesRefs:r,chartType:t.settings.chartType,colorTheme:t.settings.colorTheme,chartToInherit:t,reader:o}),a=Object(g.a)(t,function(n){n.settings.series=i});S(a)},onStartSelect:function(){return p(!0)},onQuitSelect:function(){return p(!1)}}),u.a.createElement(j.a,{label:a()("水平(类别)轴"),textValue:E,appendToValueAfterSelect:"no",A:e,singleRange:!1,resetRangeOnQuitSelect:!0,validate:N(e,{}),onCommit:function(n){var e=v.a.parse(n),r=Object(g.a)(t,function(n){n.settings.series.forEach(function(n){n.categoryLabel=e.map(v.a.appendRefId)})});S(r)},onStartSelect:function(){return p(!0)},onQuitSelect:function(){return p(!1)}}),Q(t.settings.chartType)&&u.a.createElement(O.c,null,u.a.createElement("div",{className:"series-select-label f-v-center"},u.a.createElement(O.d,{label:a()("图例项(系列)")}),u.a.createElement("div",{className:"f-1"}),u.a.createElement("div",{className:"button-add-series",onClick:function(){var n=Object(g.a)(t,function(n){var t=n.settings,e=t.series,r=t.chartType,i=t.colorTheme,a=e;a.push(h.a.createSeriesRefs([],[],A?A.categoryLabel:[])),n.settings.series=h.a.createSeries({seriesRefs:a,chartType:r,colorTheme:i,chartToInherit:n,reader:o})});S(n)},role:"button"},a()("添加系列"))),u.a.createElement(x.b,{showSelectedIcon:!0,onChange:function(n){I(Number(n))}},t.settings.series.filter(function(n,e){return t.settings.chartType!==h.a.ChartType.bubble||e%2==0}).map(function(n,e){var r=e===C;return u.a.createElement(x.a,{value:String(e),key:e,selected:r},function(r){var i=r.role;return u.a.createElement("div",{className:"option-series f-1 f-v-center"},u.a.createElement("div",{className:"series-name f-1"},d.a.Series.getSeriesLabel(n,e,o)),"option"===i&&u.a.createElement("div",{className:"button-remove-series",onClick:function(){var e,r;e=n.id,r=Object(g.a)(t,function(n){var t=n.settings,r=t.series,i=t.chartType,a=t.colorTheme,c=r.filter(function(n){return n.id!==e});n.settings.series=h.a.createSeries({seriesRefs:c,chartType:i,colorTheme:a,chartToInherit:n,reader:o})}),S(r)}}))})}))),u.a.createElement(j.a,{inline:!0,label:a()("名称"),textValue:B,disabled:!A,appendToValueAfterSelect:"no",A:e,singleRange:!0,resetRangeOnQuitSelect:!0,validate:N(e,{singleRange:!0,singleLineOrCol:!0}),onCommit:function(n){var e=v.a.parse(n),r=Object(g.a)(t,function(n){var t=A&&n.settings.series.find(function(n){return n.id===A.id});t&&(t.seriesLabel=e.map(v.a.appendRefId))});S(r)},onStartSelect:function(){return p(!0)},onQuitSelect:function(){return p(!1)}}),u.a.createElement(j.a,{inline:!0,label:a()("Y值"),textValue:R,disabled:!A,appendToValueAfterSelect:"no",A:e,singleRange:!1,resetRangeOnQuitSelect:!0,validate:N(e,{}),onCommit:function(n){var e=v.a.parse(n),r=Object(g.a)(t,function(n){var t=A&&n.settings.series.find(function(n){return n.id===A.id});t&&(t.dataRange=e.map(v.a.appendRefId)),n.settings.series=h.a.createSeries({seriesRefs:n.settings.series,chartType:n.settings.chartType,colorTheme:n.settings.colorTheme,chartToInherit:n,reader:o})});S(r)},onStartSelect:function(){return p(!0)},onQuitSelect:function(){return p(!1)}}),D.attributes.supportSummaryCount&&u.a.createElement(y.a,{label:a()("汇总计数"),checked:t.settings.summaryCount,disabled:!1,onChange:function(){var n=Object(g.a)(t,function(n){n.settings.summaryCount=!n.settings.summaryCount});S(n)}}),u.a.createElement(y.a,{label:a()("切换行/列"),checked:z.isActive,disabled:!z.isAvailable,onChange:function(){if(z.isAvailable){var n=d.a.Operations.switchRowColumn.switch(t.settings.series,o);if(n){var e=Object(g.a)(t,function(t){t.settings.series=h.a.createSeries({seriesRefs:n,chartType:t.settings.chartType,colorTheme:t.settings.colorTheme,chartToInherit:t,reader:o})});S(e)}}}}),["seriesLabel","categoryLabel"].map(function(n){var e=d.a.Operations.firstAs.getStatus(n,t.settings.series);if(e.isAvailable){var c={categoryLabel:a()("类别名"),seriesLabel:a()("系列名")}[n];return u.a.createElement(y.a,{key:n,label:"row"===e.rowOrColType?a()(r||(r=M(["第 "," 行作为",""],["第 "," 行作为",""])),e.rowOrColIndex+1,c):a()(i||(i=M(["第 "," 列作为",""],["第 "," 列作为",""])),Object(b.c)(e.rowOrColIndex),c),checked:e.isActive,disabled:!e.isAvailable,onChange:function(){if(e.isAvailable){var r=d.a.Operations.firstAs.switch(n,t.settings.series);if(r){var i=Object(g.a)(t,function(n){n.settings.series=h.a.createSeries({seriesRefs:r,chartType:n.settings.chartType,colorTheme:n.settings.colorTheme,chartToInherit:n,reader:o})});S(i)}}}})}}),u.a.createElement(y.a,{label:a()("显示隐藏值"),checked:!t.settings.plotVisibleDataOnly,disabled:0===t.settings.series.length,onChange:function(){var n=Object(g.a)(t,function(n){n.settings.plotVisibleDataOnly=!n.settings.plotVisibleDataOnly});S(n)}}))))}},3257:function(n,t,e){var r=e(3258);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3258:function(n,t,e){var r=e(1857);(n.exports=e(1854)(!1)).push([n.i,".chart-checkbox-field {\n  min-height: 20px; }\n  .chart-checkbox-field .chart-checkbox {\n    -webkit-appearance: none;\n    width: 14px;\n    min-width: 14px;\n    max-width: 14px;\n    height: 14px;\n    min-height: 14px;\n    max-height: 14px;\n    border-radius: initial;\n    border: none;\n    box-shadow: none;\n    outline: none;\n    margin: 0;\n    background-position: center;\n    background-repeat: no-repeat;\n    background-size: contain;\n    cursor: pointer;\n    background-image: url("+r(e(3259))+"); }\n    .chart-checkbox-field .chart-checkbox:hover {\n      background-image: url("+r(e(3260))+"); }\n    .chart-checkbox-field .chart-checkbox:disabled {\n      background-image: url("+r(e(3261))+");\n      cursor: not-allowed; }\n    .chart-checkbox-field .chart-checkbox:checked {\n      background-image: url("+r(e(3262))+"); }\n      .chart-checkbox-field .chart-checkbox:checked:hover {\n        background-image: url("+r(e(3263))+"); }\n      .chart-checkbox-field .chart-checkbox:checked:disabled {\n        background-image: url("+r(e(3264))+"); }\n  .chart-checkbox-field .chart-checkbox-label {\n    margin-left: 10px;\n    user-select: none;\n    color: #333; }\n    .chart-checkbox-field .chart-checkbox-label.is-disabled {\n      opacity: 0.3; }\n  .chart-checkbox-field + .chart-checkbox-field {\n    margin-top: 8px; }\n",""])},3259:function(n,t,e){n.exports=e.p+"images/toggle_multiple.f0688def2c.png"},3260:function(n,t,e){n.exports=e.p+"images/toggle_multiple_hover.941da50b75.png"},3261:function(n,t,e){n.exports=e.p+"images/toggle_multiple_disabled.12238b077b.png"},3262:function(n,t,e){n.exports=e.p+"images/toggle_multiple_selected.1d3c42ad2b.png"},3263:function(n,t,e){n.exports=e.p+"images/toggle_multiple_selected_hover.dc62000e7e.png"},3264:function(n,t,e){n.exports=e.p+"images/toggle_multiple_selected_disabled.4cbfae84de.png"},3265:function(n,t,e){var r=e(3266);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3266:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,".chart-input-field {\n  margin-bottom: 15px; }\n  .chart-input-field > .chart-label {\n    margin-bottom: 6px; }\n\n.chart-label {\n  display: block;\n  color: #a5a5a5; }\n\n.chart-error {\n  margin: 8px 0;\n  font-size: 12px;\n  color: #cd4747; }\n\ninput.chart-input {\n  -webkit-appearance: none;\n  box-sizing: border-box;\n  outline: none;\n  display: block;\n  width: 100%;\n  min-width: 0;\n  resize: none;\n  line-height: 1.5;\n  padding: 7px 16px;\n  font-size: 12px;\n  color: #333;\n  border-radius: 2px;\n  background-color: #fff;\n  background-image: none;\n  border: 1px solid #e5e5e5;\n  box-shadow: inset 0 1px 3px -1px #e5e5e5;\n  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out; }\n  input.chart-input:-moz-placeholder {\n    color: #cdcdcd; }\n  input.chart-input::-moz-placeholder {\n    color: #cdcdcd;\n    opacity: 1; }\n  input.chart-input:-ms-input-placeholder {\n    color: #cdcdcd !important; }\n  input.chart-input::-webkit-input-placeholder {\n    color: #cdcdcd; }\n  input.chart-input::placeholder {\n    color: #cdcdcd !important; }\n  input.chart-input::-ms-clear {\n    display: none; }\n  input.chart-input:hover {\n    border: 1px solid #cccccc; }\n  input.chart-input:focus {\n    border: 1px solid #a5a5a5; }\n  input.chart-input[disabled] {\n    background-color: #f7f7f7;\n    border: 1px solid #e5e5e5;\n    cursor: not-allowed; }\n",""])},3267:function(n,t,e){"use strict";e.d(t,"a",function(){return h});var r=e(3),i=e(1),o=e.n(i),a=e(2107),c=e(2134),u=e(2361),s=e(3268),f=(e.n(s),this&&this.__assign||function(){return(f=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)}),l=this&&this.__rest||function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e},d=r.sheets.range.RangeInput,h=function(n){var t=n.label,e=n.validate,r=n.inline,s=n.children,h=n.textValue,v=n.onCommit,b=l(n,["label","validate","inline","children","textValue","onCommit"]),g=Object(i.useState)(""),p=g[0],m=g[1],y=Object(i.useState)(""),O=y[0],j=y[1];Object(i.useEffect)(function(){m(h);var n=e&&e(h);j(n&&n.message||"")},[h]);var x=function(n){if(n!==h){var t=e&&e(n);t?(t.reset&&m(h),j(t.message)):(j(""),v&&v(n))}};return s?o.a.createElement("div",{className:"chart-range-field "+(r?"is-inline":"")},s):o.a.createElement("div",{className:"chart-range-field"},o.a.createElement("div",{className:"chart-range-input "+(r?"is-inline":"")},t?o.a.createElement(u.d,{label:t}):null,o.a.createElement(d,f({textValue:p,invalid:Boolean(O),onEnter:function(n){var t=n.textValue;m(t),x(t)},onBlur:function(n){var t=n.textValue;m(t),x(t)},onChange:function(n){var t=n.textValue,e=n.isChangeFromSelect;m(t),j(""),e&&x(t)},showSelectionsOnSheet:function(n){if(!n)return!1;var t=c.a.parse(n);if(!t||0===t.length)return!1;var e=b.A.spread.B(),r=e&&e.name;return a.a.getSingleSheetName(t)===r}(p)},b))),O?o.a.createElement(u.b,{error:O}):null)}},3268:function(n,t,e){var r=e(3269);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3269:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,".chart-range-field {\n  margin-bottom: 15px; }\n  .chart-range-field .chart-label {\n    margin-bottom: 6px; }\n  .chart-range-field .sm-range-input {\n    flex-grow: 1;\n    width: 100%; }\n  .chart-range-field .is-inline {\n    display: flex;\n    flex-direction: row;\n    align-items: center; }\n    .chart-range-field .is-inline > .chart-label {\n      white-space: nowrap;\n      min-width: 37px; }\n    .chart-range-field .is-inline > .chart-range-input {\n      flex-grow: 1; }\n  .chart-range-field input {\n    min-height: 34px; }\n",""])},3270:function(n,t,e){var r=e(3271);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3271:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,".chart-select {\n  box-sizing: border-box;\n  color: #333;\n  border: 1px solid #e5e5e5;\n  border-radius: 2px;\n  line-height: 32px;\n  position: relative;\n  user-select: none;\n  cursor: pointer;\n  min-width: 0; }\n  .chart-select.is-active, .chart-select:hover {\n    border-color: #ccc; }\n  .chart-select .icon-dropdown {\n    margin-left: 10px;\n    min-width: 6px;\n    min-height: 4px;\n    border-top: 4px solid #888;\n    border-left: 3px solid transparent;\n    border-right: 3px solid transparent; }\n  .chart-select .current-option {\n    min-width: 150px;\n    min-height: 32px;\n    height: 32px;\n    padding: 0 15px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap; }\n  .chart-select .current-option-content {\n    min-width: 0;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .chart-select .option-list {\n    position: absolute;\n    z-index: 1;\n    bottom: -3px;\n    left: 0;\n    right: 0;\n    transform: translateY(100%);\n    max-height: 304px;\n    overflow-y: scroll;\n    overflow-x: hidden;\n    padding: 5px 0;\n    font-size: 12px;\n    margin: 0;\n    box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.1);\n    background: #fff; }\n\n.chart-select-option {\n  position: relative;\n  padding-left: 15px;\n  min-height: 32px;\n  height: 32px;\n  cursor: pointer;\n  overflow-x: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis; }\n  .chart-select-option[data-selected='true'] {\n    background: #f5f5f5; }\n  .chart-select-option:hover {\n    background: #f5f5f5; }\n  .chart-select-option .option-empty {\n    color: #888; }\n\n.chart-select.show-checkmark .chart-select-option {\n  padding-left: 40px; }\n  .chart-select.show-checkmark .chart-select-option[data-selected='true'] {\n    background: #f5f5f5; }\n    .chart-select.show-checkmark .chart-select-option[data-selected='true']::before {\n      content: ' ';\n      display: block;\n      background-image: url(\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjAgMCAyMCAyMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT5SZWN0YW5nbGUgNTY8L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGRlZnM+PC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4gICAgICAgIDxnIGlkPSJHcm91cC0yMyIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2U9IiM2NjY2NjYiPiAgICAgICAgICAgIDxwb2x5bGluZSBpZD0iUmVjdGFuZ2xlLTEwNzMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwLjUwMDAwMCwgOC4wMTE0NzgpIHJvdGF0ZSgtMzE1LjAwMDAwMCkgdHJhbnNsYXRlKC0xMC41MDAwMDAsIC04LjAxMTQ3OCkgIiBwb2ludHM9IjE0IDEuMDAxNDM0NzIgMTQgMTUuMDIxNTIwOCA3IDE1LjAyMTUyMDgiPjwvcG9seWxpbmU+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=\");\n      width: 12px;\n      height: 12px;\n      background-size: contain;\n      position: absolute;\n      left: 16px;\n      top: 50%;\n      transform: translateY(-50%); }\n",""])},3272:function(n,t,e){"use strict";e.d(t,"a",function(){return d});var r=e(0),i=e.n(r),o=e(1),a=e.n(o),c=e(2133),u=e(2137),s=e(2362),f=e(3273),l=(e.n(f),function(n){var t=n.colorTheme;return a.a.createElement("div",{className:"color-theme-display f-v-center"},function(n,t){return void 0===t&&(t=6),Object(u.a)(t).map(function(e,r){return c.a.getColorFromTheme(n,r,t)})}(t).map(function(n,t){return a.a.createElement("div",{className:"color",key:n,style:{backgroundColor:n}})}))}),d=function(n){var t=n.colorTheme,e=n.onChange,r=n.themes;return a.a.createElement("div",{className:"color-theme-select"},a.a.createElement(s.b,{onChange:function(n){var t=n.split("-"),i=t[0],o=t[1],a=r[i][Number(o)];e(a)}},r.multicolor&&a.a.createElement("div",{className:"theme-group-title f-v-center"},i()("多色")),r.multicolor&&r.multicolor.map(function(n,e){return a.a.createElement(s.a,{value:"multicolor-"+e,key:e,selected:c.a.isSameColorTheme(n,t)},a.a.createElement(l,{colorTheme:n}))}),r.monochrome&&a.a.createElement("div",{className:"theme-group-title f-v-center"},i()("单色")),r.monochrome&&r.monochrome.map(function(n,e){return a.a.createElement(s.a,{value:"monochrome-"+e,key:e,selected:c.a.isSameColorTheme(n,t)},a.a.createElement(l,{colorTheme:n}))})))}},3273:function(n,t,e){var r=e(3274);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3274:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,".color-theme-display .color {\n  margin-right: 2px;\n  width: 20px;\n  height: 20px; }\n\n.color-theme-select {\n  width: 174px; }\n  .color-theme-select .theme-group-title {\n    color: #a5a5a5;\n    padding-left: 12px;\n    height: 34px; }\n",""])},3275:function(n,t,e){var r=e(3276);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3276:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,".sidebar-tab.data-tab .section-chart-type .current-chart-type {\n  height: 40px;\n  border-bottom: 1px solid #e5e5e5; }\n  .sidebar-tab.data-tab .section-chart-type .current-chart-type .chart-image-sm {\n    width: 24px; }\n  .sidebar-tab.data-tab .section-chart-type .current-chart-type .chart-type-name {\n    margin-left: 8px; }\n\n.sidebar-tab.data-tab .section-chart-type .chart-type-list {\n  width: 296px;\n  height: 220px;\n  margin-top: 15px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  line-height: 0;\n  padding: 2px 10px 0 2px; }\n  .sidebar-tab.data-tab .section-chart-type .chart-type-list::-webkit-scrollbar {\n    width: 3px;\n    background-color: transparent; }\n  .sidebar-tab.data-tab .section-chart-type .chart-type-list::-webkit-scrollbar-thumb {\n    border-radius: 1.5px;\n    background-color: #d8d8d8; }\n  .sidebar-tab.data-tab .section-chart-type .chart-type-list .chart-type-item {\n    width: 84px;\n    height: 72px;\n    margin-bottom: 10px;\n    border: 1px solid rgba(0, 0, 0, 0.1);\n    border-radius: 2px;\n    font-size: 11px;\n    color: #666666;\n    margin-right: 7px;\n    cursor: pointer; }\n    .sidebar-tab.data-tab .section-chart-type .chart-type-list .chart-type-item:nth-child(3n) {\n      margin-right: 0px; }\n    .sidebar-tab.data-tab .section-chart-type .chart-type-list .chart-type-item.is-active {\n      border: 2px solid #6da0e3; }\n    .sidebar-tab.data-tab .section-chart-type .chart-type-list .chart-type-item .chart-image {\n      width: 50px;\n      height: 36px; }\n    .sidebar-tab.data-tab .section-chart-type .chart-type-list .chart-type-item .chart-type-name {\n      min-height: 12px;\n      height: 12px;\n      max-width: 100%;\n      margin-top: 5px;\n      font-size: 11px;\n      color: #666; }\n      .sidebar-tab.data-tab .section-chart-type .chart-type-list .chart-type-item .chart-type-name span {\n        height: 12px;\n        line-height: 12px;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis; }\n    .sidebar-tab.data-tab .section-chart-type .chart-type-list .chart-type-item .new-chart-type-dot {\n      display: inline-block;\n      background: #6da0e3;\n      width: 6px;\n      height: 6px;\n      margin-right: 4px;\n      border-radius: 100%; }\n\n.sidebar-tab.data-tab .section-data-range .series-select-label {\n  margin-bottom: 6px; }\n  .sidebar-tab.data-tab .section-data-range .series-select-label .button-add-series {\n    min-width: 64px;\n    padding: 0 8px;\n    height: 22px;\n    line-height: 22px;\n    text-align: center;\n    border-radius: 2px;\n    border: solid 1px #e5e5e5;\n    background-image: linear-gradient(to bottom, #ffffff, #fafafa);\n    font-size: 12px;\n    color: #666666;\n    cursor: pointer; }\n    .sidebar-tab.data-tab .section-data-range .series-select-label .button-add-series:hover {\n      border: solid 1px #cccccc; }\n\n.sidebar-tab.data-tab .section-data-range .option-series {\n  overflow: hidden; }\n  .sidebar-tab.data-tab .section-data-range .option-series .series-name {\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .sidebar-tab.data-tab .section-data-range .option-series .button-remove-series {\n    display: none;\n    width: 20px;\n    min-width: 20px;\n    height: 20px;\n    margin-right: 10px;\n    background-position: center;\n    background-repeat: no-repeat;\n    background-size: 12px auto;\n    background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT5Db21iaW5lZCBTaGFwZSBDb3B5PC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPiAgICAgICAgPGcgaWQ9IuWbvuihqOS+p+i+ueagj0AyeCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM0ODAuMDAwMDAwLCAtMTgwNC4wMDAwMDApIiBmaWxsPSIjQ0NDQ0NDIj4gICAgICAgICAgICA8cGF0aCBkPSJNMzQ5My42NDk5MiwxODE2IEwzNDk3Ljc3NDcxLDE4MTEuODc1MjEgQzM0OTguMjMwMzIsMTgxMS40MTk2IDM0OTguMjMwMzIsMTgxMC42ODA5MSAzNDk3Ljc3NDcxLDE4MTAuMjI1MjkgQzM0OTcuMzE5MDksMTgwOS43Njk2OCAzNDk2LjU4MDQsMTgwOS43Njk2OCAzNDk2LjEyNDc5LDE4MTAuMjI1MjkgTDM0OTIsMTgxNC4zNTAwOCBMMzQ4Ny44NzUyMSwxODEwLjIyNTI5IEMzNDg3LjQxOTYsMTgwOS43Njk2OCAzNDg2LjY4MDkxLDE4MDkuNzY5NjggMzQ4Ni4yMjUyOSwxODEwLjIyNTI5IEMzNDg1Ljc2OTY4LDE4MTAuNjgwOTEgMzQ4NS43Njk2OCwxODExLjQxOTYgMzQ4Ni4yMjUyOSwxODExLjg3NTIxIEwzNDkwLjM1MDA4LDE4MTYgTDM0ODYuMjI1MjksMTgyMC4xMjQ3OSBDMzQ4NS43Njk2OCwxODIwLjU4MDQgMzQ4NS43Njk2OCwxODIxLjMxOTA5IDM0ODYuMjI1MjksMTgyMS43NzQ3MSBDMzQ4Ni42ODA5MSwxODIyLjIzMDMyIDM0ODcuNDE5NiwxODIyLjIzMDMyIDM0ODcuODc1MjEsMTgyMS43NzQ3MSBMMzQ5MiwxODE3LjY0OTkyIEwzNDk2LjEyNDc5LDE4MjEuNzc0NzEgQzM0OTYuNTgwNCwxODIyLjIzMDMyIDM0OTcuMzE5MDksMTgyMi4yMzAzMiAzNDk3Ljc3NDcxLDE4MjEuNzc0NzEgQzM0OTguMjMwMzIsMTgyMS4zMTkwOSAzNDk4LjIzMDMyLDE4MjAuNTgwNCAzNDk3Ljc3NDcxLDE4MjAuMTI0NzkgTDM0OTMuNjQ5OTIsMTgxNiBaIE0zNDkyLDE4MjggQzM0ODUuMzcyNTgsMTgyOCAzNDgwLDE4MjIuNjI3NDIgMzQ4MCwxODE2IEMzNDgwLDE4MDkuMzcyNTggMzQ4NS4zNzI1OCwxODA0IDM0OTIsMTgwNCBDMzQ5OC42Mjc0MiwxODA0IDM1MDQsMTgwOS4zNzI1OCAzNTA0LDE4MTYgQzM1MDQsMTgyMi42Mjc0MiAzNDk4LjYyNzQyLDE4MjggMzQ5MiwxODI4IFoiIGlkPSJDb21iaW5lZC1TaGFwZS1Db3B5Ij48L3BhdGg+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=); }\n    .sidebar-tab.data-tab .section-data-range .option-series .button-remove-series:hover {\n      background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT5Db21iaW5lZCBTaGFwZSBDb3B5IDI8L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+ICAgICAgICA8ZyBpZD0i5Zu+6KGo5L6n6L655qCPQDJ4IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzQ4MC4wMDAwMDAsIC0xODY0LjAwMDAwMCkiIGZpbGw9IiM2NjY2NjYiPiAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNDkzLjY0OTkyLDE4NzYgTDM0OTcuNzc0NzEsMTg3MS44NzUyMSBDMzQ5OC4yMzAzMiwxODcxLjQxOTYgMzQ5OC4yMzAzMiwxODcwLjY4MDkxIDM0OTcuNzc0NzEsMTg3MC4yMjUyOSBDMzQ5Ny4zMTkwOSwxODY5Ljc2OTY4IDM0OTYuNTgwNCwxODY5Ljc2OTY4IDM0OTYuMTI0NzksMTg3MC4yMjUyOSBMMzQ5MiwxODc0LjM1MDA4IEwzNDg3Ljg3NTIxLDE4NzAuMjI1MjkgQzM0ODcuNDE5NiwxODY5Ljc2OTY4IDM0ODYuNjgwOTEsMTg2OS43Njk2OCAzNDg2LjIyNTI5LDE4NzAuMjI1MjkgQzM0ODUuNzY5NjgsMTg3MC42ODA5MSAzNDg1Ljc2OTY4LDE4NzEuNDE5NiAzNDg2LjIyNTI5LDE4NzEuODc1MjEgTDM0OTAuMzUwMDgsMTg3NiBMMzQ4Ni4yMjUyOSwxODgwLjEyNDc5IEMzNDg1Ljc2OTY4LDE4ODAuNTgwNCAzNDg1Ljc2OTY4LDE4ODEuMzE5MDkgMzQ4Ni4yMjUyOSwxODgxLjc3NDcxIEMzNDg2LjY4MDkxLDE4ODIuMjMwMzIgMzQ4Ny40MTk2LDE4ODIuMjMwMzIgMzQ4Ny44NzUyMSwxODgxLjc3NDcxIEwzNDkyLDE4NzcuNjQ5OTIgTDM0OTYuMTI0NzksMTg4MS43NzQ3MSBDMzQ5Ni41ODA0LDE4ODIuMjMwMzIgMzQ5Ny4zMTkwOSwxODgyLjIzMDMyIDM0OTcuNzc0NzEsMTg4MS43NzQ3MSBDMzQ5OC4yMzAzMiwxODgxLjMxOTA5IDM0OTguMjMwMzIsMTg4MC41ODA0IDM0OTcuNzc0NzEsMTg4MC4xMjQ3OSBMMzQ5My42NDk5MiwxODc2IFogTTM0OTIsMTg4OCBDMzQ4NS4zNzI1OCwxODg4IDM0ODAsMTg4Mi42Mjc0MiAzNDgwLDE4NzYgQzM0ODAsMTg2OS4zNzI1OCAzNDg1LjM3MjU4LDE4NjQgMzQ5MiwxODY0IEMzNDk4LjYyNzQyLDE4NjQgMzUwNCwxODY5LjM3MjU4IDM1MDQsMTg3NiBDMzUwNCwxODgyLjYyNzQyIDM0OTguNjI3NDIsMTg4OCAzNDkyLDE4ODggWiIgaWQ9IkNvbWJpbmVkLVNoYXBlLUNvcHktMiI+PC9wYXRoPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+); }\n  .sidebar-tab.data-tab .section-data-range .option-series:hover .button-remove-series {\n    display: block; }\n",""])},3277:function(n,t,e){"use strict";e.d(t,"a",function(){return m});var r=e(0),i=e.n(r),o=e(1),a=e.n(o),c=e(2129),u=e(2139),s=e(2107),f=e(2124),l=e(2194),d=e(2511),h=e(2361),v=e(3278),b=e(2362),g=e(3282);e.n(g);function p(n){n.settings.axes=n.settings.axes||u.a.defaultChartAxes()}var m=function(n){var t=n.chart,e=n.reader,r=n.seriesIndex,g=n.setSeriesIndex,m=n.onChange,y=Object(o.useState)(0),O=y[0],j=y[1],x=t.settings,w=x.chartTitle,C=x.axes,M=void 0===C?u.a.defaultChartAxes():C,N=x.legendPosition,I=x.legendVisible,S=x.chartType,D=x.colorTheme,k=c.a[S],z=k.attributes.useSectorColor,L=k.attributes.useSeriesColor,T=k.attributes.isRectangular,A=k.attributes.isSingleSeries,E=k.attributes.isAxisInverted,B=A?t.settings.series[0]:t.settings.series[r],R=z?k.attributes.getSectors(B,D,e):[];return a.a.createElement("div",{className:"sidebar-tab style-tab"},a.a.createElement("section",{className:"section-title-and-axis"},a.a.createElement("h3",{className:"section-title"},i()("标题和坐标轴")),a.a.createElement("div",{className:"section-content"},a.a.createElement(h.c,{label:i()("图表标题"),placeholder:i()("最多可输入200个字符"),maxLength:200,defaultValue:w,onCommit:function(n){return m(Object(l.a)(t,function(t){t.settings.chartTitle=n.trim().slice(0,200)}))}}),T&&a.a.createElement(h.c,{label:E?i()("垂直(类别)轴标题"):i()("水平(类别)轴标题"),placeholder:i()("最多可输入100个字符"),maxLength:100,defaultValue:M.primaryCategory.title.text,onCommit:function(n){return m(Object(l.a)(t,function(t){p(t),t.settings.axes.primaryCategory.title.text=n.trim().slice(0,100)}))}}),T&&a.a.createElement(h.c,{label:E?i()("水平(值)轴标题"):i()("垂直(值)轴标题"),placeholder:i()("最多可输入100个字符"),maxLength:100,defaultValue:M.primaryValue.title.text,onCommit:function(n){return m(Object(l.a)(t,function(t){p(t),t.settings.axes.primaryValue.title.text=n.trim().slice(0,100)}))}}),T&&a.a.createElement(h.c,null,a.a.createElement(h.d,{label:i()("自定义值轴范围")}),a.a.createElement("div",{className:"f-v-center"},a.a.createElement(h.a,{placeholder:i()("最小值"),defaultValue:"number"==typeof M.primaryValue.min?String(M.primaryValue.min):"",onCommit:function(n){var e=""===n?void 0:parseFloat(n);if(e!=e)return!1;m(Object(l.a)(t,function(n){p(n),n.settings.axes.primaryValue.min=e}))}}),a.a.createElement(h.a,{placeholder:i()("最大值"),defaultValue:"number"==typeof M.primaryValue.max?String(M.primaryValue.max):"",onCommit:function(n){var e=""===n?void 0:parseFloat(n);if(e!=e)return!1;m(Object(l.a)(t,function(n){p(n),n.settings.axes.primaryValue.max=e}))}}),a.a.createElement("div",{className:"reset-button",onClick:function(){m(Object(l.a)(t,function(n){p(n),n.settings.axes.primaryValue.min=void 0,n.settings.axes.primaryValue.max=void 0}))}},i()("重置")))))),!k.attributes.hideLegend&&a.a.createElement("section",{className:"section-legend"},a.a.createElement("h3",{className:"section-title"},i()("图例")),a.a.createElement("div",{className:"section-content"},a.a.createElement(b.b,{showSelectedIcon:!0,onChange:function(n){m(Object(l.a)(t,function(t){t.settings.legendPosition="none"===n?void 0:Number(n),t.settings.legendVisible="none"!==n}))}},[{name:i()("右侧"),value:String(f.a.LegendPosition.right)},{name:i()("左侧"),value:String(f.a.LegendPosition.left)},{name:i()("上方"),value:String(f.a.LegendPosition.top)},{name:i()("下方"),value:String(f.a.LegendPosition.bottom)},{name:i()("无"),value:"none"}].map(function(n){var t=I&&N?String(N):"none";return a.a.createElement(b.a,{key:String(n.value),value:String(n.value),selected:n.value===t},n.name)})))),L&&a.a.createElement("section",{className:"section-series"},a.a.createElement("h3",{className:"section-title"},i()("系列")),a.a.createElement("div",{className:"section-content"},a.a.createElement("div",{className:"series-color-setting f-v-center"},a.a.createElement(b.b,{showSelectedIcon:!0,onChange:function(n){g(Number(n))}},t.settings.series.map(function(n,t){return a.a.createElement(b.a,{key:String(t),value:String(t),selected:t===r},s.a.Series.getSeriesLabel(n,t,e))})),a.a.createElement(v.b,{key:r,color:B&&B.color,onChange:function(n){m(Object(l.a)(t,function(t){var e=t.settings.series[r];e&&(e.color=n)}))}},a.a.createElement("div",{className:"color-item-select f-center"},a.a.createElement(v.a,{noHoverEffect:!0,color:B&&B.color}),a.a.createElement("div",{className:"icon-dropdown"})))))),z&&!t.settings.summaryCount&&B&&a.a.createElement("section",{className:"section-sector"},a.a.createElement("h3",{className:"section-title"},i()("扇区")),a.a.createElement("div",{className:"section-content"},a.a.createElement("div",{className:"sector-color-setting f-v-center"},a.a.createElement(b.b,{showSelectedIcon:!0,onChange:function(n){j(Number(n))}},R.map(function(n,t){return a.a.createElement(b.a,{key:String(t),value:String(t),selected:t===O},n.label)})),a.a.createElement(v.b,{key:O,color:R[O]?R[O].color:void 0,onChange:function(n){m(Object(l.a)(t,function(t){var e=t.settings.series.find(function(n){return n.id===B.id});e&&e.sectorColors[O]&&(e.sectorColors[O]=n)}))}},a.a.createElement("div",{className:"color-item-select f-center"},a.a.createElement(v.a,{noHoverEffect:!0,color:R[O]?R[O].color:void 0}),a.a.createElement("div",{className:"icon-dropdown"})))))),a.a.createElement("section",{className:"section-reference-lines"},a.a.createElement("h3",{className:"section-title"},i()("参考线")),a.a.createElement("div",{className:"section-content"},a.a.createElement(d.a,{label:i()("数据标签"),checked:t.settings.dataLabels,onChange:function(n){m(Object(l.a)(t,function(t){t.settings.dataLabels=n.target.checked}))}}),T&&a.a.createElement(d.a,{label:i()("值轴网格线"),checked:M.primaryValue.majorGridLine.visible,onChange:function(n){m(Object(l.a)(t,function(t){p(t),t.settings.axes.primaryValue.majorGridLine.visible=n.target.checked}))}}),T&&a.a.createElement(d.a,{label:i()("类别轴网格线"),checked:M.primaryCategory.majorGridLine.visible,onChange:function(n){m(Object(l.a)(t,function(t){p(t),t.settings.axes.primaryCategory.majorGridLine.visible=n.target.checked}))}}))))}},3278:function(n,t,e){"use strict";e.d(t,"a",function(){return u}),e.d(t,"b",function(){return f});var r=e(1),i=e.n(r),o=e(2133),a=e(3279),c=e(3280),u=(e.n(c),function(n){var t=n.color,e=n.colorName,r=n.isSelected,o=n.noHoverEffect,a=void 0!==o&&o,c=n.onSelect;return i.a.createElement("div",{className:"chart-color-item "+(r?"is-selected":"")+" "+(a?"no-hover-effect":""),style:{backgroundColor:t||"white"},onClick:function(){return c&&t&&c(t)}},e?i.a.createElement("div",{className:"color-name"},e):null)}),s=function(n){var t=n.color,e=n.onChange,c=function(){var n=t&&o.a.parse(t);return n?o.a.toHex(n).slice(1):""},s=Object(r.useState)(c),f=s[0],l=s[1],d=function(n){var t=o.a.parse(n.startsWith("#")?n:"#"+n);if(t){var r=o.a.toHex(t);l(r.slice(1)),e(r)}else l(c())};return i.a.createElement("div",{className:"chart-color-palette"},i.a.createElement("div",{className:"color-list"},a.b.map(function(n,e){return i.a.createElement(u,{color:n,colorName:a.a[e],key:e,isSelected:o.a.isSameColor(n,t),onSelect:d})})),i.a.createElement("div",{className:"color-input f-center"},i.a.createElement(u,{color:t||"#ffffff"}),i.a.createElement("div",{className:"color-prefix"},"#"),i.a.createElement("input",{type:"text",value:f,onChange:function(n){return l(n.target.value)},onKeyPress:function(n){return"Enter"===n.key&&d(n.target.value)},onBlur:function(n){return d(n.target.value)}})))},f=function(n){var t=n.color,e=n.onChange,o=n.children,a=Object(r.useState)(!1),c=a[0],u=a[1],f=Object(r.useRef)(null);Object(r.useEffect)(function(){var n=function(n){n&&n.target&&c&&f.current&&(n.target===f.current||f.current.contains(n.target)||u(!1))};return c?document.addEventListener("click",n):document.removeEventListener("click",n),function(){document.removeEventListener("click",n)}},[c]);return i.a.createElement("div",{className:"chart-color-picker "+(c?"is-active":""),ref:f},i.a.createElement("div",{onClick:function(){u(!c)}},o),c&&i.a.createElement(s,{color:t,onChange:function(n){e(n),u(!1)}}))}},3279:function(n,t,e){"use strict";e.d(t,"a",function(){return o}),e.d(t,"b",function(){return a});var r=e(0),i=e.n(r),o=[i()("无填充"),i()("漆黑"),i()("红"),i()("橙"),i()("黄"),i()("葱绿"),i()("湖蓝"),i()("天色"),i()("藤紫"),i()("白练"),i()("白鼠"),i()("樱"),i()("缟"),i()("练"),i()("芽"),i()("水"),i()("缥"),i()("丁香"),i()("灰青"),i()("鼠"),i()("虹"),i()("落柿"),i()("花叶"),i()("白绿"),i()("天青"),i()("天空"),i()("水晶"),i()("薄钝"),i()("墨"),i()("甚三红"),i()("珊瑚"),i()("金"),i()("薄青"),i()("白群"),i()("薄花"),i()("紫苑"),i()("石墨"),i()("黑"),i()("绯红"),i()("棕黄"),i()("土黄"),i()("苍翠"),i()("孔雀"),i()("琉璃"),i()("青莲")],a=["#FFFFFF","#0d0015","#fe2c23","#ff9900","#ffd900","#a3e043","#37d9f0","#4da8ee","#956FE7","#F3F3F4","#CCCCCC","#FEF2F0","#FEF5E7","#FEFCD9","#EDF6E8","#E6FAFA","#EBF4FC","#F0EDF6","#D7D8D9","#A5A5A5","#FBD4D0","#FFD7B9","#F9EDA6","#d4e9d6","#C7E6EA","#CCE0F1","#DAD5E9","#7B7F83","#494949","#EE7976","#FAA573","#e6b322","#98C091","#79C6CD","#6EAAD7","#9C8EC1","#41464B","#333333","#BE1A1D","#B95514","#AD720E","#1C7231","#1C7892","#19439C","#511B78"]},3280:function(n,t,e){var r=e(3281);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3281:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,".chart-color-item {\n  width: 16px;\n  height: 16px;\n  box-sizing: border-box;\n  border: 1px solid #f2f2f2;\n  cursor: pointer;\n  position: relative; }\n  .chart-color-item.is-selected {\n    background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lsYJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDE2IDE2IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxNiAxNjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8ZyBpZD0iUGFnZS0xIiBzdHlsZT0ib3BhY2l0eTowLjc7Ij4KCTxnIGlkPSLpu5Hli74iPgoJCTxnIGlkPSJHcm91cC0yMy1Db3B5LTIyIj4KCQkJPHBvbHlsaW5lIGlkPSJSZWN0YW5nbGUtMTA3MyIgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzMzMzMzMztzdHJva2Utd2lkdGg6Mi4yNTsiIHBvaW50cz0iMTQuMzQ1LDQuNDI0IDYuNDE0LDEyLjM1NSAKCQkJCTIuNDU1LDguMzk1IAkJCSIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8L3N2Zz4K);\n    background-position: center;\n    background-repeat: no-repeat;\n    background-size: 10px 12px; }\n  .chart-color-item .color-name {\n    display: none;\n    position: absolute;\n    z-index: 1;\n    bottom: -7px;\n    left: 50%;\n    transform: translate(-50%, 100%);\n    min-width: 48px;\n    height: 24px;\n    line-height: 24px;\n    border-radius: 2px;\n    background-color: #41464b;\n    font-size: 12px;\n    font-weight: 600;\n    -webkit-font-smoothing: antialiased;\n    white-space: nowrap;\n    color: #fff;\n    pointer-events: none;\n    text-align: center;\n    user-select: none; }\n    .chart-color-item .color-name::before {\n      display: block;\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 50%;\n      transform: translate(-50%, -100%);\n      border-bottom: 4px solid #41464b;\n      border-left: 4px solid transparent;\n      border-right: 4px solid transparent; }\n  .chart-color-item:not(.no-hover-effect):hover {\n    box-shadow: 0 1px 5px #00000091;\n    border: none; }\n    .chart-color-item:not(.no-hover-effect):hover .color-name {\n      display: block; }\n\n.chart-color-palette {\n  display: block;\n  background: #fff;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  padding: 10px 10px;\n  color: #333; }\n  .chart-color-palette .color-list {\n    width: 180px;\n    margin-right: -4px; }\n    .chart-color-palette .color-list .chart-color-item {\n      display: inline-block;\n      margin-right: 4px; }\n  .chart-color-palette .color-input {\n    color: #333;\n    font-weight: 400;\n    font-size: 12px; }\n    .chart-color-palette .color-input .color-prefix {\n      margin: 0 4px;\n      color: #b0b0b1; }\n    .chart-color-palette .color-input input {\n      border: none;\n      width: 60px;\n      height: 19px;\n      padding: 1px; }\n      .chart-color-palette .color-input input:focus {\n        border-radius: 2px;\n        border: 1px solid #e5e5e5;\n        outline: none;\n        box-shadow: none; }\n\n.chart-color-picker {\n  position: relative; }\n  .chart-color-picker .chart-color-palette {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    transform: translateY(100%); }\n",""])},3282:function(n,t,e){var r=e(3283);"string"==typeof r&&(r=[[n.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(1855)(r,i);r.locals&&(n.exports=r.locals)},3283:function(n,t,e){(n.exports=e(1854)(!1)).push([n.i,".sidebar-tab.style-tab .section-title-and-axis input + input {\n  margin-left: 10px; }\n\n.sidebar-tab.style-tab .section-title-and-axis .reset-button {\n  white-space: nowrap;\n  margin-left: 6px;\n  font-size: 12px;\n  color: #6290cc;\n  cursor: pointer;\n  user-select: none; }\n\n.sidebar-tab.style-tab .section-series .chart-select,\n.sidebar-tab.style-tab .section-sector .chart-select {\n  flex-grow: 1; }\n\n.sidebar-tab.style-tab .section-series .color-item-select,\n.sidebar-tab.style-tab .section-sector .color-item-select {\n  margin-left: 10px;\n  width: 63px;\n  height: 34px;\n  box-sizing: border-box;\n  color: #333;\n  border: 1px solid #e5e5e5;\n  border-radius: 2px;\n  line-height: 32px;\n  position: relative;\n  user-select: none;\n  cursor: pointer; }\n  .sidebar-tab.style-tab .section-series .color-item-select.is-active, .sidebar-tab.style-tab .section-series .color-item-select:hover,\n  .sidebar-tab.style-tab .section-sector .color-item-select.is-active,\n  .sidebar-tab.style-tab .section-sector .color-item-select:hover {\n    border-color: #ccc; }\n  .sidebar-tab.style-tab .section-series .color-item-select .icon-dropdown,\n  .sidebar-tab.style-tab .section-sector .color-item-select .icon-dropdown {\n    margin-left: 10px;\n    min-width: 6px;\n    min-height: 4px;\n    border-top: 4px solid #888;\n    border-left: 3px solid transparent;\n    border-right: 3px solid transparent; }\n\n.sidebar-tab.style-tab .section-legend .chart-select {\n  width: 150px; }\n",""])},3284:function(n,t,e){"use strict";e.d(t,"a",function(){return o});var r,i,o,a=e(3),c=e(4),u=e(24),s=e(2137),f=e(2144),l=e(2118),d=e(2195),h=e(2512),v=e(3285),b=e(2140),g=e(2138),p=e(2194),m=e(2107),y=e(2124),O=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),j=this&&this.__assign||function(){return(j=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},x=this&&this.__spreadArrays||function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),i=0;for(t=0;t<e;t++)for(var o=arguments[t],a=0,c=o.length;a<c;a++,i++)r[i]=o[a];return r},w=a.sheets.Core,C=w.Spread.Formatter,M=w.Spread.Sheets,N=M.FloatingObjects,I=M.Events,S=I.FloatingObjectLoaded,D=I.FloatingObjectChanged,k=I.FloatingObjectBeforeUnload,z=I.FloatingObjectSelectionChanged,L=I.RowOrColVisibleChanged,T=I.SheetZoomed,A=I.CellClick,E=I.RangeFiltered,B=I.RangeGroupStateChanged,R=function(){},Q=function(n,t,e,r){},Z=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.isChartV2=!0,t}return O(t,n),t.prototype.clone=function(){var n=new t(this.name()+"-clone"),e=JSON.stringify(this.toJSON());return n.fromJSON(JSON.parse(e)),n.content(this.cloneContent()),n.chart=Object(p.a)(this.chart,function(n){n.id=y.a.generateChartId()}),n},t.prototype.exportPosition=function(){var n=this.width(),t=this.height();return{row:this.startRow(),col:this.startColumn(),rowOffset:Math.round(this.startRowOffset()),colOffset:Math.round(this.startColumnOffset()),width:n,height:t}},t.prototype.applyPosition=function(n){var t=n.row,e=n.col,r=n.rowOffset,i=n.colOffset,o=n.width,a=n.height;this.startRow(t),this.startRowOffset(Math.round(r)),this.startColumn(e),this.startColumnOffset(Math.round(i)),this.width(o),this.height(a)},t}(N.FloatingObject);!function(n){n.categoryToFormatType=function(n,t){switch(n){case C.FormatterCategory.text:case C.FormatterCategory.time:case C.FormatterCategory.accounting:case C.FormatterCategory.currency:case C.FormatterCategory.number:case C.FormatterCategory.fraction:case C.FormatterCategory.scientific:case C.FormatterCategory.percent:return"number";case C.FormatterCategory.date:case C.FormatterCategory.dateTime:return"date";case C.FormatterCategory.other:var e=Number(t);return e==e?"number":"text";default:return Object(f.c)(n),"text"}},n.cellToDataItem=function(t,e,r,i,o){var a=m.a.DataItems.empty;if(null==e||""===e)return a(i,o);var c=C.getFormatterCategory(t),u=n.categoryToFormatType(c,e);switch(u){case"empty":return a(i,o);case"number":return"number"!=typeof e||e!=e?{type:"text",value:String(e),text:r,format:t,isHidden:i,span:o}:{type:u,value:Number(e),text:r,format:t,isHidden:i,span:o};case"text":return{type:u,value:String(e),text:r,format:t,isHidden:i,span:o};case"date":return e instanceof Date?{type:u,value:e,oadate:w.Spread.Common._DateTimeHelper._toOADate(e),text:r,format:t,isHidden:i,span:o}:{type:"text",value:String(e),text:r,format:t,isHidden:i,span:o};default:return Object(f.b)(u)}};var t={};n.format=function(n,e){try{return e?(t[e]||(t[e]=new w.Spread.Formatter.GeneralFormatter(e)),t[e].format(n,{})||""):String(n)}catch(t){return n?String(n):""}}}(i||(i={})),function(n){var t=-1;n.create=function(n,e){var r,o,a,f=e.getState,p=e.handler,O="chart:environment:"+ ++t,w=Object(b.a)(O),C=function(n,t){t.sheet;var e=t.floatingObject;t.contentDiv;e instanceof Z&&p.updateChartHosts(e.chart.id,e.getHost())},M=function(){var t=n.spread.B();if(t){var e=t.E.floatingObjects.all().filter(function(n){return n.isSelected()&&n instanceof Z}).map(function(n){return{fo:n,id:n.chart.id}});e[0]&&p.deleteChart(e)}};Object(v.b)(n,Object(h.a)(((r={})[S]=C,r[D]=function(n,t){var e=t,r=e.floatingObject,i=e.propertyName;if(r instanceof Z&&["location","position","width","height"].includes(i)){var o=r.exportPosition(),a=y.a.getChartById(f(),r.chart.id);a&&(Object(g.a)(a.position,o)||p.updateChartPosition(a.id,o))}},r[k]=C,r[z]=function(t,e){var r=e.floatingObject;if(r instanceof Z&&r.isSelected()){var i=n.spread.B();if(!i)return;var o=i.id;p.selectChart(o,r.chart.id)}},r[A]=function(){var t=n.spread.B();if(t){var e=t.id;p.selectChart(e,void 0)}},r[L]=function(){return p.dataChanged()},r[E]=function(){return p.dataChanged()},r[B]=function(){return p.dataChanged()},r),Q)),Object(v.a)(n,Object(h.a)(((o={})[T]=function(n,t){var e=t.zoomFactor;p.zoom(e)},o),Q));var N,I=n.R.RR,P=function(n){return function(t,e){return void 0===e&&(e=[]),n(t),x(e,p.collectChangesAndMarkCommitted())}};(a={})[u.a.CollectOperatorAfterFloatingObjectDeleted]=M,a[u.a.CollectOperatorAfterFloatingObjectPasted]=function(n){var t=n.sheet,e=t.floatingObjects.all().filter(function(n){return n instanceof Z&&!y.a.getChartById(f(),n.chart.id)}).map(function(n){var e=n.exportPosition();return j(j({},n.chart),{sheetId:t.guid(),position:e})}).filter(Boolean);p.addChart(e)},a[u.a.CollectOperatorAfterFloatingObjectCut]=M,a[u.a.CollectOperatorAfterSheetDuplicated]=function(n){var t=n.oldSheet,e=n.newSheet;p.duplicateSheet({oldSheetId:t.guid(),newSheetId:e.guid()})},a[u.a.CollectOperatorAfterSheetDeleted]=function(n){var t=n.deleteSheet;p.deleteSheet({sheetId:t.id})},a[u.a.CollectOperatorAfterSheetRenamed]=R,a[u.a.CollectOperatorAfterSorted]=R,a[u.a.CollectOperatorAfterAddOrDeleteCells]=R,a[u.a.CollectOperatorAfterDragDropped]=R,a[u.a.CollectOperatorAfterRowOrColChanged]=R,N=a,Object.keys(N).forEach(function(n){var t=N[n];I(n,P(Object(b.b)(O+":hook:"+n,t)))}),n.on(c.default.PermissionChanged,function(){return p.permissionChanged()}),n.on(c.default.AfterActiveRenderTaskCompleted,function(n){var t=n.sheet,e=y.a.getChartsBySheet(f(),t.id).map(function(n){return n.id});e.length&&p.forceRepaintCharts(e)});var G={readData:function(t){var e=t.sheetName,r=t.range,o=r.row,a=r.rowCount,c=r.col,u=r.colCount,f=n.spread.getSheetByName(e);if(!f)return[];var l=f.E,d=l.G()-1,h=l.G()-1,v=l.isRangeReadable({row:o,rowCount:a,col:c,colCount:u}),b=Object(s.a)(a).map(function(n){return l.getRowVisible(o+n)}),g=Object(s.a)(u).map(function(n){return l.getColumnVisible(c+n)}),p=l.getSpans({row:o,rowCount:a,col:c,colCount:u}).length>0;return Object(s.a)(a).map(function(n,t){var e=o+t,r=v||l.isRangeReadable({row:e,rowCount:1,col:c,colCount:u});return Object(s.a)(u).map(function(n,o){var a=c+o;if(e<0||e>d)return m.a.DataItems.empty(!0,void 0);if(a<0||a>h)return m.a.DataItems.empty(!0,void 0);var u=r||l.isRangeReadable(e,a,1,1),s=!(b[t]&&g[o]),f=p?l.getSpan(e,a):void 0,v=f&&{rowIndex:e-f.row,colIndex:a-f.col,rowCount:f.rowCount,colCount:f.colCount};if(!u)return m.a.DataItems.empty(s,v);var y=l.getValue(e,a),O=l.getText(e,a),j=l.getFormatter(e,a),x=l.getAutoFormatter(e,a);return i.cellToDataItem(j||x,y,O,s,v)})})},format:i.format,setCharts:function(t){var r={};return n.spread.sheets.forEach(function(n){var i=n.E,o=t.filter(function(t){return t.sheetId===n.id}),a=i.floatingObjects.all().filter(function(n){return n instanceof Z});Object(d.a)(a,o,{getKeyA:function(n){return n.chart.id},getKeyB:function(n){return n.id},needUpdate:function(n,t){return!0},add:function(n){w("[add]",n);var t=new Z("chartv2-"+n.id);return t.chart=n,t.dynamicMove(!0),t.dynamicSize(!1),t.allowMove(e.canEditChart(n)),t.allowResize(e.canEditChart(n)),t.disableSelect(!e.canEditChart(n)),t.applyPosition(n.position),t.content(document.createElement("div")),i.floatingObjects.add(t),t},remove:function(n){return w("[remove]",n),i.floatingObjects.remove(n.name()),null},update:function(n,t){w("[update]",n,t),n.chart=t;var r="chartv2-"+t.id;return n.name()!==r&&n.name(r),n.allowMove(e.canEditChart(t)),n.allowResize(e.canEditChart(t)),n.disableSelect(!e.canEditChart(t)),n.applyPosition(t.position),n}}),i.floatingObjects.all().filter(function(n){return n instanceof Z}).forEach(function(n){r[n.chart.id]=n.getHost()})}),r},selectChart:function(t){var e=n.spread.B(),r=e&&e.E;if(r&&r.guid()===t.id){var i=r.floatingObjects.all().find(function(n){return n instanceof Z&&n.chart.id===t.id});i&&!i.isSelected()&&i.isSelected(!0)}}};return l.b?Object(b.c)(G,O,!1,["format","readData"]):G}}(o||(o={}))},3285:function(n,t,e){"use strict";e.d(t,"b",function(){return o}),e.d(t,"a",function(){return a});var r=e(3).sheets.Core.Spread.Sheets,i=0,o=function(n,t){var e="listener_"+i++,o=r.Worksheet,a=function(n){for(var e=0,r=Object.entries(t);e<r.length;e++){var i=r[e],o=i[0],a=i[1];n.bind(o,a)}};n.spread.sheets.forEach(function(n){a(n.E)}),o._registerFeature(e,{priority:4998,init:function(){a(this)},dispose:function(){}})},a=function(n,t){var e="listener_"+i++,o=r.Workbook,a=function(n){for(var e=0,r=Object.entries(t);e<r.length;e++){var i=r[e],o=i[0],a=i[1];n.bind(o,a)}};a(n.spread.gcSpread),o._registerFeature(e,{priority:4998,init:function(){a(this)}})}},3286:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(3),o=e(4),a=e(2118),c=e(2140),u=e(2134),s=i.sheets.Core,f=s.Spread.Sheets.FormulaTextBox;!function(n){var t=s.Spread.CalcEngine.Functions;!function(){if(!t.findGlobalFunction("SERIES")){var n=new t.Function("SERIES",0,9);n.evaluate=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return 0},n.acceptsReference=function(n){return!0},n.acceptsArray=function(n){return!0},t.defineGlobalCustomFunction("SERIES",n)}}();var e=document.body.appendChild(document.createElement("div"));e.id="reference-editor",e.style.display="none";var r=-1;n.create=function(n,t){var i=t.handler,s="chart:referenceeditor:"+ ++r,l=[],d=function(){var t=n.spread.B();if(!t)return[];var e=t.name;return l.filter(function(n){return n.reference&&n.reference.sheetName===e})},h=function(t){return function(e){var r=e.paramRange.index,o=e.fromRange,a=e.toRange;if(i.onChanging){var c=l[r],s=n.spread.B();if(s){var f=s.name,h={key:c.key,reference:{sheetName:f,range:a}},v={key:c.key,reference:{sheetName:f,range:o}},b=i.onChanging({next:h,prev:v,records:d(),index:r,changeType:t});return b?{replace:b.map(function(n,t){return{index:t,rangeString:u.a.stringify(n.reference)}})}:void 0}}}},v=function(n){return function(n,t){n.paramRange.index,n.fromRange,n.toRange;if(i.onChanged){var e=t.map(function(n,t){var e=u.a.parse(n)[0];return{key:d()[t].key,reference:e}});i.onChanged({records:e})}}},b=function(){var t=n.spread.gcSpread.B();if(t){var r,i=0===(r=d().map(function(n){return n.reference})).length?"":"=SERIES("+r.map(function(n){return u.a.stringify(n)}).join(",")+")",o=t;if(!o._formulaTextBoxForChart){o._formulaTextBoxForChart=new f.FormulaTextBox(e,{rangeSelectMode:!0,absoluteReference:!0},n.spread.gcSpread);var a=o._formulaTextBoxForChart;a.onRangeMoving=h("move"),a.onRangeMoved=v(),a.onRangeResizing=h("resize"),a.onRangeResized=v();a.bind("TextChanged",function(){var t=n.spread.gcSpread.B();t&&t._render._paintFormulaTextBox()})}o._formulaTextBoxForChart.text(i),o._render._paintFormulaTextBox()}};n.on(o.default.IV,b);var g={setReferenceRecords:function(n){var t=n.filter(function(n){return n.reference});l=t,b()},DEBUG:function(){return{currentRecords:l}}};return g.setReferenceRecords([]),a.b?Object(c.c)(g,s):g}}(r||(r={}))},3287:function(n,t,e){"use strict";e.d(t,"a",function(){return r});var r,i=e(3),o=e(2118),a=e(2195),c=e(2512),u=e(2360),s=e(2140),f=e(2138),l=e(2231),d=e(2134),h=this&&this.__assign||function(){return(h=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},v=i.sheets.Core,b=i.sheets.Events;!function(n){var t=function(n){return{sheetName:n.getSource().getName(),range:{row:n.getRow(0),col:n.getColumn(0),rowCount:n.getActualRowCount(0),colCount:n.getActualColumnCount(0)}}},e=v.Spread.CalcEngine.Functions,r=Object(u.a)(),i=-1;n.create=function(n,u){var g="chart:watcher:"+ ++i,p=Object(s.a)(g),m="YoWatchThis_"+i,y=[],O=function(){return n.spread.gcSpread.getCalcObserver(m)},j=u.handler;!function(){if(!e.findGlobalFunction("YO_WATCH_THIS")){var n=new e.Function("YO_WATCH_THIS",0,9);n.evaluate=function(n){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=e.map(t);return r.emit("Evaluating",{key:n,references:o}),0},n.acceptsReference=function(){return!0},n.acceptsArray=function(){return!0},e.defineGlobalCustomFunction("YO_WATCH_THIS",n)}}();var x=function(n){var t=n.observerId,e=n.formula,r=y.find(function(n){return n.observerId===t});if(r){var i=e||O().getFormula(t),o=d.a.parseWatchFormula(i);if(!o)throw new Error("parse watch formula failed: "+i);j.referenceRangeChanged(o,r)}};v.Spread.Sheets._getFeatureManager("Worksheet").register(m,Object(c.a)({adjustFormulasOnCellOpsForCalcObserver:x,adjustFormulasOnSheetNameChangedForCalcObserver:x},function(n,t,e,r){})),n.on(b.ActiveCellAttrsChanged,function(){var t=n.spread.B().E,e=t.getSelections()[0];if(e){var r=e.row,i=e.col,o=e.rowCount,a=e.colCount,c=t.name();y.filter(function(n){return n.reference&&n.reference.sheetName===c&&Object(l.h)(n.reference.range,{row:r,col:i,rowCount:o,colCount:a})}).forEach(function(n){j.referenceValueChanged(n)})}}),r.on("Evaluating",function(n){var t=n.key,e=n.references,r=y.find(function(n){return n.key===t});if(1!==e.length)throw new Error("references' length should be 1");r&&j.referenceValueChanged({key:r.key,reference:e[0]})});var w={setWatchList:function(n){y=Object(a.a)(y,n,{getKeyA:function(n){return n.key},getKeyB:function(n){return n.key},needUpdate:function(n,t){return!Object(f.a)(n.reference,t.reference)},add:function(n){p("[watch] add",n);var t,e='YO_WATCH_THIS("'+(t=n).key+'",'+d.a.stringify(t.reference)+")";return j.recordAdded(n,e),h(h({},n),{observerId:O().addObserver(e)})},remove:function(n){return p("[watch] remove",n),O().removeObserver(n.observerId),null}})}};return o.b?Object(s.c)(w,g):w}}(r||(r={}))}});